const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-C3RsYZLo.js","./iframe-D_EQZObv.js","./index-DDTrk2sx.js","./marked.esm-5oS_x8zC.js","./throttle-8delv2dO.js","./flatten-DiKC8pdQ.js","./number-overlay-editor-BJmacAHz.js","./react-number-format.es-D-Gz6BRS.js"])))=>i.map(i=>d[i]);
var Xs=Object.defineProperty;var Ys=(e,t,n)=>t in e?Xs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Xe=(e,t,n)=>Ys(e,typeof t!="symbol"?t+"":t,n);import{r as a,R as vt,_ as Rl}from"./iframe-D_EQZObv.js";import{h as Gs,g as El,j as _s,k as Ks,v as Us,l as Vs,m as sn,r as co,t as qs}from"./throttle-8delv2dO.js";import{u as js,f as Zi}from"./flatten-DiKC8pdQ.js";import{s as Jt,a as Zs}from"./marked.esm-5oS_x8zC.js";function Il(e="This should not happen"){throw new Error(e)}function jt(e,t="Assertion failed"){if(!e)return Il(t)}function rr(e,t){return Il(t??"Hell froze over")}function Js(e,t){try{return e()}catch{return t}}const Ji=Object.prototype.hasOwnProperty;function Ho(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ho(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Ji.call(e,n)&&++o&&!Ji.call(t,n)||!(n in t)||!Ho(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const $r=null,Si=void 0;var j;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(j||(j={}));var Qi;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(Qi||(Qi={}));var Or;(function(e){e.Triangle="triangle",e.Dots="dots"})(Or||(Or={}));function Tr(e){return"width"in e&&typeof e.width=="number"}async function el(e){return typeof e=="object"?e:await e()}function Io(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown)}function xu(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown||e.kind===j.Boolean||e.kind===j.Image||e.kind===j.Custom)}function Do(e){return e.kind===cn.Marker||e.kind===cn.NewRow}function er(e){if(!Io(e)||e.kind===j.Image)return!1;switch(e.kind){case j.Text:case j.Number:case j.Markdown:case j.Uri:case j.Custom:case j.Boolean:return e.readonly!==!0;default:rr(e,"A cell was passed with an invalid kind")}}function Qs(e){return Gs(e,"editor")}function Mi(e){return!(e.readonly??!1)}var cn;(function(e){e.NewRow="new-row",e.Marker="marker"})(cn||(cn={}));function ea(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let tl;const zn=class zn{constructor(t){Xe(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new zn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ea([...this.items,n]);return new zn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,l]of n.entries()){const[s,c]=l;if(s<=r&&o<=c){const f=[];s<o&&f.push([s,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new zn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Xe(zn,"empty",()=>tl??(tl=new zn([]))),Xe(zn,"fromSingleSelection",t=>zn.empty().add(t));let it=zn;const ta=Jt("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function $t(e,t,n,o,r=!1){const i=a.useRef();i.current=t,a.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=c=>{var f;(f=i.current)==null||f.call(l,c)};return l.addEventListener(e,s,{passive:o,capture:r}),()=>{l.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function qn(e,t){return e===void 0?void 0:t}const na=Math.PI;function nl(e){return e*na/180}const Dl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Fl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Hl=(e,t,n)=>Math.min(e,t-n*2),Tl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ri=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),a.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},oa=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ra(e,t,n){const[o,r]=a.useState(e),i=a.useRef(!0);a.useEffect(()=>()=>{i.current=!1},[]);const l=a.useRef(El(s=>{i.current&&r(s)},n));return a.useLayoutEffect(()=>{i.current&&l.current(()=>e())},t),o}const ia="֑-߿יִ-﷽ﹰ-ﻼ",la="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",sa=new RegExp("^[^"+la+"]*["+ia+"]");function Ei(e){return sa.test(e)?"rtl":"not-rtl"}let Ar;function pi(){if(typeof document>"u")return 0;if(Ar!==void 0)return Ar;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Ar=n-o,Ar}const ao=Symbol();function aa(e){const t=a.useRef([ao,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=a.useState(e),[,r]=a.useState(),i=a.useCallback(s=>{const c=t.current[0];c!==ao&&(s=typeof s=="function"?s(c):s,s===c)||(c!==ao&&r({}),o(f=>typeof s=="function"?s(c===ao?f:c):s),t.current[0]=ao)},[]),l=a.useCallback(()=>{t.current[0]=ao,r({})},[]);return[t.current[0]===ao?n:t.current[0],i,l]}function Al(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ca(e){const t=a.useRef(e);return Ho(e,t.current)||(t.current=e),t.current}const da=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const l=i.length>1;return a.createElement(ta,{"data-testid":"GDG-default-image-overlay-editor"},a.createElement(_s.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},i.map(s=>{const c=(r==null?void 0:r(s))??a.createElement("img",{draggable:!1,src:s});return a.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&a.createElement("button",{className:"gdg-edit-icon",onClick:o},a.createElement(Ri,null)))},ua=Jt("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class fa extends vt.PureComponent{constructor(){super(...arguments);Xe(this,"targetElement",null);Xe(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,l=Zs(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(l);if(c===void 0){const u=document.createElement("template");u.innerHTML=l,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),vt.createElement(ua,{ref:this.containerRefHook})}}const ha=Jt("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),ga=Jt("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),ma=Jt("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let ol=0;const _r=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:l,...s}=e,{onChange:c,className:f}=s,u=a.useRef(null),w=n??"";jt(c!==void 0,"GrowingEntry must be a controlled input area");const[b]=a.useState(()=>"input-box-"+(ol=(ol+1)%1e7));a.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const g=w.toString().length;h.focus(),h.setSelectionRange(r?0:g,g)},[]),a.useLayoutEffect(()=>{var h;if(l!==void 0){const g=typeof l=="number"?[l,null]:l;(h=u.current)==null||h.setSelectionRange(g[0],g[1])}},[l]);const m=a.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return a.createElement(ma,{className:"gdg-growing-entry"},a.createElement(ga,{className:f},w+`
`),a.createElement(ha,{...s,className:(f??"")+" gdg-input",id:b,ref:u,onKeyDown:m,value:w,placeholder:t,dir:"auto"}))},fi={};let Un=null;function wa(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function To(e){const t=e.toLowerCase().trim();if(fi[t]!==void 0)return fi[t];Un=Un||wa(),Un.style.color="#000",Un.style.color=t;const n=getComputedStyle(Un).color;Un.style.color="#fff",Un.style.color=t;const o=getComputedStyle(Un).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),fi[t]=r,r}function fo(e,t){const[n,o,r]=To(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const rl=new Map;function il(e,t){const n=`${e}-${t}`,o=rl.get(n);if(o!==void 0)return o;const r=Zt(e,t);return rl.set(n,r),r}function Zt(e,t){if(t===void 0)return e;const[n,o,r,i]=To(e);if(i===1)return e;const[l,s,c,f]=To(t),u=i+f*(1-i),w=(i*n+f*l*(1-i))/u,b=(i*o+f*s*(1-i))/u,m=(i*r+f*c*(1-i))/u;return`rgba(${w}, ${b}, ${m}, ${u})`}function ku(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...To(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...To(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,l=1-n,s=o[3]*l+r[3]*i,c=Math.floor((o[0]*l+r[0]*i)/s),f=Math.floor((o[1]*l+r[1]*i)/s),u=Math.floor((o[2]*l+r[2]*i)/s);return`rgba(${c}, ${f}, ${u}, ${s})`}function Su(e){if(e==="transparent")return 0;function t(i){const l=i/255;return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}const[n,o,r]=To(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function ba(e,t){return vt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function ya(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(tr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function ir(e,t){return(e??"")===(t??"")}function pa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function zl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function tr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Bl(e){return[e.x+e.width-1,e.y+e.height-1]}function ll(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,l=n.y+n.height-1,[s,c]=e;if(c<i||c>l)return!1;if(t.span===void 0)return s>=o&&s<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function va(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&ll(e,t,i)&&r++;for(const l of n.current.rangeStack)ll(e,t,l)&&r++;return r}function Ll(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,l)=>({...i,sticky:e[l].sticky})),n=o}return n}function Ao(e,t){let n=0;const o=Ll(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function ho(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function vi(e,t,n,o,r){const i=Ll(e,o),l=[];for(const f of i)if(f.sticky)l.push(f);else break;if(l.length>0)for(const f of l)n-=f.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let f=t;f<s;f++){const u=i[f];u.sticky||l.push(u)}return l}function Ca(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function xa(e,t,n,o,r,i,l,s,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let w=t;for(let h=0;h<f;h++){const g=i-1-h,x=typeof l=="number"?l:l(g);if(w-=x,e>=w)return g}const b=i-f,m=e-(c??0);if(typeof l=="number"){const h=Math.floor((m-u)/l)+s;return h>=b?void 0:h}else{let h=u;for(let g=s;g<b;g++){const x=l(g);if(m<=h+x)return g;h+=x}return}}let Wr=0,nr={};const ka=typeof window>"u";async function Sa(){var e;ka||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Wr=0,nr={},Us())}Sa();function Pl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function zo(e,t,n,o="middle"){const r=Pl(e,t,o,n);let i=nr[r];return i===void 0&&(i=t.measureText(e),nr[r]=i,Wr++),Wr>1e4&&(nr={},Wr=0),i}function Wl(e,t){const n=Pl(e,void 0,"middle",t);return nr[n]}function Zn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ma(e,t)}function sl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const al=[];function Ma(e,t){for(const i of al)if(i.key===t)return i.val;const n=sl(e,"alphabetic"),r=-(sl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return al.push({key:t,val:r}),r}function Ra(e,t,n,o,r,i){const{ctx:l,rect:s,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const w=1-f/u;l.globalAlpha=w,l.fillStyle=c.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function sr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},l=n??r.textDark;return l!==i.fillStyle&&(o.fillStyle=l,i.fillStyle=l),i}function Mu(e,t,n){const{rect:o,ctx:r,theme:i}=e;r.fillStyle=i.textDark,Rn({ctx:r,rect:o,theme:i},t,n)}function $l(e,t,n,o,r,i,l,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+l):c==="center"?e.fillText(t,n+r/2,o+i/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+l)}function Ol(e,t){const n=zo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ea(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ia(e,t,n,o,r,i,l,s,c,f){const u=s.baseFontFull,w=Ks(e,t,u,r-s.cellHorizontalPadding*2,f??!1),b=Ol(e,u),m=s.lineHeight*b,h=b+m*(w.length-1),g=h+s.cellVerticalPadding>i;g&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let C=Math.max(o+s.cellVerticalPadding,x);for(const v of w)if($l(e,v,n,C,r,b,l,s,c),C+=m,C>o+i)break;g&&e.restore()}function Rn(e,t,n,o,r){const{ctx:i,rect:l,theme:s}=e,{x:c,y:f,width:u,height:w}=l;o=o??!1,o||(t=Ea(t,u));const b=Zn(i,s),m=Ei(t)==="rtl";if(n===void 0&&m&&(n="right"),m&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ia(i,t,c,f,u,w,b,s,n,r):$l(i,t,c,f,u,w,b,s,n),h&&(i.textAlign="start"),m&&(i.direction="inherit")}}function En(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Da(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Fa(e,t,n){const o=function(s,c){const f=c.x-s.x,u=c.y-s.y,w=Math.sqrt(f*f+u*u),b=f/w,m=u/w;return{x:f,y:c.y-s.y,len:w,nx:b,ny:m,ang:Math.atan2(m,b)}};let r;const i=t.length;let l=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const f=t[(s+1)%i],u=o(c,l),w=o(c,f),b=u.nx*w.ny-u.ny*w.nx,m=u.nx*w.nx-u.ny*-w.ny;let h=Math.asin(b<-1?-1:b>1?1:b),g=1,x=!1;m<0?h<0?h=Math.PI+h:(h=Math.PI-h,g=-1,x=!0):h>0&&(g=-1,x=!0),r=c.radius!==void 0?c.radius:n;const C=h/2;let v=Math.abs(Math.cos(C)*r/Math.sin(C)),I;v>Math.min(u.len/2,w.len/2)?(v=Math.min(u.len/2,w.len/2),I=Math.abs(v*Math.sin(C)/Math.cos(C))):I=r;let X=c.x+w.nx*v,N=c.y+w.ny*v;X+=-w.ny*I*g,N+=w.nx*I*g,e.arc(X,N,I,u.ang+Math.PI/2*g,w.ang-Math.PI/2*g,x),l=c,c=f}e.closePath()}function Ci(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h){const g={x:0,y:i+f,width:0,height:0};if(e>=m.length||t>=u||t<-2||e<0)return g;const x=i-r;if(e>=w){const C=l>e?-1:1,v=Ao(m);g.x+=v+c;for(let I=l;I!==e;I+=C)g.x+=m[C===1?I:I-1].width*C}else for(let C=0;C<e;C++)g.x+=m[C].width;if(g.width=m[e].width+1,t===-1)g.y=r,g.height=x;else if(t===-2){g.y=0,g.height=r;let C=e;const v=m[e].group,I=m[e].sticky;for(;C>0&&ir(m[C-1].group,v)&&m[C-1].sticky===I;){const N=m[C-1];g.x-=N.width,g.width+=N.width,C--}let X=e;for(;X+1<m.length&&ir(m[X+1].group,v)&&m[X+1].sticky===I;){const N=m[X+1];g.width+=N.width,X++}if(!I){const N=Ao(m),A=g.x-N;A<0&&(g.x-=A,g.width+=A),g.x+g.width>n&&(g.width=n-g.x)}}else if(t>=u-b){let C=u-t;for(g.y=o;C>0;){const v=t+C-1;g.height=typeof h=="number"?h:h(v),g.y-=g.height,C--}g.height+=1}else{const C=s>t?-1:1;if(typeof h=="number"){const v=t-s;g.y+=v*h}else for(let v=s;v!==t;v+=C)g.y+=h(v)*C;g.height=(typeof h=="number"?h:h(t))+1}return g}const Ii=1<<21;function bn(e,t){return(t+2)*Ii+e}function Nl(e){return e%Ii}function Di(e){return Math.floor(e/Ii)-2}function Fi(e){const t=Nl(e),n=Di(e);return[t,n]}class Xl{constructor(){Xe(this,"visibleWindow",{x:0,y:0,width:0,height:0});Xe(this,"freezeCols",0);Xe(this,"freezeRows",[]);Xe(this,"isInWindow",t=>{const n=Nl(t),o=Di(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,l=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ho(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ha extends Xl{constructor(){super(...arguments);Xe(this,"cache",new Map);Xe(this,"setValue",(n,o)=>{this.cache.set(bn(n[0],n[1]),o)});Xe(this,"getValue",n=>this.cache.get(bn(n[0],n[1])));Xe(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class or{constructor(t=[]){Xe(this,"cells");this.cells=new Set(t.map(n=>bn(n[0],n[1])))}add(t){this.cells.add(bn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(bn(t[0],t[1]))}remove(t){this.cells.delete(bn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Di(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(bn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Fi(t)}}function Ta(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Yl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function Gl(){return Yl}const _l=vt.createContext(Yl);function Ru(){return vt.useContext(_l)}function Bn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Zt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const xi=150;function Aa(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??xi}function Kl(e,t,n,o,r,i,l,s,c){let f=0;const u=r===void 0?[]:r.map(m=>{const h=Aa(e,m[o],t,c);return f=Math.max(f,h),h});if(u.length>5&&s){f=0;let m=0;for(const g of u)m+=g;const h=m/u.length;for(let g=0;g<u.length;g++)u[g]>=h*2?u[g]=0:f=Math.max(f,u[g])}const w=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=w;const b=Math.max(Math.ceil(i),Math.min(Math.floor(l),Math.ceil(f)));return{...n,width:b}}function za(e,t,n,o,r,i,l,s,c){const f=a.useRef(t),u=a.useRef(n),w=a.useRef(l);f.current=t,u.current=n,w.current=l;const[b,m]=a.useMemo(()=>{if(typeof window>"u")return[null,null];const v=document.createElement("canvas");return v.style.display="none",v.style.opacity="0",v.style.position="fixed",[v,v.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>(b&&document.documentElement.append(b),()=>{b==null||b.remove()}),[b]);const h=a.useRef({}),g=a.useRef(),[x,C]=a.useState();return a.useLayoutEffect(()=>{const v=u.current;if(v===void 0||e.every(Tr))return;let I=Math.max(1,10-Math.floor(e.length/1e4)),X=0;I<f.current&&I>1&&(I--,X=1);const N={x:0,y:0,width:e.length,height:Math.min(f.current,I)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const _=v(N,c.signal),S=X>0?v(A,c.signal):void 0;let $;typeof _=="object"?$=_:$=await el(_),S!==void 0&&(typeof S=="object"?$=[...$,...S]:$=[...$,...await el(S)]),g.current=e,C($)})()},[c.signal,e]),a.useMemo(()=>{let I=e.every(Tr)?e:m===null?e.map(z=>Tr(z)?z:{...z,width:xi}):(m.font=w.current.baseFontFull,e.map((z,_)=>{if(Tr(z))return z;if(h.current[z.id]!==void 0)return{...z,width:h.current[z.id]};if(x===void 0||g.current!==e||z.id===void 0)return{...z,width:xi};const S=Kl(m,l,z,_,x,r,i,!0,s);return h.current[z.id]=S.width,S})),X=0,N=0;const A=[];for(const[z,_]of I.entries())X+=_.width,_.grow!==void 0&&_.grow>0&&(N+=_.grow,A.push(z));if(X<o&&A.length>0){const z=[...I],_=o-X;let S=_;for(let $=0;$<A.length;$++){const W=A[$],F=(I[W].grow??0)/N,R=$===A.length-1?S:Math.min(S,Math.floor(_*F));z[W]={...I[W],growOffset:R,width:I[W].width+R},S-=R}I=z}return{sizedColumns:I,nonGrowWidth:X}},[o,e,m,x,l,r,i,s])}const at='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Ba=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},La=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Pa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Wa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},$a=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Ul=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Oa=e=>{const t=e.bgColor;return`${at}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Na=Ul,Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},_a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Ka=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},ac=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},cc={headerRowID:Ba,headerNumber:Pa,headerCode:La,headerString:Wa,headerBoolean:$a,headerAudioUri:Na,headerVideoUri:Xa,headerEmoji:Ya,headerImage:Ga,headerUri:Ul,headerPhone:_a,headerMarkdown:Ka,headerDate:Ua,headerTime:Va,headerEmail:qa,headerReference:ja,headerIfThenElse:Za,headerSingleValue:Ja,headerLookup:Qa,headerTextTemplate:ec,headerMath:tc,headerRollup:nc,headerJoinStrings:oc,headerSplitString:rc,headerGeoDistance:ic,headerArray:lc,rowOwnerOverlay:sc,protectedColumnOverlay:ac,renameIcon:Oa};function dc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class uc{constructor(t,n){Xe(this,"onSettled");Xe(this,"spriteMap",new Map);Xe(this,"headerIcons");Xe(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,l,s,c=1){const[f,u]=dc(n,s),w=l*Math.ceil(window.devicePixelRatio),b=`${f}_${u}_${w}_${t}`;let m=this.spriteMap.get(b);if(m===void 0){const h=this.headerIcons[t];if(h===void 0)return;m=document.createElement("canvas");const g=m.getContext("2d");if(g===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(b,m);const C=x.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{g.drawImage(x,0,0,w,w)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(m,0,0,w,w,r,i,l,l),c<1&&(o.globalAlpha=1)}}function Vl(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Kr(e,t,n,o,r,i,l,s,c){s=s??t;let f=t,u=e;const w=o-i;let b=!1;for(;f<n&&u<w;){const m=r(u);if(f+m>s&&c(f,u,m,!1,l&&u===o-1)===!0){b=!0;break}f+=m,u++}if(!b){f=n;for(let m=0;m<i;m++){u=o-1-m;const h=r(u);f-=h,c(f,u,h,!0,l&&u===o-1)}}}function Jn(e,t,n,o,r,i){let l=0,s=0;const c=r+o;for(const f of e){const u=f.sticky?s:l+n;if(i(f,u,c,f.sticky?0:s,t)===!0)break;l+=f.width,s+=f.sticky?f.width:0}}function ql(e,t,n,o,r){let i=0,l=0;for(let s=0;s<e.length;s++){const c=e[s];let f=s+1,u=c.width;for(c.sticky&&(l+=u);f<e.length&&ir(e[f].group,c.group)&&e[f].sticky===e[s].sticky;){const g=e[f];u+=g.width,f++,s++,g.sticky&&(l+=g.width)}const w=c.sticky?0:n,b=i+w,m=c.sticky?0:Math.max(0,l-b),h=Math.min(u-m,t-(b+m));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",b+m,0,h,o),i+=u}}function jl(e,t,n,o,r,i,l){var b;const[s,c]=e;let f,u;const w=((b=l.find(m=>!m.sticky))==null?void 0:b.sourceIndex)??0;if(c>w){const m=Math.max(s,w);let h=t,g=o;for(let x=i.sourceIndex-1;x>=m;x--)h-=l[x].width,g+=l[x].width;for(let x=i.sourceIndex+1;x<=c;x++)g+=l[x].width;u={x:h,y:n,width:g,height:r}}if(w>s){const m=Math.min(c,w-1);let h=t,g=o;for(let x=i.sourceIndex-1;x>=s;x--)h-=l[x].width,g+=l[x].width;for(let x=i.sourceIndex+1;x<=m;x++)g+=l[x].width;f={x:h,y:n,width:g,height:r}}return[f,u]}function fc(e,t,n,o){if(o==="any")return Zl(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),zl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===l?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function lr(e,t,n,o,r,i,l,s){return e<=r+l&&r<=e+n&&t<=i+s&&i<=t+o}function uo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Zl(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function hc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function gc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,l=t+4,s=n+4,c=r-e.x,f=e.x+e.width-l,u=i-e.y,w=e.y+e.height-s,b=c>0?e.x+Math.floor(c/o)*o:e.x,m=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,g=w>0?e.y+e.height-Math.floor(w/o)*o:e.y+e.height;return{x:b,y:h,width:m-b,height:g-h}}function mc(e,t,n,o,r){const[i,l,s,c]=t,[f,u,w,b]=r,{x:m,y:h,width:g,height:x}=e,C=[];if(g<=0||x<=0)return C;const v=m+g,I=h+x,X=m<i,N=h<l,A=m+g>s,z=h+x>c,_=m>=i&&m<s||v>i&&v<=s||m<i&&v>s,S=h>=l&&h<c||I>l&&I<=c||h<l&&I>c;if(_&&S){const W=Math.max(m,i),F=Math.max(h,l),R=Math.min(v,s),M=Math.min(I,c);C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:f,y:u,width:w-f+1,height:b-u+1}})}if(X&&N){const W=m,F=h,R=Math.min(v,i),M=Math.min(I,l);C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:0,y:0,width:f+1,height:u+1}})}if(N&&_){const W=Math.max(m,i),F=h,R=Math.min(v,s),M=Math.min(I,l);C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:f,y:0,width:w-f+1,height:u+1}})}if(N&&A){const W=Math.max(m,s),F=h,R=v,M=Math.min(I,l);C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:w,y:0,width:n-w+1,height:u+1}})}if(X&&S){const W=m,F=Math.max(h,l),R=Math.min(v,i),M=Math.min(I,c);C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:0,y:u,width:f+1,height:b-u+1}})}if(A&&S){const W=Math.max(m,s),F=Math.max(h,l),R=v,M=Math.min(I,c);C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:w,y:u,width:n-w+1,height:b-u+1}})}if(X&&z){const W=m,F=Math.max(h,c),R=Math.min(v,i),M=I;C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:0,y:b,width:f+1,height:o-b+1}})}if(z&&_){const W=Math.max(m,i),F=Math.max(h,c),R=Math.min(v,s),M=I;C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:f,y:b,width:w-f+1,height:o-b+1}})}if(A&&z){const W=Math.max(m,s),F=Math.max(h,c),R=v,M=I;C.push({rect:{x:W,y:F,width:R-W,height:M-F},clip:{x:w,y:b,width:n-w+1,height:o-b+1}})}return C}const wc={kind:j.Loading,allowOverlay:!1};function cl(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x,C,v,I,X,N,A,z,_,S,$,W,F,R,M,ce,ne,oe,Ie){let ve=(I==null?void 0:I.size)??Number.MAX_SAFE_INTEGER;const Z=performance.now();let K=R.baseFontFull;e.font=K;const we={ctx:e},J=[0,0],be=x>0?ho(c,x,f):0;let fe,U;const xe=Vl(v);return Jn(t,s,i,l,r,(Ce,Ue,ot,wt,rt)=>{const ze=Math.max(0,wt-Ue),Ve=Ue+ze,Me=r+1,bt=Ce.width-ze,ct=o-r-1;if(v.length>0){let Ye=!1;for(let We=0;We<v.length;We++){const $e=v[We];if(lr(Ve,Me,bt,ct,$e.x,$e.y,$e.width,$e.height)){Ye=!0;break}}if(!Ye)return}const Ze=()=>{e.save(),e.beginPath(),e.rect(Ve,Me,bt,ct),e.clip()},V=X.columns.hasIndex(Ce.sourceIndex),Oe=w(Ce.group??"").overrideTheme,De=Ce.themeOverride===void 0&&Oe===void 0?R:Bn(R,Oe,Ce.themeOverride),Fe=De.baseFontFull;Fe!==K&&(K=Fe,e.font=Fe),Ze();let he;return Kr(rt,ot,o,c,f,x,C,xe,(Ye,We,$e,de,ue)=>{var pn,Qt,en;if(We<0||(J[0]=Ce.sourceIndex,J[1]=We,I!==void 0&&!I.has(J)))return;if(v.length>0){let Be=!1;for(let Rt=0;Rt<v.length;Rt++){const ut=v[Rt];if(lr(Ue,Ye,Ce.width,$e,ut.x,ut.y,ut.width,ut.height)){Be=!0;break}}if(!Be)return}const tt=X.rows.hasIndex(We),Ge=m.hasIndex(We),Ke=We<c?u(J):wc;let dt=Ue,Je=Ce.width,Te=!1,Ct=!1;if(Ke.span!==void 0){const[Be,Rt]=Ke.span,ut=`${We},${Be},${Rt},${Ce.sticky}`;if(U===void 0&&(U=new Set),U.has(ut)){ve--;return}else{const Ot=jl(Ke.span,Ue,Ye,Ce.width,$e,Ce,n),Tt=Ce.sticky?Ot[0]:Ot[1];if(!Ce.sticky&&Ot[0]!==void 0&&(Ct=!0),Tt!==void 0){dt=Tt.x,Je=Tt.width,U.add(ut),e.restore(),he=void 0,e.save(),e.beginPath();const Gt=Math.max(0,wt-Tt.x);e.rect(Tt.x+Gt,Ye,Tt.width-Gt,$e),fe===void 0&&(fe=[]),fe.push({x:Tt.x+Gt,y:Ye,width:Tt.width-Gt,height:$e}),e.clip(),Te=!0}}}const Lt=b==null?void 0:b(We),xt=ue&&((pn=Ce.trailingRowOptions)==null?void 0:pn.themeOverride)!==void 0?(Qt=Ce.trailingRowOptions)==null?void 0:Qt.themeOverride:void 0,Mt=Ke.themeOverride===void 0&&Lt===void 0&&xt===void 0?De:Bn(De,Lt,xt,Ke.themeOverride);e.beginPath();const Wt=pa(J,Ke,X);let ht=va(J,Ke,X,g);const yn=Ke.span!==void 0&&X.columns.some(Be=>Ke.span!==void 0&&Be>=Ke.span[0]&&Be<=Ke.span[1]);Wt&&!h&&g?ht=0:Wt&&g&&(ht=Math.max(ht,1)),yn&&ht++,Wt||(tt&&ht++,V&&!ue&&ht++);const Ln=Ke.kind===j.Protected?Mt.bgCellMedium:Mt.bgCell;let lt;if((de||Ln!==R.bgCell)&&(lt=Zt(Ln,lt)),ht>0||Ge){Ge&&(lt=Zt(Mt.bgHeader,lt));for(let Be=0;Be<ht;Be++)lt=Zt(Mt.accentLight,lt)}else if(N!==void 0){for(const Be of N)if(Be[0]===Ce.sourceIndex&&Be[1]===We){lt=Zt(Mt.bgSearchResult,lt);break}}if(A!==void 0)for(let Be=0;Be<A.length;Be++){const Rt=A[Be],ut=Rt.range;Rt.style!=="solid-outline"&&ut.x<=Ce.sourceIndex&&Ce.sourceIndex<ut.x+ut.width&&ut.y<=We&&We<ut.y+ut.height&&(lt=Zt(Rt.color,lt))}let In=!1;if(I!==void 0){const Be=Ye+1,ut=(de?Be+$e-1:Math.min(Be+$e-1,o-be))-Be;(ut!==$e-1||dt+1<=wt)&&(In=!0,e.save(),e.beginPath(),e.rect(dt+1,Be,Je-1,ut),e.clip()),lt=lt===void 0?Mt.bgCell:Zt(lt,Mt.bgCell)}const dn=Ce.sourceIndex===n.length-1,pe=We===c-1;lt!==void 0&&(e.fillStyle=lt,he!==void 0&&(he.fillStyle=lt),I!==void 0?e.fillRect(dt+1,Ye+1,Je-(dn?2:1),$e-(pe?2:1)):e.fillRect(dt,Ye,Je,$e)),Ke.style==="faded"&&(e.globalAlpha=.6);let gt;for(let Be=0;Be<S.length;Be++){const Rt=S[Be];if(Rt.item[0]===Ce.sourceIndex&&Rt.item[1]===We){gt=Rt;break}}if(Je>Ie&&!Ct){const Be=Mt.baseFontFull;Be!==K&&(e.font=Be,K=Be),he=Jl(e,Ke,Ce.sourceIndex,We,dn,pe,dt,Ye,Je,$e,ht>0,Mt,lt??Mt.bgCell,z,_,(gt==null?void 0:gt.hoverAmount)??0,$,F,Z,W,he,M,ce,ne,oe)}return In&&e.restore(),Ke.style==="faded"&&(e.globalAlpha=1),ve--,Te&&(e.restore(),(en=he==null?void 0:he.deprep)==null||en.call(he,we),he=void 0,Ze(),K=Fe,e.font=Fe),ve<=0}),e.restore(),ve<=0}),fe}const jo=[0,0],Zo={x:0,y:0,width:0,height:0},hi=[void 0,()=>{}];let ki=!1;function bc(){ki=!0}function Jl(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x,C,v,I,X,N,A,z,_){var ce,ne;let S,$;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(S=x[1][0],$=x[1][1]);let W;jo[0]=n,jo[1]=o,Zo.x=l,Zo.y=s,Zo.width=c,Zo.height=f,hi[0]=A.getValue(jo),hi[1]=oe=>A.setValue(jo,oe),ki=!1;const F={ctx:e,theme:w,col:n,row:o,cell:t,rect:Zo,highlighted:u,cellFillColor:b,hoverAmount:g,frameTime:v,hoverX:S,drawState:hi,hoverY:$,imageLoader:m,spriteManager:h,hyperWrapping:C,overrideCursor:S!==void 0?_:void 0,requestAnimationFrame:bc},R=Ra(F,t.lastUpdated,v,X,r,i),M=z(t);if(M!==void 0){(X==null?void 0:X.renderer)!==M&&((ce=X==null?void 0:X.deprep)==null||ce.call(X,F),X=void 0);const oe=(ne=M.drawPrep)==null?void 0:ne.call(M,F,X);I!==void 0&&!Do(F.cell)?I(F,()=>M.draw(F,t)):M.draw(F,t),W=oe===void 0?void 0:{deprep:oe==null?void 0:oe.deprep,fillStyle:oe==null?void 0:oe.fillStyle,font:oe==null?void 0:oe.font,renderer:M}}return(R||ki)&&(N==null||N(jo)),W}function Hi(e,t,n,o,r,i,l,s,c=-20,f=-20,u=32,w="center",b="square"){const m=Math.floor(r+l/2),h=b==="circle"?1e4:t.roundingRadius??4;let g=Hl(u,l,t.cellVerticalPadding),x=g/2;const C=Fl(w,o,i,t.cellHorizontalPadding,g),v=Dl(C,m,g),I=Tl(o+c,r+f,v);switch(n){case!0:{e.beginPath(),En(e,C-g/2,m-g/2,g,g,h),b==="circle"&&(x*=.8,g*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-x+g/4.23,m-x+g/1.97),e.lineTo(C-x+g/2.42,m-x+g/1.44),e.lineTo(C-x+g/1.29,m-x+g/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case $r:case!1:{e.beginPath(),En(e,C-g/2+.5,m-g/2+.5,g-1,g-1,h),e.lineWidth=1,e.strokeStyle=I?t.textDark:t.textMedium,e.stroke();break}case Si:{e.beginPath(),En(e,C-g/2,m-g/2,g,g,h),e.fillStyle=I?t.textMedium:t.textLight,e.fill(),b==="circle"&&(x*=.8,g*=.8),e.beginPath(),e.moveTo(C-g/3,m),e.lineTo(C+g/3,m),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:rr()}}function yc(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x,C,v){var S,$,W,F;const I=l+s;if(I<=0)return;e.fillStyle=w.bgHeader,e.fillRect(0,0,r,I);const X=(S=o==null?void 0:o[0])==null?void 0:S[0],N=($=o==null?void 0:o[0])==null?void 0:$[1],A=(W=o==null?void 0:o[1])==null?void 0:W[0],z=(F=o==null?void 0:o[1])==null?void 0:F[1],_=w.headerFontFull;e.font=_,Jn(t,0,i,0,I,(R,M,ce,ne)=>{var Ce;if(x!==void 0&&!x.has([R.sourceIndex,-1]))return;const oe=Math.max(0,ne-M);e.save(),e.beginPath(),e.rect(M+oe,s,R.width-oe,l),e.clip();const Ie=g(R.group??"").overrideTheme,ve=R.themeOverride===void 0&&Ie===void 0?w:Bn(w,Ie,R.themeOverride);ve.bgHeader!==w.bgHeader&&(e.fillStyle=ve.bgHeader,e.fill()),ve!==w&&(e.font=ve.baseFontFull);const Z=u.columns.hasIndex(R.sourceIndex),K=c!==void 0||f,we=!K&&N===-1&&X===R.sourceIndex,J=K?0:((Ce=m.find(Ue=>Ue.item[0]===R.sourceIndex&&Ue.item[1]===-1))==null?void 0:Ce.hoverAmount)??0,be=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===R.sourceIndex,fe=Z?ve.accentColor:be?ve.bgHeaderHasFocus:ve.bgHeader,U=n?s:0,xe=R.sourceIndex===0?0:1;Z?(e.fillStyle=fe,e.fillRect(M+xe,U,R.width-xe,l)):(be||J>0)&&(e.beginPath(),e.rect(M+xe,U,R.width-xe,l),be&&(e.fillStyle=ve.bgHeaderHasFocus,e.fill()),J>0&&(e.globalAlpha=J,e.fillStyle=ve.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ts(e,M,U,R.width,l,R,Z,ve,we,we?A:void 0,we?z:void 0,be,J,b,C,v),e.restore()}),n&&pc(e,t,r,i,s,o,w,b,m,h,g,x)}function pc(e,t,n,o,r,i,l,s,c,f,u,w){const[m,h]=(i==null?void 0:i[0])??[];let g=0;ql(t,n,o,r,(x,C,v,I,X,N)=>{if(w!==void 0&&!w.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(v,I,X,N),e.clip();const A=u(C),z=(A==null?void 0:A.overrideTheme)===void 0?l:Bn(l,A.overrideTheme),_=h===-2&&m!==void 0&&m>=x[0]&&m<=x[1],S=_?z.bgHeaderHovered:z.bgHeader;if(S!==l.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=z.textGroupHeader??z.textHeader,A!==void 0){let $=v;if(A.icon!==void 0&&(s.drawSprite(A.icon,"normal",e,$+8,(r-20)/2,20,z),$+=26),e.fillText(A.name,$+8,r/2+Zn(e,l.headerFontFull)),A.actions!==void 0&&_){const W=Ql({x:v,y:I,width:X,height:N},A.actions);e.beginPath();const F=W[0].x-10,R=v+X-F;e.rect(F,0,R,r);const M=e.createLinearGradient(F,0,F+R,0),ce=fo(S,0);M.addColorStop(0,ce),M.addColorStop(10/R,S),M.addColorStop(1,S),e.fillStyle=M,e.fill(),e.globalAlpha=.6;const[ne,oe]=(i==null?void 0:i[1])??[-1,-1];for(let Ie=0;Ie<A.actions.length;Ie++){const ve=A.actions[Ie],Z=W[Ie],K=uo(Z,ne+v,oe);K&&(e.globalAlpha=1),s.drawSprite(ve.icon,"normal",e,Z.x+Z.width/2-10,Z.y+Z.height/2-10,20,z),K&&(e.globalAlpha=.6)}e.globalAlpha=1}}v!==0&&f(x[0])&&(e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,r),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),g=v+X}),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const zr=30;function vc(e,t,n,o,r){return{x:e+n-zr,y:Math.max(t,t+o/2-zr/2),width:zr,height:Math.min(zr,o)}}function Ql(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:l,height:i}),o+=26;return n}function Jo(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function es(e,t,n,o,r,i,l,s){var C;const c=l.cellHorizontalPadding,f=l.headerIconSize,u=vc(n,o,r,i);let w=n+c;const b=t.icon===void 0?void 0:{x:w,y:o+(i-f)/2,width:f,height:f},m=b===void 0||t.overlayIcon===void 0?void 0:{x:b.x+9,y:b.y+6,width:18,height:18};b!==void 0&&(w+=Math.ceil(f*1.3));const h={x:w,y:o,width:r-w,height:i};let g;if(t.indicatorIcon!==void 0){const v=e===void 0?((C=Wl(t.title,l.headerFontFull))==null?void 0:C.width)??0:zo(t.title,e,l.headerFontFull).width;h.width=v,w+=v+c,g={x:w,y:o+(i-f)/2,width:f,height:f}}const x=n+r/2;return{menuBounds:Jo(u,x,s),iconBounds:Jo(b,x,s),iconOverlayBounds:Jo(m,x,s),textBounds:Jo(h,x,s),indicatorIconBounds:Jo(g,x,s)}}function dl(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const v=i.rowMarkerChecked;v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=w);const I=i.headerRowMarkerTheme!==void 0?Bn(s,i.headerRowMarkerTheme):s;Hi(e,I,v,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=l?s.textHeaderSelected:s.textHeader,C=i.hasMenu===!0&&(c||m&&l)&&g.menuBounds!==void 0;if(i.icon!==void 0&&g.iconBounds!==void 0){let v=l?"selected":"normal";i.style==="highlight"&&(v=l?"selected":"special"),b.drawSprite(i.icon,v,e,g.iconBounds.x,g.iconBounds.y,g.iconBounds.width,s),i.overlayIcon!==void 0&&g.iconOverlayBounds!==void 0&&b.drawSprite(i.overlayIcon,l?"selected":"special",e,g.iconOverlayBounds.x,g.iconOverlayBounds.y,g.iconOverlayBounds.width,s)}if(C&&o>35){const I=h?35:o-35,X=h?35*.7:o-35*.7,N=I/o,A=X/o,z=e.createLinearGradient(t,0,t+o,0),_=fo(x,0);z.addColorStop(h?1:0,x),z.addColorStop(N,x),z.addColorStop(A,_),z.addColorStop(h?0:1,_),e.fillStyle=z}else e.fillStyle=x;if(h&&(e.textAlign="right"),g.textBounds!==void 0&&e.fillText(i.title,h?g.textBounds.x+g.textBounds.width:g.textBounds.x,n+r/2+Zn(e,s.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&g.indicatorIconBounds!==void 0&&(!C||!lr(g.menuBounds.x,g.menuBounds.y,g.menuBounds.width,g.menuBounds.height,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,g.indicatorIconBounds.height))){let v=l?"selected":"normal";i.style==="highlight"&&(v=l?"selected":"special"),b.drawSprite(i.indicatorIcon,v,e,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,s)}if(C&&g.menuBounds!==void 0){const v=g.menuBounds,I=f!==void 0&&u!==void 0&&uo(v,f+t,u+n);if(I||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Or.Triangle){e.beginPath();const X=v.x+v.width/2-5.5,N=v.y+v.height/2-3;Fa(e,[{x:X,y:N},{x:X+11,y:N},{x:X+5.5,y:N+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Or.Dots){e.beginPath();const X=v.x+v.width/2,N=v.y+v.height/2;Da(e,X,N),e.fillStyle=x,e.fill()}else{const X=v.x+(v.width-s.headerIconSize)/2,N=v.y+(v.height-s.headerIconSize)/2;b.drawSprite(i.menuIcon,"normal",e,X,N,s.headerIconSize,s)}I||(e.globalAlpha=1)}}function ts(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g){const x=Ei(i.title)==="rtl",C=es(e,i,t,n,o,r,s,x);h!==void 0?h({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:l,hoverAmount:b,isHovered:c,hasSelectedCell:w,spriteManager:m,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0}},()=>dl(e,t,n,o,r,i,l,s,c,f,u,b,m,g,x,C)):dl(e,t,n,o,r,i,l,s,c,f,u,b,m,g,x,C)}function Cc(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x,C,v){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const I=Vl(x);Jn(t,c,l,s,i,(X,N,A,z,_)=>{if(X!==t[t.length-1])return;N+=X.width;const S=Math.max(N,z);S>o||(e.save(),e.beginPath(),e.rect(S,i+1,1e4,r-i-1),e.clip(),Kr(_,A,r,f,u,h,g,I,($,W,F,R)=>{if(!R&&x.length>0&&!x.some(Ie=>lr(N,$,1e4,F,Ie.x,Ie.y,Ie.width,Ie.height)))return;const M=b.hasIndex(W),ce=m.hasIndex(W);e.beginPath();const ne=w==null?void 0:w(W),oe=ne===void 0?v:Bn(v,ne);oe.bgCell!==v.bgCell&&(e.fillStyle=oe.bgCell,e.fillRect(N,$,1e4,F)),ce&&(e.fillStyle=oe.bgHeader,e.fillRect(N,$,1e4,F)),M&&(e.fillStyle=oe.accentLight,e.fillRect(N,$,1e4,F))}),e.restore())})}function xc(e,t,n,o,r,i,l,s,c){let f=!1;for(const h of t)if(!h.sticky){f=l(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,w=c.borderColor,b=f?Ao(t):0;let m;if(b!==0&&(m=il(w,c.bgCell),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,o),e.strokeStyle=m,e.stroke()),r>0){const h=w===u&&m!==void 0?m:il(u,c.bgCell),g=ho(i,r,s);e.beginPath(),e.moveTo(0,o-g+.5),e.lineTo(n,o-g+.5),e.strokeStyle=h,e.stroke()}}const ns=(e,t,n)=>{let o=0,r=t,i=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:l}};function kc(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h){var F;const g=h.bgCell,{minX:x,maxX:C,minY:v,maxY:I}=ns(s,i,l),X=[],N=l-ho(m,b,f);let A=c,z=n,_=0;for(;A+r<N;){const R=A+r,M=f(z);if(R>=v&&R<=I-1){const ce=u==null?void 0:u(z),ne=ce==null?void 0:ce.bgCell;ne!==void 0&&ne!==g&&z>=m-b&&X.push({x,y:R,w:C-x,h:M,color:ne})}A+=M,z<m-b&&(_=A),z++}let S=0;const $=Math.min(N,I)-_;if($>0)for(let R=0;R<t.length;R++){const M=t[R];if(M.width===0)continue;const ce=M.sticky?S:S+o,ne=(F=M.themeOverride)==null?void 0:F.bgCell;ne!==void 0&&ne!==g&&ce>=x&&ce<=C&&w(R+1)&&X.push({x:ce,y:_,w:M.width,h:$,color:ne}),S+=M.width}if(X.length===0)return;let W;e.beginPath();for(let R=X.length-1;R>=0;R--){const M=X[R];W===void 0?W=M.color:M.color!==W&&(e.fillStyle=W,e.fill(),e.beginPath(),W=M.color),e.rect(M.x,M.y,M.w,M.h)}W!==void 0&&(e.fillStyle=W,e.fill()),e.beginPath()}function ul(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x,C=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,l);for(const F of c)e.rect(F.x+1,F.y+1,F.width-1,F.height-1);e.clip("evenodd")}const v=x.horizontalBorderColor??x.borderColor,I=x.borderColor,{minX:X,maxX:N,minY:A,maxY:z}=ns(s,i,l),_=[];e.beginPath();let S=.5;for(let F=0;F<t.length;F++){const R=t[F];if(R.width===0)continue;S+=R.width;const M=R.sticky?S:S+o;M>=X&&M<=N&&m(F+1)&&_.push({x1:M,y1:Math.max(f,A),x2:M,y2:Math.min(l,z),color:I})}let $=l+.5;for(let F=g-h;F<g;F++){const R=w(F);$-=R,_.push({x1:X,y1:$,x2:N,y2:$,color:v})}if(C!==!0){let F=u+.5,R=n;const M=$;for(;F+r<M;){const ce=F+r;if(ce>=A&&ce<=z-1){const ne=b==null?void 0:b(R);_.push({x1:X,y1:ce,x2:N,y2:ce,color:(ne==null?void 0:ne.horizontalBorderColor)??(ne==null?void 0:ne.borderColor)??v})}F+=w(R),R++}}const W=Vs(_,F=>F.color);for(const F of Object.keys(W)){e.strokeStyle=F;for(const R of W[F])e.moveTo(R.x1,R.y1),e.lineTo(R.x2,R.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Sc(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x,C,v){const I=[];e.imageSmoothingEnabled=!1;const X=Math.min(r.cellYOffset,l),N=Math.max(r.cellYOffset,l);let A=0;if(typeof C=="number")A+=(N-X)*C;else for(let M=X;M<N;M++)A+=C(M);l>r.cellYOffset&&(A=-A),A+=c-r.translateY;const z=Math.min(r.cellXOffset,i),_=Math.max(r.cellXOffset,i);let S=0;for(let M=z;M<_;M++)S+=g[M].width;i>r.cellXOffset&&(S=-S),S+=s-r.translateX;const $=Ao(x);if(S!==0&&A!==0)return{regions:[]};const W=f>0?ho(b,f,C):0,F=u-$-Math.abs(S),R=w-m-W-Math.abs(A)-1;if(F>150&&R>150){const M={sx:0,sy:0,sw:u*h,sh:w*h,dx:0,dy:0,dw:u*h,dh:w*h};if(A>0?(M.sy=(m+1)*h,M.sh=R*h,M.dy=(A+m+1)*h,M.dh=R*h,I.push({x:0,y:m,width:u,height:A+1})):A<0&&(M.sy=(-A+m+1)*h,M.sh=R*h,M.dy=(m+1)*h,M.dh=R*h,I.push({x:0,y:w+A-W,width:u,height:-A+W})),S>0?(M.sx=$*h,M.sw=F*h,M.dx=(S+$)*h,M.dw=F*h,I.push({x:$-1,y:0,width:S+2,height:w})):S<0&&(M.sx=($-S)*h,M.sw=F*h,M.dx=$*h,M.dw=F*h,I.push({x:u+S,y:0,width:-S,height:w})),e.setTransform(1,0,0,1,0,0),v){if($>0&&S!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ce=$*h,ne=w*h;e.drawImage(t,0,0,ce,ne,0,0,ce,ne)}if(W>0&&S===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ce=(w-W)*h,ne=u*h,oe=W*h;e.drawImage(t,0,ce,ne,oe,0,ce,ne,oe)}}e.drawImage(t,M.sx,M.sy,M.sw,M.sh,M.dx,M.dy,M.dw,M.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:I}}function Mc(e,t,n,o,r,i,l,s,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Jn(c,n,o,r,s,(w,b,m,h)=>{if(w.sourceIndex===f){const g=Math.max(b,h)+1;return u.push({x:g,y:0,width:i-g,height:l}),!0}}),u}function Rc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Ho(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:l,...s}=r,{width:c,...f}=i;if(!Ho(s,f))return!1;n=o}return n===void 0?!0:n}return!0}function fl(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g){const x=h==null?void 0:h.filter(z=>z.style!=="no-outline");if(x===void 0||x.length===0)return;const C=Ao(s),v=ho(m,b,w),I=[c,0,s.length,m-b],X=[C,0,t,n-v],N=x.map(z=>{const _=z.range,S=z.style??"dashed";return mc(_,I,t,n,X).map($=>{const W=$.rect,F=Ci(W.x,W.y,t,n,u,f+u,o,r,i,l,m,c,b,s,w),R=W.width===1&&W.height===1?F:Ci(W.x+W.width-1,W.y+W.height-1,t,n,u,f+u,o,r,i,l,m,c,b,s,w);return W.x+W.width>=s.length&&(R.width-=1),W.y+W.height>=m&&(R.height-=1),{color:z.color,style:S,clip:$.clip,rect:gc({x:F.x,y:F.y,width:R.x+R.width-F.x,height:R.y+R.height-F.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let z=!1;for(const _ of N)for(const S of _)if((S==null?void 0:S.rect)!==void 0&&lr(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const $=z,W=!hc(S.clip,S.rect);W&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!z?(e.setLineDash([5,3]),z=!0):(S.style==="solid"||S.style==="solid-outline")&&z&&(e.setLineDash([]),z=!1),e.strokeStyle=S.style==="solid-outline"?Zt(Zt(S.color,g.borderColor),g.bgCell):fo(S.color,1),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),W&&(e.restore(),z=$)}z&&e.setLineDash([])};return A(),A}function hl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function gi(e,t,n,o,r,i,l,s,c,f,u,w,b,m,h,g,x){if(u.current===void 0)return;const C=u.current.range,v=u.current.cell,I=[C.x+C.width-1,C.y+C.height-1];if(v[1]>=x&&I[1]>=x||!l.some(M=>M.sourceIndex===v[0]||M.sourceIndex===I[0]))return;const[N,A]=u.current.cell,z=b(u.current.cell),_=z.span??[N,N],S=A>=x-m,$=m>0&&!S?ho(x,m,w)-1:0,W=I[1];let F;if(Jn(l,o,r,i,f,(M,ce,ne,oe,Ie)=>{if(M.sticky&&N>M.sourceIndex)return;const ve=M.sourceIndex<_[0],Z=M.sourceIndex>_[1],K=M.sourceIndex===I[0];if(!(!K&&(ve||Z)))return Kr(Ie,ne,n,x,w,m,h,void 0,(we,J,be)=>{if(J!==A&&J!==W)return;let fe=ce,U=M.width;if(z.span!==void 0){const Ce=jl(z.span,ce,we,M.width,be,M,s),Ue=M.sticky?Ce[0]:Ce[1];Ue!==void 0&&(fe=Ue.x,U=Ue.width)}return J===W&&K&&g&&(F=()=>{var Ce;oe>fe&&!M.sticky&&(e.beginPath(),e.rect(oe,0,t-oe,n),e.clip()),e.beginPath(),e.rect(fe+U-4,we+be-4,4,4),e.fillStyle=((Ce=M.themeOverride)==null?void 0:Ce.accentColor)??c.accentColor,e.fill()}),F!==void 0}),F!==void 0}),F===void 0)return;const R=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-$),e.clip(),F==null||F(),e.restore()};return R(),R}function Ec(e,t,n,o,r,i,l,s,c){c===void 0||c.size===0||(e.beginPath(),ql(t,n,i,o,(f,u,w,b,m,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(w,b,m,h)}),Jn(t,s,i,l,r,(f,u,w,b)=>{const m=Math.max(0,b-u),h=u+m+1,g=f.width-m-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,g,r-o)}),e.clip())}function Ic(e,t,n,o,r,i,l,s,c,f){let u=0;return Jn(e,i,o,r,n,(w,b,m,h,g)=>(Kr(g,m,t,l,s,c,f,void 0,(x,C,v,I)=>{I||(u=Math.max(C,u))}),!0)),u}function gl(e,t){var dn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:l,cellYOffset:s,translateX:c,translateY:f,mappedColumns:u,enableGroups:w,freezeColumns:b,dragAndDropState:m,theme:h,drawFocus:g,headerHeight:x,groupHeaderHeight:C,disabledRows:v,rowHeight:I,verticalBorder:X,overrideCursor:N,isResizing:A,selection:z,fillHandle:_,freezeTrailingRows:S,rows:$,getCellContent:W,getGroupDetails:F,getRowThemeOverride:R,isFocused:M,drawHeaderCallback:ce,prelightCells:ne,drawCellCallback:oe,highlightRegions:Ie,resizeCol:ve,imageLoader:Z,lastBlitData:K,hoverValues:we,hyperWrapping:J,hoverInfo:be,spriteManager:fe,maxScaleFactor:U,hasAppendRow:xe,touchMode:Ce,enqueue:Ue,renderStateProvider:ot,getCellRenderer:wt,renderStrategy:rt,bufferACtx:ze,bufferBCtx:Ve,damage:Me,minimumCellWidth:bt,resizeIndicator:ct}=e;if(r===0||i===0)return;const Ze=rt==="double-buffer",V=Math.min(U,Math.ceil(window.devicePixelRatio??1)),Oe=rt!=="direct"&&Rc(e,t),De=n.canvas;(De.width!==r*V||De.height!==i*V)&&(De.width=r*V,De.height=i*V,De.style.width=r+"px",De.style.height=i+"px");const Fe=o.canvas,he=w?C+x:x,Ye=he+1;(Fe.width!==r*V||Fe.height!==Ye*V)&&(Fe.width=r*V,Fe.height=Ye*V,Fe.style.width=r+"px",Fe.style.height=Ye+"px");const We=ze.canvas,$e=Ve.canvas;Ze&&(We.width!==r*V||We.height!==i*V)&&(We.width=r*V,We.height=i*V,K.current!==void 0&&(K.current.aBufferScroll=void 0)),Ze&&($e.width!==r*V||$e.height!==i*V)&&($e.width=r*V,$e.height=i*V,K.current!==void 0&&(K.current.bBufferScroll=void 0));const de=K.current;if(Oe===!0&&l===(de==null?void 0:de.cellXOffset)&&s===(de==null?void 0:de.cellYOffset)&&c===(de==null?void 0:de.translateX)&&f===(de==null?void 0:de.translateY))return;let ue=null;Ze&&(ue=n);const tt=o;let Ge;Ze?Me!==void 0?Ge=(de==null?void 0:de.lastBuffer)==="b"?Ve:ze:Ge=(de==null?void 0:de.lastBuffer)==="b"?ze:Ve:Ge=n;const Ke=Ge.canvas,dt=Ze?Ke===We?$e:We:De,Je=typeof I=="number"?()=>I:I;tt.save(),Ge.save(),tt.beginPath(),Ge.beginPath(),tt.textBaseline="middle",Ge.textBaseline="middle",V!==1&&(tt.scale(V,V),Ge.scale(V,V));const Te=vi(u,l,r,m,c);let Ct=[];const Lt=g&&((dn=z.current)==null?void 0:dn.cell[1])===s&&f===0;let xt=!1;if(Ie!==void 0){for(const pe of Ie)if(pe.style!=="no-outline"&&pe.range.y===s&&f===0){xt=!0;break}}const Mt=()=>{yc(tt,Te,w,be,r,c,x,C,m,A,z,h,fe,we,X,F,Me,ce,Ce),ul(tt,Te,s,c,f,r,i,void 0,void 0,C,he,Je,R,X,S,$,h,!0),tt.beginPath(),tt.moveTo(0,Ye-.5),tt.lineTo(r,Ye-.5),tt.strokeStyle=Zt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),tt.stroke(),xt&&fl(tt,r,i,l,s,c,f,u,b,x,C,I,S,$,Ie,h),Lt&&gi(tt,r,i,s,c,f,Te,u,h,he,z,Je,W,S,xe,_,$)};if(Me!==void 0){const pe=Te[Te.length-1].sourceIndex+1,gt=Me.hasItemInRegion([{x:l,y:-2,width:pe,height:2},{x:l,y:s,width:pe,height:300},{x:0,y:s,width:b,height:300},{x:0,y:-2,width:b,height:2},{x:l,y:$-S,width:pe,height:S,when:S>0}]),pn=Qt=>{cl(Qt,Te,u,i,he,c,f,s,$,Je,W,F,R,v,M,g,S,xe,Ct,Me,z,ne,Ie,Z,fe,we,be,oe,J,h,Ue,ot,wt,N,bt);const en=z.current;_&&g&&en!==void 0&&Me.has(Bl(en.range))&&gi(Qt,r,i,s,c,f,Te,u,h,he,z,Je,W,S,xe,_,$)};gt&&(pn(Ge),ue!==null&&(ue.save(),ue.scale(V,V),ue.textBaseline="middle",pn(ue),ue.restore()),Me.hasHeader()&&(Ec(tt,Te,r,C,he,c,f,s,Me),Mt())),Ge.restore(),tt.restore();return}if((Oe!==!0||l!==(de==null?void 0:de.cellXOffset)||c!==(de==null?void 0:de.translateX)||Lt!==(de==null?void 0:de.mustDrawFocusOnHeader)||xt!==(de==null?void 0:de.mustDrawHighlightRingsOnHeader))&&Mt(),Oe===!0){jt(dt!==void 0&&de!==void 0);const{regions:pe}=Sc(Ge,dt,dt===We?de.aBufferScroll:de.bBufferScroll,dt===We?de.bBufferScroll:de.aBufferScroll,de,l,s,c,f,S,r,i,$,he,V,u,Te,I,Ze);Ct=pe}else Oe!==!1&&(jt(de!==void 0),Ct=Mc(de,l,s,c,f,r,i,he,Te,Oe));xc(Ge,Te,r,i,S,$,X,Je,h);const Wt=fl(Ge,r,i,l,s,c,f,u,b,x,C,I,S,$,Ie,h),ht=g?gi(Ge,r,i,s,c,f,Te,u,h,he,z,Je,W,S,xe,_,$):void 0;if(Ge.fillStyle=h.bgCell,Ct.length>0){Ge.beginPath();for(const pe of Ct)Ge.rect(pe.x,pe.y,pe.width,pe.height);Ge.clip(),Ge.fill(),Ge.beginPath()}else Ge.fillRect(0,0,r,i);const yn=cl(Ge,Te,u,i,he,c,f,s,$,Je,W,F,R,v,M,g,S,xe,Ct,Me,z,ne,Ie,Z,fe,we,be,oe,J,h,Ue,ot,wt,N,bt);Cc(Ge,Te,u,r,i,he,c,f,s,$,Je,R,z.rows,v,S,xe,Ct,Me,h),kc(Ge,Te,s,c,f,r,i,Ct,he,Je,R,X,S,$,h),ul(Ge,Te,s,c,f,r,i,Ct,yn,C,he,Je,R,X,S,$,h),Wt==null||Wt(),ht==null||ht(),A&&ct!=="none"&&Jn(Te,0,c,0,he,(pe,gt)=>pe.sourceIndex===ve?(hl(tt,gt+pe.width,0,he+1,Zt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),ct==="full"&&hl(Ge,gt+pe.width,he,i,Zt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),ue!==null&&(ue.fillStyle=h.bgCell,ue.fillRect(0,0,r,i),ue.drawImage(Ge.canvas,0,0));const Ln=Ic(Te,i,he,c,f,s,$,Je,S,xe);Z==null||Z.setWindow({x:l,y:s,width:Te.length,height:Ln-s},b,Array.from({length:S},(pe,gt)=>$-1-gt));const lt=de!==void 0&&(l!==de.cellXOffset||c!==de.translateX),In=de!==void 0&&(s!==de.cellYOffset||f!==de.translateY);K.current={cellXOffset:l,cellYOffset:s,translateX:c,translateY:f,mustDrawFocusOnHeader:Lt,mustDrawHighlightRingsOnHeader:xt,lastBuffer:Ze?Ke===We?"a":"b":void 0,aBufferScroll:Ke===We?[lt,In]:de==null?void 0:de.aBufferScroll,bBufferScroll:Ke===$e?[lt,In]:de==null?void 0:de.bBufferScroll},Ge.restore(),tt.restore()}const Dc=80;function Fc(e){const t=e-1;return t*t*t+1}class Hc{constructor(t){Xe(this,"callback");Xe(this,"currentHoveredItem");Xe(this,"leavingItems",[]);Xe(this,"lastAnimationTime");Xe(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>tr(o.item,t.item))||this.leavingItems.push(t)});Xe(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>tr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Xe(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Xe(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Xe(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Fc(t.hoverAmount)})));Xe(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Dc;for(const i of this.leavingItems)i.hoverAmount=sn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=sn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Xe(this,"setHovered",t=>{var n;if(!tr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Tc{constructor(t){Xe(this,"fn");Xe(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Ti(e){return new Tc(e)}const Ac=Ti(()=>window.navigator.userAgent.includes("Firefox")),Nr=Ti(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Xr=Ti(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function zc(e){const t=a.useRef([]),n=a.useRef(0),o=a.useRef(e);o.current=e;const r=a.useCallback(()=>{const i=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(Fi);t.current=[],o.current(new or(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:l)},[]);return a.useCallback(i=>{t.current.length===0&&r();const l=bn(i[0],i[1]);t.current.includes(l)||t.current.push(l)},[r])}const jn="header",an="group-header",Yr="out-of-bounds";var Fo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Fo||(Fo={}));function os(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const ml=6,Bc=(e,t)=>{if(e.kind===j.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Lc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:l,cellYOffset:s,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:w,rows:b,getCellContent:m,getRowThemeOverride:h,onHeaderMenuClick:g,onHeaderIndicatorClick:x,enableGroups:C,isFilling:v,onCanvasFocused:I,onCanvasBlur:X,isFocused:N,selection:A,freezeColumns:z,onContextMenu:_,freezeTrailingRows:S,fixedShadowX:$=!0,fixedShadowY:W=!0,drawFocusRing:F,onMouseDown:R,onMouseUp:M,onMouseMoveRaw:ce,onMouseMove:ne,onItemHovered:oe,dragAndDropState:Ie,firstColAccessible:ve,onKeyDown:Z,onKeyUp:K,highlightRegions:we,canvasRef:J,onDragStart:be,onDragEnd:fe,eventTargetRef:U,isResizing:xe,resizeColumn:Ce,isDragging:Ue,isDraggable:ot=!1,allowResize:wt,disabledRows:rt,hasAppendRow:ze,getGroupDetails:Ve,theme:Me,prelightCells:bt,headerIcons:ct,verticalBorder:Ze,drawCell:V,drawHeader:Oe,onCellFocused:De,onDragOverCell:Fe,onDrop:he,onDragLeave:Ye,imageWindowLoader:We,smoothScrollX:$e=!1,smoothScrollY:de=!1,experimental:ue,getCellRenderer:tt,resizeIndicator:Ge="full"}=e,Ke=e.translateX??0,dt=e.translateY??0,Je=Math.max(z,Math.min(i.length-1,l)),Te=a.useRef(null),Ct=a.useRef((ue==null?void 0:ue.eventTarget)??window),Lt=Ct.current,xt=We,Mt=a.useRef(),[Wt,ht]=a.useState(!1),yn=a.useRef([]),Ln=a.useRef(),[lt,In]=a.useState(),[dn,pe]=a.useState(),gt=a.useRef(null),[pn,Qt]=a.useState(),[en,Be]=a.useState(!1),Rt=a.useRef(en);Rt.current=en;const ut=a.useMemo(()=>new uc(ct,()=>{go.current=void 0,eo.current()}),[ct]),Ot=C?u+c:c,Tt=a.useRef(-1),Gt=((ue==null?void 0:ue.enableFirefoxRescaling)??!1)&&Ac.value,Pn=((ue==null?void 0:ue.enableSafariRescaling)??!1)&&Nr.value;a.useLayoutEffect(()=>{window.devicePixelRatio===1||!Gt&&!Pn||(Tt.current!==-1&&ht(!0),window.clearTimeout(Tt.current),Tt.current=window.setTimeout(()=>{ht(!1),Tt.current=-1},200))},[s,Je,Ke,dt,Gt,Pn]);const Et=ba(i,z),yt=$?Ao(Et,Ie):0,Ft=a.useCallback((k,G,Q)=>{const re=k.getBoundingClientRect();if(G>=Et.length||Q>=b)return;const q=re.width/n,le=Ci(G,Q,n,o,u,Ot,Je,s,Ke,dt,b,z,S,Et,w);return q!==1&&(le.x*=q,le.y*=q,le.width*=q,le.height*=q),le.x+=re.x,le.y+=re.y,le},[n,o,u,Ot,Je,s,Ke,dt,b,z,S,Et,w]),At=a.useCallback((k,G,Q,re)=>{const q=k.getBoundingClientRect(),le=q.width/n,He=(G-q.left)/le,Ae=(Q-q.top)/le,se=5,Qe=vi(Et,Je,n,void 0,Ke);let ie=0,Ee=0;re instanceof MouseEvent&&(ie=re.button,Ee=re.buttons);const ke=Ca(He,Qe,Ke),Ne=xa(Ae,o,C,c,u,b,w,s,dt,S),Ht=(re==null?void 0:re.shiftKey)===!0,Kt=(re==null?void 0:re.ctrlKey)===!0,qe=(re==null?void 0:re.metaKey)===!0,pt=re!==void 0&&!(re instanceof MouseEvent)||(re==null?void 0:re.pointerType)==="touch",fn=[He<0?-1:n<He?1:0,Ae<Ot?-1:o<Ae?1:0];let Xt;if(ke===-1||Ae<0||He<0||Ne===void 0||He>n||Ae>o){const nt=He>n?1:He<0?-1:0,Ut=Ae>o?1:Ae<0?-1:0;let Vt=nt*2,je=Ut*2;nt===0&&(Vt=ke===-1?Fo.EndPadding:Fo.Center),Ut===0&&(je=Ne===void 0?Fo.EndPadding:Fo.Center);let St=!1;if(ke===-1&&Ne===-1){const Gn=Ft(k,Et.length-1,-1);jt(Gn!==void 0),St=G<Gn.x+Gn.width+se}const Yn=He>n&&He<n+pi()||Ae>o&&Ae<o+pi();Xt={kind:Yr,location:[ke!==-1?ke:He<0?0:Et.length-1,Ne??b-1],region:[Vt,je],shiftKey:Ht,ctrlKey:Kt,metaKey:qe,isEdge:St,isTouch:pt,button:ie,buttons:Ee,scrollEdge:fn,isMaybeScrollbar:Yn}}else if(Ne<=-1){let nt=Ft(k,ke,Ne);jt(nt!==void 0);let Ut=nt!==void 0&&nt.x+nt.width-G<=se;const Vt=ke-1;G-nt.x<=se&&Vt>=0?(Ut=!0,nt=Ft(k,Vt,Ne),jt(nt!==void 0),Xt={kind:C&&Ne===-2?an:jn,location:[Vt,Ne],bounds:nt,group:Et[Vt].group??"",isEdge:Ut,shiftKey:Ht,ctrlKey:Kt,metaKey:qe,isTouch:pt,localEventX:G-nt.x,localEventY:Q-nt.y,button:ie,buttons:Ee,scrollEdge:fn}):Xt={kind:C&&Ne===-2?an:jn,group:Et[ke].group??"",location:[ke,Ne],bounds:nt,isEdge:Ut,shiftKey:Ht,ctrlKey:Kt,metaKey:qe,isTouch:pt,localEventX:G-nt.x,localEventY:Q-nt.y,button:ie,buttons:Ee,scrollEdge:fn}}else{const nt=Ft(k,ke,Ne);jt(nt!==void 0);const Ut=nt!==void 0&&nt.x+nt.width-G<se;let Vt=!1;if(f&&A.current!==void 0){const je=Bl(A.current.range),St=Ft(k,je[0],je[1]);if(St!==void 0){const Yn=St.x+St.width-2,Gn=St.y+St.height-2;Vt=Math.abs(Yn-G)<ml&&Math.abs(Gn-Q)<ml}}Xt={kind:"cell",location:[ke,Ne],bounds:nt,isEdge:Ut,shiftKey:Ht,ctrlKey:Kt,isFillHandle:Vt,metaKey:qe,isTouch:pt,localEventX:G-nt.x,localEventY:Q-nt.y,button:ie,buttons:Ee,scrollEdge:fn}}return Xt},[n,Et,Je,Ke,o,C,c,u,b,w,s,dt,S,Ft,f,A,Ot]),[Dn]=lt??[],ar=a.useRef(()=>{}),Wn=a.useRef(lt);Wn.current=lt;const[Fn,Hn]=a.useMemo(()=>{const k=document.createElement("canvas"),G=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",G.style.display="none",G.style.opacity="0",G.style.position="fixed",[k.getContext("2d",{alpha:!1}),G.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>{if(!(Fn===null||Hn===null))return document.documentElement.append(Fn.canvas),document.documentElement.append(Hn.canvas),()=>{Fn.canvas.remove(),Hn.canvas.remove()}},[Fn,Hn]);const vn=a.useMemo(()=>new Ha,[]),cr=Gt&&Wt?1:Pn&&Wt?2:5,dr=(ue==null?void 0:ue.disableMinimumCellWidth)===!0?1:10,go=a.useRef(),mo=a.useRef(null),wo=a.useRef(null),Qn=a.useCallback(()=>{var He;const k=Te.current,G=gt.current;if(k===null||G===null||(mo.current===null&&(mo.current=k.getContext("2d",{alpha:!1}),k.width=0,k.height=0),wo.current===null&&(wo.current=G.getContext("2d",{alpha:!1}),G.width=0,G.height=0),mo.current===null||wo.current===null||Fn===null||Hn===null))return;let Q=!1;const re=Ae=>{Q=!0,Qt(Ae)},q=go.current,le={headerCanvasCtx:wo.current,canvasCtx:mo.current,bufferACtx:Fn,bufferBCtx:Hn,width:n,height:o,cellXOffset:Je,cellYOffset:s,translateX:Math.round(Ke),translateY:Math.round(dt),mappedColumns:Et,enableGroups:C,freezeColumns:z,dragAndDropState:Ie,theme:Me,headerHeight:c,groupHeaderHeight:u,disabledRows:rt??it.empty(),rowHeight:w,verticalBorder:Ze,isResizing:xe,resizeCol:Ce,isFocused:N,selection:A,fillHandle:f,drawCellCallback:V,hasAppendRow:ze,overrideCursor:re,maxScaleFactor:cr,freezeTrailingRows:S,rows:b,drawFocus:F,getCellContent:m,getGroupDetails:Ve??(Ae=>({name:Ae})),getRowThemeOverride:h,drawHeaderCallback:Oe,prelightCells:bt,highlightRegions:we,imageLoader:xt,lastBlitData:Ln,damage:Mt.current,hoverValues:yn.current,hoverInfo:Wn.current,spriteManager:ut,scrolling:Wt,hyperWrapping:(ue==null?void 0:ue.hyperWrapping)??!1,touchMode:en,enqueue:ar.current,renderStateProvider:vn,renderStrategy:(ue==null?void 0:ue.renderStrategy)??(Nr.value?"double-buffer":"single-buffer"),getCellRenderer:tt,minimumCellWidth:dr,resizeIndicator:Ge};le.damage===void 0?(go.current=le,gl(le,q)):gl(le,void 0),!Q&&(le.damage===void 0||le.damage.has((He=Wn==null?void 0:Wn.current)==null?void 0:He[0]))&&Qt(void 0)},[Fn,Hn,n,o,Je,s,Ke,dt,Et,C,z,Ie,Me,c,u,rt,w,Ze,xe,ze,Ce,N,A,f,S,b,F,cr,m,Ve,h,V,Oe,bt,we,xt,ut,Wt,ue==null?void 0:ue.hyperWrapping,ue==null?void 0:ue.renderStrategy,en,vn,tt,dr,Ge]),eo=a.useRef(Qn);a.useLayoutEffect(()=>{Qn(),eo.current=Qn},[Qn]),a.useLayoutEffect(()=>{(async()=>{var G;((G=document==null?void 0:document.fonts)==null?void 0:G.ready)!==void 0&&(await document.fonts.ready,go.current=void 0,eo.current())})()},[]);const $n=a.useCallback(k=>{Mt.current=k,eo.current(),Mt.current=void 0},[]),Ur=zc($n);ar.current=Ur;const ur=a.useCallback(k=>{$n(new or(k.map(G=>G.cell)))},[$n]);xt.setCallback($n);const[fr,Vr]=a.useState(!1),[bo,On]=Dn??[],Bo=bo!==void 0&&On===-1,qr=bo!==void 0&&On===-2;let Lo=!1,Po=!1,to=pn;if(to===void 0&&bo!==void 0&&On!==void 0&&On>-1&&On<b){const k=m([bo,On],!0);Lo=k.kind===cn.NewRow||k.kind===cn.Marker&&k.markerKind!=="number",Po=k.kind===j.Boolean&&Mi(k),to=k.cursor}const _t=Ue?"grabbing":(dn??!1)||xe?"col-resize":fr||v?"crosshair":to!==void 0?to:Bo||Lo||Po||qr?"pointer":"default",Wo=a.useMemo(()=>({contain:"strict",display:"block",cursor:_t}),[_t]),$o=a.useRef("default"),yo=U==null?void 0:U.current;yo!=null&&$o.current!==Wo.cursor&&(yo.style.cursor=$o.current=Wo.cursor);const Tn=a.useCallback((k,G,Q,re)=>{if(Ve===void 0)return;const q=Ve(k);if(q.actions!==void 0){const le=Ql(G,q.actions);for(const[He,Ae]of le.entries())if(uo(Ae,Q+G.x,re+Ae.y))return q.actions[He]}},[Ve]),An=a.useCallback((k,G,Q,re)=>{const q=Et[G];if(!Ue&&!xe&&!(dn??!1)){const le=Ft(k,G,-1);jt(le!==void 0);const He=es(void 0,q,le.x,le.y,le.width,le.height,Me,Ei(q.title)==="rtl");if(q.hasMenu===!0&&He.menuBounds!==void 0&&uo(He.menuBounds,Q,re))return{area:"menu",bounds:He.menuBounds};if(q.indicatorIcon!==void 0&&He.indicatorIconBounds!==void 0&&uo(He.indicatorIconBounds,Q,re))return{area:"indicator",bounds:He.indicatorIconBounds}}},[Et,Ft,dn,Ue,xe,Me]),po=a.useRef(0),Cn=a.useRef(),xn=a.useRef(!1),no=a.useCallback(k=>{const G=Te.current,Q=U==null?void 0:U.current;if(G===null||k.target!==G&&k.target!==Q)return;xn.current=!0;let re,q;if(k instanceof MouseEvent?(re=k.clientX,q=k.clientY):(re=k.touches[0].clientX,q=k.touches[0].clientY),k.target===Q&&Q!==null){const He=Q.getBoundingClientRect();if(re>He.right||q>He.bottom)return}const le=At(G,re,q,k);Cn.current=le.location,le.isTouch&&(po.current=Date.now()),Rt.current!==le.isTouch&&Be(le.isTouch),!(le.kind===jn&&An(G,le.location[0],re,q)!==void 0)&&(le.kind===an&&Tn(le.group,le.bounds,le.localEventX,le.localEventY)!==void 0||(R==null||R(le),!le.isTouch&&ot!==!0&&ot!==le.kind&&le.button<3&&le.button!==1&&k.preventDefault()))},[U,ot,At,Tn,An,R]);$t("touchstart",no,Lt,!1),$t("mousedown",no,Lt,!1);const hr=a.useRef(0),Oo=a.useCallback(k=>{var Ee,ke;const G=hr.current;hr.current=Date.now();const Q=Te.current;if(xn.current=!1,M===void 0||Q===null)return;const re=U==null?void 0:U.current,q=k.target!==Q&&k.target!==re;let le,He,Ae=!0;if(k instanceof MouseEvent){if(le=k.clientX,He=k.clientY,Ae=k.button<3,k.pointerType==="touch")return}else le=k.changedTouches[0].clientX,He=k.changedTouches[0].clientY;let se=At(Q,le,He,k);se.isTouch&&po.current!==0&&Date.now()-po.current>500&&(se={...se,isLongTouch:!0}),G!==0&&Date.now()-G<(se.isTouch?1e3:500)&&(se={...se,isDoubleClick:!0}),Rt.current!==se.isTouch&&Be(se.isTouch),!q&&k.cancelable&&Ae&&k.preventDefault();const[Qe]=se.location,ie=An(Q,Qe,le,He);if(se.kind===jn&&ie!==void 0){(se.button!==0||((Ee=Cn.current)==null?void 0:Ee[0])!==Qe||((ke=Cn.current)==null?void 0:ke[1])!==-1)&&M(se,!0);return}else if(se.kind===an){const Ne=Tn(se.group,se.bounds,se.localEventX,se.localEventY);if(Ne!==void 0){se.button===0&&Ne.onClick(se);return}}M(se,q)},[M,U,At,An,Tn]);$t("mouseup",Oo,Lt,!1),$t("touchend",Oo,Lt,!1);const Re=a.useCallback(k=>{var Qe,ie;const G=Te.current;if(G===null)return;const Q=U==null?void 0:U.current,re=k.target!==G&&k.target!==Q;let q,le,He=!0;k instanceof MouseEvent?(q=k.clientX,le=k.clientY,He=k.button<3):(q=k.changedTouches[0].clientX,le=k.changedTouches[0].clientY);const Ae=At(G,q,le,k);Rt.current!==Ae.isTouch&&Be(Ae.isTouch),!re&&k.cancelable&&He&&k.preventDefault();const[se]=Ae.location;if(Ae.kind===jn){const Ee=An(G,se,q,le);Ee!==void 0&&Ae.button===0&&((Qe=Cn.current)==null?void 0:Qe[0])===se&&((ie=Cn.current)==null?void 0:ie[1])===-1&&(Ee.area==="menu"?g==null||g(se,Ee.bounds):Ee.area==="indicator"&&(x==null||x(se,Ee.bounds)))}else if(Ae.kind===an){const Ee=Tn(Ae.group,Ae.bounds,Ae.localEventX,Ae.localEventY);Ee!==void 0&&Ae.button===0&&Ee.onClick(Ae)}},[U,At,An,g,x,Tn]);$t("click",Re,Lt,!1);const gr=a.useCallback(k=>{const G=Te.current,Q=U==null?void 0:U.current;if(G===null||k.target!==G&&k.target!==Q||_===void 0)return;const re=At(G,k.clientX,k.clientY,k);_(re,()=>{k.cancelable&&k.preventDefault()})},[U,At,_]);$t("contextmenu",gr,(U==null?void 0:U.current)??null,!1);const mr=a.useCallback(k=>{Mt.current=new or(k.map(G=>G.item)),yn.current=k,eo.current(),Mt.current=void 0},[]),tn=a.useMemo(()=>new Hc(mr),[mr]),wr=a.useRef(tn);wr.current=tn,a.useLayoutEffect(()=>{const k=wr.current;if(Dn===void 0||Dn[1]<0){k.setHovered(Dn);return}const G=m(Dn,!0),Q=tt(G),re=Q===void 0&&G.kind===j.Custom||(Q==null?void 0:Q.needsHover)!==void 0&&(typeof Q.needsHover=="boolean"?Q.needsHover:Q.needsHover(G));k.setHovered(re?Dn:void 0)},[m,tt,Dn]);const un=a.useRef(),No=a.useCallback(k=>{var Ae;const G=Te.current;if(G===null)return;const Q=U==null?void 0:U.current,re=k.target!==G&&k.target!==Q,q=At(G,k.clientX,k.clientY,k);if(q.kind!=="out-of-bounds"&&re&&!xn.current&&!q.isTouch)return;const le=(se,Qe)=>{In(ie=>ie===se||(ie==null?void 0:ie[0][0])===(se==null?void 0:se[0][0])&&(ie==null?void 0:ie[0][1])===(se==null?void 0:se[0][1])&&((ie==null?void 0:ie[1][0])===(se==null?void 0:se[1][0])&&(ie==null?void 0:ie[1][1])===(se==null?void 0:se[1][1])||!Qe)?ie:se)};if(!os(q,un.current))Qt(void 0),oe==null||oe(q),le(q.kind===Yr?void 0:[q.location,[q.localEventX,q.localEventY]],!0),un.current=q;else if(q.kind==="cell"||q.kind===jn||q.kind===an){let se=!1,Qe=!0;if(q.kind==="cell"){const Ee=m(q.location);Qe=((Ae=tt(Ee))==null?void 0:Ae.needsHoverPosition)??Ee.kind===j.Custom,se=Qe}else se=!0;const ie=[q.location,[q.localEventX,q.localEventY]];le(ie,Qe),Wn.current=ie,se&&$n(new or([q.location]))}const He=q.location[0]>=(ve?0:1);pe(q.kind===jn&&q.isEdge&&He&&wt===!0),Vr(q.kind==="cell"&&q.isFillHandle),ce==null||ce(k),ne(q)},[U,At,ve,wt,ce,ne,oe,m,tt,$n]);$t("mousemove",No,Lt,!0);const br=a.useCallback(k=>{const G=Te.current;if(G===null)return;let Q,re;A.current!==void 0&&(Q=Ft(G,A.current.cell[0],A.current.cell[1]),re=A.current.cell),Z==null||Z({bounds:Q,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:re})},[Z,A,Ft]),yr=a.useCallback(k=>{const G=Te.current;if(G===null)return;let Q,re;A.current!==void 0&&(Q=Ft(G,A.current.cell[0],A.current.cell[1]),re=A.current.cell),K==null||K({bounds:Q,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:re})},[K,A,Ft]),jr=a.useCallback(k=>{if(Te.current=k,J!==void 0&&(J.current=k),ue!=null&&ue.eventTarget)Ct.current=ue.eventTarget;else if(k===null)Ct.current=window;else{const G=k.getRootNode();G===document&&(Ct.current=window),Ct.current=G}},[J,ue==null?void 0:ue.eventTarget]),Zr=a.useCallback(k=>{const G=Te.current;if(G===null||ot===!1||xe){k.preventDefault();return}let Q,re;const q=At(G,k.clientX,k.clientY);if(ot!==!0&&q.kind!==ot){k.preventDefault();return}const le=(Ee,ke)=>{Q=Ee,re=ke};let He,Ae,se;const Qe=(Ee,ke,Ne)=>{He=Ee,Ae=ke,se=Ne};let ie=!1;if(be==null||be({...q,setData:le,setDragImage:Qe,preventDefault:()=>ie=!0,defaultPrevented:()=>ie}),!ie&&Q!==void 0&&re!==void 0&&k.dataTransfer!==null)if(k.dataTransfer.setData(Q,re),k.dataTransfer.effectAllowed="copyLink",He!==void 0&&Ae!==void 0&&se!==void 0)k.dataTransfer.setDragImage(He,Ae,se);else{const[Ee,ke]=q.location;if(ke!==void 0){const Ne=document.createElement("canvas"),Ht=Ft(G,Ee,ke);jt(Ht!==void 0);const Kt=Math.ceil(window.devicePixelRatio??1);Ne.width=Ht.width*Kt,Ne.height=Ht.height*Kt;const qe=Ne.getContext("2d");qe!==null&&(qe.scale(Kt,Kt),qe.textBaseline="middle",ke===-1?(qe.font=Me.headerFontFull,qe.fillStyle=Me.bgHeader,qe.fillRect(0,0,Ne.width,Ne.height),ts(qe,0,0,Ht.width,Ht.height,Et[Ee],!1,Me,!1,void 0,void 0,!1,0,ut,Oe,!1)):(qe.font=Me.baseFontFull,qe.fillStyle=Me.bgCell,qe.fillRect(0,0,Ne.width,Ne.height),Jl(qe,m([Ee,ke]),0,ke,!1,!1,0,0,Ht.width,Ht.height,!1,Me,Me.bgCell,xt,ut,1,void 0,!1,0,void 0,void 0,void 0,vn,tt,()=>{}))),Ne.style.left="-100%",Ne.style.position="absolute",Ne.style.width=`${Ht.width}px`,Ne.style.height=`${Ht.height}px`,document.body.append(Ne),k.dataTransfer.setDragImage(Ne,Ht.width/2,Ht.height/2),window.setTimeout(()=>{Ne.remove()},0)}}else k.preventDefault()},[ot,xe,At,be,Ft,Me,Et,ut,Oe,m,xt,vn,tt]);$t("dragstart",Zr,(U==null?void 0:U.current)??null,!1,!1);const nn=a.useRef(),Nn=a.useCallback(k=>{const G=Te.current;if(he!==void 0&&k.preventDefault(),G===null||Fe===void 0)return;const Q=At(G,k.clientX,k.clientY),[re,q]=Q.location,le=re-(ve?0:1),[He,Ae]=nn.current??[];(He!==le||Ae!==q)&&(nn.current=[le,q],Fe([le,q],k.dataTransfer))},[ve,At,Fe,he]);$t("dragover",Nn,(U==null?void 0:U.current)??null,!1,!1);const on=a.useCallback(()=>{nn.current=void 0,fe==null||fe()},[fe]);$t("dragend",on,(U==null?void 0:U.current)??null,!1,!1);const H=a.useCallback(k=>{const G=Te.current;if(G===null||he===void 0)return;k.preventDefault();const Q=At(G,k.clientX,k.clientY),[re,q]=Q.location,le=re-(ve?0:1);he([le,q],k.dataTransfer)},[ve,At,he]);$t("drop",H,(U==null?void 0:U.current)??null,!1,!1);const mt=a.useCallback(()=>{Ye==null||Ye()},[Ye]);$t("dragleave",mt,(U==null?void 0:U.current)??null,!1,!1);const Xn=a.useRef(A);Xn.current=A;const vo=a.useRef(null),Co=a.useCallback(k=>{var G;Te.current===null||!Te.current.contains(document.activeElement)||(k===null&&Xn.current.current!==void 0?(G=J==null?void 0:J.current)==null||G.focus({preventScroll:!0}):k!==null&&k.focus({preventScroll:!0}),vo.current=k)},[J]);a.useImperativeHandle(t,()=>({focus:()=>{var G;const k=vo.current;k===null||!document.contains(k)?(G=J==null?void 0:J.current)==null||G.focus({preventScroll:!0}):k.focus({preventScroll:!0})},getBounds:(k,G)=>{if(!(J===void 0||J.current===null))return Ft(J.current,k??0,G??-1)},damage:ur,getMouseArgsForPosition:(k,G,Q)=>{if(!(J===void 0||J.current===null))return At(J.current,k,G,Q)}}),[J,ur,Ft]);const Xo=a.useRef(),Jr=ra(()=>{var Ae,se,Qe;if(n<50||(ue==null?void 0:ue.disableAccessibilityTree)===!0)return null;let k=vi(Et,Je,n,Ie,Ke);const G=ve?0:-1;!ve&&((Ae=k[0])==null?void 0:Ae.sourceIndex)===0&&(k=k.slice(1));const[Q,re]=((se=A.current)==null?void 0:se.cell)??[],q=(Qe=A.current)==null?void 0:Qe.range,le=k.map(ie=>ie.sourceIndex),He=co(s,Math.min(b,s+r));return Q!==void 0&&re!==void 0&&!(le.includes(Q)&&He.includes(re))&&Co(null),a.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":b+1,"aria-multiselectable":"true","aria-colcount":Et.length+G},a.createElement("thead",{role:"rowgroup"},a.createElement("tr",{role:"row","aria-rowindex":1},k.map(ie=>a.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(ie.sourceIndex),"aria-colindex":ie.sourceIndex+1+G,tabIndex:-1,onFocus:Ee=>{if(Ee.target!==vo.current)return De==null?void 0:De([ie.sourceIndex,-1])},key:ie.sourceIndex},ie.title)))),a.createElement("tbody",{role:"rowgroup"},He.map(ie=>a.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(ie),key:ie,"aria-rowindex":ie+2},k.map(Ee=>{const ke=Ee.sourceIndex,Ne=bn(ke,ie),Ht=Q===ke&&re===ie,Kt=q!==void 0&&ke>=q.x&&ke<q.x+q.width&&ie>=q.y&&ie<q.y+q.height,qe=`glide-cell-${ke}-${ie}`,pt=[ke,ie],fn=m(pt,!0);return a.createElement("td",{key:Ne,role:"gridcell","aria-colindex":ke+1+G,"aria-selected":Kt,"aria-readonly":Do(fn)||!er(fn),id:qe,"data-testid":qe,onClick:()=>{const Xt=J==null?void 0:J.current;if(Xt!=null)return Z==null?void 0:Z({bounds:Ft(Xt,ke,ie),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:pt})},onFocusCapture:Xt=>{var nt,Ut;if(!(Xt.target===vo.current||((nt=Xo.current)==null?void 0:nt[0])===ke&&((Ut=Xo.current)==null?void 0:Ut[1])===ie))return Xo.current=pt,De==null?void 0:De(pt)},ref:Ht?Co:void 0,tabIndex:-1},Bc(fn,tt))})))))},[n,Et,Je,Ie,Ke,b,s,r,A,Co,m,J,Z,Ft,De],200),Yo=z===0||!$?0:Je>z?1:sn(-Ke/100,0,1),B=-s*32+dt,zt=W?sn(-B/100,0,1):0,Bt=a.useMemo(()=>{if(!Yo&&!zt)return null;const k={position:"absolute",top:0,left:yt,width:n-yt,height:o,opacity:Yo,pointerEvents:"none",transition:$e?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},G={position:"absolute",top:Ot,left:0,width:n,height:o,opacity:zt,pointerEvents:"none",transition:de?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return a.createElement(a.Fragment,null,Yo>0&&a.createElement("div",{id:"shadow-x",style:k}),zt>0&&a.createElement("div",{id:"shadow-y",style:G}))},[Yo,zt,yt,n,$e,Ot,o,de]),Qr=a.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return a.createElement(a.Fragment,null,a.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:br,onKeyUp:yr,onFocus:I,onBlur:X,ref:jr,style:Wo},Jr),a.createElement("canvas",{ref:gt,style:Qr}),Bt)},Pc=a.memo(a.forwardRef(Lc));function Qo(e,t,n,o){return sn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Wc=e=>{const[t,n]=a.useState(),[o,r]=a.useState(),[i,l]=a.useState(),[s,c]=a.useState(),[f,u]=a.useState(!1),[w,b]=a.useState(),[m,h]=a.useState(),[g,x]=a.useState(),[C,v]=a.useState(!1),[I,X]=a.useState(),{onHeaderMenuClick:N,onHeaderIndicatorClick:A,getCellContent:z,onColumnMoved:_,onColumnResize:S,onColumnResizeStart:$,onColumnResizeEnd:W,gridRef:F,maxColumnWidth:R,minColumnWidth:M,onRowMoved:ce,lockColumns:ne,onColumnProposeMove:oe,onMouseDown:Ie,onMouseUp:ve,onItemHovered:Z,onDragStart:K,canvasRef:we}=e,J=(S??W??$)!==void 0,{columns:be,selection:fe}=e,U=fe.columns,xe=a.useCallback(V=>{const[Oe,De]=V.location;i!==void 0&&s!==Oe&&Oe>=ne?(u(!0),c(Oe)):m!==void 0&&De!==void 0?(v(!0),x(Math.max(0,De))):o===void 0&&!f&&!C&&(Z==null||Z(V))},[i,m,s,Z,ne,o,f,C]),Ce=_!==void 0,Ue=a.useCallback(V=>{var Oe;if(V.button===0){const[De,Fe]=V.location;if(V.kind==="out-of-bounds"&&V.isEdge&&J){const he=(Oe=F==null?void 0:F.current)==null?void 0:Oe.getBounds(be.length-1,-1);he!==void 0&&(n(he.x),r(be.length-1))}else if(V.kind==="header"&&De>=ne){const he=we==null?void 0:we.current;if(V.isEdge&&J&&he){n(V.bounds.x),r(De);const We=he.getBoundingClientRect().width/he.offsetWidth,$e=V.bounds.width/We;$==null||$(be[De],$e,De,$e+(be[De].growOffset??0))}else V.kind==="header"&&Ce&&(b(V.bounds.x),l(De))}else V.kind==="cell"&&ne>0&&De===0&&Fe!==void 0&&ce!==void 0&&(X(V.bounds.y),h(Fe))}Ie==null||Ie(V)},[Ie,J,ne,ce,F,be,Ce,$,we]),ot=a.useCallback((V,Oe)=>{f||C||N==null||N(V,Oe)},[f,C,N]),wt=a.useCallback((V,Oe)=>{f||C||A==null||A(V,Oe)},[f,C,A]),rt=a.useRef(-1),ze=a.useCallback(()=>{rt.current=-1,h(void 0),x(void 0),X(void 0),v(!1),l(void 0),c(void 0),b(void 0),u(!1),r(void 0),n(void 0)},[]),Ve=a.useCallback((V,Oe)=>{if(V.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const Fe of U){if(Fe===o)continue;const he=be[Fe],Ye=Qo(he,rt.current,M,R);S==null||S(he,Ye,Fe,Ye+(he.growOffset??0))}const De=Qo(be[o],rt.current,M,R);if(W==null||W(be[o],De,o,De+(be[o].growOffset??0)),U.hasIndex(o))for(const Fe of U){if(Fe===o)continue;const he=be[Fe],Ye=Qo(he,rt.current,M,R);W==null||W(he,Ye,Fe,Ye+(he.growOffset??0))}}ze(),i!==void 0&&s!==void 0&&(oe==null?void 0:oe(i,s))!==!1&&(_==null||_(i,s)),m!==void 0&&g!==void 0&&(ce==null||ce(m,g))}ve==null||ve(V,Oe)},[ve,o,i,s,m,g,U,W,be,M,R,S,_,ce,ze,oe]),Me=a.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(oe==null?void 0:oe(i,s))!==!1)return{src:i,dest:s}},[i,s,oe]),bt=a.useCallback(V=>{const Oe=we==null?void 0:we.current;if(i!==void 0&&w!==void 0)Math.abs(V.clientX-w)>20&&u(!0);else if(m!==void 0&&I!==void 0)Math.abs(V.clientY-I)>20&&v(!0);else if(o!==void 0&&t!==void 0&&Oe){const Fe=Oe.getBoundingClientRect().width/Oe.offsetWidth,he=(V.clientX-t)/Fe,Ye=be[o],We=Qo(Ye,he,M,R);if(S==null||S(Ye,We,o,We+(Ye.growOffset??0)),rt.current=he,(U==null?void 0:U.first())===o)for(const $e of U){if($e===o)continue;const de=be[$e],ue=Qo(de,rt.current,M,R);S==null||S(de,ue,$e,ue+(de.growOffset??0))}}},[i,w,m,I,o,t,be,M,R,S,U,we]),ct=a.useCallback((V,Oe)=>{if(m===void 0||g===void 0)return z(V,Oe);let[De,Fe]=V;return Fe===g?Fe=m:(Fe>g&&(Fe-=1),Fe>=m&&(Fe+=1)),z([De,Fe],Oe)},[m,g,z]),Ze=a.useCallback(V=>{K==null||K(V),V.defaultPrevented()||ze()},[ze,K]);return a.createElement(Pc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ct,isResizing:o!==void 0,onHeaderMenuClick:ot,onHeaderIndicatorClick:wt,isDragging:f,onItemHovered:xe,onDragStart:Ze,onMouseDown:Ue,allowResize:J,onMouseUp:Ve,dragAndDropState:Me,onMouseMoveRaw:bt,ref:F})};function $c(e){const t=a.useRef(null),[n,o]=a.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return a.useLayoutEffect(()=>{const r=l=>{for(const s of l){const{width:c,height:f}=s&&s.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Oc=(e,t,n)=>{const o=a.useRef(null),r=a.useRef(null),i=a.useRef(null),l=a.useRef(0),s=a.useRef(t);s.current=t;const c=n.current;a.useEffect(()=>{const f=()=>{var b,m;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((b=i.current)==null?void 0:b[0])===h[0]&&((m=i.current)==null?void 0:m[1])===h[1])if(l.current>10){i.current=null,r.current=null;return}else l.current++;else l.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},w=b=>{b.touches.length===0&&(r.current=!1,l.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const b=c;return b.addEventListener("touchstart",u),b.addEventListener("touchend",w),()=>{b.removeEventListener("touchstart",u),b.removeEventListener("touchend",w),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Nc=()=>e=>e.isSafari?"scroll":"auto",Xc=Jt("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Nc()]}});function Yc(e){const[t,n]=a.useState(!1),o=typeof window>"u"?null:window,r=a.useRef(0);return $t("touchstart",a.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),$t("touchend",a.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Gc=e=>{var J,be;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:l,className:s,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:w,rightElementProps:b,kineticScrollPerfHack:m=!1,scrollRef:h,initialSize:g}=e,x=[],C=(b==null?void 0:b.sticky)??!1,v=(b==null?void 0:b.fill)??!1,I=a.useRef(0),X=a.useRef(0),N=a.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,z=a.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),_=a.useRef(null),S=Yc(200),[$,W]=a.useState(!0),F=a.useRef(0);a.useLayoutEffect(()=>{if(!$||S||z.current.lockDirection===void 0)return;const fe=N.current;if(fe===null)return;const[U,xe]=z.current.lockDirection;U!==void 0?fe.scrollLeft=U:xe!==void 0&&(fe.scrollTop=xe),z.current.lockDirection=void 0},[S,$]);const R=a.useCallback((fe,U)=>{var Ze;const xe=N.current;if(xe===null)return;U=U??xe.scrollTop,fe=fe??xe.scrollLeft;const Ce=z.current.scrollTop,Ue=z.current.scrollLeft,ot=fe-Ue,wt=U-Ce;S&&ot!==0&&wt!==0&&(Math.abs(ot)>3||Math.abs(wt)>3)&&c&&z.current.lockDirection===void 0&&(z.current.lockDirection=Math.abs(ot)<Math.abs(wt)?[Ue,void 0]:[void 0,Ce]);const rt=z.current.lockDirection;fe=(rt==null?void 0:rt[0])??fe,U=(rt==null?void 0:rt[1])??U,z.current.scrollLeft=fe,z.current.scrollTop=U;const ze=xe.clientWidth,Ve=xe.clientHeight,Me=U,bt=X.current-Me,ct=xe.scrollHeight-Ve;if(X.current=Me,ct>0&&(Math.abs(bt)>2e3||Me===0||Me===ct)&&o>xe.scrollHeight+5){const V=Me/ct,Oe=(o-Ve)*V;I.current=Oe-Me}rt!==void 0&&(window.clearTimeout(F.current),W(!1),F.current=window.setTimeout(()=>W(!0),200)),i({x:fe,y:Me+I.current,width:ze-u,height:Ve-f,paddingRight:((Ze=_.current)==null?void 0:Ze.clientWidth)??0})},[f,u,o,i,c,S]);Oc(m&&Nr.value,R,N);const M=a.useRef(R);M.current=R;const ce=a.useRef(),ne=a.useRef(!1);a.useLayoutEffect(()=>{ne.current?R():ne.current=!0},[R,f,u]);const oe=a.useCallback(fe=>{N.current=fe,h!==void 0&&(h.current=fe)},[h]);let Ie=0,ve=0;for(x.push(a.createElement("div",{key:Ie++,style:{width:r,height:0}}));ve<o;){const fe=Math.min(5e6,o-ve);x.push(a.createElement("div",{key:Ie++,style:{width:0,height:fe}})),ve+=fe}const{ref:Z,width:K,height:we}=$c(g);return typeof window<"u"&&(((J=ce.current)==null?void 0:J.height)!==we||((be=ce.current)==null?void 0:be.width)!==K)&&(window.setTimeout(()=>M.current(),0),ce.current={width:K,height:we}),(K??0)===0||(we??0)===0?a.createElement("div",{ref:Z}):a.createElement("div",{ref:Z},a.createElement(Xc,{isSafari:Nr.value},a.createElement("div",{className:"dvn-underlay"},t),a.createElement("div",{ref:oe,style:ce.current,draggable:l,onDragStart:fe=>{l||(fe.stopPropagation(),fe.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>R()},a.createElement("div",{className:"dvn-scroll-inner"+(w===void 0?" dvn-hidden":"")},a.createElement("div",{className:"dvn-stack"},x),w!==void 0&&a.createElement(a.Fragment,null,!v&&a.createElement("div",{className:"dvn-spacer"}),a.createElement("div",{ref:_,style:{height:we,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:v?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},w))))))},_c=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:l,freezeColumns:s,experimental:c,nonGrowWidth:f,clientSize:u,className:w,onVisibleRegionChanged:b,scrollRef:m,preventDiagonalScrolling:h,rightElement:g,rightElementProps:x,overscrollX:C,overscrollY:v,initialSize:I,smoothScrollX:X=!1,smoothScrollY:N=!1,isDraggable:A}=e,{paddingRight:z,paddingBottom:_}=c??{},[S,$]=u,W=a.useRef(),F=a.useRef(),R=a.useRef(),M=a.useRef(),ce=f+Math.max(0,C??0);let ne=l?r+i:r;if(typeof o=="number")ne+=n*o;else for(let Z=0;Z<n;Z++)ne+=o(Z);v!==void 0&&(ne+=v);const oe=a.useRef(),Ie=a.useCallback(()=>{var wt,rt;if(oe.current===void 0)return;const Z={...oe.current};let K=0,we=Z.x<0?-Z.x:0,J=0,be=0;Z.x=Z.x<0?0:Z.x;let fe=0;for(let ze=0;ze<s;ze++)fe+=t[ze].width;for(const ze of t){const Ve=K-fe;if(Z.x>=Ve+ze.width)K+=ze.width,be++,J++;else if(Z.x>Ve)K+=ze.width,X?we+=Ve-Z.x:be++,J++;else if(Z.x+Z.width>Ve)K+=ze.width,J++;else break}let U=0,xe=0,Ce=0;if(typeof o=="number")N?(xe=Math.floor(Z.y/o),U=xe*o-Z.y):xe=Math.ceil(Z.y/o),Ce=Math.ceil(Z.height/o)+xe,U<0&&Ce++;else{let ze=0;for(let Ve=0;Ve<n;Ve++){const Me=o(Ve),bt=ze+(N?0:Me/2);if(Z.y>=ze+Me)ze+=Me,xe++,Ce++;else if(Z.y>bt)ze+=Me,N?U+=bt-Z.y:xe++,Ce++;else if(Z.y+Z.height>Me/2+ze)ze+=Me,Ce++;else break}}const Ue={x:be,y:xe,width:J-be,height:Ce-xe},ot=W.current;(ot===void 0||ot.y!==Ue.y||ot.x!==Ue.x||ot.height!==Ue.height||ot.width!==Ue.width||F.current!==we||R.current!==U||Z.width!==((wt=M.current)==null?void 0:wt[0])||Z.height!==((rt=M.current)==null?void 0:rt[1]))&&(b==null||b({x:be,y:xe,width:J-be,height:Ce-xe},Z.width,Z.height,Z.paddingRight??0,we,U),W.current=Ue,F.current=we,R.current=U,M.current=[Z.width,Z.height])},[t,o,n,b,s,X,N]),ve=a.useCallback(Z=>{oe.current=Z,Ie()},[Ie]);return a.useEffect(()=>{Ie()},[Ie]),a.createElement(Gc,{scrollRef:m,className:w,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:A===!0||typeof A=="string",scrollWidth:ce+(z??0),scrollHeight:ne+(_??0),clientHeight:$,rightElement:g,paddingBottom:_,paddingRight:z,rightElementProps:x,update:ve,initialSize:I},a.createElement(Wc,{eventTargetRef:m,width:S,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Kc=Jt("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Uc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Vc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),qc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),jc=10,Zc=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:l,searchResults:s,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:w=!1,onSearchClose:b}=e,[m]=a.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,g]=a.useState(""),x=l??h,C=a.useCallback(K=>{g(K),c==null||c(K)},[c]),[v,I]=a.useState(),X=a.useRef(v);X.current=v,a.useEffect(()=>{s!==void 0&&(s.length>0?I(K=>({rowsSearched:o,results:s.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):I(void 0))},[o,s]);const N=a.useRef();N.current===void 0&&(N.current=new AbortController);const A=a.useRef(),[z,_]=a.useState([]),S=s??z,$=a.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0,N.current.abort())},[]),W=a.useRef(n);W.current=n;const F=a.useCallback(K=>{const we=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let J=W.current,be=Math.min(10,o),fe=0;I(void 0),_([]);const U=[],xe=async()=>{var ct;if(f===void 0)return;const Ce=performance.now(),Ue=o-fe;let ot=f({x:0,y:J,width:r.length,height:Math.min(be,Ue,o-J)},N.current.signal);typeof ot=="function"&&(ot=await ot());let wt=!1;for(const[Ze,V]of ot.entries())for(const[Oe,De]of V.entries()){let Fe;switch(De.kind){case j.Text:case j.Number:Fe=De.displayData;break;case j.Uri:case j.Markdown:Fe=De.data;break;case j.Boolean:Fe=typeof De.data=="boolean"?De.data.toString():void 0;break;case j.Image:case j.Bubble:Fe=De.data.join("🐳");break;case j.Custom:Fe=De.copyData;break}Fe!==void 0&&we.test(Fe)&&(U.push([Oe,Ze+J]),wt=!0)}const rt=performance.now();wt&&_([...U]),fe+=ot.length,jt(fe<=o);const ze=((ct=X.current)==null?void 0:ct.selectedIndex)??-1;I({results:U.length,rowsSearched:fe,selectedIndex:ze}),u==null||u(U,ze),J+be>=o?J=0:J+=be;const Ve=rt-Ce,Me=Math.max(Ve,1),bt=jc/Me;be=Math.ceil(be*bt),fe<o&&U.length<1e3&&(A.current=window.requestAnimationFrame(xe))};$(),A.current=window.requestAnimationFrame(xe)},[$,r.length,f,u,o]),R=a.useCallback(()=>{var K;b==null||b(),I(void 0),_([]),u==null||u([],-1),$(),(K=t==null?void 0:t.current)==null||K.focus()},[$,t,b,u]),M=a.useCallback(K=>{C(K.target.value),s===void 0&&(K.target.value===""?(I(void 0),_([]),$()):F(K.target.value))},[F,$,C,s]);a.useEffect(()=>{w&&i.current!==null&&(C(""),i.current.focus({preventScroll:!0}))},[w,i,C]);const ce=a.useCallback(K=>{var J;if((J=K==null?void 0:K.stopPropagation)==null||J.call(K),v===void 0)return;const we=(v.selectedIndex+1)%v.results;I({...v,selectedIndex:we}),u==null||u(S,we)},[v,u,S]),ne=a.useCallback(K=>{var J;if((J=K==null?void 0:K.stopPropagation)==null||J.call(K),v===void 0)return;let we=(v.selectedIndex-1)%v.results;we<0&&(we+=v.results),I({...v,selectedIndex:we}),u==null||u(S,we)},[u,S,v]),oe=a.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(R(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?ne():ce())},[R,ce,ne]);a.useEffect(()=>()=>{$()},[$]);const[Ie,ve]=a.useState(!1);a.useEffect(()=>{if(w)ve(!0);else{const K=setTimeout(()=>ve(!1),150);return()=>clearTimeout(K)}},[w]);const Z=a.useMemo(()=>{if(!w&&!Ie)return null;let K;v!==void 0&&(K=v.results>=1e3?"over 1000":`${v.results} result${v.results!==1?"s":""}`,v.selectedIndex>=0&&(K=`${v.selectedIndex+1} of ${K}`));const we=fe=>{fe.stopPropagation()},be={width:`${Math.floor(((v==null?void 0:v.rowsSearched)??0)/o*100)}%`};return a.createElement(Kc,{className:w?"":"out",onMouseDown:we,onMouseMove:we,onMouseUp:we,onClick:we},a.createElement("div",{className:"gdg-search-bar-inner"},a.createElement("input",{id:m,"aria-hidden":!w,"data-testid":"search-input",ref:i,onChange:M,value:x,tabIndex:w?void 0:-1,onKeyDownCapture:oe}),a.createElement("button",{"aria-label":"Previous Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:ne,disabled:((v==null?void 0:v.results)??0)===0},Uc),a.createElement("button",{"aria-label":"Next Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:ce,disabled:((v==null?void 0:v.results)??0)===0},Vc),b!==void 0&&a.createElement("button",{"aria-label":"Close Search","aria-hidden":!w,"data-testid":"search-close-button",tabIndex:w?void 0:-1,onClick:R},qc)),v!==void 0?a.createElement(a.Fragment,null,a.createElement("div",{className:"gdg-search-status"},a.createElement("div",{"data-testid":"search-result-area"},K)),a.createElement("div",{className:"gdg-search-progress",style:be})):a.createElement("div",{className:"gdg-search-status"},a.createElement("label",{htmlFor:m},"Type to search")))},[w,Ie,v,o,m,i,M,x,oe,ne,ce,b,R]);return a.createElement(a.Fragment,null,a.createElement(_c,{prelightCells:S,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Z)};class Jc extends a.PureComponent{constructor(){super(...arguments);Xe(this,"wrapperRef",a.createRef());Xe(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("touchend",this.clickOutside,!0),n.addEventListener("mousedown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("touchend",this.clickOutside,!0),n.removeEventListener("mousedown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return a.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const Qc=()=>e=>Math.max(16,e.targetHeight-10),ed=Jt("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Qc(),"px"]}}),td=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[l,s]=vt.useState(n);return vt.createElement(Jc,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},vt.createElement(ed,{targetHeight:t.height,"data-testid":"group-rename-input",value:l,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,l.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(l):c.key==="Escape"&&o()},autoFocus:!0}))};function nd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Le(e,t,n){const o=rs(e,t);return o&&(n.didMatch=!0),o}function rs(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(rs(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const l=e.split("+"),s=l.pop();if(!nd(s,t))return!1;if(l[0]==="any")return!0;for(const c of l)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Xr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function od(e,t,n,o,r,i,l){const s=vt.useCallback((u,w,b,m)=>{var I;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!l&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(b||m==="drag"),g=o==="mixed"&&h,x=r==="mixed"&&h;let C={current:u===void 0?void 0:{...u,rangeStack:m==="drag"?((I=e.current)==null?void 0:I.rangeStack)??[]:[]},columns:g?e.columns:it.empty(),rows:x?e.rows:it.empty()};b&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,w)},[o,e,n,i,l,r,t]),c=vt.useCallback((u,w,b)=>{u=u??e.rows,w!==void 0&&(u=u.add(w));let m;if(r==="exclusive"&&u.length>0)m={current:void 0,columns:it.empty(),rows:u};else{const h=b&&n==="mixed",g=b&&o==="mixed";m={current:h?e.current:void 0,columns:g?e.columns:it.empty(),rows:u}}t(m,!1)},[o,e,n,r,t]),f=vt.useCallback((u,w,b)=>{u=u??e.columns,w!==void 0&&(u=u.add(w));let m;if(o==="exclusive"&&u.length>0)m={current:void 0,rows:it.empty(),columns:u};else{const h=b&&n==="mixed",g=b&&r==="mixed";m={current:h?e.current:void 0,rows:g?e.rows:it.empty(),columns:u}}t(m,!1)},[o,e,n,r,t]);return[s,c,f]}function rd(e,t,n,o,r){const i=a.useCallback(f=>{if(e===!0){const u=[];for(let w=f.y;w<f.y+f.height;w++){const b=[];for(let m=f.x;m<f.x+f.width;m++)m<0||w>=r?b.push({kind:j.Loading,allowOverlay:!1}):b.push(t([m,w]));u.push(b)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),l=e!==void 0?i:void 0,s=a.useCallback(f=>{if(l===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const w=l(u,o.signal);return typeof w=="function"?async()=>(await w()).map(b=>[{kind:j.Loading,allowOverlay:!1},...b]):w.map(b=>[{kind:j.Loading,allowOverlay:!1},...b])}return l(u,o.signal)},[o.signal,l,n]);return[e!==void 0?s:void 0,l]}function id(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case j.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Si?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case j.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case j.Image:case j.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case j.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case j.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case j.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case j.Markdown:case j.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case j.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case j.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case j.Protected:return{formatted:"************",rawValue:"",format:"string"};default:rr()}}function ld(e,t){return e.map((o,r)=>{const i=t[r];return o.map(l=>l.span!==void 0&&l.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:id(l))})}function wl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function sd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(l=>wl(l,!0)).join(",")):r.push(wl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function mi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function bl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function ad(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function cd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${mi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((l,s)=>`<li gdg-raw-value=${bl(r.rawValue[s])}>`+mi(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${bl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${mi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function dd(e,t){const n=ld(e,t),o=sd(n),r=cd(n);return{textPlain:o,textHtml:r}}function yl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,w=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",b=c.querySelectorAll("br");for(const g of b)g.replaceWith(`
`);const m=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((l=c.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const g=c.querySelectorAll("li");i==null||i.push({rawValue:[...g].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...g].map(x=>x.textContent??""),format:"string-array"})}else if(m!==null)i==null||i.push({rawValue:ad(m),formatted:c.textContent??"",format:h});else{let g=c.textContent??"";w&&(g=g.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:g??"",formatted:g??"",format:h})}}}return i!==void 0&&r.push(i),r}function ud(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,f=[];if(c.width>2){const b=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof b=="function")return i;f.push(...b);const m=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}else{const b=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof b=="function")return i;f.push(...b)}let u=c.x-n,w=c.x+c.width-1-n;for(const b of f)for(const m of b)m.span!==void 0&&(u=Math.min(m.span[0],u),w=Math.max(m.span[1],w));u===c.x-n&&w===c.x+c.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:w-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function pl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function fd(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,l)),r=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(pl(e.slice(r,l))),r=l+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}l++}return r<e.length&&o.push(pl(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function vl(e,t,n){var s;const o=dd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},l=(c,f)=>{var u,w;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(w=n==null?void 0:n.clipboardData)==null||w.setData("text/html",f)}catch{i(c,f)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function is(e){return e!==!0}function Cl(e){return typeof e=="string"?e:`${e}px`}const hd=()=>e=>e.innerWidth,gd=()=>e=>e.innerHeight,md=Jt("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[hd()],"wmyidgi-1":[gd()]}}),wd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return a.createElement(md,{innerHeight:Cl(n),innerWidth:Cl(t),...r},o)},bd=2,yd=1300;function pd(e,t,n){const o=vt.useRef(0),[r,i]=e??[0,0];vt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let l=!1,s=0;const c=f=>{var u;if(!l){if(s===0)s=f;else{const w=f-s;o.current=Math.min(1,o.current+w/yd);const b=o.current**1.618*w*bd;(u=t.current)==null||u.scrollBy(r*b,i*b),s=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{l=!0}},[t,r,i,n])}function vd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:l,remSize:s}){const[c,f,u,w,b,m]=vt.useMemo(()=>{if(!l||s===16)return[e,t,n,o,r,i];const h=s/16,g=e,x=Gl();return[typeof g=="number"?g*h:C=>Math.ceil(g(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,l,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:w,overscrollX:b,overscrollY:m}}const Vn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Pe(e,t){return e===!0?t:e===!1?"":e}function xl(e){const t=Xr.value;return{activateCell:Pe(e.activateCell," |Enter|shift+Enter"),clear:Pe(e.clear,"any+Escape"),closeOverlay:Pe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Pe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Pe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Pe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Pe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Pe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Pe(e.downFill,"primary+_68"),scrollToSelectedCell:Pe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Pe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Pe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Pe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Pe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Pe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Pe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Pe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Pe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Pe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Pe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Pe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Pe(e.goToLastCell,"primary+End"),goToLastColumn:Pe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Pe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Pe(e.goToNextPage,"PageDown"),goToPreviousPage:Pe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Pe(e.rightFill,"primary+_82"),search:Pe(e.search,"primary+f"),selectAll:Pe(e.selectAll,"primary+a"),selectColumn:Pe(e.selectColumn,"ctrl+ "),selectGrowDown:Pe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Pe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Pe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Pe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Pe(e.selectRow,"shift+ "),selectToFirstCell:Pe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Pe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Pe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Pe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Pe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Pe(e.selectToLastRow,"primary+shift+ArrowDown")}}function Cd(e){const t=ca(e);return vt.useMemo(()=>{if(t===void 0)return xl(Vn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Vn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Vn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Vn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Vn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Vn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Vn.selectToLastCell};return xl({...Vn,...n})},[t])}function xd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const l={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(l.subGroups=o.subGroups.map((s,c)=>t(s,r+1,[...i,c])).sort((s,c)=>s.headerIndex-c.headerIndex)),l}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Ai(e,t){const n=[];function o(l,s,c=!1){let f=s!==null?s-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(f=l.subGroups[0].headerIndex-l.headerIndex),f--,n.push({headerIndex:l.headerIndex,contentIndex:-1,skip:c,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:f}),l.subGroups)for(let u=0;u<l.subGroups.length;u++){const w=u<l.subGroups.length-1?l.subGroups[u+1].headerIndex:s;o(l.subGroups[u],w,c||l.isCollapsed)}}const r=xd(e.groups);for(let l=0;l<r.length;l++){const s=l<r.length-1?r[l+1].headerIndex:null;o(r[l],s)}let i=0;for(const l of n)l.contentIndex=i,i+=l.rows;return n.filter(l=>l.skip===!1).map(l=>{const{skip:s,...c}=l;return c})}function Gr(e,t){if(t===void 0||Ai.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(n--,!o.isCollapsed){if(n<o.rows)return{path:[...o.path,n],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n,contentIndex:o.contentIndex+n,groupRows:o.rows};n-=o.rows}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function kd(e,t,n,o){const r=vt.useMemo(()=>e===void 0?void 0:Ai(e,t),[e,t]),i=vt.useMemo(()=>r===void 0?t:r.reduce((f,u)=>f+(u.isCollapsed?1:u.rows+1),0),[r,t]),l=vt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:f=>{const{isGroupHeader:u}=Gr(f,r);return u?e.height:typeof n=="number"?n:n(f)},[r,e,n]),s=vt.useCallback(f=>{if(r===void 0)return f;let u=f;for(const w of r){if(u===0)return;if(u--,!w.isCollapsed){if(u<w.rows)return w.contentIndex+u;u-=w.rows}}return f},[r]),c=qn(o??(e==null?void 0:e.themeOverride),vt.useCallback(f=>{if(e===void 0)return o==null?void 0:o(f,f,f);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:u,contentIndex:w,groupIndex:b}=Gr(f,r);return u?e.themeOverride:o==null?void 0:o(f,b,w)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:s,getRowThemeOverride:c}:{rowHeight:l,rows:i,rowNumberMapper:s,getRowThemeOverride:c}}function Sd(e,t){const n=vt.useMemo(()=>e===void 0?void 0:Ai(e,t),[e,t]);return{getRowGroupingForPath:ss,updateRowGroupingByPath:ls,mapper:vt.useCallback(o=>{if(typeof o=="number")return Gr(o,n);const r=Gr(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function ls(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,l)=>l===o?{...i,...n}:i):e.map((i,l)=>l===o?{...i,subGroups:ls(i.subGroups??[],r,n)}:i)}function ss(e,t){const[n,...o]=t;return o[0]===-1?e[n]:ss(e[n].subGroups??[],o)}function Md(e,t){const[n]=a.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Rd(e,t,n,o,r){const[i,l]=a.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),s=a.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:l}),[o,l,i]),[c,f,u]=aa(s),w=a.useRef(r);w.current=r;const b=Md(null,g=>{g!==null&&t!==void 0?g.scrollTop=t:g!==null&&e!==void 0&&(g.scrollLeft=e)}),m=(c.height??1)>1;a.useLayoutEffect(()=>{if(t!==void 0&&b.current!==null&&m){if(b.current.scrollTop===t)return;b.current.scrollTop=t,b.current.scrollTop!==t&&u(),w.current()}},[t,m,u,b]);const h=(c.width??1)>1;return a.useLayoutEffect(()=>{if(e!==void 0&&b.current!==null&&h){if(b.current.scrollLeft===e)return;b.current.scrollLeft=e,b.current.scrollLeft!==e&&u(),w.current()}},[e,h,u,b]),{visibleRegion:c,setVisibleRegion:f,scrollRef:b}}const Ed=a.lazy(async()=>await Rl(()=>import("./data-grid-overlay-editor-C3RsYZLo.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));let Id=0;function Dd(e){return js(Zi(Zi(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return co((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Br(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Lr={kind:j.Loading,allowOverlay:!1},Pr={columns:it.empty(),rows:it.empty(),current:void 0},Fd=(e,t)=>{var Vi,qi,ji;const[n,o]=a.useState(Pr),[r,i]=a.useState(),l=a.useRef(null),s=a.useRef(null),[c,f]=a.useState(),u=a.useRef(),w=typeof window>"u"?null:window,{imageEditorOverride:b,getRowThemeOverride:m,markdownDivCreateNode:h,width:g,height:x,columns:C,rows:v,getCellContent:I,onCellClicked:X,onCellActivated:N,onFillPattern:A,onFinishedEditing:z,coercePasteValue:_,drawHeader:S,drawCell:$,editorBloom:W,onHeaderClicked:F,onColumnProposeMove:R,rangeSelectionColumnSpanning:M=!0,spanRangeBehavior:ce="default",onGroupHeaderClicked:ne,onCellContextMenu:oe,className:Ie,onHeaderContextMenu:ve,getCellsForSelection:Z,onGroupHeaderContextMenu:K,onGroupHeaderRenamed:we,onCellEdited:J,onCellsEdited:be,onSearchResultsChanged:fe,searchResults:U,onSearchValueChange:xe,searchValue:Ce,onKeyDown:Ue,onKeyUp:ot,keybindings:wt,editOnType:rt=!0,onRowAppended:ze,onColumnMoved:Ve,validateCell:Me,highlightRegions:bt,rangeSelect:ct="rect",columnSelect:Ze="multi",rowSelect:V="multi",rangeSelectionBlending:Oe="exclusive",columnSelectionBlending:De="exclusive",rowSelectionBlending:Fe="exclusive",onDelete:he,onDragStart:Ye,onMouseMove:We,onPaste:$e,copyHeaders:de=!1,freezeColumns:ue=0,cellActivationBehavior:tt="second-click",rowSelectionMode:Ge="auto",onHeaderMenuClick:Ke,onHeaderIndicatorClick:dt,getGroupDetails:Je,rowGrouping:Te,onSearchClose:Ct,onItemHovered:Lt,onSelectionCleared:xt,showSearch:Mt,onVisibleRegionChanged:Wt,gridSelection:ht,onGridSelectionChange:yn,minColumnWidth:Ln=50,maxColumnWidth:lt=500,maxColumnAutoWidth:In,provideEditor:dn,trailingRowOptions:pe,freezeTrailingRows:gt=0,allowedFillDirections:pn="orthogonal",scrollOffsetX:Qt,scrollOffsetY:en,verticalBorder:Be,onDragOverCell:Rt,onDrop:ut,onColumnResize:Ot,onColumnResizeEnd:Tt,onColumnResizeStart:Gt,customRenderers:Pn,fillHandle:Et,experimental:yt,fixedShadowX:Ft,fixedShadowY:At,headerIcons:Dn,imageWindowLoader:ar,initialSize:Wn,isDraggable:Fn,onDragLeave:Hn,onRowMoved:vn,overscrollX:cr,overscrollY:dr,preventDiagonalScrolling:go,rightElement:mo,rightElementProps:wo,trapFocus:Qn=!1,smoothScrollX:eo,smoothScrollY:$n,scaleToRem:Ur=!1,rowHeight:ur=34,headerHeight:fr=36,groupHeaderHeight:Vr=fr,theme:bo,isOutsideClick:On,renderers:Bo,resizeIndicator:qr,scrollToActiveCell:Lo=!0,drawFocusRing:Po=!0}=e,to=Po==="no-editor"?r===void 0:Po,kt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,_t=(kt==null?void 0:kt.kind)??e.rowMarkers??"none",Wo=(kt==null?void 0:kt.width)??e.rowMarkerWidth,$o=(kt==null?void 0:kt.startIndex)??e.rowMarkerStartIndex??1,yo=(kt==null?void 0:kt.theme)??e.rowMarkerTheme,Tn=kt==null?void 0:kt.headerTheme,An=kt==null?void 0:kt.headerAlwaysVisible,po=V!=="multi",Cn=(kt==null?void 0:kt.checkboxStyle)??"square",xn=Math.max(Ln,20),no=Math.max(lt,xn),hr=Math.max(In??no,xn),Oo=a.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Re,rowNumberMapper:gr,rowHeight:mr,getRowThemeOverride:tn}=kd(Te,v,ur,m),wr=a.useMemo(()=>Number.parseFloat(Oo.fontSize),[Oo]),{rowHeight:un,headerHeight:No,groupHeaderHeight:br,theme:yr,overscrollX:jr,overscrollY:Zr}=vd({groupHeaderHeight:Vr,headerHeight:fr,overscrollX:cr,overscrollY:dr,remSize:wr,rowHeight:mr,scaleToRem:Ur,theme:bo}),nn=Cd(wt),Nn=Wo??(v>1e4?48:v>1e3?44:v>100?36:32),on=_t!=="none",H=on?1:0,mt=ze!==void 0,Xn=(pe==null?void 0:pe.sticky)===!0,[vo,Co]=a.useState(!1),Xo=Mt??vo,Jr=a.useCallback(()=>{Ct!==void 0?Ct():Co(!1)},[Ct]),B=a.useMemo(()=>ht===void 0?void 0:Br(ht,H),[ht,H])??n,zt=a.useRef();zt.current===void 0&&(zt.current=new AbortController),a.useEffect(()=>()=>zt==null?void 0:zt.current.abort(),[]);const[Bt,Qr]=rd(Z,I,H,zt.current,Re),k=a.useCallback((d,p,y)=>{if(Me===void 0)return!0;const E=[d[0]-H,d[1]];return Me==null?void 0:Me(E,p,y)},[H,Me]),G=a.useRef(ht),Q=a.useCallback((d,p)=>{p&&(d=ud(d,Bt,H,ce,zt.current)),yn!==void 0?(G.current=Br(d,-H),yn(G.current)):o(d)},[yn,Bt,H,ce]),re=qn(Ot,a.useCallback((d,p,y,E)=>{Ot==null||Ot(C[y-H],p,y-H,E)},[Ot,H,C])),q=qn(Tt,a.useCallback((d,p,y,E)=>{Tt==null||Tt(C[y-H],p,y-H,E)},[Tt,H,C])),le=qn(Gt,a.useCallback((d,p,y,E)=>{Gt==null||Gt(C[y-H],p,y-H,E)},[Gt,H,C])),He=qn(S,a.useCallback((d,p)=>(S==null?void 0:S({...d,columnIndex:d.columnIndex-H},p))??!1,[S,H])),Ae=qn($,a.useCallback((d,p)=>($==null?void 0:$({...d,col:d.col-H},p))??!1,[$,H])),se=a.useCallback(d=>{if(he!==void 0){const p=he(Br(d,-H));return typeof p=="boolean"?p:Br(p,H)}return!0},[he,H]),[Qe,ie,Ee]=od(B,Q,Oe,De,Fe,ct,M),ke=a.useMemo(()=>Bn(Gl(),yr),[yr]),[Ne,Ht]=a.useState([0,0,0]),Kt=a.useMemo(()=>{if(Bo===void 0)return{};const d={};for(const p of Bo)d[p.kind]=p;return d},[Bo]),qe=a.useCallback(d=>d.kind!==j.Custom?Kt[d.kind]:Pn==null?void 0:Pn.find(p=>p.isMatch(d)),[Pn,Kt]);let{sizedColumns:pt,nonGrowWidth:fn}=za(C,Re,Qr,Ne[0]-(H===0?0:Nn)-Ne[2],xn,hr,ke,qe,zt.current);_t!=="none"&&(fn+=Nn);const Xt=a.useMemo(()=>pt.some(d=>d.group!==void 0),[pt]),nt=Xt?No+br:No,Ut=B.rows.length,Vt=_t==="none"?void 0:Ut===0?!1:Ut===Re?!0:void 0,je=a.useMemo(()=>_t==="none"?pt:[{title:"",width:Nn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:yo,rowMarker:Cn,rowMarkerChecked:Vt,headerRowMarkerTheme:Tn,headerRowMarkerAlwaysVisible:An,headerRowMarkerDisabled:po},...pt],[_t,pt,Nn,yo,Cn,Vt,Tn,An,po]),St=a.useRef({height:1,width:1,x:0,y:0}),Yn=a.useRef(!1),{setVisibleRegion:Gn,visibleRegion:oo,scrollRef:st}=Rd(Qt,en,un,St,()=>Yn.current=!0);St.current=oo;const us=oo.x+H,pr=oo.y,Pt=a.useRef(null),Yt=a.useCallback(d=>{var p;d===!0?(p=Pt.current)==null||p.focus():window.requestAnimationFrame(()=>{var y;(y=Pt.current)==null||y.focus()})},[]),Nt=mt?Re+1:Re,rn=a.useCallback(d=>{const p=H===0?d:d.map(E=>({...E,location:[E.location[0]-H,E.location[1]]})),y=be==null?void 0:be(p);if(y!==!0)for(const E of p)J==null||J(E.location,E.value);return y},[J,be,H]),[ro,ei]=a.useState(),vr=B.current!==void 0&&B.current.range.width*B.current.range.height>1?B.current.range:void 0,xo=to?(Vi=B.current)==null?void 0:Vi.cell:void 0,Cr=xo==null?void 0:xo[0],xr=xo==null?void 0:xo[1],fs=a.useMemo(()=>{if((bt===void 0||bt.length===0)&&(vr??Cr??xr??ro)===void 0)return;const d=[];if(bt!==void 0)for(const p of bt){const y=je.length-p.range.x-H;y>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+H,width:Math.min(y,p.range.width)},style:p.style})}return ro!==void 0&&d.push({color:fo(ke.accentColor,0),range:ro,style:"dashed"}),vr!==void 0&&d.push({color:fo(ke.accentColor,.5),range:vr,style:"solid-outline"}),Cr!==void 0&&xr!==void 0&&d.push({color:ke.accentColor,range:{x:Cr,y:xr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[ro,vr,Cr,xr,bt,je.length,ke.accentColor,H]),zi=a.useRef(je);zi.current=je;const qt=a.useCallback(([d,p],y=!1)=>{var P,T,L,O,Y,ee,ge;const E=mt&&p===Nt-1;if(d===0&&on){if(E)return Lr;const te=gr(p);return te===void 0?Lr:{kind:cn.Marker,allowOverlay:!1,checkboxStyle:Cn,checked:(B==null?void 0:B.rows.hasIndex(p))===!0,markerKind:_t==="clickable-number"?"number":_t,row:$o+te,drawHandle:vn!==void 0,cursor:_t==="clickable-number"?"pointer":void 0}}else if(E){const ye=d===H?(pe==null?void 0:pe.hint)??"":"",ae=zi.current[d];if(((P=ae==null?void 0:ae.trailingRowOptions)==null?void 0:P.disabled)===!0)return Lr;{const _e=((T=ae==null?void 0:ae.trailingRowOptions)==null?void 0:T.hint)??ye,Se=((L=ae==null?void 0:ae.trailingRowOptions)==null?void 0:L.addIcon)??(pe==null?void 0:pe.addIcon);return{kind:cn.NewRow,hint:_e,allowOverlay:!1,icon:Se}}}else{const te=d-H;if(y||(yt==null?void 0:yt.strict)===!0){const ae=St.current,_e=ae.x>te||te>ae.x+ae.width||ae.y>p||p>ae.y+ae.height||p>=ni.current,Se=te===((Y=(O=ae.extras)==null?void 0:O.selected)==null?void 0:Y[0])&&p===((ee=ae.extras)==null?void 0:ee.selected[1]);let me=!1;if(((ge=ae.extras)==null?void 0:ge.freezeRegions)!==void 0){for(const et of ae.extras.freezeRegions)if(uo(et,te,p)){me=!0;break}}if(_e&&!Se&&!me)return Lr}let ye=I([te,p]);return H!==0&&ye.span!==void 0&&(ye={...ye,span:[ye.span[0]+H,ye.span[1]+H]}),ye}},[mt,Nt,on,gr,Cn,B==null?void 0:B.rows,_t,$o,vn,H,pe==null?void 0:pe.hint,pe==null?void 0:pe.addIcon,yt==null?void 0:yt.strict,I]),ti=a.useCallback(d=>{let p=(Je==null?void 0:Je(d))??{name:d};return we!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:y=>ri({group:p.name,bounds:y.bounds})}]}),p},[Je,we]),kr=a.useCallback(d=>{var L;const[p,y]=d.cell,E=je[p],D=(E==null?void 0:E.group)!==void 0?(L=ti(E.group))==null?void 0:L.overrideTheme:void 0,P=E==null?void 0:E.themeOverride,T=tn==null?void 0:tn(y);i({...d,theme:Bn(ke,D,P,T,d.content.themeOverride)})},[tn,je,ti,ke]),ko=a.useCallback((d,p,y)=>{var T;if(B.current===void 0)return;const[E,D]=B.current.cell,P=qt([E,D]);if(P.kind!==j.Boolean&&P.allowOverlay){let L=P;if(y!==void 0)switch(L.kind){case j.Number:{const O=Js(()=>y==="-"?-0:Number.parseFloat(y),0);L={...L,data:Number.isNaN(O)?0:O};break}case j.Text:case j.Markdown:case j.Uri:L={...L,data:y};break}kr({target:d,content:L,initialValue:y,cell:[E,D],highlight:y===void 0,forceEditMode:y!==void 0})}else P.kind===j.Boolean&&p&&P.readonly!==!0&&(rn([{location:B.current.cell,value:{...P,data:is(P.data)}}]),(T=Pt.current)==null||T.damage([{cell:B.current.cell}]))},[qt,B,rn,kr]),Bi=a.useCallback((d,p)=>{var D;const y=(D=Pt.current)==null?void 0:D.getBounds(d,p);if(y===void 0||st.current===null)return;const E=qt([d,p]);E.allowOverlay&&kr({target:y,content:E,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0})},[qt,st,kr]),It=a.useCallback((d,p,y="both",E=0,D=0,P=void 0)=>{if(st.current!==null){const T=Pt.current,L=s.current,O=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,ee=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ge=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(T!==null&&L!==null){let te={x:0,y:0,width:0,height:0},ye=0,ae=0;if((O!==void 0||Y!==void 0)&&(te=T.getBounds((O??0)+H,Y??0)??te,te.width===0||te.height===0))return;const _e=L.getBoundingClientRect(),Se=_e.width/L.offsetWidth;if(ee!==void 0&&(te={...te,x:ee-_e.left-st.current.scrollLeft,width:1}),ge!==void 0&&(te={...te,y:ge+_e.top-st.current.scrollTop,height:1}),te!==void 0){const me={x:te.x-E,y:te.y-D,width:te.width+2*E,height:te.height+2*D};let et=0;for(let ui=0;ui<ue;ui++)et+=pt[ui].width;let ft=0;const Dt=gt+(Xn?1:0);Dt>0&&(ft=ho(Nt,Dt,un));let mn=et*Se+_e.left+H*Nn*Se,Sn=_e.right,wn=_e.top+nt*Se,Mn=_e.bottom-ft*Se;const Fr=te.width+E*2;switch(P==null?void 0:P.hAlign){case"start":Sn=mn+Fr;break;case"end":mn=Sn-Fr;break;case"center":mn=Math.floor((mn+Sn)/2)-Fr/2,Sn=mn+Fr;break}const Hr=te.height+D*2;switch(P==null?void 0:P.vAlign){case"start":Mn=wn+Hr;break;case"end":wn=Mn-Hr;break;case"center":wn=Math.floor((wn+Mn)/2)-Hr/2,Mn=wn+Hr;break}mn>me.x?ye=me.x-mn:Sn<me.x+me.width&&(ye=me.x+me.width-Sn),wn>me.y?ae=me.y-wn:Mn<me.y+me.height&&(ae=me.y+me.height-Mn),y==="vertical"||typeof d=="number"&&d<ue?ye=0:(y==="horizontal"||typeof p=="number"&&p>=Nt-Dt)&&(ae=0),(ye!==0||ae!==0)&&(Se!==1&&(ye/=Se,ae/=Se),st.current.scrollTo(ye+st.current.scrollLeft,ae+st.current.scrollTop))}}}},[H,gt,Nn,st,nt,ue,pt,Nt,Xn,un]),Li=a.useRef(Bi),Pi=a.useRef(I),ni=a.useRef(Re);Li.current=Bi,Pi.current=I,ni.current=Re;const So=a.useCallback(async(d,p=!0)=>{var O;const y=je[d];if(((O=y==null?void 0:y.trailingRowOptions)==null?void 0:O.disabled)===!0)return;const E=ze==null?void 0:ze();let D,P=!0;E!==void 0&&(D=await E,D==="top"&&(P=!1),typeof D=="number"&&(P=!1));let T=0;const L=()=>{if(ni.current<=Re){T<500&&window.setTimeout(L,T),T=50+T*2;return}const Y=typeof D=="number"?D:P?Re:0;Dr.current(d-H,Y),Qe({cell:[d,Y],range:{x:d,y:Y,width:1,height:1}},!1,!1,"edit");const ee=Pi.current([d-H,Y]);ee.allowOverlay&&er(ee)&&ee.readonly!==!0&&p&&window.setTimeout(()=>{Li.current(d,Y)},0)};L()},[je,ze,H,Re,Qe]),Sr=a.useCallback(d=>{var y,E;const p=((E=(y=pt[d])==null?void 0:y.trailingRowOptions)==null?void 0:E.targetColumn)??(pe==null?void 0:pe.targetColumn);if(typeof p=="number")return p+(on?1:0);if(typeof p=="object"){const D=C.indexOf(p);if(D>=0)return D+(on?1:0)}},[pt,C,on,pe==null?void 0:pe.targetColumn]),_n=a.useRef(),Mo=a.useRef(),Go=a.useCallback((d,p)=>{var D;const[y,E]=p;return Bn(ke,(D=je[y])==null?void 0:D.themeOverride,tn==null?void 0:tn(E),d.themeOverride)},[tn,je,ke]),{mapper:io}=Sd(Te,v),hn=Te==null?void 0:Te.navigationBehavior,_o=a.useCallback(d=>{var ee,ge,te;const p=Xr.value?d.metaKey:d.ctrlKey,y=p&&V==="multi",E=p&&Ze==="multi",[D,P]=d.location,T=B.columns,L=B.rows,[O,Y]=((ee=B.current)==null?void 0:ee.cell)??[];if(d.kind==="cell"){if(Mo.current=void 0,lo.current=[D,P],D===0&&on){if(mt===!0&&P===Re||_t==="number"||V==="none")return;const ye=qt(d.location);if(ye.kind!==cn.Marker)return;if(vn!==void 0){const Se=qe(ye);jt((Se==null?void 0:Se.kind)===cn.Marker);const me=(ge=Se==null?void 0:Se.onClick)==null?void 0:ge.call(Se,{...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Go(ye,d.location),preventDefault:()=>{}});if(me===void 0||me.checked===ye.checked)return}i(void 0),Yt();const ae=L.hasIndex(P),_e=_n.current;if(V==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&_e!==void 0&&L.hasIndex(_e)){const Se=[Math.min(_e,P),Math.max(_e,P)+1];y||Ge==="multi"?ie(void 0,Se,!0):ie(it.fromSingleSelection(Se),void 0,y)}else V==="multi"&&(y||d.isTouch||Ge==="multi")?ae?ie(L.remove(P),void 0,!0):(ie(void 0,P,!0),_n.current=P):ae&&L.length===1?ie(it.empty(),void 0,p):(ie(it.fromSingleSelection(P),void 0,p),_n.current=P)}else if(D>=H&&mt&&P===Re){const ye=Sr(D);So(ye??D)}else if(O!==D||Y!==P){const ye=qt(d.location),ae=qe(ye);if((ae==null?void 0:ae.onSelect)!==void 0){let me=!1;if(ae.onSelect({...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>me=!0,theme:Go(ye,d.location)}),me)return}if(hn==="block"&&io(P).isGroupHeader)return;const _e=Xn&&P===Re,Se=Xn&&B!==void 0&&((te=B.current)==null?void 0:te.cell[1])===Re;if((d.shiftKey||d.isLongTouch===!0)&&O!==void 0&&Y!==void 0&&B.current!==void 0&&!Se){if(_e)return;const me=Math.min(D,O),et=Math.max(D,O),ft=Math.min(P,Y),Dt=Math.max(P,Y);Qe({...B.current,range:{x:me,y:ft,width:et-me+1,height:Dt-ft+1}},!0,p,"click"),_n.current=void 0,Yt()}else Qe({cell:[D,P],range:{x:D,y:P,width:1,height:1}},!0,p,"click"),_n.current=void 0,i(void 0),Yt()}}else if(d.kind==="header")if(lo.current=[D,P],i(void 0),on&&D===0)_n.current=void 0,Mo.current=void 0,V==="multi"&&(L.length!==Re?ie(it.fromSingleSelection([0,Re]),void 0,p):ie(it.empty(),void 0,p),Yt());else{const ye=Mo.current;if(Ze==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&ye!==void 0&&T.hasIndex(ye)){const ae=[Math.min(ye,D),Math.max(ye,D)+1];E?Ee(void 0,ae,p):Ee(it.fromSingleSelection(ae),void 0,p)}else E?(T.hasIndex(D)?Ee(T.remove(D),void 0,p):Ee(void 0,D,p),Mo.current=D):Ze!=="none"&&(Ee(it.fromSingleSelection(D),void 0,p),Mo.current=D);_n.current=void 0,Yt()}else d.kind===an?lo.current=[D,P]:d.kind===Yr&&!d.isMaybeScrollbar&&(Q(Pr,!1),i(void 0),Yt(),xt==null||xt(),_n.current=void 0,Mo.current=void 0)},[V,Ze,B,on,H,mt,Re,_t,qt,vn,Yt,Ge,qe,Go,ie,Sr,So,hn,io,Xn,Qe,Ee,Q,xt]),Ko=a.useRef(!1),lo=a.useRef(),Wi=a.useRef(oo),ln=a.useRef(),hs=a.useCallback(d=>{if(Ro.current=!1,Wi.current=St.current,d.button!==0&&d.button!==1){ln.current=void 0;return}const p=performance.now();ln.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&(Ko.current=!0);const y=d.kind==="cell"&&d.isFillHandle;!y&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:B,fillHandle:y}),lo.current=void 0,!d.isTouch&&d.button===0&&!y?_o(d):!d.isTouch&&d.button===1&&(lo.current=d.location))},[B,_o]),[oi,ri]=a.useState(),$i=a.useCallback(d=>{if(d.kind!==an||Ze!=="multi")return;const p=Xr.value?d.metaKey:d.ctrlKey,[y]=d.location,E=B.columns;if(y<H)return;const D=je[y];let P=y,T=y;for(let L=y-1;L>=H&&ir(D.group,je[L].group);L--)P--;for(let L=y+1;L<je.length&&ir(D.group,je[L].group);L++)T++;if(Yt(),p)if(E.hasAll([P,T+1])){let L=E;for(let O=P;O<=T;O++)L=L.remove(O);Ee(L,void 0,p)}else Ee(void 0,[P,T+1],p);else Ee(it.fromSingleSelection([P,T+1]),void 0,p)},[Ze,Yt,B.columns,je,H,Ee]),Ro=a.useRef(!1),Mr=a.useCallback(async d=>{if(Bt!==void 0&&re!==void 0){const p=St.current.y,y=St.current.height;let E=Bt({x:d,y:p,width:1,height:Math.min(y,Re-p)},zt.current.signal);typeof E!="object"&&(E=await E());const D=pt[d-H],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=ke.baseFontFull;const L=Kl(T,ke,D,0,E,xn,no,!1,qe);re==null||re(D,L.width,d,L.width)}}},[pt,Bt,no,ke,xn,re,H,Re,qe]),[gs,ii]=a.useState(),Eo=a.useCallback(async(d,p)=>{var L,O;const y=(L=d.current)==null?void 0:L.range;if(y===void 0||Bt===void 0||p.current===void 0)return;const E=p.current.range;if(A!==void 0){let Y=!1;if(A({fillDestination:{...E,x:E.x-H},patternSource:{...y,x:y.x-H},preventDefault:()=>Y=!0}),Y)return}let D=Bt(y,zt.current.signal);typeof D!="object"&&(D=await D());const P=D,T=[];for(let Y=0;Y<E.width;Y++)for(let ee=0;ee<E.height;ee++){const ge=[E.x+Y,E.y+ee];if(zl(ge,y))continue;const te=P[ee%y.height][Y%y.width];Do(te)||!er(te)||T.push({location:ge,value:{...te}})}rn(T),(O=Pt.current)==null||O.damage(T.map(Y=>({cell:Y.location})))},[Bt,rn,A,H]),Oi=a.useCallback(()=>{if(B.current===void 0||B.current.range.width<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,width:1}}};Eo(d,B)},[Eo,B]),Ni=a.useCallback(()=>{if(B.current===void 0||B.current.range.height<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,height:1}}};Eo(d,B)},[Eo,B]),ms=a.useCallback((d,p)=>{var ee,ge;const y=c;if(f(void 0),ei(void 0),ii(void 0),Ko.current=!1,p)return;if((y==null?void 0:y.fillHandle)===!0&&B.current!==void 0&&((ee=y.previousSelection)==null?void 0:ee.current)!==void 0){if(ro===void 0)return;const te={...B,current:{...B.current,range:Zl(y.previousSelection.current.range,ro)}};Eo(y.previousSelection,te),Q(te,!0);return}const[E,D]=d.location,[P,T]=lo.current??[],L=()=>{Ro.current=!0},O=te=>{var ae,_e,Se;const ye=te.isTouch||P===E&&T===D;if(ye&&(X==null||X([E-H,D],{...te,preventDefault:L})),te.button===1)return!Ro.current;if(!Ro.current){const me=qt(d.location),et=qe(me);if(et!==void 0&&et.onClick!==void 0&&ye){const Dt=et.onClick({...te,cell:me,posX:te.localEventX,posY:te.localEventY,bounds:te.bounds,theme:Go(me,d.location),preventDefault:L});Dt!==void 0&&!Do(Dt)&&Io(Dt)&&(rn([{location:te.location,value:Dt}]),(ae=Pt.current)==null||ae.damage([{cell:te.location}]))}if(Ro.current||B.current===void 0)return!1;let ft=!1;switch(me.activationBehaviorOverride??tt){case"double-click":case"second-click":{if(((Se=(_e=y==null?void 0:y.previousSelection)==null?void 0:_e.current)==null?void 0:Se.cell)===void 0)break;const[Dt,mn]=B.current.cell,[Sn,wn]=y.previousSelection.current.cell;ft=E===Dt&&E===Sn&&D===mn&&D===wn&&(te.isDoubleClick===!0||tt==="second-click");break}case"single-click":{ft=!0;break}}if(ft)return N==null||N([E-H,D]),ko(te.bounds,!1),!0}return!1},Y=d.location[0]-H;if(d.isTouch){const te=St.current,ye=Wi.current;if(te.x!==ye.x||te.y!==ye.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&tr((ge=B.current)==null?void 0:ge.cell,d.location)){oe==null||oe([Y,d.location[1]],{...d,preventDefault:L});return}else if(d.kind==="header"&&B.columns.hasIndex(E)){ve==null||ve(Y,{...d,preventDefault:L});return}else if(d.kind===an){if(Y<0)return;K==null||K(Y,{...d,preventDefault:L});return}}d.kind==="cell"?O(d)||_o(d):d.kind===an?ne==null||ne(Y,{...d,preventDefault:L}):(d.kind===jn&&(F==null||F(Y,{...d,preventDefault:L})),_o(d));return}if(d.kind==="header"){if(Y<0)return;d.isEdge?d.isDoubleClick===!0&&Mr(E):d.button===0&&E===P&&D===T&&(F==null||F(Y,{...d,preventDefault:L}))}if(d.kind===an){if(Y<0)return;d.button===0&&E===P&&D===T&&(ne==null||ne(Y,{...d,preventDefault:L}),Ro.current||$i(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&O(d),lo.current=void 0},[c,B,H,ro,Eo,Q,X,qt,qe,tt,Go,rn,N,ko,oe,ve,K,_o,ne,F,Mr,$i]),ws=a.useCallback(d=>{const p={...d,location:[d.location[0]-H,d.location[1]]};We==null||We(p),c!==void 0&&d.buttons===0&&(f(void 0),ei(void 0),ii(void 0),Ko.current=!1),ii(y=>{var E;return Ko.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(y==null?void 0:y[0])&&d.scrollEdge[1]===y[1]?y:c===void 0||(((E=ln.current)==null?void 0:E.location[0])??0)<H?void 0:d.scrollEdge})},[c,We,H]),bs=a.useCallback((d,p)=>{Ke==null||Ke(d-H,p)},[Ke,H]),ys=a.useCallback((d,p)=>{dt==null||dt(d-H,p)},[dt,H]),kn=(qi=B==null?void 0:B.current)==null?void 0:qi.cell,ps=a.useCallback((d,p,y,E,D,P)=>{Yn.current=!1;let T=kn;T!==void 0&&(T=[T[0]-H,T[1]]);const L=ue===0?void 0:{x:0,y:d.y,width:ue,height:d.height},O=[];L!==void 0&&O.push(L),gt>0&&(O.push({x:d.x-H,y:Re-gt,width:d.width,height:gt}),ue>0&&O.push({x:0,y:Re-gt,width:ue,height:gt}));const Y={x:d.x-H,y:d.y,width:d.width,height:mt&&d.y+d.height>=Re?d.height-1:d.height,tx:D,ty:P,extras:{selected:T,freezeRegion:L,freezeRegions:O}};St.current=Y,Gn(Y),Ht([p,y,E]),Wt==null||Wt(Y,Y.tx,Y.ty,Y.extras)},[kn,H,mt,Re,ue,gt,Gn,Wt]),vs=qn(R,a.useCallback((d,p)=>(R==null?void 0:R(d-H,p-H))!==!1,[R,H])),Cs=qn(Ve,a.useCallback((d,p)=>{Ve==null||Ve(d-H,p-H),Ze!=="none"&&Ee(it.fromSingleSelection(p),void 0,!0)},[Ze,Ve,H,Ee])),li=a.useRef(!1),xs=a.useCallback(d=>{if(d.location[0]===0&&H>0){d.preventDefault();return}Ye==null||Ye({...d,location:[d.location[0]-H,d.location[1]]}),d.defaultPrevented()||(li.current=!0),f(void 0)},[Ye,H]),ks=a.useCallback(()=>{li.current=!1},[]),Xi=Te==null?void 0:Te.selectionBehavior,Rr=a.useCallback(d=>{if(Xi!=="block-spanning")return;const{isGroupHeader:p,path:y,groupRows:E}=io(d);if(p)return[d,d];const D=y[y.length-1],P=d-D,T=d+E-D-1;return[P,T]},[io,Xi]),si=a.useRef(),ai=a.useCallback(d=>{var p,y,E;if(!os(d,si.current)&&(si.current=d,!(((p=ln==null?void 0:ln.current)==null?void 0:p.button)!==void 0&&ln.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((y=ln.current)==null?void 0:y.location[0])===0&&d.location[0]===0&&H===1&&V==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(ln.current.location[1])&&B.rows.hasIndex(ln.current.location[1])){const D=Math.min(ln.current.location[1],d.location[1]),P=Math.max(ln.current.location[1],d.location[1])+1;ie(it.fromSingleSelection([D,P]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&B.current!==void 0&&!li.current&&!Ko.current&&(ct==="rect"||ct==="multi-rect")){const[D,P]=B.current.cell;let[T,L]=d.location;if(L<0&&(L=St.current.y),c.fillHandle===!0&&((E=c.previousSelection)==null?void 0:E.current)!==void 0){const O=c.previousSelection.current.range;L=Math.min(L,mt?Re-1:Re);const Y=fc(O,T,L,pn);ei(Y)}else{if(mt&&P===Re)return;if(mt&&L===Re)if(d.kind===Yr)L--;else return;T=Math.max(T,H);const ee=Rr(P);L=ee===void 0?L:sn(L,ee[0],ee[1]);const ge=T-D,te=L-P,ye={x:ge>=0?D:T,y:te>=0?P:L,width:Math.abs(ge)+1,height:Math.abs(te)+1};Qe({...B.current,range:ye},!0,!1,"drag")}}Lt==null||Lt({...d,location:[d.location[0]-H,d.location[1]]})}},[c,H,V,B,ct,Lt,ie,mt,Re,pn,Rr,Qe]),Ss=a.useCallback(()=>{var T,L;const d=si.current;if(d===void 0)return;const[p,y]=d.scrollEdge;let[E,D]=d.location;const P=St.current;p===-1?E=((L=(T=P.extras)==null?void 0:T.freezeRegion)==null?void 0:L.x)??P.x:p===1&&(E=P.x+P.width),y===-1?D=Math.max(0,P.y):y===1&&(D=Math.min(Re-1,P.y+P.height)),E=sn(E,0,je.length-1),D=sn(D,0,Re-1),ai({...d,location:[E,D]})},[je.length,ai,Re]);pd(gs,st,Ss);const gn=a.useCallback(d=>{if(B.current===void 0)return;const[p,y]=d,[E,D]=B.current.cell,P=B.current.range;let T=P.x,L=P.x+P.width,O=P.y,Y=P.y+P.height;const[ee,ge]=Rr(D)??[0,Re-1],te=ge+1;if(y!==0)switch(y){case 2:{Y=te,O=D,It(0,Y,"vertical");break}case-2:{O=ee,Y=D+1,It(0,O,"vertical");break}case 1:{O<D?(O++,It(0,O,"vertical")):(Y=Math.min(te,Y+1),It(0,Y,"vertical"));break}case-1:{Y>D+1?(Y--,It(0,Y,"vertical")):(O=Math.max(ee,O-1),It(0,O,"vertical"));break}default:rr()}if(p!==0)if(p===2)L=je.length,T=E,It(L-1-H,0,"horizontal");else if(p===-2)T=H,L=E+1,It(T-H,0,"horizontal");else{let ye=[];if(Bt!==void 0){const ae=Bt({x:T,y:O,width:L-T-H,height:Y-O},zt.current.signal);typeof ae=="object"&&(ye=Dd(ae))}if(p===1){let ae=!1;if(T<E){if(ye.length>0){const _e=co(T+1,E+1).find(Se=>!ye.includes(Se-H));_e!==void 0&&(T=_e,ae=!0)}else T++,ae=!0;ae&&It(T,0,"horizontal")}ae||(L=Math.min(je.length,L+1),It(L-1-H,0,"horizontal"))}else if(p===-1){let ae=!1;if(L>E+1){if(ye.length>0){const _e=co(L-1,E,-1).find(Se=>!ye.includes(Se-H));_e!==void 0&&(L=_e,ae=!0)}else L--,ae=!0;ae&&It(L-H,0,"horizontal")}ae||(T=Math.max(H,T-1),It(T-H,0,"horizontal"))}else rr()}Qe({cell:B.current.cell,range:{x:T,y:O,width:L-T,height:Y-O}},!0,!1,"keyboard-select")},[Bt,Rr,B,je.length,H,Re,It,Qe]),ci=a.useRef(Lo);ci.current=Lo;const Kn=a.useCallback((d,p,y,E)=>{const D=Nt-(y?0:1);d=sn(d,H,pt.length-1+H),p=sn(p,0,D);const P=kn==null?void 0:kn[0],T=kn==null?void 0:kn[1];if(d===P&&p===T)return!1;if(E&&B.current!==void 0){const L=[...B.current.rangeStack];(B.current.range.width>1||B.current.range.height>1)&&L.push(B.current.range),Q({...B,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:L}},!0)}else Qe({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===p&&(u.current=void 0),ci.current&&It(d-H,p),!0},[Nt,H,pt.length,kn,B,It,Q,Qe]),Ms=a.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&Io(d)&&(rn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var D;(D=Pt.current)==null||D.damage([{cell:r.cell}])})),Yt(!0),i(void 0);const[y,E]=p;if(B.current!==void 0&&(y!==0||E!==0)){const D=B.current.cell[1]===Nt-1&&d!==void 0;Kn(sn(B.current.cell[0]+y,0,je.length-1),sn(B.current.cell[1]+E,0,Nt-1),D,!1)}z==null||z(d,p)},[r==null?void 0:r.cell,Yt,B,z,rn,Nt,Kn,je.length]),Rs=a.useMemo(()=>`gdg-overlay-${Id++}`,[]),so=a.useCallback(d=>{var y,E,D,P;Yt();const p=[];for(let T=d.x;T<d.x+d.width;T++)for(let L=d.y;L<d.y+d.height;L++){const O=I([T-H,L]);if(!O.allowOverlay&&O.kind!==j.Boolean)continue;let Y;if(O.kind===j.Custom){const ee=qe(O),ge=(y=ee==null?void 0:ee.provideEditor)==null?void 0:y.call(ee,O);(ee==null?void 0:ee.onDelete)!==void 0?Y=ee.onDelete(O):Qs(ge)&&(Y=(E=ge==null?void 0:ge.deletedValue)==null?void 0:E.call(ge,O))}else if(Io(O)&&O.allowOverlay||O.kind===j.Boolean){const ee=qe(O);Y=(D=ee==null?void 0:ee.onDelete)==null?void 0:D.call(ee,O)}Y!==void 0&&!Do(Y)&&Io(Y)&&p.push({location:[T,L],value:Y})}rn(p),(P=Pt.current)==null||P.damage(p.map(T=>({cell:T.location})))},[Yt,I,qe,rn,H]),Uo=r!==void 0,Yi=a.useCallback(d=>{var _e,Se;const p=()=>{d.stopPropagation(),d.preventDefault()},y={didMatch:!1},{bounds:E}=d,D=B.columns,P=B.rows,T=nn;if(!Uo&&Le(T.clear,d,y))Q(Pr,!1),xt==null||xt();else if(!Uo&&Le(T.selectAll,d,y))Q({columns:it.empty(),rows:it.empty(),current:{cell:((_e=B.current)==null?void 0:_e.cell)??[H,0],range:{x:H,y:0,width:C.length,height:Re},rangeStack:[]}},!1);else if(Le(T.search,d,y))(Se=l==null?void 0:l.current)==null||Se.focus({preventScroll:!0}),Co(!0);else if(Le(T.delete,d,y)){const me=(se==null?void 0:se(B))??!0;if(me!==!1){const et=me===!0?B:me;if(et.current!==void 0){so(et.current.range);for(const ft of et.current.rangeStack)so(ft)}for(const ft of et.rows)so({x:H,y:ft,width:C.length,height:1});for(const ft of et.columns)so({x:ft,y:0,width:1,height:Re})}}if(y.didMatch)return p(),!0;if(B.current===void 0)return!1;let[L,O]=B.current.cell;const[,Y]=B.current.cell;let ee=!1,ge=!1;if(Le(T.scrollToSelectedCell,d,y)?Dr.current(L-H,O):Ze!=="none"&&Le(T.selectColumn,d,y)?D.hasIndex(L)?Ee(D.remove(L),void 0,!0):Ze==="single"?Ee(it.fromSingleSelection(L),void 0,!0):Ee(void 0,L,!0):V!=="none"&&Le(T.selectRow,d,y)?P.hasIndex(O)?ie(P.remove(O),void 0,!0):V==="single"?ie(it.fromSingleSelection(O),void 0,!0):ie(void 0,O,!0):!Uo&&E!==void 0&&Le(T.activateCell,d,y)?O===Re&&mt?window.setTimeout(()=>{const me=Sr(L);So(me??L)},0):(N==null||N([L-H,O]),ko(E,!0)):B.current.range.height>1&&Le(T.downFill,d,y)?Ni():B.current.range.width>1&&Le(T.rightFill,d,y)?Oi():Le(T.goToNextPage,d,y)?O+=Math.max(1,St.current.height-4):Le(T.goToPreviousPage,d,y)?O-=Math.max(1,St.current.height-4):Le(T.goToFirstCell,d,y)?(i(void 0),O=0,L=0):Le(T.goToLastCell,d,y)?(i(void 0),O=Number.MAX_SAFE_INTEGER,L=Number.MAX_SAFE_INTEGER):Le(T.selectToFirstCell,d,y)?(i(void 0),gn([-2,-2])):Le(T.selectToLastCell,d,y)?(i(void 0),gn([2,2])):Uo?(Le(T.closeOverlay,d,y)&&i(void 0),Le(T.acceptOverlayDown,d,y)&&(i(void 0),O++),Le(T.acceptOverlayUp,d,y)&&(i(void 0),O--),Le(T.acceptOverlayLeft,d,y)&&(i(void 0),L--),Le(T.acceptOverlayRight,d,y)&&(i(void 0),L++)):(Le(T.goDownCell,d,y)?O+=1:Le(T.goUpCell,d,y)?O-=1:Le(T.goRightCell,d,y)?L+=1:Le(T.goLeftCell,d,y)?L-=1:Le(T.goDownCellRetainSelection,d,y)?(O+=1,ee=!0):Le(T.goUpCellRetainSelection,d,y)?(O-=1,ee=!0):Le(T.goRightCellRetainSelection,d,y)?(L+=1,ee=!0):Le(T.goLeftCellRetainSelection,d,y)?(L-=1,ee=!0):Le(T.goToLastRow,d,y)?O=Re-1:Le(T.goToFirstRow,d,y)?O=Number.MIN_SAFE_INTEGER:Le(T.goToLastColumn,d,y)?L=Number.MAX_SAFE_INTEGER:Le(T.goToFirstColumn,d,y)?L=Number.MIN_SAFE_INTEGER:(ct==="rect"||ct==="multi-rect")&&(Le(T.selectGrowDown,d,y)?gn([0,1]):Le(T.selectGrowUp,d,y)?gn([0,-1]):Le(T.selectGrowRight,d,y)?gn([1,0]):Le(T.selectGrowLeft,d,y)?gn([-1,0]):Le(T.selectToLastRow,d,y)?gn([0,2]):Le(T.selectToFirstRow,d,y)?gn([0,-2]):Le(T.selectToLastColumn,d,y)?gn([2,0]):Le(T.selectToFirstColumn,d,y)&&gn([-2,0])),ge=y.didMatch),hn!==void 0&&hn!=="normal"&&O!==Y){const me=hn==="skip-up"||hn==="skip"||hn==="block",et=hn==="skip-down"||hn==="skip"||hn==="block",ft=O<Y;if(ft&&me){for(;O>=0&&io(O).isGroupHeader;)O--;O<0&&(O=Y)}else if(!ft&&et){for(;O<Re&&io(O).isGroupHeader;)O++;O>=Re&&(O=Y)}}const ye=Kn(L,O,!1,ee),ae=y.didMatch;return ae&&(ye||!ge||Qn)&&p(),ae},[hn,Uo,B,nn,Ze,V,ct,H,io,Re,Kn,Q,xt,C.length,se,Qn,so,Ee,ie,mt,Sr,So,N,ko,Ni,Oi,gn]),Vo=a.useCallback(d=>{let p=!1;if(Ue!==void 0&&Ue({...d,cancel:()=>{p=!0}}),p||Yi(d)||B.current===void 0)return;const[y,E]=B.current.cell,D=St.current;if(rt&&!d.metaKey&&!d.ctrlKey&&B.current!==void 0&&d.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(d.key)&&d.bounds!==void 0&&er(I([y-H,Math.max(0,Math.min(E,Re-1))]))){if((!mt||E!==Re)&&(D.y>E||E>D.y+D.height||D.x>y||y>D.x+D.width))return;ko(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[rt,Ue,Yi,B,I,H,Re,mt,ko]),Es=a.useCallback((d,p)=>{const y=d.location[0]-H;if(d.kind==="header"&&(ve==null||ve(y,{...d,preventDefault:p})),d.kind===an){if(y<0)return;K==null||K(y,{...d,preventDefault:p})}if(d.kind==="cell"){const[E,D]=d.location;oe==null||oe([y,D],{...d,preventDefault:p}),ya(B,d.location)||Kn(E,D,!1,!1)}},[B,oe,K,ve,H,Kn]),di=a.useCallback(async d=>{var T,L,O;if(!nn.paste)return;function p(Y,ee,ge,te){var ae,_e;const ye=typeof ge=="object"?(ge==null?void 0:ge.join(`
`))??"":(ge==null?void 0:ge.toString())??"";if(!Do(Y)&&er(Y)&&Y.readonly!==!0){const Se=_==null?void 0:_(ye,Y);if(Se!==void 0&&Io(Se))return{location:ee,value:Se};const me=qe(Y);if(me===void 0)return;if(me.kind===j.Custom){jt(Y.kind===j.Custom);const et=(ae=me.onPaste)==null?void 0:ae.call(me,ye,Y.data);return et===void 0?void 0:{location:ee,value:{...Y,data:et}}}else{const et=(_e=me.onPaste)==null?void 0:_e.call(me,ye,Y,{formatted:te,formattedString:typeof te=="string"?te:te==null?void 0:te.join(`
`),rawValue:ge});return et===void 0?void 0:(jt(et.kind===Y.kind),{location:ee,value:et})}}}const y=B.columns,E=B.rows,D=((T=st.current)==null?void 0:T.contains(document.activeElement))===!0||((L=s.current)==null?void 0:L.contains(document.activeElement))===!0;let P;if(B.current!==void 0?P=[B.current.range.x,B.current.range.y]:y.length===1?P=[y.first()??0,0]:E.length===1&&(P=[H,E.first()??0]),D&&P!==void 0){let Y,ee;const ge="text/plain",te="text/html";if(navigator.clipboard.read!==void 0){const Se=await navigator.clipboard.read();for(const me of Se){if(me.types.includes(te)){const ft=await(await me.getType(te)).text(),Dt=yl(ft);if(Dt!==void 0){Y=Dt;break}}me.types.includes(ge)&&(ee=await(await me.getType(ge)).text())}}else if(navigator.clipboard.readText!==void 0)ee=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(te)){const Se=d.clipboardData.getData(te);Y=yl(Se)}Y===void 0&&d.clipboardData.types.includes(ge)&&(ee=d.clipboardData.getData(ge))}else return;const[ye,ae]=P,_e=[];do{if($e===void 0){const Se=qt(P),me=ee??(Y==null?void 0:Y.map(ft=>ft.map(Dt=>Dt.rawValue).join("	")).join("	"))??"",et=p(Se,P,me,void 0);et!==void 0&&_e.push(et);break}if(Y===void 0){if(ee===void 0)return;Y=fd(ee)}if($e===!1||typeof $e=="function"&&($e==null?void 0:$e([P[0]-H,P[1]],Y.map(Se=>Se.map(me=>{var et;return((et=me.rawValue)==null?void 0:et.toString())??""}))))!==!0)return;for(const[Se,me]of Y.entries()){if(Se+ae>=Re)break;for(const[et,ft]of me.entries()){const Dt=[et+ye,Se+ae],[mn,Sn]=Dt;if(mn>=je.length||Sn>=Nt)continue;const wn=qt(Dt),Mn=p(wn,Dt,ft.rawValue,ft.formatted);Mn!==void 0&&_e.push(Mn)}}}while(!1);rn(_e),(O=Pt.current)==null||O.damage(_e.map(Se=>({cell:Se.location})))}},[_,qe,qt,B,nn.paste,st,je.length,rn,Nt,$e,H,Re]);$t("paste",di,w,!1,!0);const qo=a.useCallback(async(d,p)=>{var T,L;if(!nn.copy)return;const y=p===!0||((T=st.current)==null?void 0:T.contains(document.activeElement))===!0||((L=s.current)==null?void 0:L.contains(document.activeElement))===!0,E=B.columns,D=B.rows,P=(O,Y)=>{if(!de)vl(O,Y,d);else{const ee=Y.map(ge=>({kind:j.Text,data:C[ge].title,displayData:C[ge].title,allowOverlay:!1}));vl([ee,...O],Y,d)}};if(y&&Bt!==void 0){if(B.current!==void 0){let O=Bt(B.current.range,zt.current.signal);typeof O!="object"&&(O=await O()),P(O,co(B.current.range.x-H,B.current.range.x+B.current.range.width-H))}else if(D!==void 0&&D.length>0){const Y=[...D].map(ee=>{const ge=Bt({x:H,y:ee,width:C.length,height:1},zt.current.signal);return typeof ge=="object"?ge[0]:ge().then(te=>te[0])});if(Y.some(ee=>ee instanceof Promise)){const ee=await Promise.all(Y);P(ee,co(C.length))}else P(Y,co(C.length))}else if(E.length>0){const O=[],Y=[];for(const ee of E){let ge=Bt({x:ee,y:0,width:1,height:Re},zt.current.signal);typeof ge!="object"&&(ge=await ge()),O.push(ge),Y.push(ee-H)}if(O.length===1)P(O[0],Y);else{const ee=O.reduce((ge,te)=>ge.map((ye,ae)=>[...ye,...te[ae]]));P(ee,Y)}}}},[C,Bt,B,nn.copy,H,st,Re,de]);$t("copy",qo,w,!1,!1);const Is=a.useCallback(async d=>{var y,E;if(!(!nn.cut||!(((y=st.current)==null?void 0:y.contains(document.activeElement))===!0||((E=s.current)==null?void 0:E.contains(document.activeElement))===!0))&&(await qo(d),B.current!==void 0)){let D={current:{cell:B.current.cell,range:B.current.range,rangeStack:[]},rows:it.empty(),columns:it.empty()};const P=se==null?void 0:se(D);if(P===!1||(D=P===!0?D:P,D.current===void 0))return;so(D.current.range)}},[so,B,nn.cut,qo,st,se]);$t("cut",Is,w,!1,!1);const Ds=a.useCallback((d,p)=>{if(fe!==void 0){H!==0&&(d=d.map(D=>[D[0]-H,D[1]])),fe(d,p);return}if(d.length===0||p===-1)return;const[y,E]=d[p];u.current!==void 0&&u.current[0]===y&&u.current[1]===E||(u.current=[y,E],Kn(y,E,!1,!1))},[fe,H,Kn]),[Er,Ir]=((ji=ht==null?void 0:ht.current)==null?void 0:ji.cell)??[],Dr=a.useRef(It);Dr.current=It,a.useLayoutEffect(()=>{var d,p,y,E;ci.current&&!Yn.current&&Er!==void 0&&Ir!==void 0&&(Er!==((p=(d=G.current)==null?void 0:d.current)==null?void 0:p.cell[0])||Ir!==((E=(y=G.current)==null?void 0:y.current)==null?void 0:E.cell[1]))&&Dr.current(Er,Ir),Yn.current=!1},[Er,Ir]);const Gi=B.current!==void 0&&(B.current.cell[0]>=je.length||B.current.cell[1]>=Nt);a.useLayoutEffect(()=>{Gi&&Q(Pr,!1)},[Gi,Q]);const Fs=a.useMemo(()=>mt===!0&&(pe==null?void 0:pe.tint)===!0?it.fromSingleSelection(Nt-1):it.empty(),[Nt,mt,pe==null?void 0:pe.tint]),Hs=a.useCallback(d=>typeof Be=="boolean"?Be:(Be==null?void 0:Be(d-H))??!0,[H,Be]),Ts=a.useMemo(()=>{if(oi===void 0||s.current===null)return null;const{bounds:d,group:p}=oi,y=s.current.getBoundingClientRect();return a.createElement(td,{bounds:d,group:p,canvasBounds:y,onClose:()=>ri(void 0),onFinish:E=>{ri(void 0),we==null||we(p,E)}})},[we,oi]),As=Math.min(je.length,ue+(on?1:0));a.useImperativeHandle(t,()=>({appendRow:(d,p)=>So(d+H,p),updateCells:d=>{var p;return H!==0&&(d=d.map(y=>({cell:[y.cell[0]+H,y.cell[1]]}))),(p=Pt.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var y;if(!((s==null?void 0:s.current)===null||(st==null?void 0:st.current)===null)){if(d===void 0&&p===void 0){const E=s.current.getBoundingClientRect(),D=E.width/st.current.clientWidth;return{x:E.x-st.current.scrollLeft*D,y:E.y-st.current.scrollTop*D,width:st.current.scrollWidth*D,height:st.current.scrollHeight*D}}return(y=Pt.current)==null?void 0:y.getBounds((d??0)+H,p)}},focus:()=>{var d;return(d=Pt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await qo(void 0,!0);break;case"paste":await di();break}},scrollTo:It,remeasureColumns:d=>{for(const p of d)Mr(p+H)},getMouseArgsForPosition:(d,p,y)=>{if((Pt==null?void 0:Pt.current)===null)return;const E=Pt.current.getMouseArgsForPosition(d,p,y);if(E!==void 0)return{...E,location:[E.location[0]-H,E.location[1]]}}}),[So,Mr,st,qo,Vo,di,H,It]);const[_i,Ki]=kn??[],zs=a.useCallback(d=>{const[p,y]=d;if(y===-1){Ze!=="none"&&(Ee(it.fromSingleSelection(p),void 0,!1),Yt());return}_i===p&&Ki===y||(Qe({cell:d,range:{x:p,y,width:1,height:1}},!0,!1,"keyboard-nav"),It(p,y))},[Ze,Yt,It,_i,Ki,Qe,Ee]),[Bs,Ls]=a.useState(!1),Ui=a.useRef(El(d=>{Ls(d)},5)),Ps=a.useCallback(()=>{Ui.current(!0),B.current===void 0&&B.columns.length===0&&B.rows.length===0&&c===void 0&&Qe({cell:[H,pr],range:{x:H,y:pr,width:1,height:1}},!0,!1,"keyboard-select")},[pr,B,c,H,Qe]),Ws=a.useCallback(()=>{Ui.current(!1)},[]),[$s,Os]=a.useMemo(()=>{let d;const p=(yt==null?void 0:yt.scrollbarWidthOverride)??pi(),y=Re+(mt?1:0);if(typeof un=="number")d=nt+y*un;else{let D=0;const P=Math.min(y,10);for(let T=0;T<P;T++)D+=un(T);D=Math.floor(D/P),d=nt+y*D}d+=p;const E=je.reduce((D,P)=>P.width+D,0)+p;return[`${Math.min(1e5,E)}px`,`${Math.min(1e5,d)}px`]},[je,yt==null?void 0:yt.scrollbarWidthOverride,un,Re,mt,nt]),Ns=a.useMemo(()=>Ta(ke),[ke]);return a.createElement(_l.Provider,{value:ke},a.createElement(wd,{style:Ns,className:Ie,inWidth:g??$s,inHeight:x??Os},a.createElement(Zc,{fillHandle:Et,drawFocusRing:to,experimental:yt,fixedShadowX:Ft,fixedShadowY:At,getRowThemeOverride:tn,headerIcons:Dn,imageWindowLoader:ar,initialSize:Wn,isDraggable:Fn,onDragLeave:Hn,onRowMoved:vn,overscrollX:jr,overscrollY:Zr,preventDiagonalScrolling:go,rightElement:mo,rightElementProps:wo,smoothScrollX:eo,smoothScrollY:$n,className:Ie,enableGroups:Xt,onCanvasFocused:Ps,onCanvasBlur:Ws,canvasRef:s,onContextMenu:Es,theme:ke,cellXOffset:us,cellYOffset:pr,accessibilityHeight:oo.height,onDragEnd:ks,columns:je,nonGrowWidth:fn,drawHeader:He,onColumnProposeMove:vs,drawCell:Ae,disabledRows:Fs,freezeColumns:As,lockColumns:H,firstColAccessible:H===0,getCellContent:qt,minColumnWidth:xn,maxColumnWidth:no,searchInputRef:l,showSearch:Xo,onSearchClose:Jr,highlightRegions:fs,getCellsForSelection:Bt,getGroupDetails:ti,headerHeight:No,isFocused:Bs,groupHeaderHeight:Xt?br:0,freezeTrailingRows:gt+(mt&&(pe==null?void 0:pe.sticky)===!0?1:0),hasAppendRow:mt,onColumnResize:re,onColumnResizeEnd:q,onColumnResizeStart:le,onCellFocused:zs,onColumnMoved:Cs,onDragStart:xs,onHeaderMenuClick:bs,onHeaderIndicatorClick:ys,onItemHovered:ai,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:ws,onKeyDown:Vo,onKeyUp:ot,onMouseDown:hs,onMouseUp:ms,onDragOverCell:Rt,onDrop:ut,onSearchResultsChanged:Ds,onVisibleRegionChanged:ps,clientSize:Ne,rowHeight:un,searchResults:U,searchValue:Ce,onSearchValueChange:xe,rows:Nt,scrollRef:st,selection:B,translateX:oo.tx,translateY:oo.ty,verticalBorder:Hs,gridRef:Pt,getCellRenderer:qe,resizeIndicator:qr}),Ts,r!==void 0&&a.createElement(a.Suspense,{fallback:null},a.createElement(Ed,{...r,validateCell:k,bloom:W,id:Rs,getCellRenderer:qe,className:(yt==null?void 0:yt.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:dn,imageEditorOverride:b,onFinishEditing:Ms,markdownDivCreateNode:h,isOutsideClick:On,customEventTarget:yt==null?void 0:yt.eventTarget}))))},Hd=a.forwardRef(Fd),as=20;function kl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:l,height:s,x:c,y:f}=r,u=t.maxSize??as,w=Math.floor(r.y+s/2),b=Hl(u,s,i.cellVerticalPadding),m=Fl(t.contentAlign??"center",c,l,i.cellHorizontalPadding,b),h=Dl(m,w,b),g=Tl(c+n,f+o,h);return Mi(t)&&g}const Td={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:j.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Ad(e,e.cell.data,Mi(e.cell),e.cell.maxSize??as,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{kl(e)&&e.preventDefault()},onClick:e=>{if(kl(e))return{...e.cell,data:is(e.cell.data)}},onPaste:(e,t)=>{let n=$r;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Si),n===t.data?void 0:{...t,data:n}}};function Ad(e,t,n,o,r){if(!n&&t===$r)return;const{ctx:i,hoverAmount:l,theme:s,rect:c,highlighted:f,hoverX:u,hoverY:w,cell:{contentAlign:b}}=e,{x:m,y:h,width:g,height:x}=c;let C=!1;if(r>0){let v=n?1-r+r*l:.4;if(t===$r&&(v*=l),v===0)return;v<1&&(C=!0,i.globalAlpha=v)}Hi(i,s,t,m,h,g,x,f,u,w,o,b),C&&(i.globalAlpha=1)}const zd=Jt("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Bd=e=>{const{bubbles:t}=e;return a.createElement(zd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"boe-bubble"},n)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Ld={getAccessibilityString:e=>Al(e.data),kind:j.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>Wd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Bd,{bubbles:t.data})},onPaste:()=>{}},Pd=4;function Wd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:l,y:s,width:c,height:f}=n,u=20,w=8,b=Pd;let m=l+o.cellHorizontalPadding;const h=[];for(const g of t){if(m>l+c)break;const x=zo(g,r,o.baseFontFull).width;h.push({x:m,width:x}),m+=x+w*2+b}r.beginPath();for(const g of h)En(r,g.x,s+(f-u)/2,g.width+w*2,u,o.roundingRadius??u/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,x]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],x.x+w,s+f/2+Zn(r,o))}const $d=Jt("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Od=e=>{const{drilldowns:t}=e;return a.createElement($d,null,t.map((n,o)=>a.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&a.createElement("img",{src:n.img}),a.createElement("div",null,n.text))))},Nd={getAccessibilityString:e=>Al(e.data.map(t=>t.text)),kind:j.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+20+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Gd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Od,{drilldowns:t.data})},onPaste:()=>{}},Xd=4,wi={};function Yd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,l=n-i*2,s=4,c=n*r,f=o+i,u=o*3,w=(u+i*2)*r,b=`${e},${t},${r},${n}`;if(wi[b]!==void 0)return{el:wi[b],height:c,width:w,middleWidth:s*r,sideWidth:f*r,padding:i*r,dpr:r};const m=document.createElement("canvas"),h=m.getContext("2d");return h===null?null:(m.width=w,m.height=c,h.scale(r,r),wi[b]=m,h.beginPath(),En(h,i,i,u,l,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),En(h,i+.5,i+.5,u,l,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:m,height:c,width:w,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Gd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:l,row:s}=e,{x:c,width:f}=n,u=o.baseFontFull,w=Ol(r,u),b=Math.min(n.height,Math.max(16,Math.ceil(w*o.lineHeight)*2)),m=Math.floor(n.y+(n.height-b)/2),h=b-10,g=8,x=Xd;let C=c+o.cellHorizontalPadding;const v=o.roundingRadius??6,I=Yd(o.bgCell,o.drilldownBorder,b,v),X=[];for(const N of t){if(C>c+f)break;const z=zo(N.text,r,u).width;let _=0;N.img!==void 0&&i.loadOrGetImage(N.img,l,s)!==void 0&&(_=h-8+4);const S=z+_+g*2;X.push({x:C,width:S}),C+=S+x}if(I!==null){const{el:N,height:A,middleWidth:z,sideWidth:_,width:S,dpr:$,padding:W}=I,F=_/$,R=W/$;for(const M of X){const ce=Math.floor(M.x),ne=Math.floor(M.width),oe=ne-(F-R)*2;r.imageSmoothingEnabled=!1,r.drawImage(N,0,0,_,A,ce-R,m,F,b),oe>0&&r.drawImage(N,_,0,z,A,ce+(F-R),m,oe,b),r.drawImage(N,S-_,0,_,A,ce+ne-(F-R),m,F,b),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[N,A]of X.entries()){const z=t[N];let _=A.x+g;if(z.img!==void 0){const S=i.loadOrGetImage(z.img,l,s);if(S!==void 0){const $=h-8;let W=0,F=0,R=S.width,M=S.height;R>M?(W+=(R-M)/2,R=M):M>R&&(F+=(M-R)/2,M=R),r.beginPath(),En(r,_,m+b/2-$/2,$,$,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(S,W,F,R,M,_,m+b/2-$/2,$,$),r.restore(),_+=$+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(z.text,_,m+b/2+Zn(r,o))}}const _d={getAccessibilityString:e=>e.data.join(", "),kind:j.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Kd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??da;return a.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},bi=4;function Kd(e,t,n,o){const{rect:r,col:i,row:l,theme:s,ctx:c,imageLoader:f}=e,{x:u,y:w,height:b,width:m}=r,h=b-s.cellVerticalPadding*2,g=[];let x=0;for(let v=0;v<t.length;v++){const I=t[v];if(I.length===0)continue;const X=f.loadOrGetImage(I,i,l);if(X!==void 0){g[v]=X;const N=X.width*(h/X.height);x+=N+bi}}if(x===0)return;x-=bi;let C=u+s.cellHorizontalPadding;o==="right"?C=Math.floor(u+m-s.cellHorizontalPadding-x):o==="center"&&(C=Math.floor(u+m/2-x/2));for(const v of g){if(v===void 0)continue;const I=v.width*(h/v.height);n>0&&(c.beginPath(),En(c,C,w+s.cellVerticalPadding,I,h,n),c.save(),c.clip()),c.drawImage(v,C,w+s.cellVerticalPadding,I,h),n>0&&c.restore(),C+=I+bi}}function Ud(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Vd={getAccessibilityString:()=>"",kind:j.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Ud(n,o)*t.skeletonWidthVariability));const c=l.cellHorizontalPadding;s+c*2>=i.width&&(s=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*l.cellVerticalPadding);En(r,i.x+c,i.y+(i.height-f)/2,s,f,l.roundingRadius??3),r.fillStyle=fo(l.textDark,.1),r.fill()},onPaste:()=>{}},qd=()=>e=>e.targetWidth,Sl=Jt("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[qd(),"px"]}}),jd=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:l,validatedSelection:s}=e,c=t.data,f=t.readonly===!0,[u,w]=a.useState(c===""||o),b=a.useCallback(()=>{w(h=>!h)},[]),m=c?"gdg-ml-6":"";return u?a.createElement(Sl,{targetWidth:i.width-20},a.createElement(_r,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),a.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${m}`,onClick:()=>l(t)},a.createElement(oa,null))):a.createElement(Sl,{targetWidth:i.width},a.createElement(fa,{contents:c,createNode:r}),!f&&a.createElement(a.Fragment,null,a.createElement("div",{className:"spacer"}),a.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${m}`,onClick:b},a.createElement(Ri,null))),a.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Zd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:sr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:l,validatedSelection:s}=e;return a.createElement(jd,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:l,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Jd={getAccessibilityString:e=>e.row.toString(),kind:cn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Qd,measure:()=>44,draw:e=>tu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:l}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=l/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Qd(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=eu,n.textAlign="center",i}function eu(e){const{ctx:t}=e;t.textAlign="start"}function tu(e,t,n,o,r,i){const{ctx:l,rect:s,hoverAmount:c,theme:f}=e,{x:u,y:w,width:b,height:m}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){l.globalAlpha=h;const g=7*(n?c:1);if(Hi(l,f,n,r?u+g:u,w,r?b-g:b,m,!0,void 0,void 0,18,"center",i),r){l.globalAlpha=c,l.beginPath();for(const x of[3,6])for(const C of[-5,-1,3])l.rect(u+x,w+m/2+C,2,2);l.fillStyle=f.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const g=t.toString(),x=f.markerFontFull,C=u+b/2;o==="both"&&c!==0&&(l.globalAlpha=1-c),l.fillStyle=f.textLight,l.font=x,l.fillText(g,C,w+m/2+Zn(l,x)),c!==0&&(l.globalAlpha=1)}}const nu={getAccessibilityString:()=>"",kind:cn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>ou(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function ou(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:l,spriteManager:s}=e,{x:c,y:f,width:u,height:w}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,w-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const b=t!=="";let m=0;if(n!==void 0){const g=w-8,x=c+8/2,C=f+8/2;s.drawSprite(n,"normal",o,x,C,g,l,b?1:i),m=g}else{m=24;const h=12,g=b?h:i*h,x=b?0:(1-i)*h*.5,C=l.cellHorizontalPadding+4;g>0&&(o.moveTo(c+C+x,f+w/2),o.lineTo(c+C+x+g,f+w/2),o.moveTo(c+C+x+g*.5,f+w/2-g*.5),o.lineTo(c+C+x+g*.5,f+w/2+g*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,m+c+l.cellHorizontalPadding+.5,f+w/2+Zn(o,l)),o.beginPath()}function cs(e,t,n,o,r,i,l){e.textBaseline="alphabetic";const s=ru(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),En(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??fo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function ru(e,t,n,o,r){const i=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+l/2+1,width:t.width-i,height:t.height-l-1};const s=zo(n,e,o.baseFontFull,"alphabetic"),c=t.height-l,f=Math.min(c,s.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:s.width+i*3,height:f-1}}const iu=a.lazy(async()=>await Rl(()=>import("./number-overlay-editor-BJmacAHz.js"),__vite__mapDeps([6,1,3,7]),import.meta.url)),lu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:sr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:l}=e,{hoverEffect:s,displayData:c,hoverEffectTheme:f}=n;s===!0&&t>0&&cs(o,r,f,c,i,t,l),Rn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return a.createElement(a.Suspense,{fallback:null},a.createElement(iu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},su={getAccessibilityString:()=>"",measure:()=>108,kind:j.Protected,needsHover:!1,needsHoverPosition:!1,draw:au,onPaste:()=>{}};function au(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:l}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const f=i+l/2,u=Math.cos(nl(30))*s,w=Math.sin(nl(30))*s;for(let b=0;b<12;b++)t.moveTo(c,f-s),t.lineTo(c,f+s),t.moveTo(c+u,f-w),t.lineTo(c-u,f+w),t.moveTo(c-u,f-w),t.lineTo(c+u,f+w),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const cu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>sr(e,t,e.theme.textLight),draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return vt.createElement(_r,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},du={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:sr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:l,overrideCursor:s}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:w,hoverEffectTheme:b}=t;u===!0&&n>0&&cs(r,l,b,c,i,n,s),Rn(e,c,f,w,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return a.createElement(_r,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:l=>o({...r,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},uu=Jt("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),fu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:l}=e,[s,c]=a.useState(!r&&(t===""||o)),f=a.useCallback(()=>{c(!0)},[]);return s?a.createElement(_r,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):a.createElement(uu,null,a.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!r&&a.createElement("div",{className:"gdg-edit-icon",onClick:f},a.createElement(Ri,null)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ds(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-l-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-l/2),{x:r,y:i,width:l,height:s}}function Ml(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=Wl(l,i.baseFontFull);if(s===void 0)return!1;const c=ds(s,n,i,t.contentAlign);return uo({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:sr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:l,ctx:s}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=zo(c,s,n.baseFontFull),w=ds(u,l,n,t.contentAlign),{x:b,y:m,width:h,height:g}=w;if(r>=b-4&&r<=b-4+h+8&&i>=m-4&&i<=m-4+g+8){const x=Zn(s,n.baseFontFull);o("pointer");const C=5,v=m-x;s.beginPath(),s.moveTo(l.x+b,Math.floor(l.y+v+g+C)+.5),s.lineTo(l.x+b+h,Math.floor(l.y+v+g+C)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Rn({...e,rect:{...l,x:l.x-1}},c,t.contentAlign),Rn({...e,rect:{...l,x:l.x-2}},c,t.contentAlign),Rn({...e,rect:{...l,x:l.x+1}},c,t.contentAlign),Rn({...e,rect:{...l,x:l.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=f?n.linkColor:n.textDark,Rn(e,c,t.contentAlign)},onSelect:e=>{Ml(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Ml(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return a.createElement(fu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},gu=[Jd,nu,Td,Ld,Nd,_d,Vd,Zd,lu,su,cu,du,hu],yi=[];class mu extends Xl{constructor(){super(...arguments);Xe(this,"imageLoaded",()=>{});Xe(this,"loadedLocations",[]);Xe(this,"cache",{});Xe(this,"sendLoaded",qs(()=>{this.imageLoaded(new or(this.loadedLocations)),this.loadedLocations=[]},20));Xe(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let l=0;l<r.cells.length;l++){const s=r.cells[l];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let l=!1;const s=yi.pop()??new Image;let c=!1;const f={img:void 0,cells:[bn(o,r)],url:n,cancel:()=>{c||(c=!0,yi.length<12?yi.unshift(s):l||(s.src=""))}},u=new Promise(w=>s.addEventListener("load",()=>w(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const w=this.cache[i];if(w!==void 0&&!c){w.img=s;for(const b of w.cells)this.loadedLocations.push(Fi(b));l=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,l=this.cache[i];if(l!==void 0){const s=bn(o,r);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,r,i)}}const wu=(e,t)=>{const n=a.useMemo(()=>({...cc,...e.headerIcons}),[e.headerIcons]),o=a.useMemo(()=>e.imageWindowLoader??new mu,[e.imageWindowLoader]);return a.createElement(Hd,{...e,renderers:gu,headerIcons:n,ref:t,imageWindowLoader:o})},Eu=a.forwardRef(wu);export{Jc as C,Eu as D,j as G,_l as T,_r as a,Zt as b,Su as c,Mu as d,xu as e,Io as f,Zn as g,Qi as h,ku as i,Do as j,Qs as k,Ta as l,zo as m,To as p,En as r,Ru as u};
