import{r as t}from"./iframe-XM6KHdN3.js";import{m as we}from"./throttle-C_xxnlKX.js";import{Q as ve,R as he,u as ge}from"./image-window-loader-BztYAn9L.js";import{s as me}from"./marked.esm-CPMEao5a.js";function ce(e,h,m,o){return we(Math.round(h-(e.growOffset??0)),Math.ceil(m),Math.floor(o))}const Ce=e=>{const[h,m]=t.useState(),[o,b]=t.useState(),[l,I]=t.useState(),[u,w]=t.useState(),[C,D]=t.useState(!1),[U,c]=t.useState(),[R,O]=t.useState(),[P,te]=t.useState(),[J,p]=t.useState(!1),[oe,ne]=t.useState(),{onHeaderMenuClick:X,onHeaderIndicatorClick:ee,getCellContent:x,onColumnMoved:j,onColumnResize:S,onColumnResizeStart:_,onColumnResizeEnd:Y,gridRef:Q,maxColumnWidth:k,minColumnWidth:W,onRowMoved:A,lockColumns:L,onColumnProposeMove:F,onMouseDown:N,onMouseUp:Z,onItemHovered:n,onDragStart:B,canvasRef:y}=e,G=(S??Y??_)!==void 0,{columns:a,selection:i}=e,s=i.columns,d=t.useCallback(r=>{const[g,H]=r.location;l!==void 0&&u!==g&&g>=L?(D(!0),w(g)):R!==void 0&&H!==void 0?(p(!0),te(Math.max(0,H))):o===void 0&&!C&&!J&&(n==null||n(r))},[l,R,u,n,L,o,C,J]),K=j!==void 0,$=t.useCallback(r=>{var g;if(r.button===0){const[H,v]=r.location;if(r.kind==="out-of-bounds"&&r.isEdge&&G){const E=(g=Q==null?void 0:Q.current)==null?void 0:g.getBounds(a.length-1,-1);E!==void 0&&(m(E.x),b(a.length-1))}else if(r.kind==="header"&&H>=L){const E=y==null?void 0:y.current;if(r.isEdge&&G&&E){m(r.bounds.x),b(H);const de=E.getBoundingClientRect().width/E.offsetWidth,le=r.bounds.width/de;_==null||_(a[H],le,H,le+(a[H].growOffset??0))}else r.kind==="header"&&K&&(c(r.bounds.x),I(H))}else r.kind==="cell"&&L>0&&H===0&&v!==void 0&&A!==void 0&&(ne(r.bounds.y),O(v))}N==null||N(r)},[N,G,L,A,Q,a,K,_,y]),q=t.useCallback((r,g)=>{C||J||X==null||X(r,g)},[C,J,X]),re=t.useCallback((r,g)=>{C||J||ee==null||ee(r,g)},[C,J,ee]),M=t.useRef(-1),f=t.useCallback(()=>{M.current=-1,O(void 0),te(void 0),ne(void 0),p(!1),I(void 0),w(void 0),c(void 0),D(!1),b(void 0),m(void 0)},[]),z=t.useCallback((r,g)=>{if(r.button===0){if(o!==void 0){if((s==null?void 0:s.hasIndex(o))===!0)for(const v of s){if(v===o)continue;const E=a[v],V=ce(E,M.current,W,k);S==null||S(E,V,v,V+(E.growOffset??0))}const H=ce(a[o],M.current,W,k);if(Y==null||Y(a[o],H,o,H+(a[o].growOffset??0)),s.hasIndex(o))for(const v of s){if(v===o)continue;const E=a[v],V=ce(E,M.current,W,k);Y==null||Y(E,V,v,V+(E.growOffset??0))}}f(),l!==void 0&&u!==void 0&&(F==null?void 0:F(l,u))!==!1&&(j==null||j(l,u)),R!==void 0&&P!==void 0&&(A==null||A(R,P))}Z==null||Z(r,g)},[Z,o,l,u,R,P,s,Y,a,W,k,S,j,A,f,F]),T=t.useMemo(()=>{if(!(l===void 0||u===void 0)&&l!==u&&(F==null?void 0:F(l,u))!==!1)return{src:l,dest:u}},[l,u,F]),se=t.useCallback(r=>{const g=y==null?void 0:y.current;if(l!==void 0&&U!==void 0)Math.abs(r.clientX-U)>20&&D(!0);else if(R!==void 0&&oe!==void 0)Math.abs(r.clientY-oe)>20&&p(!0);else if(o!==void 0&&h!==void 0&&g){const v=g.getBoundingClientRect().width/g.offsetWidth,E=(r.clientX-h)/v,V=a[o],de=ce(V,E,W,k);if(S==null||S(V,de,o,de+(V.growOffset??0)),M.current=E,(s==null?void 0:s.first())===o)for(const le of s){if(le===o)continue;const ue=a[le],fe=ce(ue,M.current,W,k);S==null||S(ue,fe,le,fe+(ue.growOffset??0))}}},[l,U,R,oe,o,h,a,W,k,S,s,y]),ie=t.useCallback((r,g)=>{if(R===void 0||P===void 0)return x(r,g);let[H,v]=r;return v===P?v=R:(v>P&&(v-=1),v>=R&&(v+=1)),x([H,v],g)},[R,P,x]),ae=t.useCallback(r=>{B==null||B(r),r.defaultPrevented()||f()},[f,B]);return t.createElement(ve,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ie,isResizing:o!==void 0,onHeaderMenuClick:q,onHeaderIndicatorClick:re,isDragging:C,onItemHovered:d,onDragStart:ae,onMouseDown:$,allowResize:G,onMouseUp:z,dragAndDropState:T,onMouseMoveRaw:se,ref:Q})};function Re(e){const h=t.useRef(null),[m,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const b=I=>{for(const u of I){const{width:w,height:C}=u&&u.contentRect||{};o(D=>D.width===w&&D.height===C?D:{width:w,height:C})}},l=new window.ResizeObserver(b);return h.current&&l.observe(h.current,void 0),()=>{l.disconnect()}},[h.current]),{ref:h,...m}}const Se=(e,h,m)=>{const o=t.useRef(null),b=t.useRef(null),l=t.useRef(null),I=t.useRef(0),u=t.useRef(h);u.current=h;const w=m.current;t.useEffect(()=>{const C=()=>{var c,R;if(b.current===!1&&w!==null){const O=[w.scrollLeft,w.scrollTop];if(((c=l.current)==null?void 0:c[0])===O[0]&&((R=l.current)==null?void 0:R[1])===O[1])if(I.current>10){l.current=null,b.current=null;return}else I.current++;else I.current=0,u.current(O[0],O[1]),l.current=O;o.current=window.setTimeout(C,8.333333333333334)}},D=()=>{b.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},U=c=>{c.touches.length===0&&(b.current=!1,I.current=0,o.current=window.setTimeout(C,8.333333333333334))};if(e&&w!==null){const c=w;return c.addEventListener("touchstart",D),c.addEventListener("touchend",U),()=>{c.removeEventListener("touchstart",D),c.removeEventListener("touchend",U),o.current!==null&&window.clearTimeout(o.current)}}},[e,w])},be=()=>e=>e.isSafari?"scroll":"auto",De=me("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[be()]}});function ye(e){const[h,m]=t.useState(!1),o=typeof window>"u"?null:window,b=t.useRef(0);return ge("touchstart",t.useCallback(()=>{window.clearTimeout(b.current),m(!0)},[]),o,!0,!1),ge("touchend",t.useCallback(l=>{l.touches.length===0&&(b.current=window.setTimeout(()=>m(!1),e))},[e]),o,!0,!1),h}const He=e=>{var G,a;const{children:h,clientHeight:m,scrollHeight:o,scrollWidth:b,update:l,draggable:I,className:u,preventDiagonalScrolling:w=!1,paddingBottom:C=0,paddingRight:D=0,rightElement:U,rightElementProps:c,kineticScrollPerfHack:R=!1,scrollRef:O,initialSize:P}=e,te=[],J=(c==null?void 0:c.sticky)??!1,p=(c==null?void 0:c.fill)??!1,oe=t.useRef(0),ne=t.useRef(0),X=t.useRef(null),ee=typeof window>"u"?1:window.devicePixelRatio,x=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),j=t.useRef(null),S=ye(200),[_,Y]=t.useState(!0),Q=t.useRef(0);t.useLayoutEffect(()=>{if(!_||S||x.current.lockDirection===void 0)return;const i=X.current;if(i===null)return;const[s,d]=x.current.lockDirection;s!==void 0?i.scrollLeft=s:d!==void 0&&(i.scrollTop=d),x.current.lockDirection=void 0},[S,_]);const k=t.useCallback((i,s)=>{var ae;const d=X.current;if(d===null)return;s=s??d.scrollTop,i=i??d.scrollLeft;const K=x.current.scrollTop,$=x.current.scrollLeft,q=i-$,re=s-K;S&&q!==0&&re!==0&&(Math.abs(q)>3||Math.abs(re)>3)&&w&&x.current.lockDirection===void 0&&(x.current.lockDirection=Math.abs(q)<Math.abs(re)?[$,void 0]:[void 0,K]);const M=x.current.lockDirection;i=(M==null?void 0:M[0])??i,s=(M==null?void 0:M[1])??s,x.current.scrollLeft=i,x.current.scrollTop=s;const f=d.clientWidth,z=d.clientHeight,T=s,se=ne.current-T,ie=d.scrollHeight-z;if(ne.current=T,ie>0&&(Math.abs(se)>2e3||T===0||T===ie)&&o>d.scrollHeight+5){const r=T/ie,g=(o-z)*r;oe.current=g-T}M!==void 0&&(window.clearTimeout(Q.current),Y(!1),Q.current=window.setTimeout(()=>Y(!0),200)),l({x:i,y:T+oe.current,width:f-D,height:z-C,paddingRight:((ae=j.current)==null?void 0:ae.clientWidth)??0})},[C,D,o,l,w,S]);Se(R&&he.value,k,X);const W=t.useRef(k);W.current=k;const A=t.useRef(),L=t.useRef(!1);t.useLayoutEffect(()=>{L.current?k():L.current=!0},[k,C,D]);const F=t.useCallback(i=>{X.current=i,O!==void 0&&(O.current=i)},[O]);let N=0,Z=0;for(te.push(t.createElement("div",{key:N++,style:{width:b,height:0}}));Z<o;){const i=Math.min(5e6,o-Z);te.push(t.createElement("div",{key:N++,style:{width:0,height:i}})),Z+=i}const{ref:n,width:B,height:y}=Re(P);return typeof window<"u"&&(((G=A.current)==null?void 0:G.height)!==y||((a=A.current)==null?void 0:a.width)!==B)&&(window.setTimeout(()=>W.current(),0),A.current={width:B,height:y}),(B??0)===0||(y??0)===0?t.createElement("div",{ref:n}):t.createElement("div",{ref:n},t.createElement(De,{isSafari:he.value},t.createElement("div",{className:"dvn-underlay"},h),t.createElement("div",{ref:F,style:A.current,draggable:I,onDragStart:i=>{I||(i.stopPropagation(),i.preventDefault())},className:"dvn-scroller "+(u??""),onScroll:()=>k()},t.createElement("div",{className:"dvn-scroll-inner"+(U===void 0?" dvn-hidden":"")},t.createElement("div",{className:"dvn-stack"},te),U!==void 0&&t.createElement(t.Fragment,null,!p&&t.createElement("div",{className:"dvn-spacer"}),t.createElement("div",{ref:j,style:{height:y,maxHeight:m-Math.ceil(ee%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:D,flexGrow:p?1:void 0,right:J?D??0:void 0,pointerEvents:"auto"}},U))))))},Te=e=>{const{columns:h,rows:m,rowHeight:o,headerHeight:b,groupHeaderHeight:l,enableGroups:I,freezeColumns:u,experimental:w,nonGrowWidth:C,clientSize:D,className:U,onVisibleRegionChanged:c,scrollRef:R,preventDiagonalScrolling:O,rightElement:P,rightElementProps:te,overscrollX:J,overscrollY:p,initialSize:oe,smoothScrollX:ne=!1,smoothScrollY:X=!1,isDraggable:ee}=e,{paddingRight:x,paddingBottom:j}=w??{},[S,_]=D,Y=t.useRef(),Q=t.useRef(),k=t.useRef(),W=t.useRef(),A=C+Math.max(0,J??0);let L=I?b+l:b;if(typeof o=="number")L+=m*o;else for(let n=0;n<m;n++)L+=o(n);p!==void 0&&(L+=p);const F=t.useRef(),N=t.useCallback(()=>{var re,M;if(F.current===void 0)return;const n={...F.current};let B=0,y=n.x<0?-n.x:0,G=0,a=0;n.x=n.x<0?0:n.x;let i=0;for(let f=0;f<u;f++)i+=h[f].width;for(const f of h){const z=B-i;if(n.x>=z+f.width)B+=f.width,a++,G++;else if(n.x>z)B+=f.width,ne?y+=z-n.x:a++,G++;else if(n.x+n.width>z)B+=f.width,G++;else break}let s=0,d=0,K=0;if(typeof o=="number")X?(d=Math.floor(n.y/o),s=d*o-n.y):d=Math.ceil(n.y/o),K=Math.ceil(n.height/o)+d,s<0&&K++;else{let f=0;for(let z=0;z<m;z++){const T=o(z),se=f+(X?0:T/2);if(n.y>=f+T)f+=T,d++,K++;else if(n.y>se)f+=T,X?s+=se-n.y:d++,K++;else if(n.y+n.height>T/2+f)f+=T,K++;else break}}const $={x:a,y:d,width:G-a,height:K-d},q=Y.current;(q===void 0||q.y!==$.y||q.x!==$.x||q.height!==$.height||q.width!==$.width||Q.current!==y||k.current!==s||n.width!==((re=W.current)==null?void 0:re[0])||n.height!==((M=W.current)==null?void 0:M[1]))&&(c==null||c({x:a,y:d,width:G-a,height:K-d},n.width,n.height,n.paddingRight??0,y,s),Y.current=$,Q.current=y,k.current=s,W.current=[n.width,n.height])},[h,o,m,c,u,ne,X]),Z=t.useCallback(n=>{F.current=n,N()},[N]);return t.useEffect(()=>{N()},[N]),t.createElement(He,{scrollRef:R,className:U,kineticScrollPerfHack:w==null?void 0:w.kineticScrollPerfHack,preventDiagonalScrolling:O,draggable:ee===!0||typeof ee=="string",scrollWidth:A+(x??0),scrollHeight:L+(j??0),clientHeight:_,rightElement:P,paddingBottom:j,paddingRight:x,rightElementProps:te,update:Z,initialSize:oe},t.createElement(Ce,{eventTargetRef:R,width:S,height:_,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))};export{Te as G};
