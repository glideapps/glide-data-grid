const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-Cn1soC9a.js","./iframe-DvQ8_lQU.js","./preload-helper-C1FmrZbK.js","./index-Di5Jo-Lf.js","./marked.esm-Chqd-LbM.js","./throttle-CxLmvQkw.js","./flatten-B4uaeP2E.js","./number-overlay-editor-Cgq4yd4g.js","./react-number-format.es-Cj_6n1eP.js"])))=>i.map(i=>d[i]);
var Ks=Object.defineProperty;var Us=(e,t,n)=>t in e?Ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $e=(e,t,n)=>Us(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as Mt}from"./iframe-DvQ8_lQU.js";import{_ as Tl}from"./preload-helper-C1FmrZbK.js";import{h as Vs,g as Al,j as qs,k as js,v as Zs,l as Js,m as dn,r as ao,t as Qs}from"./throttle-CxLmvQkw.js";import{u as ea,f as rl}from"./flatten-B4uaeP2E.js";import{s as tn,a as ta}from"./marked.esm-Chqd-LbM.js";function zl(e="This should not happen"){throw new Error(e)}function Qt(e,t="Assertion failed"){if(!e)return zl(t)}function sr(e,t){return zl(t??"Hell froze over")}function na(e,t){try{return e()}catch{return t}}const il=Object.prototype.hasOwnProperty;function Ao(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ao(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(il.call(e,n)&&++o&&!il.call(t,n)||!(n in t)||!Ao(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Nr=null,Hi=void 0;var Z;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(Z||(Z={}));var ll;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(ll||(ll={}));var Xr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Xr||(Xr={}));function zr(e){return"width"in e&&typeof e.width=="number"}async function sl(e){return typeof e=="object"?e:await e()}function Do(e){return!(e.kind===Z.Loading||e.kind===Z.Bubble||e.kind===Z.RowID||e.kind===Z.Protected||e.kind===Z.Drilldown)}function Ru(e){return!(e.kind===Z.Loading||e.kind===Z.Bubble||e.kind===Z.RowID||e.kind===Z.Protected||e.kind===Z.Drilldown||e.kind===Z.Boolean||e.kind===Z.Image||e.kind===Z.Custom)}function Ho(e){return e.kind===un.Marker||e.kind===un.NewRow}function Fo(e){if(!Do(e)||e.kind===Z.Image)return!1;switch(e.kind){case Z.Text:case Z.Number:case Z.Markdown:case Z.Uri:case Z.Custom:case Z.Boolean:return e.readonly!==!0;default:sr(e,"A cell was passed with an invalid kind")}}function oa(e){return Vs(e,"editor")}function Ti(e){return!(e.readonly??!1)}var un;(function(e){e.NewRow="new-row",e.Marker="marker"})(un||(un={}));const Yr={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function bi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let al;const Vt=class Vt{constructor(t){$e(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Vt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=bi([...this.items,n]);return new Vt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,c]=a;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Vt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};$e(Vt,"create",t=>new Vt(bi(t))),$e(Vt,"empty",()=>al??(al=new Vt([]))),$e(Vt,"fromSingleSelection",t=>Vt.empty().add(t)),$e(Vt,"fromArray",t=>{if(t.length===0)return Vt.empty();const n=t.map(r=>[r,r+1]),o=bi(n);return new Vt(o)});let it=Vt;const ra=tn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Nt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=c=>{var f;(f=i.current)==null||f.call(a,c)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function Zn(e,t){return e===void 0?void 0:t}const ia=Math.PI;function cl(e){return e*ia/180}const Pl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Bl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Ll=(e,t,n)=>Math.min(e,t-n*2),Wl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ai=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},la=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function sa(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Al(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const aa="֑-߿יִ-﷽ﹰ-ﻼ",ca="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",da=new RegExp("^[^"+ca+"]*["+aa+"]");function zi(e){return da.test(e)?"rtl":"not-rtl"}let Pr;function Mi(){if(typeof document>"u")return 0;if(Pr!==void 0)return Pr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Pr=n-o,Pr}const so=Symbol();function ua(e){const t=s.useRef([so,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==so&&(l=typeof l=="function"?l(c):l,l===c)||(c!==so&&r({}),o(f=>typeof l=="function"?l(c===so?f:c):l),t.current[0]=so)},[]),a=s.useCallback(()=>{t.current[0]=so,r({})},[]);return[t.current[0]===so?n:t.current[0],i,a]}function $l(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function fa(e){const t=s.useRef(e);return Ao(e,t.current)||(t.current=e),t.current}const ha=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(ra,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(qs.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Ai,null)))},ga=tn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class ma extends Mt.PureComponent{constructor(){super(...arguments);$e(this,"targetElement",null);$e(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=ta(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const u=document.createElement("template");u.innerHTML=a,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Mt.createElement(ga,{ref:this.containerRefHook})}}const wa=tn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),ba=tn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),ya=tn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let dl=0;const Ur=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...l}=e,{onChange:c,className:f}=l,u=s.useRef(null),g=n??"";Qt(c!==void 0,"GrowingEntry must be a controlled input area");const[m]=s.useState(()=>"input-box-"+(dl=(dl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=g.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(a!==void 0){const b=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[a]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(ya,{className:"gdg-growing-entry"},s.createElement(ba,{className:f},g+`
`),s.createElement(wa,{...l,className:(f??"")+" gdg-input",id:m,ref:u,onKeyDown:w,value:g,placeholder:t,dir:"auto"}))},yi={};let qn=null;function pa(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function zo(e){const t=e.toLowerCase().trim();if(yi[t]!==void 0)return yi[t];qn=qn||pa(),qn.style.color="#000",qn.style.color=t;const n=getComputedStyle(qn).color;qn.style.color="#fff",qn.style.color=t;const o=getComputedStyle(qn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),yi[t]=r,r}function uo(e,t){const[n,o,r]=zo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const ul=new Map;function fl(e,t){const n=`${e}-${t}`,o=ul.get(n);if(o!==void 0)return o;const r=en(e,t);return ul.set(n,r),r}function en(e,t){if(t===void 0)return e;const[n,o,r,i]=zo(e);if(i===1)return e;const[a,l,c,f]=zo(t),u=i+f*(1-i),g=(i*n+f*a*(1-i))/u,m=(i*o+f*l*(1-i))/u,w=(i*r+f*c*(1-i))/u;return`rgba(${g}, ${m}, ${w}, ${u})`}function Eu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,a]=zo(e),[l,c,f,u]=zo(t),g=o*a,m=r*a,w=i*a,h=l*u,b=c*u,x=f*u,C=n,y=1-n,M=a*y+u*C;if(M===0)return"rgba(0, 0, 0, 0)";const X=Math.floor((g*y+h*C)/M),L=Math.floor((m*y+b*C)/M),P=Math.floor((w*y+x*C)/M);return`rgba(${X}, ${L}, ${P}, ${M})`}function Iu(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=zo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function va(e,t){return Mt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function Ca(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(rr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function ar(e,t){return(e??"")===(t??"")}function xa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Ol(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function rr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Nl(e){return[e.x+e.width-1,e.y+e.height-1]}function hl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function ka(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&hl(e,t,i)&&r++;for(const a of n.current.rangeStack)hl(e,t,a)&&r++;return r}function Xl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Po(e,t){let n=0;const o=Xl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function fo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ri(e,t,n,o,r){const i=Xl(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||a.push(u)}return a}function Sa(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Ma(e,t,n,o,r,i,a,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let g=t;for(let h=0;h<f;h++){const b=i-1-h,x=typeof a=="number"?a:a(b);if(g-=x,e>=g)return b}const m=i-f,w=e-(c??0);if(typeof a=="number"){const h=Math.floor((w-u)/a)+l;return h>=m?void 0:h}else{let h=u;for(let b=l;b<m;b++){const x=a(b);if(w<=h+x)return b;h+=x}return}}let Or=0,ir={};const Ra=typeof window>"u";async function Ea(){var e;Ra||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Or=0,ir={},Zs())}Ea();function Yl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Bo(e,t,n,o="middle"){const r=Yl(e,t,o,n);let i=ir[r];return i===void 0&&(i=t.measureText(e),ir[r]=i,Or++),Or>1e4&&(ir={},Or=0),i}function Gl(e,t){const n=Yl(e,void 0,"middle",t);return ir[n]}function Qn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ia(e,t)}function gl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const ml=[];function Ia(e,t){for(const i of ml)if(i.key===t)return i.val;const n=gl(e,"alphabetic"),r=-(gl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return ml.push({key:t,val:r}),r}function Da(e,t,n,o,r,i){const{ctx:a,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const g=1-f/u;a.globalAlpha=g,a.fillStyle=c.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function dr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function Du(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,Rn({ctx:a,rect:i,theme:l},t,n,o,r)}function _l(e,t,n,o,r,i,a,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function Kl(e,t){const n=Bo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Fa(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ha(e,t,n,o,r,i,a,l,c,f){const u=l.baseFontFull,g=js(e,t,u,r-l.cellHorizontalPadding*2,f??!1),m=Kl(e,u),w=l.lineHeight*m,h=m+w*(g.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let C=Math.max(o+l.cellVerticalPadding,x);for(const y of g)if(_l(e,y,n,C,r,m,a,l,c),C+=w,C>o+i)break;b&&e.restore()}function Rn(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:c,y:f,width:u,height:g}=a;o=o??!1,o||(t=Fa(t,u));const m=Qn(i,l),w=zi(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ha(i,t,c,f,u,g,m,l,n,r):_l(i,t,c,f,u,g,m,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function En(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Ta(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Aa(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,g=Math.sqrt(f*f+u*u),m=f/g,w=u/g;return{x:f,y:c.y-l.y,len:g,nx:m,ny:w,ang:Math.atan2(w,m)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,a),g=o(c,f),m=u.nx*g.ny-u.ny*g.nx,w=u.nx*g.nx-u.ny*-g.ny;let h=Math.asin(m<-1?-1:m>1?1:m),b=1,x=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,x=!0):h>0&&(b=-1,x=!0),r=c.radius!==void 0?c.radius:n;const C=h/2;let y=Math.abs(Math.cos(C)*r/Math.sin(C)),M;y>Math.min(u.len/2,g.len/2)?(y=Math.min(u.len/2,g.len/2),M=Math.abs(y*Math.sin(C)/Math.cos(C))):M=r;let X=c.x+g.nx*y,L=c.y+g.ny*y;X+=-g.ny*M*b,L+=g.nx*M*b,e.arc(X,L,M,u.ang+Math.PI/2*b,g.ang-Math.PI/2*b,x),a=c,c=f}e.closePath()}function Ei(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h){const b={x:0,y:i+f,width:0,height:0};if(e>=w.length||t>=u||t<-2||e<0)return b;const x=i-r;if(e>=g){const C=a>e?-1:1,y=Po(w);b.x+=y+c;for(let M=a;M!==e;M+=C)b.x+=w[C===1?M:M-1].width*C}else for(let C=0;C<e;C++)b.x+=w[C].width;if(b.width=w[e].width+1,t===-1)b.y=r,b.height=x;else if(t===-2){b.y=0,b.height=r;let C=e;const y=w[e].group,M=w[e].sticky;for(;C>0&&ar(w[C-1].group,y)&&w[C-1].sticky===M;){const L=w[C-1];b.x-=L.width,b.width+=L.width,C--}let X=e;for(;X+1<w.length&&ar(w[X+1].group,y)&&w[X+1].sticky===M;){const L=w[X+1];b.width+=L.width,X++}if(!M){const L=Po(w),P=b.x-L;P<0&&(b.x-=P,b.width+=P),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-m){let C=u-t;for(b.y=o;C>0;){const y=t+C-1;b.height=typeof h=="number"?h:h(y),b.y-=b.height,C--}b.height+=1}else{const C=l>t?-1:1;if(typeof h=="number"){const y=t-l;b.y+=y*h}else for(let y=l;y!==t;y+=C)b.y+=h(y)*C;b.height=(typeof h=="number"?h:h(t))+1}return b}const Pi=1<<21;function pn(e,t){return(t+2)*Pi+e}function Ul(e){return e%Pi}function Bi(e){return Math.floor(e/Pi)-2}function Li(e){const t=Ul(e),n=Bi(e);return[t,n]}class Vl{constructor(){$e(this,"visibleWindow",{x:0,y:0,width:0,height:0});$e(this,"freezeCols",0);$e(this,"freezeRows",[]);$e(this,"isInWindow",t=>{const n=Ul(t),o=Bi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ao(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class za extends Vl{constructor(){super(...arguments);$e(this,"cache",new Map);$e(this,"setValue",(n,o)=>{this.cache.set(pn(n[0],n[1]),o)});$e(this,"getValue",n=>this.cache.get(pn(n[0],n[1])));$e(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class lr{constructor(t=[]){$e(this,"cells");this.cells=new Set(t.map(n=>pn(n[0],n[1])))}add(t){this.cells.add(pn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(pn(t[0],t[1]))}remove(t){this.cells.delete(pn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Bi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(pn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Li(t)}}function Pa(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ql={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function jl(){return ql}const Zl=Mt.createContext(ql);function Fu(){return Mt.useContext(Zl)}function Ln(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=en(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ii=150;function Ba(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ii}function Jl(e,t,n,o,r,i,a,l,c){let f=0;const u=r===void 0?[]:r.map(w=>{const h=Ba(e,w[o],t,c);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const b of u)w+=b;const h=w/u.length;for(let b=0;b<u.length;b++)u[b]>=h*2?u[b]=0:f=Math.max(f,u[b])}const g=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=g;const m=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:m}}function La(e,t,n,o,r,i,a,l,c){const f=s.useRef(t),u=s.useRef(n),g=s.useRef(a);f.current=t,u.current=n,g.current=a;const[m,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(m&&document.documentElement.append(m),()=>{m==null||m.remove()}),[m]);const h=s.useRef({}),b=s.useRef(),[x,C]=s.useState();return s.useLayoutEffect(()=>{const y=u.current;if(y===void 0||e.every(zr))return;let M=Math.max(1,10-Math.floor(e.length/1e4)),X=0;M<f.current&&M>1&&(M--,X=1);const L={x:0,y:0,width:e.length,height:Math.min(f.current,M)},P={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const Y=y(L,c.signal),S=X>0?y(P,c.signal):void 0;let $;typeof Y=="object"?$=Y:$=await sl(Y),S!==void 0&&(typeof S=="object"?$=[...$,...S]:$=[...$,...await sl(S)]),b.current=e,C($)})()},[c.signal,e]),s.useMemo(()=>{let M=e.every(zr)?e:w===null?e.map(W=>zr(W)?W:{...W,width:Ii}):(w.font=g.current.baseFontFull,e.map((W,Y)=>{if(zr(W))return W;if(h.current[W.id]!==void 0)return{...W,width:h.current[W.id]};if(x===void 0||b.current!==e||W.id===void 0)return{...W,width:Ii};const S=Jl(w,a,W,Y,x,r,i,!0,l);return h.current[W.id]=S.width,S})),X=0,L=0;const P=[];for(const[W,Y]of M.entries())X+=Y.width,Y.grow!==void 0&&Y.grow>0&&(L+=Y.grow,P.push(W));if(X<o&&P.length>0){const W=[...M],Y=o-X;let S=Y;for(let $=0;$<P.length;$++){const N=P[$],z=(M[N].grow??0)/L,I=$===P.length-1?S:Math.min(S,Math.floor(Y*z));W[N]={...M[N],growOffset:I,width:M[N].width+I},S-=I}M=W}return{sizedColumns:M,nonGrowWidth:X}},[o,e,w,x,a,r,i,l])}const yt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Wa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Oa=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Ql=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Ya=e=>{const t=e.bgColor;return`${yt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Ga=Ql,_a=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ka=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},dc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},uc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},fc={headerRowID:Wa,headerNumber:Oa,headerCode:$a,headerString:Na,headerBoolean:Xa,headerAudioUri:Ga,headerVideoUri:_a,headerEmoji:Ka,headerImage:Ua,headerUri:Ql,headerPhone:Va,headerMarkdown:qa,headerDate:ja,headerTime:Za,headerEmail:Ja,headerReference:Qa,headerIfThenElse:ec,headerSingleValue:tc,headerLookup:nc,headerTextTemplate:oc,headerMath:rc,headerRollup:ic,headerJoinStrings:lc,headerSplitString:sc,headerGeoDistance:ac,headerArray:cc,rowOwnerOverlay:dc,protectedColumnOverlay:uc,renameIcon:Ya};function hc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class gc{constructor(t,n){$e(this,"onSettled");$e(this,"spriteMap",new Map);$e(this,"headerIcons");$e(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,c=1){const[f,u]=hc(n,l),g=a*Math.ceil(window.devicePixelRatio),m=`${f}_${u}_${g}_${t}`;let w=this.spriteMap.get(m);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(m,w);const C=x.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{b.drawImage(x,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(w,0,0,g,g,r,i,a,a),c<1&&(o.globalAlpha=1)}}function es(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Vr(e,t,n,o,r,i,a,l,c){l=l??t;let f=t,u=e;const g=o-i;let m=!1;for(;f<n&&u<g;){const w=r(u);if(f+w>l&&c(f,u,w,!1,a&&u===o-1)===!0){m=!0;break}f+=w,u++}if(!m){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,c(f,u,h,!0,a&&u===o-1)}}}function eo(e,t,n,o,r,i){let a=0,l=0;const c=r+o;for(const f of e){const u=f.sticky?l:a+n;if(i(f,u,c,f.sticky?0:l,t)===!0)break;a+=f.width,l+=f.sticky?f.width:0}}function ts(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const c=e[l];let f=l+1,u=c.width;for(c.sticky&&(a+=u);f<e.length&&ar(e[f].group,c.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(a+=b.width)}const g=c.sticky?0:n,m=i+g,w=c.sticky?0:Math.max(0,a-m),h=Math.min(u-w,t-(m+w));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",m+w,0,h,o),i+=u}}function ns(e,t,n,o,r,i,a){var m;const[l,c]=e;let f,u;const g=((m=a.find(w=>!w.sticky))==null?void 0:m.sourceIndex)??0;if(c>g){const w=Math.max(l,g);let h=t,b=o;for(let x=i.sourceIndex-1;x>=w;x--)h-=a[x].width,b+=a[x].width;for(let x=i.sourceIndex+1;x<=c;x++)b+=a[x].width;u={x:h,y:n,width:b,height:r}}if(g>l){const w=Math.min(c,g-1);let h=t,b=o;for(let x=i.sourceIndex-1;x>=l;x--)h-=a[x].width,b+=a[x].width;for(let x=i.sourceIndex+1;x<=w;x++)b+=a[x].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function mc(e,t,n,o){if(o==="any")return os(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Ol([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function cr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function co(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function os(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function wc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function bc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,c=r-e.x,f=e.x+e.width-a,u=i-e.y,g=e.y+e.height-l,m=c>0?e.x+Math.floor(c/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:h,width:w-m,height:b-h}}function yc(e,t,n,o,r){const[i,a,l,c]=t,[f,u,g,m]=r,{x:w,y:h,width:b,height:x}=e,C=[];if(b<=0||x<=0)return C;const y=w+b,M=h+x,X=w<i,L=h<a,P=w+b>l,W=h+x>c,Y=w>=i&&w<l||y>i&&y<=l||w<i&&y>l,S=h>=a&&h<c||M>a&&M<=c||h<a&&M>c;if(Y&&S){const N=Math.max(w,i),z=Math.max(h,a),I=Math.min(y,l),E=Math.min(M,c);C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:f,y:u,width:g-f+1,height:m-u+1}})}if(X&&L){const N=w,z=h,I=Math.min(y,i),E=Math.min(M,a);C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:0,y:0,width:f+1,height:u+1}})}if(L&&Y){const N=Math.max(w,i),z=h,I=Math.min(y,l),E=Math.min(M,a);C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:f,y:0,width:g-f+1,height:u+1}})}if(L&&P){const N=Math.max(w,l),z=h,I=y,E=Math.min(M,a);C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(X&&S){const N=w,z=Math.max(h,a),I=Math.min(y,i),E=Math.min(M,c);C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:0,y:u,width:f+1,height:m-u+1}})}if(P&&S){const N=Math.max(w,l),z=Math.max(h,a),I=y,E=Math.min(M,c);C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(X&&W){const N=w,z=Math.max(h,c),I=Math.min(y,i),E=M;C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:0,y:m,width:f+1,height:o-m+1}})}if(W&&Y){const N=Math.max(w,i),z=Math.max(h,c),I=Math.min(y,l),E=M;C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:f,y:m,width:g-f+1,height:o-m+1}})}if(P&&W){const N=Math.max(w,l),z=Math.max(h,c),I=y,E=M;C.push({rect:{x:N,y:z,width:I-N,height:E-z},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return C}const pc={kind:Z.Loading,allowOverlay:!1};function wl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,y,M,X,L,P,W,Y,S,$,N,z,I,E,ae,q,oe,Ee){let ve=(M==null?void 0:M.size)??Number.MAX_SAFE_INTEGER;const ee=performance.now();let K=I.baseFontFull;e.font=K;const Ce={ctx:e},te=[0,0],ge=x>0?fo(c,x,f):0;let Ge,V;const ne=es(y);return eo(t,l,i,a,r,(he,Le,Xe,et,ot)=>{const Me=Math.max(0,et-Le),Ae=Le+Me,He=r+1,ht=he.width-Me,gt=o-r-1;if(y.length>0){let je=!1;for(let Ye=0;Ye<y.length;Ye++){const Ze=y[Ye];if(cr(Ae,He,ht,gt,Ze.x,Ze.y,Ze.width,Ze.height)){je=!0;break}}if(!je)return}const lt=()=>{e.save(),e.beginPath(),e.rect(Ae,He,ht,gt),e.clip()},j=X.columns.hasIndex(he.sourceIndex),me=g(he.group??"").overrideTheme,Se=he.themeOverride===void 0&&me===void 0?I:Ln(I,me,he.themeOverride),Re=Se.baseFontFull;Re!==K&&(K=Re,e.font=Re),lt();let be;return Vr(ot,Xe,o,c,f,x,C,ne,(je,Ye,Ze,ie,pe)=>{var Bt,qt,nn;if(Ye<0||(te[0]=he.sourceIndex,te[1]=Ye,M!==void 0&&!M.has(te)))return;if(y.length>0){let Qe=!1;for(let bt=0;bt<y.length;bt++){const vt=y[bt];if(cr(Le,je,he.width,Ze,vt.x,vt.y,vt.width,vt.height)){Qe=!0;break}}if(!Qe)return}const _e=X.rows.hasIndex(Ye),Ke=w.hasIndex(Ye),Je=Ye<c?u(te):pc;let pt=Le,tt=he.width,ze=!1,dt=!1;if(Je.span!==void 0){const[Qe,bt]=Je.span,vt=`${Ye},${Qe},${bt},${he.sticky}`;if(V===void 0&&(V=new Set),V.has(vt)){ve--;return}else{const on=ns(Je.span,Le,je,he.width,Ze,he,n),Tt=he.sticky?on[0]:on[1];if(!he.sticky&&on[0]!==void 0&&(dt=!0),Tt!==void 0){pt=Tt.x,tt=Tt.width,V.add(vt),e.restore(),be=void 0,e.save(),e.beginPath();const Gt=Math.max(0,et-Tt.x);e.rect(Tt.x+Gt,je,Tt.width-Gt,Ze),Ge===void 0&&(Ge=[]),Ge.push({x:Tt.x+Gt,y:je,width:Tt.width-Gt,height:Ze}),e.clip(),ze=!0}}}const $t=m==null?void 0:m(Ye),zt=pe&&((Bt=he.trailingRowOptions)==null?void 0:Bt.themeOverride)!==void 0?(qt=he.trailingRowOptions)==null?void 0:qt.themeOverride:void 0,st=Je.themeOverride===void 0&&$t===void 0&&zt===void 0?Se:Ln(Se,$t,zt,Je.themeOverride);e.beginPath();const Xt=xa(te,Je,X);let It=ka(te,Je,X,b);const Yt=Je.span!==void 0&&X.columns.some(Qe=>Je.span!==void 0&&Qe>=Je.span[0]&&Qe<=Je.span[1]);Xt&&!h&&b?It=0:Xt&&b&&(It=Math.max(It,1)),Yt&&It++,Xt||(_e&&It++,j&&!pe&&It++);const vn=Je.kind===Z.Protected?st.bgCellMedium:st.bgCell;let mt;if((ie||vn!==I.bgCell)&&(mt=en(vn,mt)),It>0||Ke){Ke&&(mt=en(st.bgHeader,mt));for(let Qe=0;Qe<It;Qe++)mt=en(st.accentLight,mt)}else if(L!==void 0){for(const Qe of L)if(Qe[0]===he.sourceIndex&&Qe[1]===Ye){mt=en(st.bgSearchResult,mt);break}}if(P!==void 0)for(let Qe=0;Qe<P.length;Qe++){const bt=P[Qe],vt=bt.range;bt.style!=="solid-outline"&&vt.x<=he.sourceIndex&&he.sourceIndex<vt.x+vt.width&&vt.y<=Ye&&Ye<vt.y+vt.height&&(mt=en(bt.color,mt))}let In=!1;if(M!==void 0){const Qe=je+1,vt=(ie?Qe+Ze-1:Math.min(Qe+Ze-1,o-ge))-Qe;(vt!==Ze-1||pt+1<=et)&&(In=!0,e.save(),e.beginPath(),e.rect(pt+1,Qe,tt-1,vt),e.clip()),mt=mt===void 0?st.bgCell:en(mt,st.bgCell)}const fn=he.sourceIndex===n.length-1,wt=Ye===c-1;mt!==void 0&&(e.fillStyle=mt,be!==void 0&&(be.fillStyle=mt),M!==void 0?e.fillRect(pt+1,je+1,tt-(fn?2:1),Ze-(wt?2:1)):e.fillRect(pt,je,tt,Ze)),Je.style==="faded"&&(e.globalAlpha=.6);let De;for(let Qe=0;Qe<S.length;Qe++){const bt=S[Qe];if(bt.item[0]===he.sourceIndex&&bt.item[1]===Ye){De=bt;break}}if(tt>Ee&&!dt){const Qe=st.baseFontFull;Qe!==K&&(e.font=Qe,K=Qe),be=rs(e,Je,he.sourceIndex,Ye,fn,wt,pt,je,tt,Ze,It>0,st,mt??st.bgCell,W,Y,(De==null?void 0:De.hoverAmount)??0,$,z,ee,N,be,E,ae,q,oe)}return In&&e.restore(),Je.style==="faded"&&(e.globalAlpha=1),ve--,ze&&(e.restore(),(nn=be==null?void 0:be.deprep)==null||nn.call(be,Ce),be=void 0,lt(),K=Re,e.font=Re),ve<=0}),e.restore(),ve<=0}),Ge}const er=[0,0],tr={x:0,y:0,width:0,height:0},pi=[void 0,()=>{}];let Di=!1;function vc(){Di=!0}function rs(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,y,M,X,L,P,W,Y){var ae,q;let S,$;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(S=x[1][0],$=x[1][1]);let N;er[0]=n,er[1]=o,tr.x=a,tr.y=l,tr.width=c,tr.height=f,pi[0]=P.getValue(er),pi[1]=oe=>P.setValue(er,oe),Di=!1;const z={ctx:e,theme:g,col:n,row:o,cell:t,rect:tr,highlighted:u,cellFillColor:m,hoverAmount:b,frameTime:y,hoverX:S,drawState:pi,hoverY:$,imageLoader:w,spriteManager:h,hyperWrapping:C,overrideCursor:S!==void 0?Y:void 0,requestAnimationFrame:vc},I=Da(z,t.lastUpdated,y,X,r,i),E=W(t);if(E!==void 0){(X==null?void 0:X.renderer)!==E&&((ae=X==null?void 0:X.deprep)==null||ae.call(X,z),X=void 0);const oe=(q=E.drawPrep)==null?void 0:q.call(E,z,X);M!==void 0&&!Ho(z.cell)?M(z,()=>E.draw(z,t)):E.draw(z,t),N=oe===void 0?void 0:{deprep:oe==null?void 0:oe.deprep,fillStyle:oe==null?void 0:oe.fillStyle,font:oe==null?void 0:oe.font,renderer:E}}return(I||Di)&&(L==null||L(er)),N}function Wi(e,t,n,o,r,i,a,l,c=-20,f=-20,u=void 0,g="center",m="square"){const w=Math.floor(r+a/2),h=m==="circle"?1e4:t.roundingRadius??4;let b=Ll(u??t.checkboxMaxSize,a,t.cellVerticalPadding),x=b/2;const C=Bl(g,o,i,t.cellHorizontalPadding,b),y=Pl(C,w,b),M=Wl(o+c,r+f,y);switch(n){case!0:{e.beginPath(),En(e,C-b/2,w-b/2,b,b,h),m==="circle"&&(x*=.8,b*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-x+b/4.23,w-x+b/1.97),e.lineTo(C-x+b/2.42,w-x+b/1.44),e.lineTo(C-x+b/1.29,w-x+b/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Nr:case!1:{e.beginPath(),En(e,C-b/2+.5,w-b/2+.5,b-1,b-1,h),e.lineWidth=1,e.strokeStyle=M?t.textDark:t.textMedium,e.stroke();break}case Hi:{e.beginPath(),En(e,C-b/2,w-b/2,b,b,h),e.fillStyle=M?t.textMedium:t.textLight,e.fill(),m==="circle"&&(x*=.8,b*=.8),e.beginPath(),e.moveTo(C-b/3,w),e.lineTo(C+b/3,w),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:sr()}}function Cc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,y){var S,$,N,z;const M=a+l;if(M<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,r,M);const X=(S=o==null?void 0:o[0])==null?void 0:S[0],L=($=o==null?void 0:o[0])==null?void 0:$[1],P=(N=o==null?void 0:o[1])==null?void 0:N[0],W=(z=o==null?void 0:o[1])==null?void 0:z[1],Y=g.headerFontFull;e.font=Y,eo(t,0,i,0,M,(I,E,ae,q)=>{var he;if(x!==void 0&&!x.has([I.sourceIndex,-1]))return;const oe=Math.max(0,q-E);e.save(),e.beginPath(),e.rect(E+oe,l,I.width-oe,a),e.clip();const Ee=b(I.group??"").overrideTheme,ve=I.themeOverride===void 0&&Ee===void 0?g:Ln(g,Ee,I.themeOverride);ve.bgHeader!==g.bgHeader&&(e.fillStyle=ve.bgHeader,e.fill()),ve!==g&&(e.font=ve.headerFontFull);const ee=u.columns.hasIndex(I.sourceIndex),K=c!==void 0||f||I.headerRowMarkerDisabled===!0,Ce=!K&&L===-1&&X===I.sourceIndex,te=K?0:((he=w.find(Le=>Le.item[0]===I.sourceIndex&&Le.item[1]===-1))==null?void 0:he.hoverAmount)??0,ge=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===I.sourceIndex,Ge=ee?ve.accentColor:ge?ve.bgHeaderHasFocus:ve.bgHeader,V=n?l:0,ne=I.sourceIndex===0?0:1;ee?(e.fillStyle=Ge,e.fillRect(E+ne,V,I.width-ne,a)):(ge||te>0)&&(e.beginPath(),e.rect(E+ne,V,I.width-ne,a),ge&&(e.fillStyle=ve.bgHeaderHasFocus,e.fill()),te>0&&(e.globalAlpha=te,e.fillStyle=ve.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ss(e,E,V,I.width,a,I,ee,ve,Ce,Ce?P:void 0,Ce?W:void 0,ge,te,m,C,y),e.restore()}),n&&xc(e,t,r,i,l,o,g,m,w,h,b,x)}function xc(e,t,n,o,r,i,a,l,c,f,u,g){const[w,h]=(i==null?void 0:i[0])??[];let b=0;ts(t,n,o,r,(x,C,y,M,X,L)=>{if(g!==void 0&&!g.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,M,X,L),e.clip();const P=u(C),W=(P==null?void 0:P.overrideTheme)===void 0?a:Ln(a,P.overrideTheme),Y=h===-2&&w!==void 0&&w>=x[0]&&w<=x[1],S=Y?W.bgGroupHeaderHovered??W.bgHeaderHovered:W.bgGroupHeader??W.bgHeader;if(S!==a.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=W.textGroupHeader??W.textHeader,P!==void 0){let $=y;if(P.icon!==void 0&&(l.drawSprite(P.icon,"normal",e,$+8,(r-20)/2,20,W),$+=26),e.fillText(P.name,$+8,r/2+Qn(e,a.headerFontFull)),P.actions!==void 0&&Y){const N=is({x:y,y:M,width:X,height:L},P.actions);e.beginPath();const z=N[0].x-10,I=y+X-z;e.rect(z,0,I,r);const E=e.createLinearGradient(z,0,z+I,0),ae=uo(S,0);E.addColorStop(0,ae),E.addColorStop(10/I,S),E.addColorStop(1,S),e.fillStyle=E,e.fill(),e.globalAlpha=.6;const[q,oe]=(i==null?void 0:i[1])??[-1,-1];for(let Ee=0;Ee<P.actions.length;Ee++){const ve=P.actions[Ee],ee=N[Ee],K=co(ee,q+y,oe);K&&(e.globalAlpha=1),l.drawSprite(ve.icon,"normal",e,ee.x+ee.width/2-10,ee.y+ee.height/2-10,20,W),K&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&f(x[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=y+X}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const Br=30;function kc(e,t,n,o,r){return{x:e+n-Br,y:Math.max(t,t+o/2-Br/2),width:Br,height:Math.min(Br,o)}}function is(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function nr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ls(e,t,n,o,r,i,a,l){var C;const c=a.cellHorizontalPadding,f=a.headerIconSize,u=kc(n,o,r,i);let g=n+c;const m=t.icon===void 0?void 0:{x:g,y:o+(i-f)/2,width:f,height:f},w=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(f*1.3));const h={x:g,y:o,width:r-g,height:i};let b;if(t.indicatorIcon!==void 0){const y=e===void 0?((C=Gl(t.title,a.headerFontFull))==null?void 0:C.width)??0:Bo(t.title,e,a.headerFontFull).width;h.width=y,g+=y+c,b={x:g,y:o+(i-f)/2,width:f,height:f}}const x=n+r/2;return{menuBounds:nr(u,x,l),iconBounds:nr(m,x,l),iconOverlayBounds:nr(w,x,l),textBounds:nr(h,x,l),indicatorIconBounds:nr(b,x,l)}}function bl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const M=i.headerRowMarkerTheme!==void 0?Ln(l,i.headerRowMarkerTheme):l;Wi(e,M,y,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=a?l.textHeaderSelected:l.textHeader,C=i.hasMenu===!0&&(c||w&&a)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let y=a?"selected":"normal";i.style==="highlight"&&(y=a?"selected":"special"),m.drawSprite(i.icon,y,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&m.drawSprite(i.overlayIcon,a?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(C&&o>35){const M=h?35:o-35,X=h?35*.7:o-35*.7,L=M/o,P=X/o,W=e.createLinearGradient(t,0,t+o,0),Y=uo(x,0);W.addColorStop(h?1:0,x),W.addColorStop(L,x),W.addColorStop(P,Y),W.addColorStop(h?0:1,Y),e.fillStyle=W}else e.fillStyle=x;if(h&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,h?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+Qn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!C||!cr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let y=a?"selected":"normal";i.style==="highlight"&&(y=a?"selected":"special"),m.drawSprite(i.indicatorIcon,y,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(C&&b.menuBounds!==void 0){const y=b.menuBounds,M=f!==void 0&&u!==void 0&&co(y,f+t,u+n);if(M||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Xr.Triangle){e.beginPath();const X=y.x+y.width/2-5.5,L=y.y+y.height/2-3;Aa(e,[{x:X,y:L},{x:X+11,y:L},{x:X+5.5,y:L+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Xr.Dots){e.beginPath();const X=y.x+y.width/2,L=y.y+y.height/2;Ta(e,X,L),e.fillStyle=x,e.fill()}else{const X=y.x+(y.width-l.headerIconSize)/2,L=y.y+(y.height-l.headerIconSize)/2;m.drawSprite(i.menuIcon,"normal",e,X,L,l.headerIconSize,l)}M||(e.globalAlpha=1)}}function ss(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){const x=zi(i.title)==="rtl",C=ls(e,i,t,n,o,r,l,x);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:m,isHovered:c,hasSelectedCell:g,spriteManager:w,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>bl(e,t,n,o,r,i,a,l,c,f,u,m,w,b,x,C)):bl(e,t,n,o,r,i,a,l,c,f,u,m,w,b,x,C)}function Sc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,y){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const M=es(x);eo(t,c,a,l,i,(X,L,P,W,Y)=>{if(X!==t[t.length-1])return;L+=X.width;const S=Math.max(L,W);S>o||(e.save(),e.beginPath(),e.rect(S,i+1,1e4,r-i-1),e.clip(),Vr(Y,P,r,f,u,h,b,M,($,N,z,I)=>{if(!I&&x.length>0&&!x.some(Ee=>cr(L,$,1e4,z,Ee.x,Ee.y,Ee.width,Ee.height)))return;const E=m.hasIndex(N),ae=w.hasIndex(N);e.beginPath();const q=g==null?void 0:g(N),oe=q===void 0?y:Ln(y,q);oe.bgCell!==y.bgCell&&(e.fillStyle=oe.bgCell,e.fillRect(L,$,1e4,z)),ae&&(e.fillStyle=oe.bgHeader,e.fillRect(L,$,1e4,z)),E&&(e.fillStyle=oe.accentLight,e.fillRect(L,$,1e4,z))}),e.restore())})}function Mc(e,t,n,o,r,i,a,l,c){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,g=c.borderColor,m=f?Po(t):0;let w;if(m!==0&&(w=fl(g,c.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=g===u&&w!==void 0?w:fl(u,c.bgCell),b=fo(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const as=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function Rc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h){var z;const b=h.bgCell,{minX:x,maxX:C,minY:y,maxY:M}=as(l,i,a),X=[],L=a-fo(w,m,f);let P=c,W=n,Y=0;for(;P+r<L;){const I=P+r,E=f(W);if(I>=y&&I<=M-1){const ae=u==null?void 0:u(W),q=ae==null?void 0:ae.bgCell;q!==void 0&&q!==b&&W>=w-m&&X.push({x,y:I,w:C-x,h:E,color:q})}P+=E,W<w-m&&(Y=P),W++}let S=0;const $=Math.min(L,M)-Y;if($>0)for(let I=0;I<t.length;I++){const E=t[I];if(E.width===0)continue;const ae=E.sticky?S:S+o,q=(z=E.themeOverride)==null?void 0:z.bgCell;q!==void 0&&q!==b&&ae>=x&&ae<=C&&g(I+1)&&X.push({x:ae,y:Y,w:E.width,h:$,color:q}),S+=E.width}if(X.length===0)return;let N;e.beginPath();for(let I=X.length-1;I>=0;I--){const E=X[I];N===void 0?N=E.color:E.color!==N&&(e.fillStyle=N,e.fill(),e.beginPath(),N=E.color),e.rect(E.x,E.y,E.w,E.h)}N!==void 0&&(e.fillStyle=N,e.fill()),e.beginPath()}function yl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const z of c)e.rect(z.x+1,z.y+1,z.width-1,z.height-1);e.clip("evenodd")}const y=x.horizontalBorderColor??x.borderColor,M=x.borderColor,{minX:X,maxX:L,minY:P,maxY:W}=as(l,i,a),Y=[];e.beginPath();let S=.5;for(let z=0;z<t.length;z++){const I=t[z];if(I.width===0)continue;S+=I.width;const E=I.sticky?S:S+o;E>=X&&E<=L&&w(z+1)&&Y.push({x1:E,y1:Math.max(f,P),x2:E,y2:Math.min(a,W),color:M})}let $=a+.5;for(let z=b-h;z<b;z++){const I=g(z);$-=I,Y.push({x1:X,y1:$,x2:L,y2:$,color:y})}if(C!==!0){let z=u+.5,I=n;const E=$;for(;z+r<E;){const ae=z+r;if(ae>=P&&ae<=W-1){const q=m==null?void 0:m(I);Y.push({x1:X,y1:ae,x2:L,y2:ae,color:(q==null?void 0:q.horizontalBorderColor)??(q==null?void 0:q.borderColor)??y})}z+=g(I),I++}}const N=Js(Y,z=>z.color);for(const z of Object.keys(N)){e.strokeStyle=z;for(const I of N[z])e.moveTo(I.x1,I.y1),e.lineTo(I.x2,I.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Ec(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,y){const M=[];e.imageSmoothingEnabled=!1;const X=Math.min(r.cellYOffset,a),L=Math.max(r.cellYOffset,a);let P=0;if(typeof C=="number")P+=(L-X)*C;else for(let E=X;E<L;E++)P+=C(E);a>r.cellYOffset&&(P=-P),P+=c-r.translateY;const W=Math.min(r.cellXOffset,i),Y=Math.max(r.cellXOffset,i);let S=0;for(let E=W;E<Y;E++)S+=b[E].width;i>r.cellXOffset&&(S=-S),S+=l-r.translateX;const $=Po(x);if(S!==0&&P!==0)return{regions:[]};const N=f>0?fo(m,f,C):0,z=u-$-Math.abs(S),I=g-w-N-Math.abs(P)-1;if(z>150&&I>150){const E={sx:0,sy:0,sw:u*h,sh:g*h,dx:0,dy:0,dw:u*h,dh:g*h};if(P>0?(E.sy=(w+1)*h,E.sh=I*h,E.dy=(P+w+1)*h,E.dh=I*h,M.push({x:0,y:w,width:u,height:P+1})):P<0&&(E.sy=(-P+w+1)*h,E.sh=I*h,E.dy=(w+1)*h,E.dh=I*h,M.push({x:0,y:g+P-N,width:u,height:-P+N})),S>0?(E.sx=$*h,E.sw=z*h,E.dx=(S+$)*h,E.dw=z*h,M.push({x:$-1,y:0,width:S+2,height:g})):S<0&&(E.sx=($-S)*h,E.sw=z*h,E.dx=$*h,E.dw=z*h,M.push({x:u+S,y:0,width:-S,height:g})),e.setTransform(1,0,0,1,0,0),y){if($>0&&S!==0&&P===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ae=$*h,q=g*h;e.drawImage(t,0,0,ae,q,0,0,ae,q)}if(N>0&&S===0&&P!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ae=(g-N)*h,q=u*h,oe=N*h;e.drawImage(t,0,ae,q,oe,0,ae,q,oe)}}e.drawImage(t,E.sx,E.sy,E.sw,E.sh,E.dx,E.dy,E.dw,E.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:M}}function Ic(e,t,n,o,r,i,a,l,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||eo(c,n,o,r,l,(g,m,w,h)=>{if(g.sourceIndex===f){const b=Math.max(m,h)+1;return u.push({x:b,y:0,width:i-b,height:a}),!0}}),u}function Dc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Ao(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:c,...f}=i;if(!Ao(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function pl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){const x=h==null?void 0:h.filter(W=>W.style!=="no-outline");if(x===void 0||x.length===0)return;const C=Po(l),y=fo(w,m,g),M=[c,0,l.length,w-m],X=[C,0,t,n-y],L=x.map(W=>{const Y=W.range,S=W.style??"dashed";return yc(Y,M,t,n,X).map($=>{const N=$.rect,z=Ei(N.x,N.y,t,n,u,f+u,o,r,i,a,w,c,m,l,g),I=N.width===1&&N.height===1?z:Ei(N.x+N.width-1,N.y+N.height-1,t,n,u,f+u,o,r,i,a,w,c,m,l,g);return N.x+N.width>=l.length&&(I.width-=1),N.y+N.height>=w&&(I.height-=1),{color:W.color,style:S,clip:$.clip,rect:bc({x:z.x,y:z.y,width:I.x+I.width-z.x,height:I.y+I.height-z.y},t,n,8)}})}),P=()=>{e.lineWidth=1;let W=!1;for(const Y of L)for(const S of Y)if((S==null?void 0:S.rect)!==void 0&&cr(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const $=W,N=!wc(S.clip,S.rect);e.beginPath(),N&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!W?(e.setLineDash([5,3]),W=!0):(S.style==="solid"||S.style==="solid-outline")&&W&&(e.setLineDash([]),W=!1),e.strokeStyle=S.style==="solid-outline"?en(en(S.color,b.borderColor),b.bgCell):uo(S.color,1),e.closePath(),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),N&&(e.restore(),W=$)}W&&e.setLineDash([])};return P(),P}function vl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function vi(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x){if(u.current===void 0)return;const C=b!==!1&&b!==void 0;if(!C)return;const y=typeof b=="object"?{...Yr,...b}:Yr,M=u.current.range,X=u.current.cell,L=[M.x+M.width-1,M.y+M.height-1];if(X[1]>=x&&L[1]>=x||!a.some(q=>q.sourceIndex===X[0]||q.sourceIndex===L[0]))return;const[W,Y]=u.current.cell,S=m(u.current.cell),$=S.span??[W,W],N=Y>=x-w,z=w>0&&!N?fo(x,w,g)-1:0,I=L[1];let E;if(eo(a,o,r,i,f,(q,oe,Ee,ve,ee)=>{if(q.sticky&&W>q.sourceIndex)return;const K=q.sourceIndex<$[0],Ce=q.sourceIndex>$[1],te=q.sourceIndex===L[0];if(!(!te&&(K||Ce)))return Vr(ee,Ee,n,x,g,w,h,void 0,(ge,Ge,V)=>{if(Ge!==Y&&Ge!==I)return;let ne=oe,he=q.width;if(S.span!==void 0){const Xe=ns(S.span,oe,ge,q.width,V,q,l),et=q.sticky?Xe[0]:Xe[1];et!==void 0&&(ne=et.x,he=et.width)}return Ge===I&&te&&C&&(E=()=>{var Ae;ve>ne&&!q.sticky&&(e.beginPath(),e.rect(ve,0,t-ve,n),e.clip());const Xe=y.size,et=Xe/2,ot=ne+he+y.offsetX-et+.5,Me=ge+V+y.offsetY-et+.5;e.beginPath(),y.shape==="circle"?e.arc(ot+et,Me+et,et,0,Math.PI*2):e.rect(ot,Me,Xe,Xe),e.fillStyle=((Ae=q.themeOverride)==null?void 0:Ae.accentColor)??c.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=c.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(ot+et,Me+et,et+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(ot-y.outline/2,Me-y.outline/2,Xe+y.outline,Xe+y.outline))}),E!==void 0}),E!==void 0}),E===void 0)return;const ae=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-z),e.clip(),E==null||E(),e.restore()};return ae(),ae}function Fc(e,t,n,o,r,i,a,l,c){c===void 0||c.size===0||(e.beginPath(),ts(t,n,i,o,(f,u,g,m,w,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(g,m,w,h)}),eo(t,l,i,a,r,(f,u,g,m)=>{const w=Math.max(0,m-u),h=u+w+1,b=f.width-w-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function Hc(e,t,n,o,r,i,a,l,c,f){let u=0;return eo(e,i,o,r,n,(g,m,w,h,b)=>(Vr(b,w,t,a,l,c,f,void 0,(x,C,y,M)=>{M||(u=Math.max(C,u))}),!0)),u}function Cl(e,t){var fn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:x,groupHeaderHeight:C,disabledRows:y,rowHeight:M,verticalBorder:X,overrideCursor:L,isResizing:P,selection:W,fillHandle:Y,freezeTrailingRows:S,rows:$,getCellContent:N,getGroupDetails:z,getRowThemeOverride:I,isFocused:E,drawHeaderCallback:ae,prelightCells:q,drawCellCallback:oe,highlightRegions:Ee,resizeCol:ve,imageLoader:ee,lastBlitData:K,hoverValues:Ce,hyperWrapping:te,hoverInfo:ge,spriteManager:Ge,maxScaleFactor:V,hasAppendRow:ne,touchMode:he,enqueue:Le,renderStateProvider:Xe,getCellRenderer:et,renderStrategy:ot,bufferACtx:Me,bufferBCtx:Ae,damage:He,minimumCellWidth:ht,resizeIndicator:gt}=e;if(r===0||i===0)return;const lt=ot==="double-buffer",j=Math.min(V,Math.ceil(window.devicePixelRatio??1)),me=ot!=="direct"&&Dc(e,t),Se=n.canvas;(Se.width!==r*j||Se.height!==i*j)&&(Se.width=r*j,Se.height=i*j,Se.style.width=r+"px",Se.style.height=i+"px");const Re=o.canvas,be=g?C+x:x,je=be+1;(Re.width!==r*j||Re.height!==je*j)&&(Re.width=r*j,Re.height=je*j,Re.style.width=r+"px",Re.style.height=je+"px");const Ye=Me.canvas,Ze=Ae.canvas;lt&&(Ye.width!==r*j||Ye.height!==i*j)&&(Ye.width=r*j,Ye.height=i*j,K.current!==void 0&&(K.current.aBufferScroll=void 0)),lt&&(Ze.width!==r*j||Ze.height!==i*j)&&(Ze.width=r*j,Ze.height=i*j,K.current!==void 0&&(K.current.bBufferScroll=void 0));const ie=K.current;if(me===!0&&a===(ie==null?void 0:ie.cellXOffset)&&l===(ie==null?void 0:ie.cellYOffset)&&c===(ie==null?void 0:ie.translateX)&&f===(ie==null?void 0:ie.translateY))return;let pe=null;lt&&(pe=n);const _e=o;let Ke;lt?He!==void 0?Ke=(ie==null?void 0:ie.lastBuffer)==="b"?Ae:Me:Ke=(ie==null?void 0:ie.lastBuffer)==="b"?Me:Ae:Ke=n;const Je=Ke.canvas,pt=lt?Je===Ye?Ze:Ye:Se,tt=typeof M=="number"?()=>M:M;_e.save(),Ke.save(),_e.beginPath(),Ke.beginPath(),_e.textBaseline="middle",Ke.textBaseline="middle",j!==1&&(_e.scale(j,j),Ke.scale(j,j));const ze=Ri(u,a,r,w,c);let dt=[];const $t=b&&((fn=W.current)==null?void 0:fn.cell[1])===l&&f===0;let zt=!1;if(Ee!==void 0){for(const wt of Ee)if(wt.style!=="no-outline"&&wt.range.y===l&&f===0){zt=!0;break}}const st=()=>{Cc(_e,ze,g,ge,r,c,x,C,w,P,W,h,Ge,Ce,X,z,He,ae,he),yl(_e,ze,l,c,f,r,i,void 0,void 0,C,be,tt,I,X,S,$,h,!0),_e.beginPath(),_e.moveTo(0,je-.5),_e.lineTo(r,je-.5),_e.strokeStyle=en(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),_e.stroke(),zt&&pl(_e,r,i,a,l,c,f,u,m,x,C,M,S,$,Ee,h),$t&&vi(_e,r,i,l,c,f,ze,u,h,be,W,tt,N,S,ne,Y,$)};if(He!==void 0){const wt=ze[ze.length-1].sourceIndex+1,De=He.hasItemInRegion([{x:a,y:-2,width:wt,height:2},{x:a,y:l,width:wt,height:300},{x:0,y:l,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:a,y:$-S,width:wt,height:S,when:S>0}]),Bt=qt=>{wl(qt,ze,u,i,be,c,f,l,$,tt,N,z,I,y,E,b,S,ne,dt,He,W,q,Ee,ee,Ge,Ce,ge,oe,te,h,Le,Xe,et,L,ht);const nn=W.current;Y!==!1&&Y!==void 0&&b&&nn!==void 0&&He.has(Nl(nn.range))&&vi(qt,r,i,l,c,f,ze,u,h,be,W,tt,N,S,ne,Y,$)};De&&(Bt(Ke),pe!==null&&(pe.save(),pe.scale(j,j),pe.textBaseline="middle",Bt(pe),pe.restore()),He.hasHeader()&&(Fc(_e,ze,r,C,be,c,f,l,He),st())),Ke.restore(),_e.restore();return}if((me!==!0||a!==(ie==null?void 0:ie.cellXOffset)||c!==(ie==null?void 0:ie.translateX)||$t!==(ie==null?void 0:ie.mustDrawFocusOnHeader)||zt!==(ie==null?void 0:ie.mustDrawHighlightRingsOnHeader))&&st(),me===!0){Qt(pt!==void 0&&ie!==void 0);const{regions:wt}=Ec(Ke,pt,pt===Ye?ie.aBufferScroll:ie.bBufferScroll,pt===Ye?ie.bBufferScroll:ie.aBufferScroll,ie,a,l,c,f,S,r,i,$,be,j,u,ze,M,lt);dt=wt}else me!==!1&&(Qt(ie!==void 0),dt=Ic(ie,a,l,c,f,r,i,be,ze,me));Mc(Ke,ze,r,i,S,$,X,tt,h);const Xt=pl(Ke,r,i,a,l,c,f,u,m,x,C,M,S,$,Ee,h),It=b?vi(Ke,r,i,l,c,f,ze,u,h,be,W,tt,N,S,ne,Y,$):void 0;if(Ke.fillStyle=h.bgCell,dt.length>0){Ke.beginPath();for(const wt of dt)Ke.rect(wt.x,wt.y,wt.width,wt.height);Ke.clip(),Ke.fill(),Ke.beginPath()}else Ke.fillRect(0,0,r,i);const Yt=wl(Ke,ze,u,i,be,c,f,l,$,tt,N,z,I,y,E,b,S,ne,dt,He,W,q,Ee,ee,Ge,Ce,ge,oe,te,h,Le,Xe,et,L,ht);Sc(Ke,ze,u,r,i,be,c,f,l,$,tt,I,W.rows,y,S,ne,dt,He,h),Rc(Ke,ze,l,c,f,r,i,dt,be,tt,I,X,S,$,h),yl(Ke,ze,l,c,f,r,i,dt,Yt,C,be,tt,I,X,S,$,h),Xt==null||Xt(),It==null||It(),P&&gt!=="none"&&eo(ze,0,c,0,be,(wt,De)=>wt.sourceIndex===ve?(vl(_e,De+wt.width,0,be+1,en(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),gt==="full"&&vl(Ke,De+wt.width,be,i,en(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),pe!==null&&(pe.fillStyle=h.bgCell,pe.fillRect(0,0,r,i),pe.drawImage(Ke.canvas,0,0));const vn=Hc(ze,i,be,c,f,l,$,tt,S,ne);ee==null||ee.setWindow({x:a,y:l,width:ze.length,height:vn-l},m,Array.from({length:S},(wt,De)=>$-1-De));const mt=ie!==void 0&&(a!==ie.cellXOffset||c!==ie.translateX),In=ie!==void 0&&(l!==ie.cellYOffset||f!==ie.translateY);K.current={cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:$t,mustDrawHighlightRingsOnHeader:zt,lastBuffer:lt?Je===Ye?"a":"b":void 0,aBufferScroll:Je===Ye?[mt,In]:ie==null?void 0:ie.aBufferScroll,bBufferScroll:Je===Ze?[mt,In]:ie==null?void 0:ie.bBufferScroll},Ke.restore(),_e.restore()}const Tc=80;function Ac(e){const t=e-1;return t*t*t+1}class zc{constructor(t){$e(this,"callback");$e(this,"currentHoveredItem");$e(this,"leavingItems",[]);$e(this,"lastAnimationTime");$e(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>rr(o.item,t.item))||this.leavingItems.push(t)});$e(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>rr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});$e(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});$e(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});$e(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Ac(t.hoverAmount)})));$e(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Tc;for(const i of this.leavingItems)i.hoverAmount=dn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=dn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});$e(this,"setHovered",t=>{var n;if(!rr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Pc{constructor(t){$e(this,"fn");$e(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function $i(e){return new Pc(e)}const Bc=$i(()=>window.navigator.userAgent.includes("Firefox")),Gr=$i(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),_r=$i(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Lc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Li);t.current=[],o.current(new lr(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=pn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Jn="header",yn="group-header",Kr="out-of-bounds";var To;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(To||(To={}));function cs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Wc=(e,t)=>{if(e.kind===Z.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},$c=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:b,onHeaderIndicatorClick:x,enableGroups:C,isFilling:y,onCanvasFocused:M,onCanvasBlur:X,isFocused:L,selection:P,freezeColumns:W,onContextMenu:Y,freezeTrailingRows:S,fixedShadowX:$=!0,fixedShadowY:N=!0,drawFocusRing:z,onMouseDown:I,onMouseUp:E,onMouseMoveRaw:ae,onMouseMove:q,onItemHovered:oe,dragAndDropState:Ee,firstColAccessible:ve,onKeyDown:ee,onKeyUp:K,highlightRegions:Ce,canvasRef:te,onDragStart:ge,onDragEnd:Ge,eventTargetRef:V,isResizing:ne,resizeColumn:he,isDragging:Le,isDraggable:Xe=!1,allowResize:et,disabledRows:ot,hasAppendRow:Me,getGroupDetails:Ae,theme:He,prelightCells:ht,headerIcons:gt,verticalBorder:lt,drawCell:j,drawHeader:me,onCellFocused:Se,onDragOverCell:Re,onDrop:be,onDragLeave:je,imageWindowLoader:Ye,smoothScrollX:Ze=!1,smoothScrollY:ie=!1,experimental:pe,getCellRenderer:_e,resizeIndicator:Ke="full"}=e,Je=e.translateX??0,pt=e.translateY??0,tt=Math.max(W,Math.min(i.length-1,a)),ze=s.useRef(null),dt=s.useRef((pe==null?void 0:pe.eventTarget)??window),$t=dt.current,zt=Ye,st=s.useRef(),[Xt,It]=s.useState(!1),Yt=s.useRef([]),vn=s.useRef(),[mt,In]=s.useState(),[fn,wt]=s.useState(),De=s.useRef(null),[Bt,qt]=s.useState(),[nn,Qe]=s.useState(!1),bt=s.useRef(nn);bt.current=nn;const vt=s.useMemo(()=>new gc(gt,()=>{go.current=void 0,On.current()}),[gt]),on=C?u+c:c,Tt=s.useRef(-1),Gt=((pe==null?void 0:pe.enableFirefoxRescaling)??!1)&&Bc.value,Dn=((pe==null?void 0:pe.enableSafariRescaling)??!1)&&Gr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Gt&&!Dn||(Tt.current!==-1&&It(!0),window.clearTimeout(Tt.current),Tt.current=window.setTimeout(()=>{It(!1),Tt.current=-1},200))},[l,tt,Je,pt,Gt,Dn]);const ut=va(i,W),Lo=s.useMemo(()=>$?Po(ut,Ee):0,[ut,Ee,$]),Ue=s.useCallback((k,_,ce)=>{const le=k.getBoundingClientRect();if(_>=ut.length||ce>=m)return;const U=le.width/n,re=Ei(_,ce,n,o,u,on,tt,l,Je,pt,m,W,S,ut,g);return U!==1&&(re.x*=U,re.y*=U,re.width*=U,re.height*=U),re.x+=le.x,re.y+=le.y,re},[n,o,u,on,tt,l,Je,pt,m,W,S,ut,g]),Ft=s.useCallback((k,_,ce,le)=>{const U=k.getBoundingClientRect(),re=U.width/n,Te=(_-U.left)/re,Ve=(ce-U.top)/re,we=5,Ht=Ri(ut,tt,n,void 0,Je);let de=0,Ie=0;const We=typeof PointerEvent<"u"&&le instanceof PointerEvent&&le.pointerType==="mouse"||typeof MouseEvent<"u"&&le instanceof MouseEvent,Fe=typeof PointerEvent<"u"&&le instanceof PointerEvent&&le.pointerType==="touch"||typeof TouchEvent<"u"&&le instanceof TouchEvent;We&&(de=le.button,Ie=le.buttons);const Pe=Sa(Te,Ht,Je),xt=Ma(Ve,o,C,c,u,m,g,l,pt,S),Dt=(le==null?void 0:le.shiftKey)===!0,sn=(le==null?void 0:le.ctrlKey)===!0,kt=(le==null?void 0:le.metaKey)===!0,St=[Te<0?-1:n<Te?1:0,Ve<on?-1:o<Ve?1:0];let hn;if(Pe===-1||Ve<0||Te<0||xt===void 0||Te>n||Ve>o){const rt=Te>n?1:Te<0?-1:0,Kt=Ve>o?1:Ve<0?-1:0;let jt=rt*2,xo=Kt*2;rt===0&&(jt=Pe===-1?To.EndPadding:To.Center),Kt===0&&(xo=xt===void 0?To.EndPadding:To.Center);let Be=!1;if(Pe===-1&&xt===-1){const gn=Ue(k,ut.length-1,-1);Qt(gn!==void 0),Be=_<gn.x+gn.width+we}const At=Te>n&&Te<n+Mi()||Ve>o&&Ve<o+Mi();hn={kind:Kr,location:[Pe!==-1?Pe:Te<0?0:ut.length-1,xt??m-1],region:[jt,xo],shiftKey:Dt,ctrlKey:sn,metaKey:kt,isEdge:Be,isTouch:Fe,button:de,buttons:Ie,scrollEdge:St,isMaybeScrollbar:At}}else if(xt<=-1){let rt=Ue(k,Pe,xt);Qt(rt!==void 0);let Kt=rt!==void 0&&rt.x+rt.width-_<=we;const jt=Pe-1;_-rt.x<=we&&jt>=0?(Kt=!0,rt=Ue(k,jt,xt),Qt(rt!==void 0),hn={kind:C&&xt===-2?yn:Jn,location:[jt,xt],bounds:rt,group:ut[jt].group??"",isEdge:Kt,shiftKey:Dt,ctrlKey:sn,metaKey:kt,isTouch:Fe,localEventX:_-rt.x,localEventY:ce-rt.y,button:de,buttons:Ie,scrollEdge:St}):hn={kind:C&&xt===-2?yn:Jn,group:ut[Pe].group??"",location:[Pe,xt],bounds:rt,isEdge:Kt,shiftKey:Dt,ctrlKey:sn,metaKey:kt,isTouch:Fe,localEventX:_-rt.x,localEventY:ce-rt.y,button:de,buttons:Ie,scrollEdge:St}}else{const rt=Ue(k,Pe,xt);Qt(rt!==void 0);const Kt=rt!==void 0&&rt.x+rt.width-_<we;let jt=!1;if(f!==!1&&f!==void 0&&P.current!==void 0){const Be=typeof f=="object"?{...Yr,...f}:Yr,At=Be.size,gn=At/2,Uo=Nl(P.current.range),Zt=Ue(k,Uo[0],Uo[1]);if(Zt!==void 0){const ct=Zt.x+Zt.width+Be.offsetX-gn+.5,ni=Zt.y+Zt.height+Be.offsetY-gn+.5;jt=Math.abs(ct-_)<At&&Math.abs(ni-ce)<At}}hn={kind:"cell",location:[Pe,xt],bounds:rt,isEdge:Kt,shiftKey:Dt,ctrlKey:sn,isFillHandle:jt,metaKey:kt,isTouch:Fe,localEventX:_-rt.x,localEventY:ce-rt.y,button:de,buttons:Ie,scrollEdge:St}}return hn},[n,ut,tt,Je,o,C,c,u,m,g,l,pt,S,Ue,f,P,on]),[Fn]=mt??[],ur=s.useRef(()=>{}),Wn=s.useRef(mt);Wn.current=mt;const[Hn,Tn]=s.useMemo(()=>{const k=document.createElement("canvas"),_=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",_.style.display="none",_.style.opacity="0",_.style.position="fixed",[k.getContext("2d",{alpha:!1}),_.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Hn===null||Tn===null))return document.documentElement.append(Hn.canvas),document.documentElement.append(Tn.canvas),()=>{Hn.canvas.remove(),Tn.canvas.remove()}},[Hn,Tn]);const ho=s.useMemo(()=>new za,[]),$n=Gt&&Xt?1:Dn&&Xt?2:5,fr=(pe==null?void 0:pe.disableMinimumCellWidth)===!0?1:10,go=s.useRef(),mo=s.useRef(null),wo=s.useRef(null),bo=s.useCallback(()=>{var Te;const k=ze.current,_=De.current;if(k===null||_===null||(mo.current===null&&(mo.current=k.getContext("2d",{alpha:!1}),k.width=0,k.height=0),wo.current===null&&(wo.current=_.getContext("2d",{alpha:!1}),_.width=0,_.height=0),mo.current===null||wo.current===null||Hn===null||Tn===null))return;let ce=!1;const le=Ve=>{ce=!0,qt(Ve)},U=go.current,re={headerCanvasCtx:wo.current,canvasCtx:mo.current,bufferACtx:Hn,bufferBCtx:Tn,width:n,height:o,cellXOffset:tt,cellYOffset:l,translateX:Math.round(Je),translateY:Math.round(pt),mappedColumns:ut,enableGroups:C,freezeColumns:W,dragAndDropState:Ee,theme:He,headerHeight:c,groupHeaderHeight:u,disabledRows:ot??it.empty(),rowHeight:g,verticalBorder:lt,isResizing:ne,resizeCol:he,isFocused:L,selection:P,fillHandle:f,drawCellCallback:j,hasAppendRow:Me,overrideCursor:le,maxScaleFactor:$n,freezeTrailingRows:S,rows:m,drawFocus:z,getCellContent:w,getGroupDetails:Ae??(Ve=>({name:Ve})),getRowThemeOverride:h,drawHeaderCallback:me,prelightCells:ht,highlightRegions:Ce,imageLoader:zt,lastBlitData:vn,damage:st.current,hoverValues:Yt.current,hoverInfo:Wn.current,spriteManager:vt,scrolling:Xt,hyperWrapping:(pe==null?void 0:pe.hyperWrapping)??!1,touchMode:nn,enqueue:ur.current,renderStateProvider:ho,renderStrategy:(pe==null?void 0:pe.renderStrategy)??(Gr.value?"double-buffer":"single-buffer"),getCellRenderer:_e,minimumCellWidth:fr,resizeIndicator:Ke};re.damage===void 0?(go.current=re,Cl(re,U)):Cl(re,void 0),!ce&&(re.damage===void 0||re.damage.has((Te=Wn==null?void 0:Wn.current)==null?void 0:Te[0]))&&qt(void 0)},[Hn,Tn,n,o,tt,l,Je,pt,ut,C,W,Ee,He,c,u,ot,g,lt,ne,Me,he,L,P,f,S,m,z,$n,w,Ae,h,j,me,ht,Ce,zt,vt,Xt,pe==null?void 0:pe.hyperWrapping,pe==null?void 0:pe.renderStrategy,nn,ho,_e,fr,Ke]),On=s.useRef(bo);s.useLayoutEffect(()=>{bo(),On.current=bo},[bo]),s.useLayoutEffect(()=>{(async()=>{var _;((_=document==null?void 0:document.fonts)==null?void 0:_.ready)!==void 0&&(await document.fonts.ready,go.current=void 0,On.current())})()},[]);const Nn=s.useCallback(k=>{st.current=k,On.current(),st.current=void 0},[]),qr=Lc(Nn);ur.current=qr;const hr=s.useCallback(k=>{Nn(new lr(k.map(_=>_.cell)))},[Nn]);zt.setCallback(Nn);const[jr,gr]=s.useState(!1),[An,Xn]=Fn??[],Zr=An!==void 0&&Xn===-1&&An>=0&&An<ut.length&&ut[An].headerRowMarkerDisabled!==!0,Wo=An!==void 0&&Xn===-2;let mr=!1,$o=!1,to=Bt;if(to===void 0&&An!==void 0&&Xn!==void 0&&Xn>-1&&Xn<m){const k=w([An,Xn],!0);mr=k.kind===un.NewRow||k.kind===un.Marker&&k.markerKind!=="number",$o=k.kind===Z.Boolean&&Ti(k),to=k.cursor}const Oo=Le?"grabbing":(fn??!1)||ne?"col-resize":jr||y?"crosshair":to!==void 0?to:Zr||mr||$o||Wo?"pointer":"default",at=s.useMemo(()=>({contain:"strict",display:"block",cursor:Oo}),[Oo]),_t=s.useRef("default"),No=V==null?void 0:V.current;No!=null&&_t.current!==at.cursor&&(No.style.cursor=_t.current=at.cursor);const no=s.useCallback((k,_,ce,le)=>{if(Ae===void 0)return;const U=Ae(k);if(U.actions!==void 0){const re=is(_,U.actions);for(const[Te,Ve]of re.entries())if(co(Ve,ce+_.x,le+Ve.y))return U.actions[Te]}},[Ae]),zn=s.useCallback((k,_,ce,le)=>{const U=ut[_];if(!Le&&!ne&&!(fn??!1)){const re=Ue(k,_,-1);Qt(re!==void 0);const Te=ls(void 0,U,re.x,re.y,re.width,re.height,He,zi(U.title)==="rtl");if(U.hasMenu===!0&&Te.menuBounds!==void 0&&co(Te.menuBounds,ce,le))return{area:"menu",bounds:Te.menuBounds};if(U.indicatorIcon!==void 0&&Te.indicatorIconBounds!==void 0&&co(Te.indicatorIconBounds,ce,le))return{area:"indicator",bounds:Te.indicatorIconBounds}}},[ut,Ue,fn,Le,ne,He]),yo=s.useRef(0),Yn=s.useRef(),Gn=s.useRef(!1),po=s.useCallback(k=>{const _=ze.current,ce=V==null?void 0:V.current;if(_===null||k.target!==_&&k.target!==ce)return;Gn.current=!0;const le=k.clientX,U=k.clientY;if(k.target===ce&&ce!==null){const Te=ce.getBoundingClientRect();if(le>Te.right||U>Te.bottom)return}const re=Ft(_,le,U,k);Yn.current=re.location,re.isTouch&&(yo.current=Date.now()),bt.current!==re.isTouch&&Qe(re.isTouch),!(re.kind===Jn&&zn(_,re.location[0],le,U)!==void 0)&&(re.kind===yn&&no(re.group,re.bounds,re.localEventX,re.localEventY)!==void 0||(I==null||I(re),!re.isTouch&&Xe!==!0&&Xe!==re.kind&&re.button<3&&re.button!==1&&k.preventDefault()))},[V,Xe,Ft,no,zn,I]);Nt("pointerdown",po,$t,!1);const Pn=s.useRef(0),vo=s.useCallback(k=>{var Ie,We;const _=Pn.current;Pn.current=Date.now();const ce=ze.current;if(Gn.current=!1,E===void 0||ce===null)return;const le=V==null?void 0:V.current,U=k.target!==ce&&k.target!==le,re=k.clientX,Te=k.clientY,Ve=k.pointerType==="mouse"?k.button<3:!0;let we=Ft(ce,re,Te,k);we.isTouch&&yo.current!==0&&Date.now()-yo.current>500&&(we={...we,isLongTouch:!0}),_!==0&&Date.now()-_<(we.isTouch?1e3:500)&&(we={...we,isDoubleClick:!0}),bt.current!==we.isTouch&&Qe(we.isTouch),!U&&k.cancelable&&Ve&&k.preventDefault();const[Ht]=we.location,de=zn(ce,Ht,re,Te);if(we.kind===Jn&&de!==void 0){(we.button!==0||((Ie=Yn.current)==null?void 0:Ie[0])!==Ht||((We=Yn.current)==null?void 0:We[1])!==-1)&&E(we,!0);return}else if(we.kind===yn){const Fe=no(we.group,we.bounds,we.localEventX,we.localEventY);if(Fe!==void 0){we.button===0&&Fe.onClick(we);return}}E(we,U)},[E,V,Ft,zn,no]);Nt("pointerup",vo,$t,!1);const Jr=s.useCallback(k=>{var Ht,de;const _=ze.current;if(_===null)return;const ce=V==null?void 0:V.current,le=k.target!==_&&k.target!==ce;let U,re,Te=!0;k instanceof MouseEvent?(U=k.clientX,re=k.clientY,Te=k.button<3):(U=k.changedTouches[0].clientX,re=k.changedTouches[0].clientY);const Ve=Ft(_,U,re,k);bt.current!==Ve.isTouch&&Qe(Ve.isTouch),!le&&k.cancelable&&Te&&k.preventDefault();const[we]=Ve.location;if(Ve.kind===Jn){const Ie=zn(_,we,U,re);Ie!==void 0&&Ve.button===0&&((Ht=Yn.current)==null?void 0:Ht[0])===we&&((de=Yn.current)==null?void 0:de[1])===-1&&(Ie.area==="menu"?b==null||b(we,Ie.bounds):Ie.area==="indicator"&&(x==null||x(we,Ie.bounds)))}},[V,Ft,zn,b,x]);Nt("click",Jr,$t,!1);const wr=s.useCallback(k=>{const _=ze.current,ce=V==null?void 0:V.current;if(_===null||k.target!==_&&k.target!==ce||Y===void 0)return;const le=Ft(_,k.clientX,k.clientY,k);Y(le,()=>{k.cancelable&&k.preventDefault()})},[V,Ft,Y]);Nt("contextmenu",wr,(V==null?void 0:V.current)??null,!1);const xe=s.useCallback(k=>{st.current=new lr(k.map(_=>_.item)),Yt.current=k,On.current(),st.current=void 0},[]),Xo=s.useMemo(()=>new zc(xe),[xe]),br=s.useRef(Xo);br.current=Xo,s.useLayoutEffect(()=>{const k=br.current;if(Fn===void 0||Fn[1]<0){k.setHovered(Fn);return}const _=w(Fn,!0),ce=_e(_),le=ce===void 0&&_.kind===Z.Custom||(ce==null?void 0:ce.needsHover)!==void 0&&(typeof ce.needsHover=="boolean"?ce.needsHover:ce.needsHover(_));k.setHovered(le?Fn:void 0)},[w,_e,Fn]);const rn=s.useRef(),Qr=s.useCallback(k=>{var Ve;const _=ze.current;if(_===null)return;const ce=V==null?void 0:V.current,le=k.target!==_&&k.target!==ce,U=Ft(_,k.clientX,k.clientY,k);if(U.kind!=="out-of-bounds"&&le&&!Gn.current&&!U.isTouch)return;const re=(we,Ht)=>{In(de=>de===we||(de==null?void 0:de[0][0])===(we==null?void 0:we[0][0])&&(de==null?void 0:de[0][1])===(we==null?void 0:we[0][1])&&((de==null?void 0:de[1][0])===(we==null?void 0:we[1][0])&&(de==null?void 0:de[1][1])===(we==null?void 0:we[1][1])||!Ht)?de:we)};if(!cs(U,rn.current))qt(void 0),oe==null||oe(U),re(U.kind===Kr?void 0:[U.location,[U.localEventX,U.localEventY]],!0),rn.current=U;else if(U.kind==="cell"||U.kind===Jn||U.kind===yn){let we=!1,Ht=!0;if(U.kind==="cell"){const Ie=w(U.location);Ht=((Ve=_e(Ie))==null?void 0:Ve.needsHoverPosition)??Ie.kind===Z.Custom,we=Ht}else we=!0;const de=[U.location,[U.localEventX,U.localEventY]];re(de,Ht),Wn.current=de,we&&Nn(new lr([U.location]))}const Te=U.location[0]>=(ve?0:1);wt(U.kind===Jn&&U.isEdge&&Te&&et===!0),gr(U.kind==="cell"&&U.isFillHandle),ae==null||ae(k),q(U)},[V,Ft,ve,et,ae,q,oe,w,_e,Nn]);Nt("pointermove",Qr,$t,!0);const Cn=s.useCallback(k=>{const _=ze.current;if(_===null)return;let ce,le;P.current!==void 0&&(ce=Ue(_,P.current.cell[0],P.current.cell[1]),le=P.current.cell),ee==null||ee({bounds:ce,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:le})},[ee,P,Ue]),Yo=s.useCallback(k=>{const _=ze.current;if(_===null)return;let ce,le;P.current!==void 0&&(ce=Ue(_,P.current.cell[0],P.current.cell[1]),le=P.current.cell),K==null||K({bounds:ce,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:le})},[K,P,Ue]),yr=s.useCallback(k=>{if(ze.current=k,te!==void 0&&(te.current=k),pe!=null&&pe.eventTarget)dt.current=pe.eventTarget;else if(k===null)dt.current=window;else{const _=k.getRootNode();_===document&&(dt.current=window),dt.current=_}},[te,pe==null?void 0:pe.eventTarget]),pr=s.useCallback(k=>{const _=ze.current;if(_===null||Xe===!1||ne){k.preventDefault();return}let ce,le;const U=Ft(_,k.clientX,k.clientY);if(Xe!==!0&&U.kind!==Xe){k.preventDefault();return}const re=(Ie,We)=>{ce=Ie,le=We};let Te,Ve,we;const Ht=(Ie,We,Fe)=>{Te=Ie,Ve=We,we=Fe};let de=!1;if(ge==null||ge({...U,setData:re,setDragImage:Ht,preventDefault:()=>de=!0,defaultPrevented:()=>de}),!de&&ce!==void 0&&le!==void 0&&k.dataTransfer!==null)if(k.dataTransfer.setData(ce,le),k.dataTransfer.effectAllowed="copyLink",Te!==void 0&&Ve!==void 0&&we!==void 0)k.dataTransfer.setDragImage(Te,Ve,we);else{const[Ie,We]=U.location;if(We!==void 0){const Fe=document.createElement("canvas"),Pe=Ue(_,Ie,We);Qt(Pe!==void 0);const xt=Math.ceil(window.devicePixelRatio??1);Fe.width=Pe.width*xt,Fe.height=Pe.height*xt;const Dt=Fe.getContext("2d");Dt!==null&&(Dt.scale(xt,xt),Dt.textBaseline="middle",We===-1?(Dt.font=He.headerFontFull,Dt.fillStyle=He.bgHeader,Dt.fillRect(0,0,Fe.width,Fe.height),ss(Dt,0,0,Pe.width,Pe.height,ut[Ie],!1,He,!1,void 0,void 0,!1,0,vt,me,!1)):(Dt.font=He.baseFontFull,Dt.fillStyle=He.bgCell,Dt.fillRect(0,0,Fe.width,Fe.height),rs(Dt,w([Ie,We]),0,We,!1,!1,0,0,Pe.width,Pe.height,!1,He,He.bgCell,zt,vt,1,void 0,!1,0,void 0,void 0,void 0,ho,_e,()=>{}))),Fe.style.left="-100%",Fe.style.position="absolute",Fe.style.width=`${Pe.width}px`,Fe.style.height=`${Pe.height}px`,document.body.append(Fe),k.dataTransfer.setDragImage(Fe,Pe.width/2,Pe.height/2),window.setTimeout(()=>{Fe.remove()},0)}}else k.preventDefault()},[Xe,ne,Ft,ge,Ue,He,ut,vt,me,w,zt,ho,_e]);Nt("dragstart",pr,(V==null?void 0:V.current)??null,!1,!1);const Go=s.useRef(),ei=s.useCallback(k=>{const _=ze.current;if(be!==void 0&&k.preventDefault(),_===null||Re===void 0)return;const ce=Ft(_,k.clientX,k.clientY),[le,U]=ce.location,re=le-(ve?0:1),[Te,Ve]=Go.current??[];(Te!==re||Ve!==U)&&(Go.current=[re,U],Re([re,U],k.dataTransfer))},[ve,Ft,Re,be]);Nt("dragover",ei,(V==null?void 0:V.current)??null,!1,!1);const xn=s.useCallback(()=>{Go.current=void 0,Ge==null||Ge()},[Ge]);Nt("dragend",xn,(V==null?void 0:V.current)??null,!1,!1);const _n=s.useCallback(k=>{const _=ze.current;if(_===null||be===void 0)return;k.preventDefault();const ce=Ft(_,k.clientX,k.clientY),[le,U]=ce.location,re=le-(ve?0:1);be([re,U],k.dataTransfer)},[ve,Ft,be]);Nt("drop",_n,(V==null?void 0:V.current)??null,!1,!1);const ln=s.useCallback(()=>{je==null||je()},[je]);Nt("dragleave",ln,(V==null?void 0:V.current)??null,!1,!1);const D=s.useRef(P);D.current=P;const ft=s.useRef(null),Bn=s.useCallback(k=>{var _;ze.current===null||!ze.current.contains(document.activeElement)||(k===null&&D.current.current!==void 0?(_=te==null?void 0:te.current)==null||_.focus({preventScroll:!0}):k!==null&&k.focus({preventScroll:!0}),ft.current=k)},[te]);s.useImperativeHandle(t,()=>({focus:()=>{var _;const k=ft.current;k===null||!document.contains(k)?(_=te==null?void 0:te.current)==null||_.focus({preventScroll:!0}):k.focus({preventScroll:!0})},getBounds:(k,_)=>{if(!(te===void 0||te.current===null))return Ue(te.current,k??0,_??-1)},damage:hr,getMouseArgsForPosition:(k,_,ce)=>{if(!(te===void 0||te.current===null))return Ft(te.current,k,_,ce)}}),[te,hr,Ue,Ft]);const _o=s.useRef(),vr=sa(()=>{var Ve,we,Ht;if(n<50||(pe==null?void 0:pe.disableAccessibilityTree)===!0)return null;let k=Ri(ut,tt,n,Ee,Je);const _=ve?0:-1;!ve&&((Ve=k[0])==null?void 0:Ve.sourceIndex)===0&&(k=k.slice(1));const[ce,le]=((we=P.current)==null?void 0:we.cell)??[],U=(Ht=P.current)==null?void 0:Ht.range,re=k.map(de=>de.sourceIndex),Te=ao(l,Math.min(m,l+r));return ce!==void 0&&le!==void 0&&!(re.includes(ce)&&Te.includes(le))&&Bn(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":ut.length+_},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},k.map(de=>s.createElement("th",{role:"columnheader","aria-selected":P.columns.hasIndex(de.sourceIndex),"aria-colindex":de.sourceIndex+1+_,tabIndex:-1,onFocus:Ie=>{if(Ie.target!==ft.current)return Se==null?void 0:Se([de.sourceIndex,-1])},key:de.sourceIndex},de.title)))),s.createElement("tbody",{role:"rowgroup"},Te.map(de=>s.createElement("tr",{role:"row","aria-selected":P.rows.hasIndex(de),key:de,"aria-rowindex":de+2},k.map(Ie=>{const We=Ie.sourceIndex,Fe=pn(We,de),Pe=ce===We&&le===de,xt=U!==void 0&&We>=U.x&&We<U.x+U.width&&de>=U.y&&de<U.y+U.height,Dt=`glide-cell-${We}-${de}`,sn=[We,de],kt=w(sn,!0);return s.createElement("td",{key:Fe,role:"gridcell","aria-colindex":We+1+_,"aria-selected":xt,"aria-readonly":Ho(kt)||!Fo(kt),id:Dt,"data-testid":Dt,onClick:()=>{const St=te==null?void 0:te.current;if(St!=null)return ee==null?void 0:ee({bounds:Ue(St,We,de),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:sn})},onFocusCapture:St=>{var hn,rt;if(!(St.target===ft.current||((hn=_o.current)==null?void 0:hn[0])===We&&((rt=_o.current)==null?void 0:rt[1])===de))return _o.current=sn,Se==null?void 0:Se(sn)},ref:Pe?Bn:void 0,tabIndex:-1},Wc(kt,_e))})))))},[n,ut,tt,Ee,Je,m,l,r,P,Bn,w,te,ee,Ue,Se],200),Co=W===0||!$?0:tt>W?1:dn(-Je/100,0,1),ti=-l*32+pt,Ko=N?dn(-ti/100,0,1):0,B=s.useMemo(()=>{if(!Co&&!Ko)return null;const k={position:"absolute",top:0,left:Lo,width:n-Lo,height:o,opacity:Co,pointerEvents:"none",transition:Ze?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},_={position:"absolute",top:on,left:0,width:n,height:o,opacity:Ko,pointerEvents:"none",transition:ie?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Co>0&&s.createElement("div",{id:"shadow-x",style:k}),Ko>0&&s.createElement("div",{id:"shadow-y",style:_}))},[Co,Ko,Lo,n,Ze,on,o,ie]),Lt=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Cn,onKeyUp:Yo,onFocus:M,onBlur:X,ref:yr,style:at},vr),s.createElement("canvas",{ref:De,style:Lt}),B)},Oc=s.memo(s.forwardRef($c));function or(e,t,n,o){return dn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Nc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,c]=s.useState(),[f,u]=s.useState(!1),[g,m]=s.useState(),[w,h]=s.useState(),[b,x]=s.useState(),[C,y]=s.useState(!1),[M,X]=s.useState(),{onHeaderMenuClick:L,onHeaderIndicatorClick:P,getCellContent:W,onColumnMoved:Y,onColumnResize:S,onColumnResizeStart:$,onColumnResizeEnd:N,gridRef:z,maxColumnWidth:I,minColumnWidth:E,onRowMoved:ae,lockColumns:q,onColumnProposeMove:oe,onMouseDown:Ee,onMouseUp:ve,onItemHovered:ee,onDragStart:K,canvasRef:Ce}=e,te=(S??N??$)!==void 0,{columns:ge,selection:Ge}=e,V=Ge.columns,ne=s.useCallback(j=>{const[me,Se]=j.location;i!==void 0&&l!==me&&me>=q?(u(!0),c(me)):w!==void 0&&Se!==void 0?(y(!0),x(Math.max(0,Se))):o===void 0&&!f&&!C&&(ee==null||ee(j))},[i,w,l,ee,q,o,f,C]),he=Y!==void 0,Le=s.useCallback(j=>{var me;if(j.button===0){const[Se,Re]=j.location;if(j.kind==="out-of-bounds"&&j.isEdge&&te){const be=(me=z==null?void 0:z.current)==null?void 0:me.getBounds(ge.length-1,-1);be!==void 0&&(n(be.x),r(ge.length-1))}else if(j.kind==="header"&&Se>=q){const be=Ce==null?void 0:Ce.current;if(j.isEdge&&te&&be){n(j.bounds.x),r(Se);const Ye=be.getBoundingClientRect().width/be.offsetWidth,Ze=j.bounds.width/Ye;$==null||$(ge[Se],Ze,Se,Ze+(ge[Se].growOffset??0))}else j.kind==="header"&&he&&(m(j.bounds.x),a(Se))}else j.kind==="cell"&&q>0&&Se===0&&Re!==void 0&&ae!==void 0&&(X(j.bounds.y),h(Re))}Ee==null||Ee(j)},[Ee,te,q,ae,z,ge,he,$,Ce]),Xe=s.useCallback((j,me)=>{f||C||L==null||L(j,me)},[f,C,L]),et=s.useCallback((j,me)=>{f||C||P==null||P(j,me)},[f,C,P]),ot=s.useRef(-1),Me=s.useCallback(()=>{ot.current=-1,h(void 0),x(void 0),X(void 0),y(!1),a(void 0),c(void 0),m(void 0),u(!1),r(void 0),n(void 0)},[]),Ae=s.useCallback((j,me)=>{if(j.button===0){if(o!==void 0){if((V==null?void 0:V.hasIndex(o))===!0)for(const Re of V){if(Re===o)continue;const be=ge[Re],je=or(be,ot.current,E,I);S==null||S(be,je,Re,je+(be.growOffset??0))}const Se=or(ge[o],ot.current,E,I);if(N==null||N(ge[o],Se,o,Se+(ge[o].growOffset??0)),V.hasIndex(o))for(const Re of V){if(Re===o)continue;const be=ge[Re],je=or(be,ot.current,E,I);N==null||N(be,je,Re,je+(be.growOffset??0))}}Me(),i!==void 0&&l!==void 0&&(oe==null?void 0:oe(i,l))!==!1&&(Y==null||Y(i,l)),w!==void 0&&b!==void 0&&(ae==null||ae(w,b))}ve==null||ve(j,me)},[ve,o,i,l,w,b,V,N,ge,E,I,S,Y,ae,Me,oe]),He=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(oe==null?void 0:oe(i,l))!==!1)return{src:i,dest:l}},[i,l,oe]),ht=s.useCallback(j=>{const me=Ce==null?void 0:Ce.current;if(i!==void 0&&g!==void 0)Math.abs(j.clientX-g)>20&&u(!0);else if(w!==void 0&&M!==void 0)Math.abs(j.clientY-M)>20&&y(!0);else if(o!==void 0&&t!==void 0&&me){const Re=me.getBoundingClientRect().width/me.offsetWidth,be=(j.clientX-t)/Re,je=ge[o],Ye=or(je,be,E,I);if(S==null||S(je,Ye,o,Ye+(je.growOffset??0)),ot.current=be,(V==null?void 0:V.first())===o)for(const Ze of V){if(Ze===o)continue;const ie=ge[Ze],pe=or(ie,ot.current,E,I);S==null||S(ie,pe,Ze,pe+(ie.growOffset??0))}}},[i,g,w,M,o,t,ge,E,I,S,V,Ce]),gt=s.useCallback((j,me)=>{if(w===void 0||b===void 0)return W(j,me);let[Se,Re]=j;return Re===b?Re=w:(Re>b&&(Re-=1),Re>=w&&(Re+=1)),W([Se,Re],me)},[w,b,W]),lt=s.useCallback(j=>{K==null||K(j),j.defaultPrevented()||Me()},[Me,K]);return s.createElement(Oc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:gt,isResizing:o!==void 0,onHeaderMenuClick:Xe,onHeaderIndicatorClick:et,isDragging:f,onItemHovered:ne,onDragStart:lt,onMouseDown:Le,allowResize:te,onMouseUp:Ae,dragAndDropState:He,onMouseMoveRaw:ht,ref:z})};function Xc(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Yc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const f=()=>{var m,w;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((m=i.current)==null?void 0:m[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=m=>{m.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const m=c;return m.addEventListener("touchstart",u),m.addEventListener("touchend",g),()=>{m.removeEventListener("touchstart",u),m.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Gc=()=>e=>e.isSafari?"scroll":"auto",_c=tn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Gc()]}}),Kc=33554400,Uc=5e6;function Vc(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Nt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Nt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const qc=e=>{var Ge,V;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:g,rightElementProps:m,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,x=[],C=(m==null?void 0:m.sticky)??!1,y=(m==null?void 0:m.fill)??!1,M=s.useRef(0),X=s.useRef(0),L=s.useRef(null),P=typeof window>"u"?1:window.devicePixelRatio,W=s.useRef(P);s.useEffect(()=>{if(W.current!==P){M.current=0,X.current=0,W.current=P;const ne=L.current;ne!==null&&ae.current(ne.scrollLeft,ne.scrollTop)}},[P]);const Y=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),S=s.useRef(null),$=Vc(200),[N,z]=s.useState(!0),I=s.useRef(0);s.useLayoutEffect(()=>{if(!N||$||Y.current.lockDirection===void 0)return;const ne=L.current;if(ne===null)return;const[he,Le]=Y.current.lockDirection;he!==void 0?ne.scrollLeft=he:Le!==void 0&&(ne.scrollTop=Le),Y.current.lockDirection=void 0},[$,N]);const E=s.useCallback((ne,he)=>{var Se;const Le=L.current;if(Le===null)return;he=he??Le.scrollTop,ne=ne??Le.scrollLeft;const Xe=Y.current.scrollTop,et=Y.current.scrollLeft,ot=ne-et,Me=he-Xe;$&&ot!==0&&Me!==0&&(Math.abs(ot)>3||Math.abs(Me)>3)&&c&&Y.current.lockDirection===void 0&&(Y.current.lockDirection=Math.abs(ot)<Math.abs(Me)?[et,void 0]:[void 0,Xe]);const Ae=Y.current.lockDirection;ne=(Ae==null?void 0:Ae[0])??ne,he=(Ae==null?void 0:Ae[1])??he,Y.current.scrollLeft=ne,Y.current.scrollTop=he;const He=Le.clientWidth,ht=Le.clientHeight,gt=he,lt=X.current-gt,j=Le.scrollHeight-ht;X.current=gt;let me;if(j>0&&o>Le.scrollHeight+5)if(Math.abs(lt)>2e3||gt===0||gt===j){const Re=Math.max(0,Math.min(1,gt/j)),be=o-ht;me=Re*be,M.current=me}else M.current-=lt,me=M.current;else me=gt,M.current=me;me=Math.max(0,Math.min(me,o-ht)),M.current=me,Ae!==void 0&&(window.clearTimeout(I.current),z(!1),I.current=window.setTimeout(()=>z(!0),200)),i({x:ne,y:me,width:He-u,height:ht-f,paddingRight:((Se=S.current)==null?void 0:Se.clientWidth)??0})},[f,u,o,i,c,$]);Yc(w&&Gr.value,E,L);const ae=s.useRef(E);ae.current=E;const q=s.useRef(),oe=s.useRef(!1);s.useLayoutEffect(()=>{oe.current?E():oe.current=!0},[E,f,u]);const Ee=s.useCallback(ne=>{L.current=ne,h!==void 0&&(h.current=ne)},[h]);let ve=0,ee=0;const K=Math.min(o,Kc);for(x.push(s.createElement("div",{key:ve++,style:{width:r,height:0}}));ee<K;){const ne=Math.min(Uc,K-ee);x.push(s.createElement("div",{key:ve++,style:{width:0,height:ne}})),ee+=ne}const{ref:Ce,width:te,height:ge}=Xc(b);return typeof window<"u"&&(((Ge=q.current)==null?void 0:Ge.height)!==ge||((V=q.current)==null?void 0:V.width)!==te)&&(window.setTimeout(()=>ae.current(),0),q.current={width:te,height:ge}),(te??0)===0||(ge??0)===0?s.createElement("div",{ref:Ce}):s.createElement("div",{ref:Ce},s.createElement(_c,{isSafari:Gr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:Ee,style:q.current,draggable:a,onDragStart:ne=>{a||(ne.stopPropagation(),ne.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>E()},s.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),g!==void 0&&s.createElement(s.Fragment,null,!y&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:S,style:{height:ge,maxHeight:n-Math.ceil(P%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:y?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},g))))))},jc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:g,onVisibleRegionChanged:m,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:x,overscrollX:C,overscrollY:y,initialSize:M,smoothScrollX:X=!1,smoothScrollY:L=!1,isDraggable:P}=e,{paddingRight:W,paddingBottom:Y}=c??{},[S,$]=u,N=s.useRef(),z=s.useRef(),I=s.useRef(),E=s.useRef(),ae=f+Math.max(0,C??0);let q=a?r+i:r;if(typeof o=="number")q+=n*o;else for(let ee=0;ee<n;ee++)q+=o(ee);y!==void 0&&(q+=y);const oe=s.useRef(),Ee=s.useCallback(()=>{var et,ot;if(oe.current===void 0)return;const ee={...oe.current};let K=0,Ce=ee.x<0?-ee.x:0,te=0,ge=0;ee.x=ee.x<0?0:ee.x;let Ge=0;for(let Me=0;Me<l;Me++)Ge+=t[Me].width;for(const Me of t){const Ae=K-Ge;if(ee.x>=Ae+Me.width)K+=Me.width,ge++,te++;else if(ee.x>Ae)K+=Me.width,X?Ce+=Ae-ee.x:ge++,te++;else if(ee.x+ee.width>Ae)K+=Me.width,te++;else break}let V=0,ne=0,he=0;if(typeof o=="number")L?(ne=Math.floor(ee.y/o),V=ne*o-ee.y):ne=Math.ceil(ee.y/o),he=Math.ceil(ee.height/o)+ne,V<0&&he++;else{let Me=0;for(let Ae=0;Ae<n;Ae++){const He=o(Ae),ht=Me+(L?0:He/2);if(ee.y>=Me+He)Me+=He,ne++,he++;else if(ee.y>ht)Me+=He,L?V+=ht-ee.y:ne++,he++;else if(ee.y+ee.height>He/2+Me)Me+=He,he++;else break}}ne=Math.max(0,Math.min(ne,n-1)),he=Math.max(ne,Math.min(he,n));const Le={x:ge,y:ne,width:te-ge,height:he-ne},Xe=N.current;(Xe===void 0||Xe.y!==Le.y||Xe.x!==Le.x||Xe.height!==Le.height||Xe.width!==Le.width||z.current!==Ce||I.current!==V||ee.width!==((et=E.current)==null?void 0:et[0])||ee.height!==((ot=E.current)==null?void 0:ot[1]))&&(m==null||m({x:ge,y:ne,width:te-ge,height:he-ne},ee.width,ee.height,ee.paddingRight??0,Ce,V),N.current=Le,z.current=Ce,I.current=V,E.current=[ee.width,ee.height])},[t,o,n,m,l,X,L]),ve=s.useCallback(ee=>{oe.current=ee,Ee()},[Ee]);return s.useEffect(()=>{Ee()},[Ee]),s.createElement(qc,{scrollRef:w,className:g,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:P===!0||typeof P=="string",scrollWidth:ae+(W??0),scrollHeight:q+(Y??0),clientHeight:$,rightElement:b,paddingBottom:Y,paddingRight:W,rightElementProps:x,update:ve,initialSize:M},s.createElement(Nc,{eventTargetRef:w,width:S,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Zc=tn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Jc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Qc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),ed=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),td=10,nd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:g=!1,onSearchClose:m}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),x=a??h,C=s.useCallback(K=>{b(K),c==null||c(K)},[c]),[y,M]=s.useState(),X=s.useRef(y);X.current=y,s.useEffect(()=>{l!==void 0&&(l.length>0?M(K=>({rowsSearched:o,results:l.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):M(void 0))},[o,l]);const L=s.useRef();L.current===void 0&&(L.current=new AbortController);const P=s.useRef(),[W,Y]=s.useState([]),S=l??W,$=s.useCallback(()=>{P.current!==void 0&&(window.cancelAnimationFrame(P.current),P.current=void 0),L.current!==void 0&&L.current.abort(),L.current=new AbortController},[]),N=s.useRef(n);N.current=n;const z=s.useCallback(K=>{const Ce=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let te=N.current,ge=Math.min(10,o),Ge=0;M(void 0),Y([]);const V=[],ne=async()=>{var gt;if(f===void 0)return;const he=performance.now(),Le=o-Ge;let Xe=f({x:0,y:te,width:r.length,height:Math.min(ge,Le,o-te)},L.current.signal);typeof Xe=="function"&&(Xe=await Xe());let et=!1;for(const[lt,j]of Xe.entries())for(const[me,Se]of j.entries()){let Re;switch(Se.kind){case Z.Text:case Z.Number:Re=Se.displayData;break;case Z.Uri:case Z.Markdown:Re=Se.data;break;case Z.Boolean:Re=typeof Se.data=="boolean"?Se.data.toString():void 0;break;case Z.Image:case Z.Bubble:Re=Se.data.join("🐳");break;case Z.Custom:Re=Se.copyData;break}Re!==void 0&&Ce.test(Re)&&(V.push([me,lt+te]),et=!0)}const ot=performance.now();et&&Y([...V]),Ge+=Xe.length,Qt(Ge<=o);const Me=((gt=X.current)==null?void 0:gt.selectedIndex)??-1;M({results:V.length,rowsSearched:Ge,selectedIndex:Me}),u==null||u(V,Me),te+ge>=o?te=0:te+=ge;const Ae=ot-he,He=Math.max(Ae,1),ht=td/He;ge=Math.ceil(ge*ht),Ge<o&&V.length<1e3&&(P.current=window.requestAnimationFrame(ne))};$(),P.current=window.requestAnimationFrame(ne)},[$,r.length,f,u,o]),I=s.useCallback(()=>{var K;m==null||m(),M(void 0),Y([]),u==null||u([],-1),$(),(K=t==null?void 0:t.current)==null||K.focus()},[$,t,m,u]),E=s.useCallback(K=>{C(K.target.value),l===void 0&&(K.target.value===""?(M(void 0),Y([]),$()):z(K.target.value))},[z,$,C,l]);s.useEffect(()=>{i.current!==null&&(C(""),M(void 0),W.length>0&&(Y([]),u==null||u([],-1)),g?i.current.focus({preventScroll:!0}):$())},[g,i]);const ae=s.useCallback(K=>{var te;if((te=K==null?void 0:K.stopPropagation)==null||te.call(K),y===void 0||y.results===0)return;const Ce=(y.selectedIndex+1)%y.results;M({...y,selectedIndex:Ce}),u==null||u(S,Ce)},[y,u,S]),q=s.useCallback(K=>{var te;if((te=K==null?void 0:K.stopPropagation)==null||te.call(K),y===void 0||y.results===0)return;let Ce=(y.selectedIndex-1)%y.results;Ce<0&&(Ce+=y.results),M({...y,selectedIndex:Ce}),u==null||u(S,Ce)},[u,S,y]),oe=s.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(I(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?q():ae())},[I,ae,q]);s.useEffect(()=>()=>{$()},[$]);const[Ee,ve]=s.useState(!1);s.useEffect(()=>{if(g)ve(!0);else{const K=setTimeout(()=>ve(!1),150);return()=>clearTimeout(K)}},[g]);const ee=s.useMemo(()=>{if(!g&&!Ee)return null;let K;y!==void 0&&(K=y.results>=1e3?"over 1000":`${y.results} result${y.results!==1?"s":""}`,y.selectedIndex>=0&&(K=`${y.selectedIndex+1} of ${K}`));const Ce=Ge=>{Ge.stopPropagation()},ge={width:`${o>0?Math.floor(((y==null?void 0:y.rowsSearched)??0)/o*100):0}%`};return s.createElement(Zc,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:Ce,onMouseMove:Ce,onMouseUp:Ce,onClick:Ce},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:E,value:x,tabIndex:g?void 0:-1,onKeyDownCapture:oe}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:q,disabled:((y==null?void 0:y.results)??0)===0},Jc),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:ae,disabled:((y==null?void 0:y.results)??0)===0},Qc),m!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:I},ed)),y!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},K)),s.createElement("div",{className:"gdg-search-progress",style:ge})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[g,Ee,y,o,w,i,E,x,oe,q,ae,m,I]);return s.createElement(s.Fragment,null,s.createElement(jc,{prelightCells:S,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ee)};class od extends s.PureComponent{constructor(){super(...arguments);$e(this,"wrapperRef",s.createRef());$e(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const rd=()=>e=>Math.max(16,e.targetHeight-10),id=tn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[rd(),"px"]}}),ld=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=Mt.useState(n);return Mt.createElement(od,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Mt.createElement(id,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function sd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Oe(e,t,n){const o=ds(e,t);return o&&(n.didMatch=!0),o}function ds(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(ds(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!sd(l,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":_r.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function ad(e,t,n,o,r,i,a){const l=Mt.useCallback((u,g,m,w)=>{var M;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=(n==="mixed"||n==="additive")&&(m||w==="drag"),b=(o==="mixed"||o==="additive")&&h,x=(r==="mixed"||r==="additive")&&h;let C={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((M=e.current)==null?void 0:M.rangeStack)??[]:[]},columns:b?e.columns:it.empty(),rows:x?e.rows:it.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,g)},[o,e,n,i,a,r,t]),c=Mt.useCallback((u,g,m)=>{u=u??e.rows,g!==void 0&&(u=u.add(g));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:it.empty(),rows:u};else{const h=m&&n==="mixed"||n==="additive",b=m&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:b?e.columns:it.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=Mt.useCallback((u,g,m)=>{u=u??e.columns,g!==void 0&&(u=u.add(g));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:it.empty(),columns:u};else{const h=m&&n==="mixed"||n==="additive",b=m&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:b?e.rows:it.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,c,f]}function cd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let g=f.y;g<f.y+f.height;g++){const m=[];for(let w=f.x;w<f.x+f.width;w++)w<0||g>=r?m.push({kind:Z.Loading,allowOverlay:!1}):m.push(t([w,g]));u.push(m)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const g=a(u,o.signal);return typeof g=="function"?async()=>(await g()).map(m=>[{kind:Z.Loading,allowOverlay:!1},...m]):g.map(m=>[{kind:Z.Loading,allowOverlay:!1},...m])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function dd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case Z.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Hi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case Z.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case Z.Image:case Z.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case Z.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case Z.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case Z.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case Z.Markdown:case Z.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case Z.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case Z.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case Z.Protected:return{formatted:"************",rawValue:"",format:"string"};default:sr()}}function ud(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:dd(a))})}function xl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function fd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>xl(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:xl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ci(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function kl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function hd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function gd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ci(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${kl(r.rawValue[l])}>`+Ci(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${kl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ci(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function md(e,t){const n=ud(e,t),o=fd(n),r=gd(n);return{textPlain:o,textHtml:r}}function Sl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=c.querySelectorAll("br");for(const b of m)b.replaceWith(`
`);const w=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const b=c.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...b].map(x=>x.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:hd(w),formatted:c.textContent??"",format:h});else{let b=c.textContent??"";g&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function wd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const m=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m);const w=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const m=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}let u=c.x-n,g=c.x+c.width-1-n;for(const m of f)for(const w of m)w.span!==void 0&&(u=Math.min(w.span[0],u),g=Math.max(w.span[1],g));u===c.x-n&&g===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:g-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Ml(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function bd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Ml(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Ml(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Rl(e,t,n){var l;const o=md(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(c,f)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function us(e){return e!==!0}function El(e){return typeof e=="string"?e:`${e}px`}const yd=()=>e=>e.innerWidth,pd=()=>e=>e.innerHeight,vd=tn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[yd()],"wmyidgi-1":[pd()]}}),Cd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(vd,{innerHeight:El(n),innerWidth:El(t),...r},o)},xd=2,kd=1300;function Sd(e,t,n){const o=Mt.useRef(0),[r,i]=e??[0,0];Mt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const c=f=>{var u;if(!a){if(l===0)l=f;else{const g=f-l;o.current=Math.min(1,o.current+g/kd);const m=o.current**1.618*g*xd;(u=t.current)==null||u.scrollBy(r*m,i*m),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function Md({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[c,f,u,g,m,w]=Mt.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,x=jl();return[typeof b=="number"?b*h:C=>Math.ceil(b(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,a,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:g,overscrollX:m,overscrollY:w}}const jn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Ne(e,t){return e===!0?t:e===!1?"":e}function Il(e){const t=_r.value;return{activateCell:Ne(e.activateCell," |Enter|shift+Enter"),clear:Ne(e.clear,"any+Escape"),closeOverlay:Ne(e.closeOverlay,"any+Escape"),acceptOverlayDown:Ne(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Ne(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Ne(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Ne(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Ne(e.delete,t?"Backspace|Delete":"Delete"),downFill:Ne(e.downFill,"primary+_68"),scrollToSelectedCell:Ne(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Ne(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Ne(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Ne(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Ne(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Ne(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Ne(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Ne(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Ne(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Ne(e.goToFirstCell,"primary+Home"),goToFirstColumn:Ne(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Ne(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Ne(e.goToLastCell,"primary+End"),goToLastColumn:Ne(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Ne(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Ne(e.goToNextPage,"PageDown"),goToPreviousPage:Ne(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Ne(e.rightFill,"primary+_82"),search:Ne(e.search,"primary+f"),selectAll:Ne(e.selectAll,"primary+a"),selectColumn:Ne(e.selectColumn,"ctrl+ "),selectGrowDown:Ne(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Ne(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Ne(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Ne(e.selectGrowUp,"shift+ArrowUp"),selectRow:Ne(e.selectRow,"shift+ "),selectToFirstCell:Ne(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Ne(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Ne(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Ne(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Ne(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Ne(e.selectToLastRow,"primary+shift+ArrowDown")}}function Rd(e){const t=fa(e);return Mt.useMemo(()=>{if(t===void 0)return Il(jn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??jn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??jn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??jn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??jn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??jn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??jn.selectToLastCell};return Il({...jn,...n})},[t])}function Ed(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Oi(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let g=0;g<l.subGroups.length;g++){const m=g<l.subGroups.length-1?l.subGroups[g+1].headerIndex:c;o(l.subGroups[g],m,f||l.isCollapsed)}}const r=Ed(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function Fi(e,t){if(t===void 0||Oi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Id(e,t,n,o){const r=Mt.useMemo(()=>e===void 0?void 0:Oi(e,t),[e,t]),i=Mt.useMemo(()=>r==null?void 0:r.reduce((u,g)=>(u[g.rowIndex]=g,u),{}),[r]),a=Mt.useMemo(()=>r===void 0?t:r.reduce((u,g)=>u+(g.isCollapsed?1:g.rows+1),0),[r,t]),l=Mt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=Mt.useCallback(u=>{if(r===void 0)return u;let g=u;for(const m of r){if(g===0)return;if(g--,!m.isCollapsed){if(g<m.rows)return m.contentIndex+g;g-=m.rows}}return u},[r]),f=Zn(o??(e==null?void 0:e.themeOverride),Mt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:m,groupIndex:w}=Fi(u,r);return g?e.themeOverride:o==null?void 0:o(u,w,m)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:a,rowNumberMapper:c,getRowThemeOverride:f}}function Dd(e,t){const n=Mt.useMemo(()=>e===void 0?void 0:Oi(e,t),[e,t]);return{getRowGroupingForPath:hs,updateRowGroupingByPath:fs,mapper:Mt.useCallback(o=>{if(typeof o=="number")return Fi(o,n);const r=Fi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function fs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:fs(i.subGroups??[],r,n)}:i)}function hs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:hs(e[n].subGroups??[],o)}function Fd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Hd(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[c,f,u]=ua(l),g=s.useRef(r);g.current=r;const m=Fd(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&m.current!==null&&w){if(m.current.scrollTop===t)return;m.current.scrollTop=t,m.current.scrollTop!==t&&u(),g.current()}},[t,w,u,m]);const h=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&m.current!==null&&h){if(m.current.scrollLeft===e)return;m.current.scrollLeft=e,m.current.scrollLeft!==e&&u(),g.current()}},[e,h,u,m]),{visibleRegion:c,setVisibleRegion:f,scrollRef:m}}const Td=s.lazy(async()=>await Tl(()=>import("./data-grid-overlay-editor-Cn1soC9a.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let Ad=0;function zd(e){return ea(rl(rl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return ao((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Lr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Wr={kind:Z.Loading,allowOverlay:!1},$r={columns:it.empty(),rows:it.empty(),current:void 0},Pd=(e,t)=>{var tl,nl,ol;const[n,o]=s.useState($r),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[c,f]=s.useState(),u=s.useRef(),g=typeof window>"u"?null:window,{imageEditorOverride:m,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:x,columns:C,rows:y,getCellContent:M,onCellClicked:X,onCellActivated:L,onFillPattern:P,onFinishedEditing:W,coercePasteValue:Y,drawHeader:S,drawCell:$,editorBloom:N,onHeaderClicked:z,onColumnProposeMove:I,rangeSelectionColumnSpanning:E=!0,spanRangeBehavior:ae="default",onGroupHeaderClicked:q,onCellContextMenu:oe,className:Ee,onHeaderContextMenu:ve,getCellsForSelection:ee,onGroupHeaderContextMenu:K,onGroupHeaderRenamed:Ce,onCellEdited:te,onCellsEdited:ge,onSearchResultsChanged:Ge,searchResults:V,onSearchValueChange:ne,searchValue:he,onKeyDown:Le,onKeyUp:Xe,keybindings:et,editOnType:ot=!0,onRowAppended:Me,onColumnAppended:Ae,onColumnMoved:He,validateCell:ht,highlightRegions:gt,rangeSelect:lt="rect",columnSelect:j="multi",rowSelect:me="multi",rangeSelectionBlending:Se="exclusive",columnSelectionBlending:Re="exclusive",rowSelectionBlending:be="exclusive",onDelete:je,onDragStart:Ye,onMouseMove:Ze,onPaste:ie,copyHeaders:pe=!1,freezeColumns:_e=0,cellActivationBehavior:Ke="second-click",rowSelectionMode:Je="auto",onHeaderMenuClick:pt,onHeaderIndicatorClick:tt,getGroupDetails:ze,rowGrouping:dt,onSearchClose:$t,onItemHovered:zt,onSelectionCleared:st,showSearch:Xt,onVisibleRegionChanged:It,gridSelection:Yt,onGridSelectionChange:vn,minColumnWidth:mt=50,maxColumnWidth:In=500,maxColumnAutoWidth:fn,provideEditor:wt,trailingRowOptions:De,freezeTrailingRows:Bt=0,allowedFillDirections:qt="orthogonal",scrollOffsetX:nn,scrollOffsetY:Qe,verticalBorder:bt,onDragOverCell:vt,onDrop:on,onColumnResize:Tt,onColumnResizeEnd:Gt,onColumnResizeStart:Dn,customRenderers:ut,fillHandle:Lo,experimental:Ue,fixedShadowX:Ft,fixedShadowY:Fn,headerIcons:ur,imageWindowLoader:Wn,initialSize:Hn,isDraggable:Tn,onDragLeave:ho,onRowMoved:$n,overscrollX:fr,overscrollY:go,preventDiagonalScrolling:mo,rightElement:wo,rightElementProps:bo,trapFocus:On=!1,smoothScrollX:Nn,smoothScrollY:qr,scaleToRem:hr=!1,rowHeight:jr=34,headerHeight:gr=36,groupHeaderHeight:An=gr,theme:Xn,isOutsideClick:Zr,renderers:Wo,resizeIndicator:mr,scrollToActiveCell:$o=!0,drawFocusRing:to=!0,portalElementRef:Ni}=e,Oo=to==="no-editor"?r===void 0:to,at=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,_t=(at==null?void 0:at.kind)??e.rowMarkers??"none",No=(at==null?void 0:at.width)??e.rowMarkerWidth,no=(at==null?void 0:at.startIndex)??e.rowMarkerStartIndex??1,zn=(at==null?void 0:at.theme)??e.rowMarkerTheme,yo=at==null?void 0:at.headerTheme,Yn=at==null?void 0:at.headerAlwaysVisible,Gn=me!=="multi"||(at==null?void 0:at.headerDisabled)===!0,po=(at==null?void 0:at.checkboxStyle)??"square",Pn=Math.max(mt,20),vo=Math.max(In,Pn),Jr=Math.max(fn??vo,Pn),wr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:xe,rowNumberMapper:Xo,rowHeight:br,getRowThemeOverride:rn}=Id(dt,y,jr,w),Qr=s.useMemo(()=>Number.parseFloat(wr.fontSize),[wr]),{rowHeight:Cn,headerHeight:Yo,groupHeaderHeight:yr,theme:pr,overscrollX:Go,overscrollY:ei}=Md({groupHeaderHeight:An,headerHeight:gr,overscrollX:fr,overscrollY:go,remSize:Qr,rowHeight:br,scaleToRem:hr,theme:Xn}),xn=Rd(et),_n=No??(y>1e4?48:y>1e3?44:y>100?36:32),ln=_t!=="none",D=ln?1:0,ft=De!==void 0,Bn=(De==null?void 0:De.sticky)===!0,[_o,vr]=s.useState(!1),Co=Xt??_o,ti=s.useCallback(()=>{$t!==void 0?$t():vr(!1)},[$t]),B=s.useMemo(()=>Yt===void 0?void 0:Lr(Yt,D),[Yt,D])??n,Lt=s.useRef();Lt.current===void 0&&(Lt.current=new AbortController),s.useEffect(()=>()=>Lt==null?void 0:Lt.current.abort(),[]);const[k,_]=cd(ee,M,D,Lt.current,xe),ce=s.useCallback((d,p,v)=>{if(ht===void 0)return!0;const R=[d[0]-D,d[1]];return ht==null?void 0:ht(R,p,v)},[D,ht]),le=s.useRef(Yt),U=s.useCallback((d,p)=>{p&&(d=wd(d,k,D,ae,Lt.current)),vn!==void 0?(le.current=Lr(d,-D),vn(le.current)):o(d)},[vn,k,D,ae]),re=Zn(Tt,s.useCallback((d,p,v,R)=>{Tt==null||Tt(C[v-D],p,v-D,R)},[Tt,D,C])),Te=Zn(Gt,s.useCallback((d,p,v,R)=>{Gt==null||Gt(C[v-D],p,v-D,R)},[Gt,D,C])),Ve=Zn(Dn,s.useCallback((d,p,v,R)=>{Dn==null||Dn(C[v-D],p,v-D,R)},[Dn,D,C])),we=Zn(S,s.useCallback((d,p)=>(S==null?void 0:S({...d,columnIndex:d.columnIndex-D},p))??!1,[S,D])),Ht=Zn($,s.useCallback((d,p)=>($==null?void 0:$({...d,col:d.col-D},p))??!1,[$,D])),de=s.useCallback(d=>{if(je!==void 0){const p=je(Lr(d,-D));return typeof p=="boolean"?p:Lr(p,D)}return!0},[je,D]),[Ie,We,Fe]=ad(B,U,Se,Re,be,lt,E),Pe=s.useMemo(()=>Ln(jl(),pr),[pr]),[xt,Dt]=s.useState([0,0,0]),sn=s.useMemo(()=>{if(Wo===void 0)return{};const d={};for(const p of Wo)d[p.kind]=p;return d},[Wo]),kt=s.useCallback(d=>d.kind!==Z.Custom?sn[d.kind]:ut==null?void 0:ut.find(p=>p.isMatch(d)),[ut,sn]);let{sizedColumns:St,nonGrowWidth:hn}=La(C,xe,_,xt[0]-(D===0?0:_n)-xt[2],Pn,Jr,Pe,kt,Lt.current);_t!=="none"&&(hn+=_n);const rt=s.useMemo(()=>St.some(d=>d.group!==void 0),[St]),Kt=rt?Yo+yr:Yo,jt=B.rows.length,xo=_t==="none"?void 0:jt===0?!1:jt===xe?!0:void 0,Be=s.useMemo(()=>_t==="none"?St:[{title:"",width:_n,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zn,rowMarker:po,rowMarkerChecked:xo,headerRowMarkerTheme:yo,headerRowMarkerAlwaysVisible:Yn,headerRowMarkerDisabled:Gn},...St],[_t,St,_n,zn,po,xo,yo,Yn,Gn]),At=s.useRef({height:1,width:1,x:0,y:0}),gn=s.useRef(!1),{setVisibleRegion:Uo,visibleRegion:Zt,scrollRef:ct}=Hd(nn,Qe,Cn,At,()=>gn.current=!0);At.current=Zt;const ni=Zt.x+D,Cr=Zt.y,Pt=s.useRef(null),Ot=s.useCallback(d=>{var p;d===!0?(p=Pt.current)==null||p.focus():window.requestAnimationFrame(()=>{var v;(v=Pt.current)==null||v.focus()})},[]),Wt=ft?xe+1:xe,an=s.useCallback(d=>{const p=D===0?d:d.map(R=>({...R,location:[R.location[0]-D,R.location[1]]})),v=ge==null?void 0:ge(p);if(v!==!0)for(const R of p)te==null||te(R.location,R.value);return v},[te,ge,D]),[oo,oi]=s.useState(),xr=B.current!==void 0&&B.current.range.width*B.current.range.height>1?B.current.range:void 0,ko=Oo?(tl=B.current)==null?void 0:tl.cell:void 0,kr=ko==null?void 0:ko[0],Sr=ko==null?void 0:ko[1],ws=s.useMemo(()=>{if((gt===void 0||gt.length===0)&&(xr??kr??Sr??oo)===void 0)return;const d=[];if(gt!==void 0)for(const p of gt){const v=Be.length-p.range.x-D;v>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+D,width:Math.min(v,p.range.width)},style:p.style})}return oo!==void 0&&d.push({color:uo(Pe.accentColor,0),range:oo,style:"dashed"}),xr!==void 0&&d.push({color:uo(Pe.accentColor,.5),range:xr,style:"solid-outline"}),kr!==void 0&&Sr!==void 0&&d.push({color:Pe.accentColor,range:{x:kr,y:Sr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[oo,xr,kr,Sr,gt,Be.length,Pe.accentColor,D]),Xi=s.useRef(Be);Xi.current=Be;const Jt=s.useCallback(([d,p],v=!1)=>{var A,H,T,O,G,J,ue;const R=ft&&p===Wt-1;if(d===0&&ln){if(R)return Wr;const Q=Xo(p);return Q===void 0?Wr:{kind:un.Marker,allowOverlay:!1,checkboxStyle:po,checked:(B==null?void 0:B.rows.hasIndex(p))===!0,markerKind:_t==="clickable-number"?"number":_t,row:no+Q,drawHandle:$n!==void 0,cursor:_t==="clickable-number"?"pointer":void 0}}else if(R){const ye=d===D?(De==null?void 0:De.hint)??"":"",se=Xi.current[d];if(((A=se==null?void 0:se.trailingRowOptions)==null?void 0:A.disabled)===!0)return Wr;{const qe=((H=se==null?void 0:se.trailingRowOptions)==null?void 0:H.hint)??ye,ke=((T=se==null?void 0:se.trailingRowOptions)==null?void 0:T.addIcon)??(De==null?void 0:De.addIcon);return{kind:un.NewRow,hint:qe,allowOverlay:!1,icon:ke}}}else{const Q=d-D;if(v||(Ue==null?void 0:Ue.strict)===!0){const se=At.current,qe=se.x>Q||Q>se.x+se.width||se.y>p||p>se.y+se.height||p>=si.current,ke=Q===((G=(O=se.extras)==null?void 0:O.selected)==null?void 0:G[0])&&p===((J=se.extras)==null?void 0:J.selected[1]);let fe=!1;if(((ue=se.extras)==null?void 0:ue.freezeRegions)!==void 0){for(const nt of se.extras.freezeRegions)if(co(nt,Q,p)){fe=!0;break}}if(qe&&!ke&&!fe)return Wr}let ye=M([Q,p]);return D!==0&&ye.span!==void 0&&(ye={...ye,span:[ye.span[0]+D,ye.span[1]+D]}),ye}},[ft,Wt,ln,Xo,po,B==null?void 0:B.rows,_t,no,$n,D,De==null?void 0:De.hint,De==null?void 0:De.addIcon,Ue==null?void 0:Ue.strict,M]),ri=s.useCallback(d=>{let p=(ze==null?void 0:ze(d))??{name:d};return Ce!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>ci({group:p.name,bounds:v.bounds})}]}),p},[ze,Ce]),Mr=s.useCallback(d=>{var T;const[p,v]=d.cell,R=Be[p],F=(R==null?void 0:R.group)!==void 0?(T=ri(R.group))==null?void 0:T.overrideTheme:void 0,A=R==null?void 0:R.themeOverride,H=rn==null?void 0:rn(v);i({...d,theme:Ln(Pe,F,A,H,d.content.themeOverride)})},[rn,Be,ri,Pe]),So=s.useCallback((d,p,v)=>{var H;if(B.current===void 0)return;const[R,F]=B.current.cell,A=Jt([R,F]);if(A.kind!==Z.Boolean&&A.allowOverlay){let T=A;if(v!==void 0)switch(T.kind){case Z.Number:{const O=na(()=>v==="-"?-0:Number.parseFloat(v),0);T={...T,data:Number.isNaN(O)?0:O};break}case Z.Text:case Z.Markdown:case Z.Uri:T={...T,data:v};break}Mr({target:d,content:T,initialValue:v,cell:[R,F],highlight:v===void 0,forceEditMode:v!==void 0,activation:p})}else A.kind===Z.Boolean&&p.inputType==="keyboard"&&A.readonly!==!0&&(an([{location:B.current.cell,value:{...A,data:us(A.data)}}]),(H=Pt.current)==null||H.damage([{cell:B.current.cell}]))},[Jt,B,an,Mr]),Yi=s.useCallback((d,p)=>{var F;const v=(F=Pt.current)==null?void 0:F.getBounds(d,p);if(v===void 0||ct.current===null)return;const R=Jt([d,p]);R.allowOverlay&&Mr({target:v,content:R,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Jt,ct,Mr]),Rt=s.useCallback((d,p,v="both",R=0,F=0,A=void 0)=>{if(ct.current!==null){const H=Pt.current,T=l.current,O=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,G=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,J=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ue=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(H!==null&&T!==null){let Q={x:0,y:0,width:0,height:0},ye=0,se=0;if((O!==void 0||G!==void 0)&&(Q=H.getBounds((O??0)+D,G??0)??Q,Q.width===0||Q.height===0))return;const qe=T.getBoundingClientRect(),ke=qe.width/T.offsetWidth;if(J!==void 0&&(Q={...Q,x:J-qe.left-ct.current.scrollLeft,width:1}),ue!==void 0&&(Q={...Q,y:ue+qe.top-ct.current.scrollTop,height:1}),Q!==void 0){const fe={x:Q.x-R,y:Q.y-F,width:Q.width+2*R,height:Q.height+2*F};let nt=0;for(let wi=0;wi<_e;wi++)nt+=St[wi].width;let Ct=0;const Et=Bt+(Bn?1:0);Et>0&&(Ct=fo(Wt,Et,Cn));let Ut=nt*ke+qe.left+D*_n*ke,Sn=qe.right,bn=qe.top+Kt*ke,Mn=qe.bottom-Ct*ke;const Tr=Q.width+R*2;switch(A==null?void 0:A.hAlign){case"start":Sn=Ut+Tr;break;case"end":Ut=Sn-Tr;break;case"center":Ut=Math.floor((Ut+Sn)/2)-Tr/2,Sn=Ut+Tr;break}const Ar=Q.height+F*2;switch(A==null?void 0:A.vAlign){case"start":Mn=bn+Ar;break;case"end":bn=Mn-Ar;break;case"center":bn=Math.floor((bn+Mn)/2)-Ar/2,Mn=bn+Ar;break}Ut>fe.x?ye=fe.x-Ut:Sn<fe.x+fe.width&&(ye=fe.x+fe.width-Sn),bn>fe.y?se=fe.y-bn:Mn<fe.y+fe.height&&(se=fe.y+fe.height-Mn),v==="vertical"||typeof d=="number"&&d<_e?ye=0:(v==="horizontal"||typeof p=="number"&&p>=Wt-Et)&&(se=0),(ye!==0||se!==0)&&(ke!==1&&(ye/=ke,se/=ke),ct.current.scrollTo({left:ye+ct.current.scrollLeft,top:se+ct.current.scrollTop,behavior:(A==null?void 0:A.behavior)??"auto"}))}}}},[D,Bt,_n,ct,Kt,_e,St,Wt,Bn,Cn]),ii=s.useRef(Yi),li=s.useRef(M);ii.current=Yi,li.current=M;const si=s.useRef(xe);si.current=xe;const Gi=s.useRef(Be.length);Gi.current=Be.length;const Kn=s.useCallback(async(d,p=!0,v)=>{var G;const R=Be[d];if(((G=R==null?void 0:R.trailingRowOptions)==null?void 0:G.disabled)===!0)return;const F=Me==null?void 0:Me();let A,H=!0;F!==void 0&&(A=await F,A==="top"&&(H=!1),typeof A=="number"&&(H=!1));let T=0;const O=()=>{if(si.current<=xe){T<500&&window.setTimeout(O,T),T=50+T*2;return}const J=typeof A=="number"?A:H?xe:0;Hr.current(d-D,J,"both",0,0,v?{behavior:v}:void 0),Ie({cell:[d,J],range:{x:d,y:J,width:1,height:1}},!1,!1,"edit");const ue=li.current([d-D,J]);ue.allowOverlay&&Fo(ue)&&ue.readonly!==!0&&p&&window.setTimeout(()=>{ii.current(d,J)},0)};O()},[Be,Me,D,xe,Ie]),Rr=s.useCallback(async(d,p=!0)=>{const v=Ae==null?void 0:Ae();let R,F=!0;v!==void 0&&(R=await v,R==="left"&&(F=!1),typeof R=="number"&&(F=!1));let A=0;const H=()=>{if(Gi.current<=Be.length){A<500&&window.setTimeout(H,A),A=50+A*2;return}const T=typeof R=="number"?R:F?Be.length:0;Rt(T-D,d),Ie({cell:[T,d],range:{x:T,y:d,width:1,height:1}},!1,!1,"edit");const O=li.current([T-D,d]);O.allowOverlay&&Fo(O)&&O.readonly!==!0&&p&&window.setTimeout(()=>{ii.current(T,d)},0)};H()},[Be,Ae,D,Rt,Ie]),Mo=s.useCallback(d=>{var v,R;const p=((R=(v=St[d])==null?void 0:v.trailingRowOptions)==null?void 0:R.targetColumn)??(De==null?void 0:De.targetColumn);if(typeof p=="number")return p+(ln?1:0);if(typeof p=="object"){const F=C.indexOf(p);if(F>=0)return F+(ln?1:0)}},[St,C,ln,De==null?void 0:De.targetColumn]),Un=s.useRef(),Ro=s.useRef(),Vo=s.useCallback((d,p)=>{var F;const[v,R]=p;return Ln(Pe,(F=Be[v])==null?void 0:F.themeOverride,rn==null?void 0:rn(R),d.themeOverride)},[rn,Be,Pe]),{mapper:ro}=Dd(dt,y),mn=dt==null?void 0:dt.navigationBehavior,qo=s.useCallback(d=>{var J,ue,Q;const p=_r.value?d.metaKey:d.ctrlKey,v=p&&me==="multi",R=p&&j==="multi",[F,A]=d.location,H=B.columns,T=B.rows,[O,G]=((J=B.current)==null?void 0:J.cell)??[];if(d.kind==="cell"){if(Ro.current=void 0,io.current=[F,A],F===0&&ln){if(ft===!0&&A===xe||_t==="number"||me==="none")return;const ye=Jt(d.location);if(ye.kind!==un.Marker)return;if($n!==void 0){const ke=kt(ye);Qt((ke==null?void 0:ke.kind)===un.Marker);const fe=(ue=ke==null?void 0:ke.onClick)==null?void 0:ue.call(ke,{...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Vo(ye,d.location),preventDefault:()=>{}});if(fe===void 0||fe.checked===ye.checked)return}i(void 0),Ot();const se=T.hasIndex(A),qe=Un.current;if(me==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&qe!==void 0&&T.hasIndex(qe)){const ke=[Math.min(qe,A),Math.max(qe,A)+1];v||Je==="multi"?We(void 0,ke,!0):We(it.fromSingleSelection(ke),void 0,v)}else me==="multi"&&(v||d.isTouch||Je==="multi")?se?We(T.remove(A),void 0,!0):(We(void 0,A,!0),Un.current=A):se&&T.length===1?We(it.empty(),void 0,p):(We(it.fromSingleSelection(A),void 0,p),Un.current=A)}else if(F>=D&&ft&&A===xe){const ye=Mo(F);Kn(ye??F)}else if(O!==F||G!==A){const ye=Jt(d.location),se=kt(ye);if((se==null?void 0:se.onSelect)!==void 0){let fe=!1;if(se.onSelect({...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>fe=!0,theme:Vo(ye,d.location)}),fe)return}if(mn==="block"&&ro(A).isGroupHeader)return;const qe=Bn&&A===xe,ke=Bn&&B!==void 0&&((Q=B.current)==null?void 0:Q.cell[1])===xe;if((d.shiftKey||d.isLongTouch===!0)&&O!==void 0&&G!==void 0&&B.current!==void 0&&!ke){if(qe)return;const fe=Math.min(F,O),nt=Math.max(F,O),Ct=Math.min(A,G),Et=Math.max(A,G);Ie({...B.current,range:{x:fe,y:Ct,width:nt-fe+1,height:Et-Ct+1}},!0,p,"click"),Un.current=void 0,Ot()}else Ie({cell:[F,A],range:{x:F,y:A,width:1,height:1}},!0,p,"click"),Un.current=void 0,i(void 0),Ot()}}else if(d.kind==="header")if(io.current=[F,A],i(void 0),ln&&F===0)Un.current=void 0,Ro.current=void 0,!Gn&&me==="multi"&&(T.length!==xe?We(it.fromSingleSelection([0,xe]),void 0,p):We(it.empty(),void 0,p),Ot());else{const ye=Ro.current;if(j==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&ye!==void 0&&H.hasIndex(ye)){const se=[Math.min(ye,F),Math.max(ye,F)+1];R?Fe(void 0,se,p):Fe(it.fromSingleSelection(se),void 0,p)}else R?(H.hasIndex(F)?Fe(H.remove(F),void 0,p):Fe(void 0,F,p),Ro.current=F):j!=="none"&&(H.hasIndex(F)?Fe(H.remove(F),void 0,p):Fe(it.fromSingleSelection(F),void 0,p),Ro.current=F);Un.current=void 0,Ot()}else d.kind===yn?io.current=[F,A]:d.kind===Kr&&!d.isMaybeScrollbar&&(U($r,!1),i(void 0),Ot(),st==null||st(),Un.current=void 0,Ro.current=void 0)},[me,j,B,ln,D,ft,xe,_t,Jt,$n,Ot,Je,kt,Vo,We,Mo,Kn,mn,ro,Bn,Ie,Gn,Fe,U,st]),jo=s.useRef(!1),io=s.useRef(),_i=s.useRef(Zt),cn=s.useRef(),bs=s.useCallback(d=>{if(Eo.current=!1,_i.current=At.current,d.button!==0&&d.button!==1){cn.current=void 0;return}const p=performance.now();cn.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&(jo.current=!0);const v=d.kind==="cell"&&d.isFillHandle;!v&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:B,fillHandle:v}),io.current=void 0,!d.isTouch&&d.button===0&&!v?qo(d):!d.isTouch&&d.button===1&&(io.current=d.location))},[B,qo]),[ai,ci]=s.useState(),Ki=s.useCallback(d=>{if(d.kind!==yn||j!=="multi")return;const p=_r.value?d.metaKey:d.ctrlKey,[v]=d.location,R=B.columns;if(v<D)return;const F=Be[v];let A=v,H=v;for(let T=v-1;T>=D&&ar(F.group,Be[T].group);T--)A--;for(let T=v+1;T<Be.length&&ar(F.group,Be[T].group);T++)H++;if(Ot(),p)if(R.hasAll([A,H+1])){let T=R;for(let O=A;O<=H;O++)T=T.remove(O);Fe(T,void 0,p)}else Fe(void 0,[A,H+1],p);else Fe(it.fromSingleSelection([A,H+1]),void 0,p)},[j,Ot,B.columns,Be,D,Fe]),Eo=s.useRef(!1),Er=s.useCallback(async d=>{if(k!==void 0&&re!==void 0){const p=At.current.y,v=At.current.height;let R=k({x:d,y:p,width:1,height:Math.min(v,xe-p)},Lt.current.signal);typeof R!="object"&&(R=await R());const F=St[d-D],H=document.createElement("canvas").getContext("2d",{alpha:!1});if(H!==null){H.font=Pe.baseFontFull;const T=Jl(H,Pe,F,0,R,Pn,vo,!1,kt);re==null||re(F,T.width,d,T.width)}}},[St,k,vo,Pe,Pn,re,D,xe,kt]),[ys,di]=s.useState(),Io=s.useCallback(async(d,p)=>{var T,O;const v=(T=d.current)==null?void 0:T.range;if(v===void 0||k===void 0||p.current===void 0)return;const R=p.current.range;if(P!==void 0){let G=!1;if(P({fillDestination:{...R,x:R.x-D},patternSource:{...v,x:v.x-D},preventDefault:()=>G=!0}),G)return}let F=k(v,Lt.current.signal);typeof F!="object"&&(F=await F());const A=F,H=[];for(let G=0;G<R.width;G++)for(let J=0;J<R.height;J++){const ue=[R.x+G,R.y+J];if(Ol(ue,v))continue;const Q=A[J%v.height][G%v.width];Ho(Q)||!Fo(Q)||H.push({location:ue,value:{...Q}})}an(H),(O=Pt.current)==null||O.damage(H.map(G=>({cell:G.location})))},[k,an,P,D]),Ui=s.useCallback(()=>{if(B.current===void 0||B.current.range.width<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,width:1}}};Io(d,B)},[Io,B]),Vi=s.useCallback(()=>{if(B.current===void 0||B.current.range.height<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,height:1}}};Io(d,B)},[Io,B]),ps=s.useCallback((d,p)=>{var J,ue;const v=c;if(f(void 0),oi(void 0),di(void 0),jo.current=!1,p)return;if((v==null?void 0:v.fillHandle)===!0&&B.current!==void 0&&((J=v.previousSelection)==null?void 0:J.current)!==void 0){if(oo===void 0)return;const Q={...B,current:{...B.current,range:os(v.previousSelection.current.range,oo)}};Io(v.previousSelection,Q),U(Q,!0);return}const[R,F]=d.location,[A,H]=io.current??[],T=()=>{Eo.current=!0},O=Q=>{var se,qe,ke;const ye=Q.isTouch||A===R&&H===F;if(ye&&(X==null||X([R-D,F],{...Q,preventDefault:T})),Q.button===1)return!Eo.current;if(!Eo.current){const fe=Jt(d.location),nt=kt(fe);if(nt!==void 0&&nt.onClick!==void 0&&ye){const Et=nt.onClick({...Q,cell:fe,posX:Q.localEventX,posY:Q.localEventY,bounds:Q.bounds,theme:Vo(fe,d.location),preventDefault:T});Et!==void 0&&!Ho(Et)&&Do(Et)&&(an([{location:Q.location,value:Et}]),(se=Pt.current)==null||se.damage([{cell:Q.location}]))}if(Eo.current||B.current===void 0)return!1;let Ct=!1;switch(fe.activationBehaviorOverride??Ke){case"double-click":case"second-click":{if(((ke=(qe=v==null?void 0:v.previousSelection)==null?void 0:qe.current)==null?void 0:ke.cell)===void 0)break;const[Et,Ut]=B.current.cell,[Sn,bn]=v.previousSelection.current.cell;Ct=R===Et&&R===Sn&&F===Ut&&F===bn&&(Q.isDoubleClick===!0||Ke==="second-click");break}case"single-click":{Ct=!0;break}}if(Ct){const Ut={inputType:"pointer",pointerActivation:Q.isDoubleClick===!0?"double-click":fe.activationBehaviorOverride??Ke,pointerType:Q.isTouch?"touch":"mouse"};return L==null||L([R-D,F],Ut),So(Q.bounds,Ut),!0}}return!1},G=d.location[0]-D;if(d.isTouch){const Q=At.current,ye=_i.current;if(Q.x!==ye.x||Q.y!==ye.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&rr((ue=B.current)==null?void 0:ue.cell,d.location)){oe==null||oe([G,d.location[1]],{...d,preventDefault:T});return}else if(d.kind==="header"&&B.columns.hasIndex(R)){ve==null||ve(G,{...d,preventDefault:T});return}else if(d.kind===yn){if(G<0)return;K==null||K(G,{...d,preventDefault:T});return}}d.kind==="cell"?O(d)||qo(d):d.kind===yn?q==null||q(G,{...d,preventDefault:T}):(d.kind===Jn&&(z==null||z(G,{...d,preventDefault:T})),qo(d));return}if(d.kind==="header"){if(G<0)return;d.isEdge?d.isDoubleClick===!0&&Er(R):d.button===0&&R===A&&F===H&&(z==null||z(G,{...d,preventDefault:T}))}if(d.kind===yn){if(G<0)return;d.button===0&&R===A&&F===H&&(q==null||q(G,{...d,preventDefault:T}),Eo.current||Ki(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&O(d),io.current=void 0},[c,B,D,oo,Io,U,X,Jt,kt,Ke,Vo,an,L,So,oe,ve,K,qo,q,z,Er,Ki]),vs=s.useCallback(d=>{const p={...d,location:[d.location[0]-D,d.location[1]]};Ze==null||Ze(p),c!==void 0&&d.buttons===0&&(f(void 0),oi(void 0),di(void 0),jo.current=!1),di(v=>{var R;return jo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(v==null?void 0:v[0])&&d.scrollEdge[1]===v[1]?v:c===void 0||(((R=cn.current)==null?void 0:R.location[0])??0)<D?void 0:d.scrollEdge})},[c,Ze,D]),Cs=s.useCallback((d,p)=>{pt==null||pt(d-D,p)},[pt,D]),xs=s.useCallback((d,p)=>{tt==null||tt(d-D,p)},[tt,D]),kn=(nl=B==null?void 0:B.current)==null?void 0:nl.cell,ks=s.useCallback((d,p,v,R,F,A)=>{gn.current=!1;let H=kn;H!==void 0&&(H=[H[0]-D,H[1]]);const T=_e===0?void 0:{x:0,y:d.y,width:_e,height:d.height},O=[];T!==void 0&&O.push(T),Bt>0&&(O.push({x:d.x-D,y:xe-Bt,width:d.width,height:Bt}),_e>0&&O.push({x:0,y:xe-Bt,width:_e,height:Bt}));const G={x:d.x-D,y:d.y,width:d.width,height:ft&&d.y+d.height>=xe?d.height-1:d.height,tx:F,ty:A,extras:{selected:H,freezeRegion:T,freezeRegions:O}};At.current=G,Uo(G),Dt([p,v,R]),It==null||It(G,G.tx,G.ty,G.extras)},[kn,D,ft,xe,_e,Bt,Uo,It]),Ss=Zn(I,s.useCallback((d,p)=>(I==null?void 0:I(d-D,p-D))!==!1,[I,D])),Ms=Zn(He,s.useCallback((d,p)=>{He==null||He(d-D,p-D),j!=="none"&&Fe(it.fromSingleSelection(p),void 0,!0)},[j,He,D,Fe])),ui=s.useRef(!1),Rs=s.useCallback(d=>{if(d.location[0]===0&&D>0){d.preventDefault();return}Ye==null||Ye({...d,location:[d.location[0]-D,d.location[1]]}),d.defaultPrevented()||(ui.current=!0),f(void 0)},[Ye,D]),Es=s.useCallback(()=>{ui.current=!1},[]),qi=dt==null?void 0:dt.selectionBehavior,Ir=s.useCallback(d=>{if(qi!=="block-spanning")return;const{isGroupHeader:p,path:v,groupRows:R}=ro(d);if(p)return[d,d];const F=v[v.length-1],A=d-F,H=d+R-F-1;return[A,H]},[ro,qi]),fi=s.useRef(),hi=s.useCallback(d=>{var p,v,R;if(!cs(d,fi.current)&&(fi.current=d,!(((p=cn==null?void 0:cn.current)==null?void 0:p.button)!==void 0&&cn.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((v=cn.current)==null?void 0:v.location[0])===0&&d.location[0]===0&&D===1&&me==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(cn.current.location[1])&&B.rows.hasIndex(cn.current.location[1])){const F=Math.min(cn.current.location[1],d.location[1]),A=Math.max(cn.current.location[1],d.location[1])+1;We(it.fromSingleSelection([F,A]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&B.current!==void 0&&!ui.current&&!jo.current&&(lt==="rect"||lt==="multi-rect")){const[F,A]=B.current.cell;let[H,T]=d.location;if(T<0&&(T=At.current.y),c.fillHandle===!0&&((R=c.previousSelection)==null?void 0:R.current)!==void 0){const O=c.previousSelection.current.range;T=Math.min(T,ft?xe-1:xe);const G=mc(O,H,T,qt);oi(G)}else{if(ft&&A===xe)return;if(ft&&T===xe)if(d.kind===Kr)T--;else return;H=Math.max(H,D);const J=Ir(A);T=J===void 0?T:dn(T,J[0],J[1]);const ue=H-F,Q=T-A,ye={x:ue>=0?F:H,y:Q>=0?A:T,width:Math.abs(ue)+1,height:Math.abs(Q)+1};Ie({...B.current,range:ye},!0,!1,"drag")}}zt==null||zt({...d,location:[d.location[0]-D,d.location[1]]})}},[c,D,me,B,lt,zt,We,ft,xe,qt,Ir,Ie]),Is=s.useCallback(()=>{var H,T;const d=fi.current;if(d===void 0)return;const[p,v]=d.scrollEdge;let[R,F]=d.location;const A=At.current;p===-1?R=((T=(H=A.extras)==null?void 0:H.freezeRegion)==null?void 0:T.x)??A.x:p===1&&(R=A.x+A.width),v===-1?F=Math.max(0,A.y):v===1&&(F=Math.min(xe-1,A.y+A.height)),R=dn(R,0,Be.length-1),F=dn(F,0,xe-1),hi({...d,location:[R,F]})},[Be.length,hi,xe]);Sd(ys,ct,Is);const wn=s.useCallback(d=>{if(B.current===void 0)return;const[p,v]=d,[R,F]=B.current.cell,A=B.current.range;let H=A.x,T=A.x+A.width,O=A.y,G=A.y+A.height;const[J,ue]=Ir(F)??[0,xe-1],Q=ue+1;if(v!==0)switch(v){case 2:{G=Q,O=F,Rt(0,G,"vertical");break}case-2:{O=J,G=F+1,Rt(0,O,"vertical");break}case 1:{O<F?(O++,Rt(0,O,"vertical")):(G=Math.min(Q,G+1),Rt(0,G,"vertical"));break}case-1:{G>F+1?(G--,Rt(0,G,"vertical")):(O=Math.max(J,O-1),Rt(0,O,"vertical"));break}default:sr()}if(p!==0)if(p===2)T=Be.length,H=R,Rt(T-1-D,0,"horizontal");else if(p===-2)H=D,T=R+1,Rt(H-D,0,"horizontal");else{let ye=[];if(k!==void 0){const se=k({x:H,y:O,width:T-H-D,height:G-O},Lt.current.signal);typeof se=="object"&&(ye=zd(se))}if(p===1){let se=!1;if(H<R){if(ye.length>0){const qe=ao(H+1,R+1).find(ke=>!ye.includes(ke-D));qe!==void 0&&(H=qe,se=!0)}else H++,se=!0;se&&Rt(H,0,"horizontal")}se||(T=Math.min(Be.length,T+1),Rt(T-1-D,0,"horizontal"))}else if(p===-1){let se=!1;if(T>R+1){if(ye.length>0){const qe=ao(T-1,R,-1).find(ke=>!ye.includes(ke-D));qe!==void 0&&(T=qe,se=!0)}else T--,se=!0;se&&Rt(T-D,0,"horizontal")}se||(H=Math.max(D,H-1),Rt(H-D,0,"horizontal"))}else sr()}Ie({cell:B.current.cell,range:{x:H,y:O,width:T-H,height:G-O}},!0,!1,"keyboard-select")},[k,Ir,B,Be.length,D,xe,Rt,Ie]),gi=s.useRef($o);gi.current=$o;const Vn=s.useCallback((d,p,v,R)=>{const F=Wt-(v?0:1);d=dn(d,D,St.length-1+D),p=dn(p,0,F);const A=kn==null?void 0:kn[0],H=kn==null?void 0:kn[1];if(d===A&&p===H)return!1;if(R&&B.current!==void 0){const T=[...B.current.rangeStack];(B.current.range.width>1||B.current.range.height>1)&&T.push(B.current.range),U({...B,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:T}},!0)}else Ie({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===p&&(u.current=void 0),gi.current&&Rt(d-D,p),!0},[Wt,D,St.length,kn,B,Rt,U,Ie]),Ds=s.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&Do(d)&&(an([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var F;(F=Pt.current)==null||F.damage([{cell:r.cell}])})),Ot(!0),i(void 0);const[v,R]=p;if(B.current!==void 0&&(v!==0||R!==0)){const F=B.current.cell[1]===Wt-1&&d!==void 0,A=B.current.cell[0]===Be.length-1&&d!==void 0;let H=!0;if(F&&R===1&&Me!==void 0){H=!1;const T=B.current.cell[0]+v,O=Mo(T);Kn(O??T,!1)}if(A&&v===1&&Ae!==void 0){H=!1;const T=B.current.cell[1]+R;Rr(T,!1)}H&&Vn(dn(B.current.cell[0]+v,0,Be.length-1),dn(B.current.cell[1]+R,0,Wt-1),F,!1)}W==null||W(d,p)},[r==null?void 0:r.cell,Ot,B,W,an,Wt,Vn,Be.length,Kn,Rr,Me,Ae,Mo]),Fs=s.useMemo(()=>`gdg-overlay-${Ad++}`,[]),lo=s.useCallback(d=>{var v,R,F,A;Ot();const p=[];for(let H=d.x;H<d.x+d.width;H++)for(let T=d.y;T<d.y+d.height;T++){const O=M([H-D,T]);if(!O.allowOverlay&&O.kind!==Z.Boolean)continue;let G;if(O.kind===Z.Custom){const J=kt(O),ue=(v=J==null?void 0:J.provideEditor)==null?void 0:v.call(J,{...O,location:[H-D,T]});(J==null?void 0:J.onDelete)!==void 0?G=J.onDelete(O):oa(ue)&&(G=(R=ue==null?void 0:ue.deletedValue)==null?void 0:R.call(ue,O))}else if(Do(O)&&O.allowOverlay||O.kind===Z.Boolean){const J=kt(O);G=(F=J==null?void 0:J.onDelete)==null?void 0:F.call(J,O)}G!==void 0&&!Ho(G)&&Do(G)&&p.push({location:[H,T],value:G})}an(p),(A=Pt.current)==null||A.damage(p.map(H=>({cell:H.location})))},[Ot,M,kt,an,D]),Zo=r!==void 0,ji=s.useCallback(d=>{var qe,ke;const p=()=>{d.stopPropagation(),d.preventDefault()},v={didMatch:!1},{bounds:R}=d,F=B.columns,A=B.rows,H=xn;if(!Zo&&Oe(H.clear,d,v))U($r,!1),st==null||st();else if(!Zo&&Oe(H.selectAll,d,v))U({columns:it.empty(),rows:it.empty(),current:{cell:((qe=B.current)==null?void 0:qe.cell)??[D,0],range:{x:D,y:0,width:C.length,height:xe},rangeStack:[]}},!1);else if(Oe(H.search,d,v))(ke=a==null?void 0:a.current)==null||ke.focus({preventScroll:!0}),vr(!0);else if(Oe(H.delete,d,v)){const fe=(de==null?void 0:de(B))??!0;if(fe!==!1){const nt=fe===!0?B:fe;if(nt.current!==void 0){lo(nt.current.range);for(const Ct of nt.current.rangeStack)lo(Ct)}for(const Ct of nt.rows)lo({x:D,y:Ct,width:C.length,height:1});for(const Ct of nt.columns)lo({x:Ct,y:0,width:1,height:xe})}}if(v.didMatch)return p(),!0;if(B.current===void 0)return!1;let[T,O]=B.current.cell;const[,G]=B.current.cell;let J=!1,ue=!1;if(Oe(H.scrollToSelectedCell,d,v))Hr.current(T-D,O);else if(j!=="none"&&Oe(H.selectColumn,d,v))F.hasIndex(T)?Fe(F.remove(T),void 0,!0):j==="single"?Fe(it.fromSingleSelection(T),void 0,!0):Fe(void 0,T,!0);else if(me!=="none"&&Oe(H.selectRow,d,v))A.hasIndex(O)?We(A.remove(O),void 0,!0):me==="single"?We(it.fromSingleSelection(O),void 0,!0):We(void 0,O,!0);else if(!Zo&&R!==void 0&&Oe(H.activateCell,d,v))if(O===xe&&ft)window.setTimeout(()=>{const fe=Mo(T);Kn(fe??T)},0);else{const fe={inputType:"keyboard",key:d.key};L==null||L([T-D,O],fe),So(R,fe)}else B.current.range.height>1&&Oe(H.downFill,d,v)?Vi():B.current.range.width>1&&Oe(H.rightFill,d,v)?Ui():Oe(H.goToNextPage,d,v)?O+=Math.max(1,At.current.height-4):Oe(H.goToPreviousPage,d,v)?O-=Math.max(1,At.current.height-4):Oe(H.goToFirstCell,d,v)?(i(void 0),O=0,T=0):Oe(H.goToLastCell,d,v)?(i(void 0),O=Number.MAX_SAFE_INTEGER,T=Number.MAX_SAFE_INTEGER):Oe(H.selectToFirstCell,d,v)?(i(void 0),wn([-2,-2])):Oe(H.selectToLastCell,d,v)?(i(void 0),wn([2,2])):Zo?(Oe(H.closeOverlay,d,v)&&i(void 0),Oe(H.acceptOverlayDown,d,v)&&(i(void 0),O++),Oe(H.acceptOverlayUp,d,v)&&(i(void 0),O--),Oe(H.acceptOverlayLeft,d,v)&&(i(void 0),T--),Oe(H.acceptOverlayRight,d,v)&&(i(void 0),T++)):(Oe(H.goDownCell,d,v)?O+=1:Oe(H.goUpCell,d,v)?O-=1:Oe(H.goRightCell,d,v)?T+=1:Oe(H.goLeftCell,d,v)?T-=1:Oe(H.goDownCellRetainSelection,d,v)?(O+=1,J=!0):Oe(H.goUpCellRetainSelection,d,v)?(O-=1,J=!0):Oe(H.goRightCellRetainSelection,d,v)?(T+=1,J=!0):Oe(H.goLeftCellRetainSelection,d,v)?(T-=1,J=!0):Oe(H.goToLastRow,d,v)?O=xe-1:Oe(H.goToFirstRow,d,v)?O=Number.MIN_SAFE_INTEGER:Oe(H.goToLastColumn,d,v)?T=Number.MAX_SAFE_INTEGER:Oe(H.goToFirstColumn,d,v)?T=Number.MIN_SAFE_INTEGER:(lt==="rect"||lt==="multi-rect")&&(Oe(H.selectGrowDown,d,v)?wn([0,1]):Oe(H.selectGrowUp,d,v)?wn([0,-1]):Oe(H.selectGrowRight,d,v)?wn([1,0]):Oe(H.selectGrowLeft,d,v)?wn([-1,0]):Oe(H.selectToLastRow,d,v)?wn([0,2]):Oe(H.selectToFirstRow,d,v)?wn([0,-2]):Oe(H.selectToLastColumn,d,v)?wn([2,0]):Oe(H.selectToFirstColumn,d,v)&&wn([-2,0])),ue=v.didMatch);if(mn!==void 0&&mn!=="normal"&&O!==G){const fe=mn==="skip-up"||mn==="skip"||mn==="block",nt=mn==="skip-down"||mn==="skip"||mn==="block",Ct=O<G;if(Ct&&fe){for(;O>=0&&ro(O).isGroupHeader;)O--;O<0&&(O=G)}else if(!Ct&&nt){for(;O<xe&&ro(O).isGroupHeader;)O++;O>=xe&&(O=G)}}const ye=Vn(T,O,!1,J),se=v.didMatch;return se&&(ye||!ue||On)&&p(),se},[mn,Zo,B,xn,j,me,lt,D,ro,xe,Vn,U,st,C.length,de,On,lo,Fe,We,ft,Mo,Kn,L,So,Vi,Ui,wn]),Jo=s.useCallback(d=>{let p=!1;if(Le!==void 0&&Le({...d,...d.location&&{location:[d.location[0]-D,d.location[1]]},cancel:()=>{p=!0}}),p||ji(d)||B.current===void 0)return;const[v,R]=B.current.cell,F=At.current;if(ot&&!d.metaKey&&!d.ctrlKey&&B.current!==void 0&&d.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(d.key)&&d.bounds!==void 0&&Fo(M([v-D,Math.max(0,Math.min(R,xe-1))]))){if((!ft||R!==xe)&&(F.y>R||R>F.y+F.height||F.x>v||v>F.x+F.width))return;const A={inputType:"keyboard",key:d.key};L==null||L([v-D,R],A),So(d.bounds,A,d.key),d.stopPropagation(),d.preventDefault()}},[ot,Le,ji,B,M,D,xe,ft,L,So]),Hs=s.useCallback((d,p)=>{const v=d.location[0]-D;if(d.kind==="header"&&(ve==null||ve(v,{...d,preventDefault:p})),d.kind===yn){if(v<0)return;K==null||K(v,{...d,preventDefault:p})}if(d.kind==="cell"){const[R,F]=d.location;oe==null||oe([v,F],{...d,preventDefault:p}),Ca(B,d.location)||Vn(R,F,!1,!1)}},[B,oe,K,ve,D,Vn]),mi=s.useCallback(async d=>{var H,T,O;if(!xn.paste)return;function p(G,J,ue,Q){var se,qe;const ye=typeof ue=="object"?(ue==null?void 0:ue.join(`
`))??"":(ue==null?void 0:ue.toString())??"";if(!Ho(G)&&Fo(G)&&G.readonly!==!0){const ke=Y==null?void 0:Y(ye,G);if(ke!==void 0&&Do(ke))return{location:J,value:ke};const fe=kt(G);if(fe===void 0)return;if(fe.kind===Z.Custom){Qt(G.kind===Z.Custom);const nt=(se=fe.onPaste)==null?void 0:se.call(fe,ye,G.data);return nt===void 0?void 0:{location:J,value:{...G,data:nt}}}else{const nt=(qe=fe.onPaste)==null?void 0:qe.call(fe,ye,G,{formatted:Q,formattedString:typeof Q=="string"?Q:Q==null?void 0:Q.join(`
`),rawValue:ue});return nt===void 0?void 0:(Qt(nt.kind===G.kind),{location:J,value:nt})}}}const v=B.columns,R=B.rows,F=((H=ct.current)==null?void 0:H.contains(document.activeElement))===!0||((T=l.current)==null?void 0:T.contains(document.activeElement))===!0;let A;if(B.current!==void 0?A=[B.current.range.x,B.current.range.y]:v.length===1?A=[v.first()??0,0]:R.length===1&&(A=[D,R.first()??0]),F&&A!==void 0){let G,J;const ue="text/plain",Q="text/html";if(navigator.clipboard.read!==void 0){const ke=await navigator.clipboard.read();for(const fe of ke){if(fe.types.includes(Q)){const Ct=await(await fe.getType(Q)).text(),Et=Sl(Ct);if(Et!==void 0){G=Et;break}}fe.types.includes(ue)&&(J=await(await fe.getType(ue)).text())}}else if(navigator.clipboard.readText!==void 0)J=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(Q)){const ke=d.clipboardData.getData(Q);G=Sl(ke)}G===void 0&&d.clipboardData.types.includes(ue)&&(J=d.clipboardData.getData(ue))}else return;const[ye,se]=A,qe=[];do{if(ie===void 0){const ke=Jt(A),fe=J??(G==null?void 0:G.map(Ct=>Ct.map(Et=>Et.rawValue).join("	")).join("	"))??"",nt=p(ke,A,fe,void 0);nt!==void 0&&qe.push(nt);break}if(G===void 0){if(J===void 0)return;G=bd(J)}if(ie===!1||typeof ie=="function"&&(ie==null?void 0:ie([A[0]-D,A[1]],G.map(ke=>ke.map(fe=>{var nt;return((nt=fe.rawValue)==null?void 0:nt.toString())??""}))))!==!0)return;for(const[ke,fe]of G.entries()){if(ke+se>=xe)break;for(const[nt,Ct]of fe.entries()){const Et=[nt+ye,ke+se],[Ut,Sn]=Et;if(Ut>=Be.length||Sn>=Wt)continue;const bn=Jt(Et),Mn=p(bn,Et,Ct.rawValue,Ct.formatted);Mn!==void 0&&qe.push(Mn)}}}while(!1);an(qe),(O=Pt.current)==null||O.damage(qe.map(ke=>({cell:ke.location})))}},[Y,kt,Jt,B,xn.paste,ct,Be.length,an,Wt,ie,D,xe]);Nt("paste",mi,g,!1,!0);const Qo=s.useCallback(async(d,p)=>{var H,T;if(!xn.copy)return;const v=p===!0||((H=ct.current)==null?void 0:H.contains(document.activeElement))===!0||((T=l.current)==null?void 0:T.contains(document.activeElement))===!0,R=B.columns,F=B.rows,A=(O,G)=>{if(!pe)Rl(O,G,d);else{const J=G.map(ue=>({kind:Z.Text,data:C[ue].title,displayData:C[ue].title,allowOverlay:!1}));Rl([J,...O],G,d)}};if(v&&k!==void 0){if(B.current!==void 0){let O=k(B.current.range,Lt.current.signal);typeof O!="object"&&(O=await O()),A(O,ao(B.current.range.x-D,B.current.range.x+B.current.range.width-D))}else if(F!==void 0&&F.length>0){const G=[...F].map(J=>{const ue=k({x:D,y:J,width:C.length,height:1},Lt.current.signal);return typeof ue=="object"?ue[0]:ue().then(Q=>Q[0])});if(G.some(J=>J instanceof Promise)){const J=await Promise.all(G);A(J,ao(C.length))}else A(G,ao(C.length))}else if(R.length>0){const O=[],G=[];for(const J of R){let ue=k({x:J,y:0,width:1,height:xe},Lt.current.signal);typeof ue!="object"&&(ue=await ue()),O.push(ue),G.push(J-D)}if(O.length===1)A(O[0],G);else{const J=O.reduce((ue,Q)=>ue.map((ye,se)=>[...ye,...Q[se]]));A(J,G)}}}},[C,k,B,xn.copy,D,ct,xe,pe]);Nt("copy",Qo,g,!1,!1);const Ts=s.useCallback(async d=>{var v,R;if(!(!xn.cut||!(((v=ct.current)==null?void 0:v.contains(document.activeElement))===!0||((R=l.current)==null?void 0:R.contains(document.activeElement))===!0))&&(await Qo(d),B.current!==void 0)){let F={current:{cell:B.current.cell,range:B.current.range,rangeStack:[]},rows:it.empty(),columns:it.empty()};const A=de==null?void 0:de(F);if(A===!1||(F=A===!0?F:A,F.current===void 0))return;lo(F.current.range)}},[lo,B,xn.cut,Qo,ct,de]);Nt("cut",Ts,g,!1,!1);const As=s.useCallback((d,p)=>{if(Ge!==void 0){D!==0&&(d=d.map(F=>[F[0]-D,F[1]])),Ge(d,p);return}if(d.length===0||p===-1)return;const[v,R]=d[p];u.current!==void 0&&u.current[0]===v&&u.current[1]===R||(u.current=[v,R],Vn(v,R,!1,!1))},[Ge,D,Vn]),[Dr,Fr]=((ol=Yt==null?void 0:Yt.current)==null?void 0:ol.cell)??[],Hr=s.useRef(Rt);Hr.current=Rt,s.useLayoutEffect(()=>{var d,p,v,R;gi.current&&!gn.current&&Dr!==void 0&&Fr!==void 0&&(Dr!==((p=(d=le.current)==null?void 0:d.current)==null?void 0:p.cell[0])||Fr!==((R=(v=le.current)==null?void 0:v.current)==null?void 0:R.cell[1]))&&Hr.current(Dr,Fr),gn.current=!1},[Dr,Fr]);const Zi=B.current!==void 0&&(B.current.cell[0]>=Be.length||B.current.cell[1]>=Wt);s.useLayoutEffect(()=>{Zi&&U($r,!1)},[Zi,U]);const zs=s.useMemo(()=>ft===!0&&(De==null?void 0:De.tint)===!0?it.fromSingleSelection(Wt-1):it.empty(),[Wt,ft,De==null?void 0:De.tint]),Ps=s.useCallback(d=>typeof bt=="boolean"?bt:(bt==null?void 0:bt(d-D))??!0,[D,bt]),Bs=s.useMemo(()=>{if(ai===void 0||l.current===null)return null;const{bounds:d,group:p}=ai,v=l.current.getBoundingClientRect();return s.createElement(ld,{bounds:d,group:p,canvasBounds:v,onClose:()=>ci(void 0),onFinish:R=>{ci(void 0),Ce==null||Ce(p,R)}})},[Ce,ai]),Ls=Math.min(Be.length,_e+(ln?1:0));s.useImperativeHandle(t,()=>({appendRow:(d,p)=>Kn(d+D,p),appendColumn:(d,p)=>Rr(d,p),updateCells:d=>{var p;return D!==0&&(d=d.map(v=>({cell:[v.cell[0]+D,v.cell[1]]}))),(p=Pt.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var v;if(!((l==null?void 0:l.current)===null||(ct==null?void 0:ct.current)===null)){if(d===void 0&&p===void 0){const R=l.current.getBoundingClientRect(),F=R.width/ct.current.clientWidth;return{x:R.x-ct.current.scrollLeft*F,y:R.y-ct.current.scrollTop*F,width:ct.current.scrollWidth*F,height:ct.current.scrollHeight*F}}return(v=Pt.current)==null?void 0:v.getBounds((d??0)+D,p)}},focus:()=>{var d;return(d=Pt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qo(void 0,!0);break;case"paste":await mi();break}},scrollTo:Rt,remeasureColumns:d=>{for(const p of d)Er(p+D)},getMouseArgsForPosition:(d,p,v)=>{if((Pt==null?void 0:Pt.current)===null)return;const R=Pt.current.getMouseArgsForPosition(d,p,v);if(R!==void 0)return{...R,location:[R.location[0]-D,R.location[1]]}}}),[Kn,Rr,Er,ct,Qo,Jo,mi,D,Rt]);const[Ji,Qi]=kn??[],Ws=s.useCallback(d=>{const[p,v]=d;if(v===-1){j!=="none"&&(Fe(it.fromSingleSelection(p),void 0,!1),Ot());return}Ji===p&&Qi===v||(Ie({cell:d,range:{x:p,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Rt(p,v))},[j,Ot,Rt,Ji,Qi,Ie,Fe]),[$s,Os]=s.useState(!1),el=s.useRef(Al(d=>{Os(d)},5)),Ns=s.useCallback(()=>{el.current(!0),B.current===void 0&&B.columns.length===0&&B.rows.length===0&&c===void 0&&Ie({cell:[D,Cr],range:{x:D,y:Cr,width:1,height:1}},!0,!1,"keyboard-select")},[Cr,B,c,D,Ie]),Xs=s.useCallback(()=>{el.current(!1)},[]),[Ys,Gs]=s.useMemo(()=>{let d;const p=(Ue==null?void 0:Ue.scrollbarWidthOverride)??Mi(),v=xe+(ft?1:0);if(typeof Cn=="number")d=Kt+v*Cn;else{let F=0;const A=Math.min(v,10);for(let H=0;H<A;H++)F+=Cn(H);F=Math.floor(F/A),d=Kt+v*F}d+=p;const R=Be.reduce((F,A)=>A.width+F,0)+p;return[`${Math.min(1e5,R)}px`,`${Math.min(1e5,d)}px`]},[Be,Ue==null?void 0:Ue.scrollbarWidthOverride,Cn,xe,ft,Kt]),_s=s.useMemo(()=>Pa(Pe),[Pe]);return s.createElement(Zl.Provider,{value:Pe},s.createElement(Cd,{style:_s,className:Ee,inWidth:b??Ys,inHeight:x??Gs},s.createElement(nd,{fillHandle:Lo,drawFocusRing:Oo,experimental:Ue,fixedShadowX:Ft,fixedShadowY:Fn,getRowThemeOverride:rn,headerIcons:ur,imageWindowLoader:Wn,initialSize:Hn,isDraggable:Tn,onDragLeave:ho,onRowMoved:$n,overscrollX:Go,overscrollY:ei,preventDiagonalScrolling:mo,rightElement:wo,rightElementProps:bo,smoothScrollX:Nn,smoothScrollY:qr,className:Ee,enableGroups:rt,onCanvasFocused:Ns,onCanvasBlur:Xs,canvasRef:l,onContextMenu:Hs,theme:Pe,cellXOffset:ni,cellYOffset:Cr,accessibilityHeight:Zt.height,onDragEnd:Es,columns:Be,nonGrowWidth:hn,drawHeader:we,onColumnProposeMove:Ss,drawCell:Ht,disabledRows:zs,freezeColumns:Ls,lockColumns:D,firstColAccessible:D===0,getCellContent:Jt,minColumnWidth:Pn,maxColumnWidth:vo,searchInputRef:a,showSearch:Co,onSearchClose:ti,highlightRegions:ws,getCellsForSelection:k,getGroupDetails:ri,headerHeight:Yo,isFocused:$s,groupHeaderHeight:rt?yr:0,freezeTrailingRows:Bt+(ft&&(De==null?void 0:De.sticky)===!0?1:0),hasAppendRow:ft,onColumnResize:re,onColumnResizeEnd:Te,onColumnResizeStart:Ve,onCellFocused:Ws,onColumnMoved:Ms,onDragStart:Rs,onHeaderMenuClick:Cs,onHeaderIndicatorClick:xs,onItemHovered:hi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:vs,onKeyDown:Jo,onKeyUp:Xe,onMouseDown:bs,onMouseUp:ps,onDragOverCell:vt,onDrop:on,onSearchResultsChanged:As,onVisibleRegionChanged:ks,clientSize:xt,rowHeight:Cn,searchResults:V,searchValue:he,onSearchValueChange:ne,rows:Wt,scrollRef:ct,selection:B,translateX:Zt.tx,translateY:Zt.ty,verticalBorder:Ps,gridRef:Pt,getCellRenderer:kt,resizeIndicator:mr}),Bs,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Td,{...r,validateCell:ce,bloom:N,id:Fs,getCellRenderer:kt,className:(Ue==null?void 0:Ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:wt,imageEditorOverride:m,portalElementRef:Ni,onFinishEditing:Ds,markdownDivCreateNode:h,isOutsideClick:Zr,customEventTarget:Ue==null?void 0:Ue.eventTarget}))))},Bd=s.forwardRef(Pd);function Dl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+l/2),m=Ll(u,l,i.cellVerticalPadding),w=Bl(t.contentAlign??"center",c,a,i.cellHorizontalPadding,m),h=Pl(w,g,m),b=Wl(c+n,f+o,h);return Ti(t)&&b}const Ld={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:Z.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Wd(e,e.cell.data,Ti(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Dl(e)&&e.preventDefault()},onClick:e=>{if(Dl(e))return{...e.cell,data:us(e.cell.data)}},onPaste:(e,t)=>{let n=Nr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Hi),n===t.data?void 0:{...t,data:n}}};function Wd(e,t,n,o,r){if(!n&&t===Nr)return;const{ctx:i,hoverAmount:a,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:g,cell:{contentAlign:m}}=e,{x:w,y:h,width:b,height:x}=c;let C=!1;if(r>0){let y=n?1-r+r*a:.4;if(t===Nr&&(y*=a),y===0)return;y<1&&(C=!0,i.globalAlpha=y)}Wi(i,l,t,w,h,b,x,f,u,g,o,m),C&&(i.globalAlpha=1)}const $d=tn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Od=e=>{const{bubbles:t}=e;return s.createElement($d,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Nd={getAccessibilityString:e=>$l(e.data),kind:Z.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Xd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Od,{bubbles:t.data})},onPaste:()=>{}};function Xd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:c,height:f}=n;let u=a+o.cellHorizontalPadding;const g=[];for(const m of t){if(u>a+c)break;const w=Bo(m,r,o.baseFontFull).width;g.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const m of g)En(r,m.x,l+(f-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,w]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],w.x+o.bubblePadding,l+f/2+Qn(r,o))}const Yd=tn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Gd=e=>{const{drilldowns:t}=e;return s.createElement(Yd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},_d={getAccessibilityString:e=>$l(e.data.map(t=>t.text)),kind:Z.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Ud(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Gd,{drilldowns:t.data})},onPaste:()=>{}},xi={};function Kd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,c=n*r,f=o+i,u=o*3,g=(u+i*2)*r,m=`${e},${t},${r},${n}`;if(xi[m]!==void 0)return{el:xi[m],height:c,width:g,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=g,w.height=c,h.scale(r,r),xi[m]=w,h.beginPath(),En(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),En(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:c,width:g,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Ud(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,g=Kl(r,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-m)/2),h=m-10,b=o.bubblePadding,x=o.bubbleMargin;let C=c+o.cellHorizontalPadding;const y=o.roundingRadius??6,M=Kd(o.bgCell,o.drilldownBorder,m,y),X=[];for(const L of t){if(C>c+f)break;const W=Bo(L.text,r,u).width;let Y=0;L.img!==void 0&&i.loadOrGetImage(L.img,a,l)!==void 0&&(Y=h-8+4);const S=W+Y+b*2;X.push({x:C,width:S}),C+=S+x}if(M!==null){const{el:L,height:P,middleWidth:W,sideWidth:Y,width:S,dpr:$,padding:N}=M,z=Y/$,I=N/$;for(const E of X){const ae=Math.floor(E.x),q=Math.floor(E.width),oe=q-(z-I)*2;r.imageSmoothingEnabled=!1,r.drawImage(L,0,0,Y,P,ae-I,w,z,m),oe>0&&r.drawImage(L,Y,0,W,P,ae+(z-I),w,oe,m),r.drawImage(L,S-Y,0,Y,P,ae+q-(z-I),w,z,m),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[L,P]of X.entries()){const W=t[L];let Y=P.x+b;if(W.img!==void 0){const S=i.loadOrGetImage(W.img,a,l);if(S!==void 0){const $=h-8;let N=0,z=0,I=S.width,E=S.height;I>E?(N+=(I-E)/2,I=E):E>I&&(z+=(E-I)/2,E=I),r.beginPath(),En(r,Y,w+m/2-$/2,$,$,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(S,N,z,I,E,Y,w+m/2-$/2,$,$),r.restore(),Y+=$+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(W.text,Y,w+m/2+Qn(r,o))}}const Vd={getAccessibilityString:e=>e.data.join(", "),kind:Z.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>qd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ha;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},ki=4;function qd(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:g,height:m,width:w}=r,h=m-l.cellVerticalPadding*2,b=[];let x=0;for(let y=0;y<t.length;y++){const M=t[y];if(M.length===0)continue;const X=f.loadOrGetImage(M,i,a);if(X!==void 0){b[y]=X;const L=X.width*(h/X.height);x+=L+ki}}if(x===0)return;x-=ki;let C=u+l.cellHorizontalPadding;o==="right"?C=Math.floor(u+w-l.cellHorizontalPadding-x):o==="center"&&(C=Math.floor(u+w/2-x/2));for(const y of b){if(y===void 0)continue;const M=y.width*(h/y.height);n>0&&(c.beginPath(),En(c,C,g+l.cellVerticalPadding,M,h,n),c.save(),c.clip()),c.drawImage(y,C,g+l.cellVerticalPadding,M,h),n>0&&c.restore(),C+=M+ki}}function jd(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Zd={getAccessibilityString:()=>"",kind:Z.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(jd(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);En(r,i.x+c,i.y+(i.height-f)/2,l,f,a.roundingRadius??3),r.fillStyle=uo(a.textDark,.1),r.fill()},onPaste:()=>{}},Jd=()=>e=>e.targetWidth,Fl=tn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Jd(),"px"]}}),Qd=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,g]=s.useState(c===""||o),m=s.useCallback(()=>{g(h=>!h)},[]),w=c?"gdg-ml-6":"";return u?s.createElement(Fl,{targetWidth:i.width-20},s.createElement(Ur,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>a(t)},s.createElement(la,null))):s.createElement(Fl,{targetWidth:i.width},s.createElement(ma,{contents:c,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:m},s.createElement(Ai,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},eu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Z.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:dr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(Qd,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},tu={getAccessibilityString:e=>e.row.toString(),kind:un.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:nu,measure:()=>44,draw:e=>ru(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function nu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=ou,n.textAlign="center",i}function ou(e){const{ctx:t}=e;t.textAlign="start"}function ru(e,t,n,o,r,i){const{ctx:a,rect:l,hoverAmount:c,theme:f}=e,{x:u,y:g,width:m,height:w}=l,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const b=7*(n?c:1);if(Wi(a,f,n,r?u+b:u,g,r?m-b:m,w,!0,void 0,void 0,f.checkboxMaxSize,"center",i),r){a.globalAlpha=c,a.beginPath();for(const x of[3,6])for(const C of[-5,-1,3])a.rect(u+x,g+w/2+C,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),x=f.markerFontFull,C=u+m/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=f.textLight,a.font=x,a.fillText(b,C,g+w/2+Qn(a,x)),c!==0&&(a.globalAlpha=1)}}const iu={getAccessibilityString:()=>"",kind:un.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>lu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function lu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:c,y:f,width:u,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let w=0;if(n!==void 0){const b=g-8,x=c+8/2,C=f+8/2;l.drawSprite(n,"normal",o,x,C,b,a,m?1:i),w=b}else{w=24;const h=12,b=m?h:i*h,x=m?0:(1-i)*h*.5,C=a.cellHorizontalPadding+4;b>0&&(o.moveTo(c+C+x,f+g/2),o.lineTo(c+C+x+b,f+g/2),o.moveTo(c+C+x+b*.5,f+g/2-b*.5),o.lineTo(c+C+x+b*.5,f+g/2+b*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,w+c+a.cellHorizontalPadding+.5,f+g/2+Qn(o,a)),o.beginPath()}function gs(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=su(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),En(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??uo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function su(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=Bo(n,e,o.baseFontFull,"alphabetic"),c=t.height-a,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const au=s.lazy(async()=>await Tl(()=>import("./number-overlay-editor-Cgq4yd4g.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),cu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Z.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:dr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&gs(o,r,f,c,i,t,a),Rn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(au,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},du={getAccessibilityString:()=>"",measure:()=>108,kind:Z.Protected,needsHover:!1,needsHoverPosition:!1,draw:uu,onPaste:()=>{}};function uu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+a/2,u=Math.cos(cl(30))*l,g=Math.sin(cl(30))*l;for(let m=0;m<12;m++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-g),t.lineTo(c-u,f+g),t.moveTo(c-u,f-g),t.lineTo(c+u,f+g),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const fu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Z.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>dr(e,t,e.theme.textLight),draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return Mt.createElement(Ur,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Z.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:dr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:g,hoverEffectTheme:m}=t;u===!0&&n>0&&gs(r,a,m,c,i,n,l),Rn(e,c,f,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Ur,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},gu=tn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),mu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[l,c]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{c(!0)},[]);return l?s.createElement(Ur,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(gu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Ai,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ms(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function Hl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Gl(a,i.baseFontFull);if(l===void 0)return!1;const c=ms(l,n,i,t.contentAlign);return co({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const wu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Z.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:dr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Bo(c,l,n.baseFontFull),g=ms(u,a,n,t.contentAlign),{x:m,y:w,width:h,height:b}=g;if(r>=m-4&&r<=m-4+h+8&&i>=w-4&&i<=w-4+b+8){const x=Qn(l,n.baseFontFull);o("pointer");const C=5,y=w-x;l.beginPath(),l.moveTo(a.x+m,Math.floor(a.y+y+b+C)+.5),l.lineTo(a.x+m+h,Math.floor(a.y+y+b+C)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Rn({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),Rn({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),Rn({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),Rn({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Rn(e,c,t.contentAlign)},onSelect:e=>{Hl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Hl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(mu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},bu=[tu,iu,Ld,Nd,_d,Vd,Zd,eu,cu,du,fu,hu,wu],Si=[];class yu extends Vl{constructor(){super(...arguments);$e(this,"imageLoaded",()=>{});$e(this,"loadedLocations",[]);$e(this,"cache",{});$e(this,"sendLoaded",Qs(()=>{this.imageLoaded(new lr(this.loadedLocations)),this.loadedLocations=[]},20));$e(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=Si.pop()??new Image;let c=!1;const f={img:void 0,cells:[pn(o,r)],url:n,cancel:()=>{c||(c=!0,Si.length<12?Si.unshift(l):a||(l.src=""))}},u=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const g=this.cache[i];if(g!==void 0&&!c){g.img=l;for(const m of g.cells)this.loadedLocations.push(Li(m));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=pn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const pu=(e,t)=>{const n=s.useMemo(()=>({...fc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??bu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new yu,[e.imageWindowLoader]);return s.createElement(Bd,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Hu=s.forwardRef(pu);export{od as C,Hu as D,Z as G,Zl as T,Ur as a,Kl as b,en as c,Du as d,Iu as e,Ru as f,Qn as g,Do as h,Eu as i,ll as j,Ho as k,oa as l,Bo as m,Pa as n,zo as p,En as r,Fu as u};
