const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-B8mhwLvG.js","./iframe-Cq2XwzQG.js","./marked.esm-B228vmBx.js","./react-number-format.es-BGhfx7JN.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var Li=Object.defineProperty;var Ni=(e,t,n)=>t in e?Li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ne=(e,t,n)=>Ni(e,typeof t!="symbol"?t+"":t,n);import{r as y,R as Zt,_ as Oi}from"./iframe-Cq2XwzQG.js";import{h as Xi,g as $i,k as Yi,v as _i,l as Vi,m as pn,r as qi,j as Ui,t as ji}from"./throttle-BMnevX76.js";import{s as ft,a as Ki}from"./marked.esm-B228vmBx.js";function Vo(e="This should not happen"){throw new Error(e)}function dt(e,t="Assertion failed"){if(!e)return Vo(t)}function Un(e,t){return Vo(t??"Hell froze over")}function Js(e,t){try{return e()}catch{return t}}const wo=Object.prototype.hasOwnProperty;function Lt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Lt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(wo.call(e,n)&&++o&&!wo.call(t,n)||!(n in t)||!Lt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const wn=null,jn=void 0;var ae=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(ae||{}),Gi=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(Gi||{}),On=(e=>(e.Triangle="triangle",e.Dots="dots",e))(On||{});function Qs(e){return"width"in e&&typeof e.width=="number"}async function Zs(e){return typeof e=="object"?e:await e()}function Ji(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function el(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function qo(e){return e.kind==="marker"||e.kind==="new-row"}function Qi(e){if(!Ji(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:Un(e,"A cell was passed with an invalid kind")}}function tl(e){return Xi(e,"editor")}function Kn(e){return!(e.readonly??!1)}var en=(e=>(e.NewRow="new-row",e.Marker="marker",e))(en||{});function Zi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let ko;const ct=class ct{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new ct(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Zi([...this.items,n]);return new ct(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const c=[];s<o&&c.push([s,o]),i<a&&c.push([i,a]),n.splice(r,1,...c)}}return new ct(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ne(ct,"empty",()=>ko??(ko=new ct([]))),ne(ct,"fromSingleSelection",t=>ct.empty().add(t));let Xn=ct;function Ke(e,t,n,o,i=!1){const r=y.useRef();r.current=t,y.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var c;(c=r.current)==null||c.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function nl(e,t){return e===void 0?void 0:t}const er=Math.PI;function xo(e){return e*er/180}const Uo=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),jo=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},Ko=(e,t,n)=>Math.min(e,t-n*2),Go=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Gn=e=>{const t=e.fgColor??"currentColor";return y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),y.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},tr=e=>{const t=e.fgColor??"currentColor";return y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function nr(e,t,n){const[o,i]=y.useState(e),r=y.useRef(!0);y.useEffect(()=>()=>{r.current=!1},[]);const l=y.useRef($i(s=>{r.current&&i(s)},n));return y.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const or="֑-߿יִ-﷽ﹰ-ﻼ",ir="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",rr=new RegExp("^[^"+ir+"]*["+or+"]");function Jn(e){return rr.test(e)?"rtl":"not-rtl"}let mn;function Co(){if(typeof document>"u")return 0;if(mn!==void 0)return mn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),mn=n-o,mn}const Mt=Symbol();function ol(e){const t=y.useRef([Mt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=y.useState(e),[,i]=y.useState(),r=y.useCallback(s=>{const a=t.current[0];a!==Mt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Mt&&i({}),o(c=>typeof s=="function"?s(a===Mt?c:a):s),t.current[0]=Mt)},[]),l=y.useCallback(()=>{t.current[0]=Mt,i({})},[]);return[t.current[0]===Mt?n:t.current[0],r,l]}function Jo(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function il(e){const t=y.useRef(e);return Lt(e,t.current)||(t.current=e),t.current}function sr(e,t){return Zt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function rl(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(vn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function $n(e,t){return(e??"")===(t??"")}function lr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function ar(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function vn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Qo(e){return[e.x+e.width-1,e.y+e.height-1]}function So(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,f]=t.span;return c>=o&&c<=i||f>=o&&c<=i||c<o&&f>i}function cr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&So(e,t,r)&&i++;for(const l of n.current.rangeStack)So(e,t,l)&&i++;return i}function Zo(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function Nt(e,t){let n=0;const o=Zo(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Xt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Yn(e,t,n,o,i){const r=Zo(e,o),l=[];for(const c of r)if(c.sticky)l.push(c);else break;if(l.length>0)for(const c of l)n-=c.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let c=t;c<s;c++){const f=r[c];f.sticky||l.push(f)}return l}function dr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function ur(e,t,n,o,i,r,l,s,a,c){const f=o+i;if(n&&e<=i)return-2;if(e<=f)return-1;let g=t;for(let d=0;d<c;d++){const u=r-1-d,b=typeof l=="number"?l:l(u);if(g-=b,e>=g)return u}const m=r-c,h=e-(a??0);if(typeof l=="number"){const d=Math.floor((h-f)/l)+s;return d>=m?void 0:d}else{let d=f;for(let u=s;u<m;u++){const b=l(u);if(h<=d+b)return u;d+=b}return}}let bn=0,Jt={};const fr=typeof window>"u";async function hr(){var e;fr||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,bn=0,Jt={},_i())}hr();function ei(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function $t(e,t,n,o="middle"){const i=ei(e,t,o,n);let r=Jt[i];return r===void 0&&(r=t.measureText(e),Jt[i]=r,bn++),bn>1e4&&(Jt={},bn=0),r}function ti(e,t){const n=ei(e,void 0,"middle",t);return Jt[n]}function pt(e,t){return typeof t!="string"&&(t=t.baseFontFull),gr(e,t)}function Io(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Eo=[];function gr(e,t){for(const r of Eo)if(r.key===t)return r.val;const n=Io(e,"alphabetic"),i=-(Io(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Eo.push({key:t,val:i}),i}function mr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let c=Number.MAX_SAFE_INTEGER;const f=500;if(t!==void 0&&(c=n-t,c<f)){const g=1-c/f;l.globalAlpha=g,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return c<f}function nn(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function ni(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function oi(e,t){const n=$t("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function yr(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function vr(e,t,n,o,i,r,l,s,a,c){const f=s.baseFontFull,g=Yi(e,t,f,i-s.cellHorizontalPadding*2,c??!1),m=oi(e,f),h=s.lineHeight*m,d=m+h*(g.length-1),u=d+s.cellVerticalPadding>r;u&&(e.save(),e.rect(n,o,i,r),e.clip());const b=o+r/2-d/2;let p=Math.max(o+s.cellVerticalPadding,b);for(const k of g)if(ni(e,k,n,p,i,m,l,s,a),p+=h,p>o+r)break;u&&e.restore()}function ut(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:c,width:f,height:g}=l;o=o??!1,o||(t=yr(t,f));const m=pt(r,s),h=Jn(t)==="rtl";if(n===void 0&&h&&(n="right"),h&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?vr(r,t,a,c,f,g,m,s,n,i):ni(r,t,a,c,f,g,m,s,n),d&&(r.textAlign="start"),h&&(r.direction="inherit")}}function it(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function br(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function pr(e,t,n){const o=function(s,a){const c=a.x-s.x,f=a.y-s.y,g=Math.sqrt(c*c+f*f),m=c/g,h=f/g;return{x:c,y:a.y-s.y,len:g,nx:m,ny:h,ang:Math.atan2(h,m)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const c=t[(s+1)%r],f=o(a,l),g=o(a,c),m=f.nx*g.ny-f.ny*g.nx,h=f.nx*g.nx-f.ny*-g.ny;let d=Math.asin(m<-1?-1:m>1?1:m),u=1,b=!1;h<0?d<0?d=Math.PI+d:(d=Math.PI-d,u=-1,b=!0):d>0&&(u=-1,b=!0),i=a.radius!==void 0?a.radius:n;const p=d/2;let k=Math.abs(Math.cos(p)*i/Math.sin(p)),E;k>Math.min(f.len/2,g.len/2)?(k=Math.min(f.len/2,g.len/2),E=Math.abs(k*Math.sin(p)/Math.cos(p))):E=i;let B=a.x+g.nx*k,D=a.y+g.ny*k;B+=-g.ny*E*u,D+=g.nx*E*u,e.arc(B,D,E,f.ang+Math.PI/2*u,g.ang-Math.PI/2*u,b),l=a,a=c}e.closePath()}function _n(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d){const u={x:0,y:r+c,width:0,height:0};if(e>=h.length||t>=f||t<-2||e<0)return u;const b=r-i;if(e>=g){const p=l>e?-1:1,k=Nt(h);u.x+=k+a;for(let E=l;E!==e;E+=p)u.x+=h[p===1?E:E-1].width*p}else for(let p=0;p<e;p++)u.x+=h[p].width;if(u.width=h[e].width+1,t===-1)u.y=i,u.height=b;else if(t===-2){u.y=0,u.height=i;let p=e;const k=h[e].group,E=h[e].sticky;for(;p>0&&$n(h[p-1].group,k)&&h[p-1].sticky===E;){const D=h[p-1];u.x-=D.width,u.width+=D.width,p--}let B=e;for(;B+1<h.length&&$n(h[B+1].group,k)&&h[B+1].sticky===E;){const D=h[B+1];u.width+=D.width,B++}if(!E){const D=Nt(h),I=u.x-D;I<0&&(u.x-=I,u.width+=I),u.x+u.width>n&&(u.width=n-u.x)}}else if(t>=f-m){let p=f-t;for(u.y=o;p>0;){const k=t+p-1;u.height=typeof d=="number"?d:d(k),u.y-=u.height,p--}u.height+=1}else{const p=s>t?-1:1;if(typeof d=="number"){const k=t-s;u.y+=k*d}else for(let k=s;k!==t;k+=p)u.y+=d(k)*p;u.height=(typeof d=="number"?d:d(t))+1}return u}const Qn=1<<21;function Ze(e,t){return(t+2)*Qn+e}function ii(e){return e%Qn}function Zn(e){return Math.floor(e/Qn)-2}function eo(e){const t=ii(e),n=Zn(e);return[t,n]}class ri{constructor(){ne(this,"visibleWindow",{x:0,y:0,width:0,height:0});ne(this,"freezeCols",0);ne(this,"freezeRows",[]);ne(this,"isInWindow",t=>{const n=ii(t),o=Zn(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Lt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class wr extends ri{constructor(){super(...arguments);ne(this,"cache",new Map);ne(this,"setValue",(n,o)=>{this.cache.set(Ze(n[0],n[1]),o)});ne(this,"getValue",n=>this.cache.get(Ze(n[0],n[1])));ne(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Qt{constructor(t=[]){ne(this,"cells");this.cells=new Set(t.map(n=>Ze(n[0],n[1])))}add(t){this.cells.add(Ze(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(Ze(t[0],t[1]))}remove(t){this.cells.delete(Ze(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Zn(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(Ze(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield eo(t)}}function kr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class xr{constructor(t,n){ne(this,"spriteMap",new Map);ne(this,"headerIcons");ne(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[c,f]=kr(n,s),g=l*Math.ceil(window.devicePixelRatio),m=`${c}_${f}_${g}_${t}`;let h=this.spriteMap.get(m);if(h===void 0){const d=this.headerIcons[t];if(d===void 0)return;h=document.createElement("canvas");const u=h.getContext("2d");if(u===null)return;const b=new Image;b.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:f,bgColor:c}))}`,this.spriteMap.set(m,h);const p=b.decode();if(p===void 0)return;this.inFlight++,p.then(()=>{u.drawImage(b,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(h,0,0,g,g,i,r,l,l),a<1&&(o.globalAlpha=1)}}const Pn={};let bt=null;function Cr(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Vn(e){const t=e.toLowerCase().trim();if(Pn[t]!==void 0)return Pn[t];bt=bt||Cr(),bt.style.color="#000",bt.style.color=t;const n=getComputedStyle(bt).color;bt.style.color="#fff",bt.style.color=t;const o=getComputedStyle(bt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),Pn[t]=i,i}function on(e,t){const[n,o,i]=Vn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Mo=new Map;function Fo(e,t){const n=`${e}-${t}`,o=Mo.get(n);if(o!==void 0)return o;const i=Ve(e,t);return Mo.set(n,i),i}function Ve(e,t){if(t===void 0)return e;const[n,o,i,r]=Vn(e);if(r===1)return e;const[l,s,a,c]=Vn(t),f=r+c*(1-r),g=(r*n+c*l*(1-r))/f,m=(r*o+c*s*(1-r))/f,h=(r*i+c*a*(1-r))/f;return`rgba(${g}, ${m}, ${h}, ${f})`}function si(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function kn(e,t,n,o,i,r,l,s,a){s=s??t;let c=t,f=e;const g=o-r;let m=!1;for(;c<n&&f<g;){const h=i(f);if(c+h>s&&a(c,f,h,!1,l&&f===o-1)===!0){m=!0;break}c+=h,f++}if(!m){c=n;for(let h=0;h<r;h++){f=o-1-h;const d=i(f);c-=d,a(c,f,d,!0,l&&f===o-1)}}}function wt(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const c of e){const f=c.sticky?s:l+n;if(r(c,f,a,c.sticky?0:s,t)===!0)break;l+=c.width,s+=c.sticky?c.width:0}}function li(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let c=s+1,f=a.width;for(a.sticky&&(l+=f);c<e.length&&$n(e[c].group,a.group)&&e[c].sticky===e[s].sticky;){const u=e[c];f+=u.width,c++,s++,u.sticky&&(l+=u.width)}const g=a.sticky?0:n,m=r+g,h=a.sticky?0:Math.max(0,l-m),d=Math.min(f-h,t-(m+h));i([a.sourceIndex,e[c-1].sourceIndex],a.group??"",m+h,0,d,o),r+=f}}function ai(e,t,n,o,i,r,l){var m;const[s,a]=e;let c,f;const g=((m=l.find(h=>!h.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const h=Math.max(s,g);let d=t,u=o;for(let b=r.sourceIndex-1;b>=h;b--)d-=l[b].width,u+=l[b].width;for(let b=r.sourceIndex+1;b<=a;b++)u+=l[b].width;f={x:d,y:n,width:u,height:i}}if(g>s){const h=Math.min(a,g-1);let d=t,u=o;for(let b=r.sourceIndex-1;b>=s;b--)d-=l[b].width,u+=l[b].width;for(let b=r.sourceIndex+1;b<=h;b++)u+=l[b].width;c={x:d,y:n,width:u,height:i}}return[c,f]}function sl(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ci={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function ll(){return ci}const al=Zt.createContext(ci);function Ot(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Ve(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function cl(e,t,n,o){if(o==="any")return Sr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),ar([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function tn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function zt(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Sr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Ir(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Er(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,c=e.x+e.width-l,f=r-e.y,g=e.y+e.height-s,m=a>0?e.x+Math.floor(a/o)*o:e.x,h=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=f>0?e.y+Math.floor(f/o)*o:e.y,u=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:d,width:h-m,height:u-d}}function Mr(e,t,n,o,i){const[r,l,s,a]=t,[c,f,g,m]=i,{x:h,y:d,width:u,height:b}=e,p=[];if(u<=0||b<=0)return p;const k=h+u,E=d+b,B=h<r,D=d<l,I=h+u>s,A=d+b>a,z=h>=r&&h<s||k>r&&k<=s||h<r&&k>s,S=d>=l&&d<a||E>l&&E<=a||d<l&&E>a;if(z&&S){const F=Math.max(h,r),C=Math.max(d,l),x=Math.min(k,s),w=Math.min(E,a);p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:c,y:f,width:g-c+1,height:m-f+1}})}if(B&&D){const F=h,C=d,x=Math.min(k,r),w=Math.min(E,l);p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:0,y:0,width:c+1,height:f+1}})}if(D&&z){const F=Math.max(h,r),C=d,x=Math.min(k,s),w=Math.min(E,l);p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:c,y:0,width:g-c+1,height:f+1}})}if(D&&I){const F=Math.max(h,s),C=d,x=k,w=Math.min(E,l);p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:g,y:0,width:n-g+1,height:f+1}})}if(B&&S){const F=h,C=Math.max(d,l),x=Math.min(k,r),w=Math.min(E,a);p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:0,y:f,width:c+1,height:m-f+1}})}if(I&&S){const F=Math.max(h,s),C=Math.max(d,l),x=k,w=Math.min(E,a);p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:g,y:f,width:n-g+1,height:m-f+1}})}if(B&&A){const F=h,C=Math.max(d,a),x=Math.min(k,r),w=E;p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:0,y:m,width:c+1,height:o-m+1}})}if(A&&z){const F=Math.max(h,r),C=Math.max(d,a),x=Math.min(k,s),w=E;p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:c,y:m,width:g-c+1,height:o-m+1}})}if(I&&A){const F=Math.max(h,s),C=Math.max(d,a),x=k,w=E;p.push({rect:{x:F,y:C,width:x-F,height:w-C},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return p}const Fr={kind:ae.Loading,allowOverlay:!1};function Bo(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b,p,k,E,B,D,I,A,z,S,P,F,C,x,w,U,V,q,re){let se=(E==null?void 0:E.size)??Number.MAX_SAFE_INTEGER;const fe=performance.now();let he=x.baseFontFull;e.font=he;const Le={ctx:e},j=[0,0],Ae=b>0?Xt(a,b,c):0;let Se,O;const pe=si(k);return wt(t,s,r,l,i,(G,Ie,qe,rt,kt)=>{const st=Math.max(0,rt-Ie),Ue=Ie+st,me=i+1,ht=G.width-st,gt=o-i-1;if(k.length>0){let ke=!1;for(let le=0;le<k.length;le++){const ye=k[le];if(tn(Ue,me,ht,gt,ye.x,ye.y,ye.width,ye.height)){ke=!0;break}}if(!ke)return}const Oe=()=>{e.save(),e.beginPath(),e.rect(Ue,me,ht,gt),e.clip()},ce=B.columns.hasIndex(G.sourceIndex),Xe=g(G.group??"").overrideTheme,Ee=G.themeOverride===void 0&&Xe===void 0?x:Ot(x,Xe,G.themeOverride),We=Ee.baseFontFull;We!==he&&(he=We,e.font=We),Oe();let J;return kn(kt,qe,o,a,c,b,p,pe,(ke,le,ye,L,$)=>{var Ct,et,tt;if(le<0||(j[0]=G.sourceIndex,j[1]=le,E!==void 0&&!E.has(j)))return;if(k.length>0){let te=!1;for(let Fe=0;Fe<k.length;Fe++){const we=k[Fe];if(tn(Ie,ke,G.width,ye,we.x,we.y,we.width,we.height)){te=!0;break}}if(!te)return}const de=B.rows.hasIndex(le),ee=h.hasIndex(le),oe=le<a?f(j):Fr;let xe=Ie,ue=G.width,K=!1,He=!1;if(oe.span!==void 0){const[te,Fe]=oe.span,we=`${le},${te},${Fe},${G.sticky}`;if(O===void 0&&(O=new Set),O.has(we)){se--;return}else{const nt=ai(oe.span,Ie,ke,G.width,ye,G,n),_e=G.sticky?nt[0]:nt[1];if(!G.sticky&&nt[0]!==void 0&&(He=!0),_e!==void 0){xe=_e.x,ue=_e.width,O.add(we),e.restore(),J=void 0,e.save(),e.beginPath();const mt=Math.max(0,rt-_e.x);e.rect(_e.x+mt,ke,_e.width-mt,ye),Se===void 0&&(Se=[]),Se.push({x:_e.x+mt,y:ke,width:_e.width-mt,height:ye}),e.clip(),K=!0}}}const $e=m==null?void 0:m(le),Ye=$&&((Ct=G.trailingRowOptions)==null?void 0:Ct.themeOverride)!==void 0?(et=G.trailingRowOptions)==null?void 0:et.themeOverride:void 0,Me=oe.themeOverride===void 0&&$e===void 0&&Ye===void 0?Ee:Ot(Ee,$e,Ye,oe.themeOverride);e.beginPath();const je=lr(j,oe,B);let ze=cr(j,oe,B,u);const Bt=oe.span!==void 0&&B.columns.some(te=>oe.span!==void 0&&te>=oe.span[0]&&te<=oe.span[1]);je&&!d&&u?ze=0:je&&u&&(ze=Math.max(ze,1)),Bt&&ze++,je||(de&&ze++,ce&&!$&&ze++);const At=oe.kind===ae.Protected?Me.bgCellMedium:Me.bgCell;let ve;if((L||At!==x.bgCell)&&(ve=Ve(At,ve)),ze>0||ee){ee&&(ve=Ve(Me.bgHeader,ve));for(let te=0;te<ze;te++)ve=Ve(Me.accentLight,ve)}else if(D!==void 0){for(const te of D)if(te[0]===G.sourceIndex&&te[1]===le){ve=Ve(Me.bgSearchResult,ve);break}}if(I!==void 0)for(let te=0;te<I.length;te++){const Fe=I[te],we=Fe.range;Fe.style!=="solid-outline"&&we.x<=G.sourceIndex&&G.sourceIndex<we.x+we.width&&we.y<=le&&le<we.y+we.height&&(ve=Ve(Fe.color,ve))}let xt=!1;if(E!==void 0){const te=ke+1,we=(L?te+ye-1:Math.min(te+ye-1,o-Ae))-te;(we!==ye-1||xe+1<=rt)&&(xt=!0,e.save(),e.beginPath(),e.rect(xe+1,te,ue-1,we),e.clip()),ve=ve===void 0?Me.bgCell:Ve(ve,Me.bgCell)}const lt=G.sourceIndex===n.length-1,be=le===a-1;ve!==void 0&&(e.fillStyle=ve,J!==void 0&&(J.fillStyle=ve),E!==void 0?e.fillRect(xe+1,ke+1,ue-(lt?2:1),ye-(be?2:1)):e.fillRect(xe,ke,ue,ye)),oe.style==="faded"&&(e.globalAlpha=.6);let Ne;for(let te=0;te<S.length;te++){const Fe=S[te];if(Fe.item[0]===G.sourceIndex&&Fe.item[1]===le){Ne=Fe;break}}if(ue>re&&!He){const te=Me.baseFontFull;te!==he&&(e.font=te,he=te),J=di(e,oe,G.sourceIndex,le,lt,be,xe,ke,ue,ye,ze>0,Me,ve??Me.bgCell,A,z,(Ne==null?void 0:Ne.hoverAmount)??0,P,C,fe,F,J,w,U,V,q)}return xt&&e.restore(),oe.style==="faded"&&(e.globalAlpha=1),se--,K&&(e.restore(),(tt=J==null?void 0:J.deprep)==null||tt.call(J,Le),J=void 0,Oe(),he=We,e.font=We),se<=0}),e.restore(),se<=0}),Se}const Ut=[0,0],jt={x:0,y:0,width:0,height:0},Rn=[void 0,()=>{}];let qn=!1;function Br(){qn=!0}function di(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b,p,k,E,B,D,I,A,z){var U,V;let S,P;b!==void 0&&b[0][0]===n&&b[0][1]===o&&(S=b[1][0],P=b[1][1]);let F;Ut[0]=n,Ut[1]=o,jt.x=l,jt.y=s,jt.width=a,jt.height=c,Rn[0]=I.getValue(Ut),Rn[1]=q=>I.setValue(Ut,q),qn=!1;const C={ctx:e,theme:g,col:n,row:o,cell:t,rect:jt,highlighted:f,cellFillColor:m,hoverAmount:u,frameTime:k,hoverX:S,drawState:Rn,hoverY:P,imageLoader:h,spriteManager:d,hyperWrapping:p,overrideCursor:S!==void 0?z:void 0,requestAnimationFrame:Br},x=mr(C,t.lastUpdated,k,B,i,r),w=A(t);if(w!==void 0){(B==null?void 0:B.renderer)!==w&&((U=B==null?void 0:B.deprep)==null||U.call(B,C),B=void 0);const q=(V=w.drawPrep)==null?void 0:V.call(w,C,B);E!==void 0&&!qo(C.cell)?E(C,()=>w.draw(C,t)):w.draw(C,t),F=q===void 0?void 0:{deprep:q==null?void 0:q.deprep,fillStyle:q==null?void 0:q.fillStyle,font:q==null?void 0:q.font,renderer:w}}return(x||qn)&&(D==null||D(Ut)),F}function to(e,t,n,o,i,r,l,s,a=-20,c=-20,f=32,g="center",m="square"){const h=Math.floor(i+l/2),d=m==="circle"?1e4:t.roundingRadius??4;let u=Ko(f,l,t.cellVerticalPadding),b=u/2;const p=jo(g,o,r,t.cellHorizontalPadding,u),k=Uo(p,h,u),E=Go(o+a,i+c,k);switch(n){case!0:{e.beginPath(),it(e,p-u/2,h-u/2,u,u,d),m==="circle"&&(b*=.8,u*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(p-b+u/4.23,h-b+u/1.97),e.lineTo(p-b+u/2.42,h-b+u/1.44),e.lineTo(p-b+u/1.29,h-b+u/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case wn:case!1:{e.beginPath(),it(e,p-u/2+.5,h-u/2+.5,u-1,u-1,d),e.lineWidth=1,e.strokeStyle=E?t.textDark:t.textMedium,e.stroke();break}case jn:{e.beginPath(),it(e,p-u/2,h-u/2,u,u,d),e.fillStyle=E?t.textMedium:t.textLight,e.fill(),m==="circle"&&(b*=.8,u*=.8),e.beginPath(),e.moveTo(p-u/3,h),e.lineTo(p+u/3,h),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Un()}}function Ar(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b,p,k){var S,P,F,C;const E=l+s;if(E<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,E);const B=(S=o==null?void 0:o[0])==null?void 0:S[0],D=(P=o==null?void 0:o[0])==null?void 0:P[1],I=(F=o==null?void 0:o[1])==null?void 0:F[0],A=(C=o==null?void 0:o[1])==null?void 0:C[1],z=g.headerFontFull;e.font=z,wt(t,0,r,0,E,(x,w,U,V)=>{var G;if(b!==void 0&&!b.has([x.sourceIndex,-1]))return;const q=Math.max(0,V-w);e.save(),e.beginPath(),e.rect(w+q,s,x.width-q,l),e.clip();const re=u(x.group??"").overrideTheme,se=x.themeOverride===void 0&&re===void 0?g:Ot(g,re,x.themeOverride);se.bgHeader!==g.bgHeader&&(e.fillStyle=se.bgHeader,e.fill()),se!==g&&(e.font=se.baseFontFull);const fe=f.columns.hasIndex(x.sourceIndex),he=a!==void 0||c,Le=!he&&D===-1&&B===x.sourceIndex,j=he?0:((G=h.find(Ie=>Ie.item[0]===x.sourceIndex&&Ie.item[1]===-1))==null?void 0:G.hoverAmount)??0,Ae=(f==null?void 0:f.current)!==void 0&&f.current.cell[0]===x.sourceIndex,Se=fe?se.accentColor:Ae?se.bgHeaderHasFocus:se.bgHeader,O=n?s:0,pe=x.sourceIndex===0?0:1;fe?(e.fillStyle=Se,e.fillRect(w+pe,O,x.width-pe,l)):(Ae||j>0)&&(e.beginPath(),e.rect(w+pe,O,x.width-pe,l),Ae&&(e.fillStyle=se.bgHeaderHasFocus,e.fill()),j>0&&(e.globalAlpha=j,e.fillStyle=se.bgHeaderHovered,e.fill(),e.globalAlpha=1)),hi(e,w,O,x.width,l,x,fe,se,Le,Le?I:void 0,Le?A:void 0,Ae,j,m,p,k),e.restore()}),n&&Hr(e,t,i,r,s,o,g,m,h,d,u,b)}function Hr(e,t,n,o,i,r,l,s,a,c,f,g){const[h,d]=(r==null?void 0:r[0])??[];let u=0;li(t,n,o,i,(b,p,k,E,B,D)=>{if(g!==void 0&&!g.hasItemInRectangle({x:b[0],y:-2,width:b[1]-b[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(k,E,B,D),e.clip();const I=f(p),A=(I==null?void 0:I.overrideTheme)===void 0?l:Ot(l,I.overrideTheme),z=d===-2&&h!==void 0&&h>=b[0]&&h<=b[1],S=z?A.bgGroupHeaderHovered??A.bgHeaderHovered:A.bgGroupHeader??A.bgHeader;if(S!==l.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=A.textGroupHeader??A.textHeader,I!==void 0){let P=k;if(I.icon!==void 0&&(s.drawSprite(I.icon,"normal",e,P+8,(i-20)/2,20,A),P+=26),e.fillText(I.name,P+8,i/2+pt(e,l.headerFontFull)),I.actions!==void 0&&z){const F=ui({x:k,y:E,width:B,height:D},I.actions);e.beginPath();const C=F[0].x-10,x=k+B-C;e.rect(C,0,x,i);const w=e.createLinearGradient(C,0,C+x,0),U=on(S,0);w.addColorStop(0,U),w.addColorStop(10/x,S),w.addColorStop(1,S),e.fillStyle=w,e.fill(),e.globalAlpha=.6;const[V,q]=(r==null?void 0:r[1])??[-1,-1];for(let re=0;re<I.actions.length;re++){const se=I.actions[re],fe=F[re],he=zt(fe,V+k,q);he&&(e.globalAlpha=1),s.drawSprite(se.icon,"normal",e,fe.x+fe.width/2-10,fe.y+fe.height/2-10,20,A),he&&(e.globalAlpha=.6)}e.globalAlpha=1}}k!==0&&c(b[0])&&(e.beginPath(),e.moveTo(k+.5,0),e.lineTo(k+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),u=k+B}),e.beginPath(),e.moveTo(u+.5,0),e.lineTo(u+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const yn=30;function Dr(e,t,n,o,i){return{x:e+n-yn,y:Math.max(t,t+o/2-yn/2),width:yn,height:Math.min(yn,o)}}function ui(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function Kt(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function fi(e,t,n,o,i,r,l,s){var p;const a=l.cellHorizontalPadding,c=l.headerIconSize,f=Dr(n,o,i,r);let g=n+a;const m=t.icon===void 0?void 0:{x:g,y:o+(r-c)/2,width:c,height:c},h=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(c*1.3));const d={x:g,y:o,width:i-g,height:r};let u;if(t.indicatorIcon!==void 0){const k=e===void 0?((p=ti(t.title,l.headerFontFull))==null?void 0:p.width)??0:$t(t.title,e,l.headerFontFull).width;d.width=k,g+=k+a,u={x:g,y:o+(r-c)/2,width:c,height:c}}const b=n+i/2;return{menuBounds:Kt(f,b,s),iconBounds:Kt(m,b,s),iconOverlayBounds:Kt(h,b,s),textBounds:Kt(d,b,s),indicatorIconBounds:Kt(u,b,s)}}function Ao(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const k=r.rowMarkerChecked;k!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const E=r.headerRowMarkerTheme!==void 0?Ot(s,r.headerRowMarkerTheme):s;to(e,E,k,t,n,o,i,!1,void 0,void 0,18,"center",r.rowMarker),k!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const b=l?s.textHeaderSelected:s.textHeader,p=r.hasMenu===!0&&(a||h&&l)&&u.menuBounds!==void 0;if(r.icon!==void 0&&u.iconBounds!==void 0){let k=l?"selected":"normal";r.style==="highlight"&&(k=l?"selected":"special"),m.drawSprite(r.icon,k,e,u.iconBounds.x,u.iconBounds.y,u.iconBounds.width,s),r.overlayIcon!==void 0&&u.iconOverlayBounds!==void 0&&m.drawSprite(r.overlayIcon,l?"selected":"special",e,u.iconOverlayBounds.x,u.iconOverlayBounds.y,u.iconOverlayBounds.width,s)}if(p&&o>35){const E=d?35:o-35,B=d?35*.7:o-35*.7,D=E/o,I=B/o,A=e.createLinearGradient(t,0,t+o,0),z=on(b,0);A.addColorStop(d?1:0,b),A.addColorStop(D,b),A.addColorStop(I,z),A.addColorStop(d?0:1,z),e.fillStyle=A}else e.fillStyle=b;if(d&&(e.textAlign="right"),u.textBounds!==void 0&&e.fillText(r.title,d?u.textBounds.x+u.textBounds.width:u.textBounds.x,n+i/2+pt(e,s.headerFontFull)),d&&(e.textAlign="left"),r.indicatorIcon!==void 0&&u.indicatorIconBounds!==void 0&&(!p||!tn(u.menuBounds.x,u.menuBounds.y,u.menuBounds.width,u.menuBounds.height,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,u.indicatorIconBounds.height))){let k=l?"selected":"normal";r.style==="highlight"&&(k=l?"selected":"special"),m.drawSprite(r.indicatorIcon,k,e,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,s)}if(p&&u.menuBounds!==void 0){const k=u.menuBounds,E=c!==void 0&&f!==void 0&&zt(k,c+t,f+n);if(E||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===On.Triangle){e.beginPath();const B=k.x+k.width/2-5.5,D=k.y+k.height/2-3;pr(e,[{x:B,y:D},{x:B+11,y:D},{x:B+5.5,y:D+6}],1),e.fillStyle=b,e.fill()}else if(r.menuIcon===On.Dots){e.beginPath();const B=k.x+k.width/2,D=k.y+k.height/2;br(e,B,D),e.fillStyle=b,e.fill()}else{const B=k.x+(k.width-s.headerIconSize)/2,D=k.y+(k.height-s.headerIconSize)/2;m.drawSprite(r.menuIcon,"normal",e,B,D,s.headerIconSize,s)}E||(e.globalAlpha=1)}}function hi(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u){const b=Jn(r.title)==="rtl",p=fi(e,r,t,n,o,i,s,b);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:m,isHovered:a,hasSelectedCell:g,spriteManager:h,menuBounds:(p==null?void 0:p.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:f},()=>Ao(e,t,n,o,i,r,l,s,a,c,f,m,h,u,b,p)):Ao(e,t,n,o,i,r,l,s,a,c,f,m,h,u,b,p)}function Pr(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b,p,k){if(p!==void 0||t[t.length-1]!==n[t.length-1])return;const E=si(b);wt(t,a,l,s,r,(B,D,I,A,z)=>{if(B!==t[t.length-1])return;D+=B.width;const S=Math.max(D,A);S>o||(e.save(),e.beginPath(),e.rect(S,r+1,1e4,i-r-1),e.clip(),kn(z,I,i,c,f,d,u,E,(P,F,C,x)=>{if(!x&&b.length>0&&!b.some(re=>tn(D,P,1e4,C,re.x,re.y,re.width,re.height)))return;const w=m.hasIndex(F),U=h.hasIndex(F);e.beginPath();const V=g==null?void 0:g(F),q=V===void 0?k:Ot(k,V);q.bgCell!==k.bgCell&&(e.fillStyle=q.bgCell,e.fillRect(D,P,1e4,C)),U&&(e.fillStyle=q.bgHeader,e.fillRect(D,P,1e4,C)),w&&(e.fillStyle=q.accentLight,e.fillRect(D,P,1e4,C))}),e.restore())})}function Rr(e,t,n,o,i,r,l,s,a){let c=!1;for(const d of t)if(!d.sticky){c=l(d.sourceIndex);break}const f=a.horizontalBorderColor??a.borderColor,g=a.borderColor,m=c?Nt(t):0;let h;if(m!==0&&(h=Fo(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=h,e.stroke()),i>0){const d=g===f&&h!==void 0?h:Fo(f,a.bgCell),u=Xt(r,i,s);e.beginPath(),e.moveTo(0,o-u+.5),e.lineTo(n,o-u+.5),e.strokeStyle=d,e.stroke()}}const gi=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Tr(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d){var C;const u=d.bgCell,{minX:b,maxX:p,minY:k,maxY:E}=gi(s,r,l),B=[],D=l-Xt(h,m,c);let I=a,A=n,z=0;for(;I+i<D;){const x=I+i,w=c(A);if(x>=k&&x<=E-1){const U=f==null?void 0:f(A),V=U==null?void 0:U.bgCell;V!==void 0&&V!==u&&A>=h-m&&B.push({x:b,y:x,w:p-b,h:w,color:V})}I+=w,A<h-m&&(z=I),A++}let S=0;const P=Math.min(D,E)-z;if(P>0)for(let x=0;x<t.length;x++){const w=t[x];if(w.width===0)continue;const U=w.sticky?S:S+o,V=(C=w.themeOverride)==null?void 0:C.bgCell;V!==void 0&&V!==u&&U>=b&&U<=p&&g(x+1)&&B.push({x:U,y:z,w:w.width,h:P,color:V}),S+=w.width}if(B.length===0)return;let F;e.beginPath();for(let x=B.length-1;x>=0;x--){const w=B[x];F===void 0?F=w.color:w.color!==F&&(e.fillStyle=F,e.fill(),e.beginPath(),F=w.color),e.rect(w.x,w.y,w.w,w.h)}F!==void 0&&(e.fillStyle=F,e.fill()),e.beginPath()}function Ho(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b,p=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const C of a)e.rect(C.x+1,C.y+1,C.width-1,C.height-1);e.clip("evenodd")}const k=b.horizontalBorderColor??b.borderColor,E=b.borderColor,{minX:B,maxX:D,minY:I,maxY:A}=gi(s,r,l),z=[];e.beginPath();let S=.5;for(let C=0;C<t.length;C++){const x=t[C];if(x.width===0)continue;S+=x.width;const w=x.sticky?S:S+o;w>=B&&w<=D&&h(C+1)&&z.push({x1:w,y1:Math.max(c,I),x2:w,y2:Math.min(l,A),color:E})}let P=l+.5;for(let C=u-d;C<u;C++){const x=g(C);P-=x,z.push({x1:B,y1:P,x2:D,y2:P,color:k})}if(p!==!0){let C=f+.5,x=n;const w=P;for(;C+i<w;){const U=C+i;if(U>=I&&U<=A-1){const V=m==null?void 0:m(x);z.push({x1:B,y1:U,x2:D,y2:U,color:(V==null?void 0:V.horizontalBorderColor)??(V==null?void 0:V.borderColor)??k})}C+=g(x),x++}}const F=Vi(z,C=>C.color);for(const C of Object.keys(F)){e.strokeStyle=C;for(const x of F[C])e.moveTo(x.x1,x.y1),e.lineTo(x.x2,x.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Wr(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b,p,k){const E=[];e.imageSmoothingEnabled=!1;const B=Math.min(i.cellYOffset,l),D=Math.max(i.cellYOffset,l);let I=0;if(typeof p=="number")I+=(D-B)*p;else for(let w=B;w<D;w++)I+=p(w);l>i.cellYOffset&&(I=-I),I+=a-i.translateY;const A=Math.min(i.cellXOffset,r),z=Math.max(i.cellXOffset,r);let S=0;for(let w=A;w<z;w++)S+=u[w].width;r>i.cellXOffset&&(S=-S),S+=s-i.translateX;const P=Nt(b);if(S!==0&&I!==0)return{regions:[]};const F=c>0?Xt(m,c,p):0,C=f-P-Math.abs(S),x=g-h-F-Math.abs(I)-1;if(C>150&&x>150){const w={sx:0,sy:0,sw:f*d,sh:g*d,dx:0,dy:0,dw:f*d,dh:g*d};if(I>0?(w.sy=(h+1)*d,w.sh=x*d,w.dy=(I+h+1)*d,w.dh=x*d,E.push({x:0,y:h,width:f,height:I+1})):I<0&&(w.sy=(-I+h+1)*d,w.sh=x*d,w.dy=(h+1)*d,w.dh=x*d,E.push({x:0,y:g+I-F,width:f,height:-I+F})),S>0?(w.sx=P*d,w.sw=C*d,w.dx=(S+P)*d,w.dw=C*d,E.push({x:P-1,y:0,width:S+2,height:g})):S<0&&(w.sx=(P-S)*d,w.sw=C*d,w.dx=P*d,w.dw=C*d,E.push({x:f+S,y:0,width:-S,height:g})),e.setTransform(1,0,0,1,0,0),k){if(P>0&&S!==0&&I===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const U=P*d,V=g*d;e.drawImage(t,0,0,U,V,0,0,U,V)}if(F>0&&S===0&&I!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const U=(g-F)*d,V=f*d,q=F*d;e.drawImage(t,0,U,V,q,0,U,V,q)}}e.drawImage(t,w.sx,w.sy,w.sw,w.sh,w.dx,w.dy,w.dw,w.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:E}}function zr(e,t,n,o,i,r,l,s,a,c){const f=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||wt(a,n,o,i,s,(g,m,h,d)=>{if(g.sourceIndex===c){const u=Math.max(m,d)+1;return f.push({x:u,y:0,width:r-u,height:l}),!0}}),f}function Lr(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(Lt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...c}=r;if(!Lt(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function Do(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u){const b=d==null?void 0:d.filter(A=>A.style!=="no-outline");if(b===void 0||b.length===0)return;const p=Nt(s),k=Xt(h,m,g),E=[a,0,s.length,h-m],B=[p,0,t,n-k],D=b.map(A=>{const z=A.range,S=A.style??"dashed";return Mr(z,E,t,n,B).map(P=>{const F=P.rect,C=_n(F.x,F.y,t,n,f,c+f,o,i,r,l,h,a,m,s,g),x=F.width===1&&F.height===1?C:_n(F.x+F.width-1,F.y+F.height-1,t,n,f,c+f,o,i,r,l,h,a,m,s,g);return F.x+F.width>=s.length&&(x.width-=1),F.y+F.height>=h&&(x.height-=1),{color:A.color,style:S,clip:P.clip,rect:Er({x:C.x,y:C.y,width:x.x+x.width-C.x,height:x.y+x.height-C.y},t,n,8)}})}),I=()=>{e.lineWidth=1;let A=!1;for(const z of D)for(const S of z)if((S==null?void 0:S.rect)!==void 0&&tn(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const P=A,F=!Ir(S.clip,S.rect);e.beginPath(),F&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!A?(e.setLineDash([5,3]),A=!0):(S.style==="solid"||S.style==="solid-outline")&&A&&(e.setLineDash([]),A=!1),e.strokeStyle=S.style==="solid-outline"?Ve(Ve(S.color,u.borderColor),u.bgCell):on(S.color,1),e.closePath(),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),F&&(e.restore(),A=P)}A&&e.setLineDash([])};return I(),I}function Po(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Tn(e,t,n,o,i,r,l,s,a,c,f,g,m,h,d,u,b){if(f.current===void 0)return;const p=f.current.range,k=f.current.cell,E=[p.x+p.width-1,p.y+p.height-1];if(k[1]>=b&&E[1]>=b||!l.some(w=>w.sourceIndex===k[0]||w.sourceIndex===E[0]))return;const[D,I]=f.current.cell,A=m(f.current.cell),z=A.span??[D,D],S=I>=b-h,P=h>0&&!S?Xt(b,h,g)-1:0,F=E[1];let C;if(wt(l,o,i,r,c,(w,U,V,q,re)=>{if(w.sticky&&D>w.sourceIndex)return;const se=w.sourceIndex<z[0],fe=w.sourceIndex>z[1],he=w.sourceIndex===E[0];if(!(!he&&(se||fe)))return kn(re,V,n,b,g,h,d,void 0,(Le,j,Ae)=>{if(j!==I&&j!==F)return;let Se=U,O=w.width;if(A.span!==void 0){const G=ai(A.span,U,Le,w.width,Ae,w,s),Ie=w.sticky?G[0]:G[1];Ie!==void 0&&(Se=Ie.x,O=Ie.width)}return j===F&&he&&u&&(C=()=>{var G;q>Se&&!w.sticky&&(e.beginPath(),e.rect(q,0,t-q,n),e.clip()),e.beginPath(),e.rect(Se+O-4,Le+Ae-4,4,4),e.fillStyle=((G=w.themeOverride)==null?void 0:G.accentColor)??a.accentColor,e.fill()}),C!==void 0}),C!==void 0}),C===void 0)return;const x=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-P),e.clip(),C==null||C(),e.restore()};return x(),x}function Nr(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),li(t,n,r,o,(c,f,g,m,h,d)=>{a.hasItemInRectangle({x:c[0],y:-2,width:c[1]-c[0]+1,height:1})&&e.rect(g,m,h,d)}),wt(t,s,r,l,i,(c,f,g,m)=>{const h=Math.max(0,m-f),d=f+h+1,u=c.width-h-1;a.has([c.sourceIndex,-1])&&e.rect(d,o,u,i-o)}),e.clip())}function Or(e,t,n,o,i,r,l,s,a,c){let f=0;return wt(e,r,o,i,n,(g,m,h,d,u)=>(kn(u,h,t,l,s,a,c,void 0,(b,p,k,E)=>{E||(f=Math.max(p,f))}),!0)),f}function Ro(e,t){var lt;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mappedColumns:f,enableGroups:g,freezeColumns:m,dragAndDropState:h,theme:d,drawFocus:u,headerHeight:b,groupHeaderHeight:p,disabledRows:k,rowHeight:E,verticalBorder:B,overrideCursor:D,isResizing:I,selection:A,fillHandle:z,freezeTrailingRows:S,rows:P,getCellContent:F,getGroupDetails:C,getRowThemeOverride:x,isFocused:w,drawHeaderCallback:U,prelightCells:V,drawCellCallback:q,highlightRegions:re,resizeCol:se,imageLoader:fe,lastBlitData:he,hoverValues:Le,hyperWrapping:j,hoverInfo:Ae,spriteManager:Se,maxScaleFactor:O,hasAppendRow:pe,touchMode:G,enqueue:Ie,renderStateProvider:qe,getCellRenderer:rt,renderStrategy:kt,bufferACtx:st,bufferBCtx:Ue,damage:me,minimumCellWidth:ht,resizeIndicator:gt}=e;if(i===0||r===0)return;const Oe=kt==="double-buffer",ce=Math.min(O,Math.ceil(window.devicePixelRatio??1)),Xe=kt!=="direct"&&Lr(e,t),Ee=n.canvas;(Ee.width!==i*ce||Ee.height!==r*ce)&&(Ee.width=i*ce,Ee.height=r*ce,Ee.style.width=i+"px",Ee.style.height=r+"px");const We=o.canvas,J=g?p+b:b,ke=J+1;(We.width!==i*ce||We.height!==ke*ce)&&(We.width=i*ce,We.height=ke*ce,We.style.width=i+"px",We.style.height=ke+"px");const le=st.canvas,ye=Ue.canvas;Oe&&(le.width!==i*ce||le.height!==r*ce)&&(le.width=i*ce,le.height=r*ce,he.current!==void 0&&(he.current.aBufferScroll=void 0)),Oe&&(ye.width!==i*ce||ye.height!==r*ce)&&(ye.width=i*ce,ye.height=r*ce,he.current!==void 0&&(he.current.bBufferScroll=void 0));const L=he.current;if(Xe===!0&&l===(L==null?void 0:L.cellXOffset)&&s===(L==null?void 0:L.cellYOffset)&&a===(L==null?void 0:L.translateX)&&c===(L==null?void 0:L.translateY))return;let $=null;Oe&&($=n);const de=o;let ee;Oe?me!==void 0?ee=(L==null?void 0:L.lastBuffer)==="b"?Ue:st:ee=(L==null?void 0:L.lastBuffer)==="b"?st:Ue:ee=n;const oe=ee.canvas,xe=Oe?oe===le?ye:le:Ee,ue=typeof E=="number"?()=>E:E;de.save(),ee.save(),de.beginPath(),ee.beginPath(),de.textBaseline="middle",ee.textBaseline="middle",ce!==1&&(de.scale(ce,ce),ee.scale(ce,ce));const K=Yn(f,l,i,h,a);let He=[];const $e=u&&((lt=A.current)==null?void 0:lt.cell[1])===s&&c===0;let Ye=!1;if(re!==void 0){for(const be of re)if(be.style!=="no-outline"&&be.range.y===s&&c===0){Ye=!0;break}}const Me=()=>{Ar(de,K,g,Ae,i,a,b,p,h,I,A,d,Se,Le,B,C,me,U,G),Ho(de,K,s,a,c,i,r,void 0,void 0,p,J,ue,x,B,S,P,d,!0),de.beginPath(),de.moveTo(0,ke-.5),de.lineTo(i,ke-.5),de.strokeStyle=Ve(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),de.stroke(),Ye&&Do(de,i,r,l,s,a,c,f,m,b,p,E,S,P,re,d),$e&&Tn(de,i,r,s,a,c,K,f,d,J,A,ue,F,S,pe,z,P)};if(me!==void 0){const be=K[K.length-1].sourceIndex+1,Ne=me.hasItemInRegion([{x:l,y:-2,width:be,height:2},{x:l,y:s,width:be,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:l,y:P-S,width:be,height:S,when:S>0}]),Ct=et=>{Bo(et,K,f,r,J,a,c,s,P,ue,F,C,x,k,w,u,S,pe,He,me,A,V,re,fe,Se,Le,Ae,q,j,d,Ie,qe,rt,D,ht);const tt=A.current;z&&u&&tt!==void 0&&me.has(Qo(tt.range))&&Tn(et,i,r,s,a,c,K,f,d,J,A,ue,F,S,pe,z,P)};Ne&&(Ct(ee),$!==null&&($.save(),$.scale(ce,ce),$.textBaseline="middle",Ct($),$.restore()),me.hasHeader()&&(Nr(de,K,i,p,J,a,c,s,me),Me())),ee.restore(),de.restore();return}if((Xe!==!0||l!==(L==null?void 0:L.cellXOffset)||a!==(L==null?void 0:L.translateX)||$e!==(L==null?void 0:L.mustDrawFocusOnHeader)||Ye!==(L==null?void 0:L.mustDrawHighlightRingsOnHeader))&&Me(),Xe===!0){dt(xe!==void 0&&L!==void 0);const{regions:be}=Wr(ee,xe,xe===le?L.aBufferScroll:L.bBufferScroll,xe===le?L.bBufferScroll:L.aBufferScroll,L,l,s,a,c,S,i,r,P,J,ce,f,K,E,Oe);He=be}else Xe!==!1&&(dt(L!==void 0),He=zr(L,l,s,a,c,i,r,J,K,Xe));Rr(ee,K,i,r,S,P,B,ue,d);const je=Do(ee,i,r,l,s,a,c,f,m,b,p,E,S,P,re,d),ze=u?Tn(ee,i,r,s,a,c,K,f,d,J,A,ue,F,S,pe,z,P):void 0;if(ee.fillStyle=d.bgCell,He.length>0){ee.beginPath();for(const be of He)ee.rect(be.x,be.y,be.width,be.height);ee.clip(),ee.fill(),ee.beginPath()}else ee.fillRect(0,0,i,r);const Bt=Bo(ee,K,f,r,J,a,c,s,P,ue,F,C,x,k,w,u,S,pe,He,me,A,V,re,fe,Se,Le,Ae,q,j,d,Ie,qe,rt,D,ht);Pr(ee,K,f,i,r,J,a,c,s,P,ue,x,A.rows,k,S,pe,He,me,d),Tr(ee,K,s,a,c,i,r,He,J,ue,x,B,S,P,d),Ho(ee,K,s,a,c,i,r,He,Bt,p,J,ue,x,B,S,P,d),je==null||je(),ze==null||ze(),I&&gt!=="none"&&wt(K,0,a,0,J,(be,Ne)=>be.sourceIndex===se?(Po(de,Ne+be.width,0,J+1,Ve(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),gt==="full"&&Po(ee,Ne+be.width,J,r,Ve(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),$!==null&&($.fillStyle=d.bgCell,$.fillRect(0,0,i,r),$.drawImage(ee.canvas,0,0));const At=Or(K,r,J,a,c,s,P,ue,S,pe);fe==null||fe.setWindow({x:l,y:s,width:K.length,height:At-s},m,Array.from({length:S},(be,Ne)=>P-1-Ne));const ve=L!==void 0&&(l!==L.cellXOffset||a!==L.translateX),xt=L!==void 0&&(s!==L.cellYOffset||c!==L.translateY);he.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mustDrawFocusOnHeader:$e,mustDrawHighlightRingsOnHeader:Ye,lastBuffer:Oe?oe===le?"a":"b":void 0,aBufferScroll:oe===le?[ve,xt]:L==null?void 0:L.aBufferScroll,bBufferScroll:oe===ye?[ve,xt]:L==null?void 0:L.bBufferScroll},ee.restore(),de.restore()}const Xr=80;function $r(e){const t=e-1;return t*t*t+1}class Yr{constructor(t){ne(this,"currentHoveredItem");ne(this,"leavingItems",[]);ne(this,"lastAnimationTime");ne(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>vn(o.item,t.item))||this.leavingItems.push(t)});ne(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>vn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ne(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ne(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ne(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:$r(t.hoverAmount)})));ne(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Xr;for(const r of this.leavingItems)r.hoverAmount=pn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=pn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ne(this,"setHovered",t=>{var n;if(!vn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class _r{constructor(t){ne(this,"fn");ne(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function no(e){return new _r(e)}const Vr=no(()=>window.navigator.userAgent.includes("Firefox")),To=no(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),dl=no(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function qr(e){const t=y.useRef([]),n=y.useRef(0),o=y.useRef(e);o.current=e;const i=y.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(eo);t.current=[],o.current(new Qt(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return y.useCallback(r=>{t.current.length===0&&i();const l=Ze(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Ft="header",Wt="group-header",Wo="out-of-bounds";var Gt=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(Gt||{});function Ur(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const zo=6,jr=(e,t)=>{if(e.kind===ae.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Kr=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:c=!1,groupHeaderHeight:f,rowHeight:g,rows:m,getCellContent:h,getRowThemeOverride:d,onHeaderMenuClick:u,onHeaderIndicatorClick:b,enableGroups:p,isFilling:k,onCanvasFocused:E,onCanvasBlur:B,isFocused:D,selection:I,freezeColumns:A,onContextMenu:z,freezeTrailingRows:S,fixedShadowX:P=!0,fixedShadowY:F=!0,drawFocusRing:C,onMouseDown:x,onMouseUp:w,onMouseMoveRaw:U,onMouseMove:V,onItemHovered:q,dragAndDropState:re,firstColAccessible:se,onKeyDown:fe,onKeyUp:he,highlightRegions:Le,canvasRef:j,onDragStart:Ae,onDragEnd:Se,eventTargetRef:O,isResizing:pe,resizeColumn:G,isDragging:Ie,isDraggable:qe=!1,allowResize:rt,disabledRows:kt,hasAppendRow:st,getGroupDetails:Ue,theme:me,prelightCells:ht,headerIcons:gt,verticalBorder:Oe,drawCell:ce,drawHeader:Xe,onCellFocused:Ee,onDragOverCell:We,onDrop:J,onDragLeave:ke,imageWindowLoader:le,smoothScrollX:ye=!1,smoothScrollY:L=!1,experimental:$,getCellRenderer:de,resizeIndicator:ee="full"}=e,oe=e.translateX??0,xe=e.translateY??0,ue=Math.max(A,Math.min(r.length-1,l)),K=y.useRef(null),He=y.useRef(($==null?void 0:$.eventTarget)??window),$e=He.current,Ye=le,Me=y.useRef(),[je,ze]=y.useState(!1),Bt=y.useRef([]),At=y.useRef(),[ve,xt]=y.useState(),[lt,be]=y.useState(),Ne=y.useRef(null),[Ct,et]=y.useState(),[tt,te]=y.useState(!1),Fe=y.useRef(tt);Fe.current=tt;const we=y.useMemo(()=>new xr(gt,()=>{sn.current=void 0,Yt.current()}),[gt]),nt=p?f+a:a,_e=y.useRef(-1),mt=(($==null?void 0:$.enableFirefoxRescaling)??!1)&&Vr.value,Cn=(($==null?void 0:$.enableSafariRescaling)??!1)&&To.value;y.useLayoutEffect(()=>{window.devicePixelRatio===1||!mt&&!Cn||(_e.current!==-1&&ze(!0),window.clearTimeout(_e.current),_e.current=window.setTimeout(()=>{ze(!1),_e.current=-1},200))},[s,ue,oe,xe,mt,Cn]);const Ce=sr(r,A),Sn=y.useMemo(()=>P?Nt(Ce,re):0,[Ce,re,P]),De=y.useCallback((v,M,W)=>{const T=v.getBoundingClientRect();if(M>=Ce.length||W>=m)return;const H=T.width/n,R=_n(M,W,n,o,f,nt,ue,s,oe,xe,m,A,S,Ce,g);return H!==1&&(R.x*=H,R.y*=H,R.width*=H,R.height*=H),R.x+=T.x,R.y+=T.y,R},[n,o,f,nt,ue,s,oe,xe,m,A,S,Ce,g]),Te=y.useCallback((v,M,W,T)=>{const H=v.getBoundingClientRect(),R=H.width/n,Y=(M-H.left)/R,_=(W-H.top)/R,N=5,Pe=Yn(Ce,ue,n,void 0,oe);let X=0,ie=0;T instanceof MouseEvent&&(X=T.button,ie=T.buttons);const Q=dr(Y,Pe,oe),Z=ur(_,o,p,a,f,m,g,s,xe,S),Re=(T==null?void 0:T.shiftKey)===!0,Ge=(T==null?void 0:T.ctrlKey)===!0,Be=(T==null?void 0:T.metaKey)===!0,at=T!==void 0&&!(T instanceof MouseEvent)||(T==null?void 0:T.pointerType)==="touch",yt=[Y<0?-1:n<Y?1:0,_<nt?-1:o<_?1:0];let Je;if(Q===-1||_<0||Y<0||Z===void 0||Y>n||_>o){const ge=Y>n?1:Y<0?-1:0,Qe=_>o?1:_<0?-1:0;let ot=ge*2,Vt=Qe*2;ge===0&&(ot=Q===-1?Gt.EndPadding:Gt.Center),Qe===0&&(Vt=Z===void 0?Gt.EndPadding:Gt.Center);let vt=!1;if(Q===-1&&Z===-1){const qt=De(v,Ce.length-1,-1);dt(qt!==void 0),vt=M<qt.x+qt.width+N}const Dn=Y>n&&Y<n+Co()||_>o&&_<o+Co();Je={kind:Wo,location:[Q!==-1?Q:Y<0?0:Ce.length-1,Z??m-1],region:[ot,Vt],shiftKey:Re,ctrlKey:Ge,metaKey:Be,isEdge:vt,isTouch:at,button:X,buttons:ie,scrollEdge:yt,isMaybeScrollbar:Dn}}else if(Z<=-1){let ge=De(v,Q,Z);dt(ge!==void 0);let Qe=ge!==void 0&&ge.x+ge.width-M<=N;const ot=Q-1;M-ge.x<=N&&ot>=0?(Qe=!0,ge=De(v,ot,Z),dt(ge!==void 0),Je={kind:p&&Z===-2?Wt:Ft,location:[ot,Z],bounds:ge,group:Ce[ot].group??"",isEdge:Qe,shiftKey:Re,ctrlKey:Ge,metaKey:Be,isTouch:at,localEventX:M-ge.x,localEventY:W-ge.y,button:X,buttons:ie,scrollEdge:yt}):Je={kind:p&&Z===-2?Wt:Ft,group:Ce[Q].group??"",location:[Q,Z],bounds:ge,isEdge:Qe,shiftKey:Re,ctrlKey:Ge,metaKey:Be,isTouch:at,localEventX:M-ge.x,localEventY:W-ge.y,button:X,buttons:ie,scrollEdge:yt}}else{const ge=De(v,Q,Z);dt(ge!==void 0);const Qe=ge!==void 0&&ge.x+ge.width-M<N;let ot=!1;if(c&&I.current!==void 0){const Vt=Qo(I.current.range),vt=De(v,Vt[0],Vt[1]);if(vt!==void 0){const Dn=vt.x+vt.width-2,qt=vt.y+vt.height-2;ot=Math.abs(Dn-M)<zo&&Math.abs(qt-W)<zo}}Je={kind:"cell",location:[Q,Z],bounds:ge,isEdge:Qe,shiftKey:Re,ctrlKey:Ge,isFillHandle:ot,metaKey:Be,isTouch:at,localEventX:M-ge.x,localEventY:W-ge.y,button:X,buttons:ie,scrollEdge:yt}}return Je},[n,Ce,ue,oe,o,p,a,f,m,g,s,xe,S,De,c,I,nt]),[St]=ve??[],oo=y.useRef(()=>{}),Ht=y.useRef(ve);Ht.current=ve;const[It,Et]=y.useMemo(()=>{const v=document.createElement("canvas"),M=document.createElement("canvas");return v.style.display="none",v.style.opacity="0",v.style.position="fixed",M.style.display="none",M.style.opacity="0",M.style.position="fixed",[v.getContext("2d",{alpha:!1}),M.getContext("2d",{alpha:!1})]},[]);y.useLayoutEffect(()=>{if(!(It===null||Et===null))return document.documentElement.append(It.canvas),document.documentElement.append(Et.canvas),()=>{It.canvas.remove(),Et.canvas.remove()}},[It,Et]);const rn=y.useMemo(()=>new wr,[]),io=mt&&je?1:Cn&&je?2:5,ro=($==null?void 0:$.disableMinimumCellWidth)===!0?1:10,sn=y.useRef(),ln=y.useRef(null),an=y.useRef(null),cn=y.useCallback(()=>{var Y;const v=K.current,M=Ne.current;if(v===null||M===null||(ln.current===null&&(ln.current=v.getContext("2d",{alpha:!1}),v.width=0,v.height=0),an.current===null&&(an.current=M.getContext("2d",{alpha:!1}),M.width=0,M.height=0),ln.current===null||an.current===null||It===null||Et===null))return;let W=!1;const T=_=>{W=!0,et(_)},H=sn.current,R={headerCanvasCtx:an.current,canvasCtx:ln.current,bufferACtx:It,bufferBCtx:Et,width:n,height:o,cellXOffset:ue,cellYOffset:s,translateX:Math.round(oe),translateY:Math.round(xe),mappedColumns:Ce,enableGroups:p,freezeColumns:A,dragAndDropState:re,theme:me,headerHeight:a,groupHeaderHeight:f,disabledRows:kt??Xn.empty(),rowHeight:g,verticalBorder:Oe,isResizing:pe,resizeCol:G,isFocused:D,selection:I,fillHandle:c,drawCellCallback:ce,hasAppendRow:st,overrideCursor:T,maxScaleFactor:io,freezeTrailingRows:S,rows:m,drawFocus:C,getCellContent:h,getGroupDetails:Ue??(_=>({name:_})),getRowThemeOverride:d,drawHeaderCallback:Xe,prelightCells:ht,highlightRegions:Le,imageLoader:Ye,lastBlitData:At,damage:Me.current,hoverValues:Bt.current,hoverInfo:Ht.current,spriteManager:we,scrolling:je,hyperWrapping:($==null?void 0:$.hyperWrapping)??!1,touchMode:tt,enqueue:oo.current,renderStateProvider:rn,renderStrategy:($==null?void 0:$.renderStrategy)??(To.value?"double-buffer":"single-buffer"),getCellRenderer:de,minimumCellWidth:ro,resizeIndicator:ee};R.damage===void 0?(sn.current=R,Ro(R,H)):Ro(R,void 0),!W&&(R.damage===void 0||R.damage.has((Y=Ht==null?void 0:Ht.current)==null?void 0:Y[0]))&&et(void 0)},[It,Et,n,o,ue,s,oe,xe,Ce,p,A,re,me,a,f,kt,g,Oe,pe,st,G,D,I,c,S,m,C,io,h,Ue,d,ce,Xe,ht,Le,Ye,we,je,$==null?void 0:$.hyperWrapping,$==null?void 0:$.renderStrategy,tt,rn,de,ro,ee]),Yt=y.useRef(cn);y.useLayoutEffect(()=>{cn(),Yt.current=cn},[cn]),y.useLayoutEffect(()=>{(async()=>{var M;((M=document==null?void 0:document.fonts)==null?void 0:M.ready)!==void 0&&(await document.fonts.ready,sn.current=void 0,Yt.current())})()},[]);const Dt=y.useCallback(v=>{Me.current=v,Yt.current(),Me.current=void 0},[]),bi=qr(Dt);oo.current=bi;const so=y.useCallback(v=>{Dt(new Qt(v.map(M=>M.cell)))},[Dt]);Ye.setCallback(Dt);const[pi,wi]=y.useState(!1),[dn,Pt]=St??[],ki=dn!==void 0&&Pt===-1,xi=dn!==void 0&&Pt===-2;let lo=!1,ao=!1,un=Ct;if(un===void 0&&dn!==void 0&&Pt!==void 0&&Pt>-1&&Pt<m){const v=h([dn,Pt],!0);lo=v.kind===en.NewRow||v.kind===en.Marker&&v.markerKind!=="number",ao=v.kind===ae.Boolean&&Kn(v),un=v.cursor}const co=Ie?"grabbing":(lt??!1)||pe?"col-resize":pi||k?"crosshair":un!==void 0?un:ki||lo||ao||xi?"pointer":"default",In=y.useMemo(()=>({contain:"strict",display:"block",cursor:co}),[co]),uo=y.useRef("default"),En=O==null?void 0:O.current;En!=null&&uo.current!==In.cursor&&(En.style.cursor=uo.current=In.cursor);const Rt=y.useCallback((v,M,W,T)=>{if(Ue===void 0)return;const H=Ue(v);if(H.actions!==void 0){const R=ui(M,H.actions);for(const[Y,_]of R.entries())if(zt(_,W+M.x,T+_.y))return H.actions[Y]}},[Ue]),Tt=y.useCallback((v,M,W,T)=>{const H=Ce[M];if(!Ie&&!pe&&!(lt??!1)){const R=De(v,M,-1);dt(R!==void 0);const Y=fi(void 0,H,R.x,R.y,R.width,R.height,me,Jn(H.title)==="rtl");if(H.hasMenu===!0&&Y.menuBounds!==void 0&&zt(Y.menuBounds,W,T))return{area:"menu",bounds:Y.menuBounds};if(H.indicatorIcon!==void 0&&Y.indicatorIconBounds!==void 0&&zt(Y.indicatorIconBounds,W,T))return{area:"indicator",bounds:Y.indicatorIconBounds}}},[Ce,De,lt,Ie,pe,me]),Mn=y.useRef(0),_t=y.useRef(),Fn=y.useRef(!1),fo=y.useCallback(v=>{const M=K.current,W=O==null?void 0:O.current;if(M===null||v.target!==M&&v.target!==W)return;Fn.current=!0;let T,H;if(v instanceof MouseEvent?(T=v.clientX,H=v.clientY):(T=v.touches[0].clientX,H=v.touches[0].clientY),v.target===W&&W!==null){const Y=W.getBoundingClientRect();if(T>Y.right||H>Y.bottom)return}const R=Te(M,T,H,v);_t.current=R.location,R.isTouch&&(Mn.current=Date.now()),Fe.current!==R.isTouch&&te(R.isTouch),!(R.kind===Ft&&Tt(M,R.location[0],T,H)!==void 0)&&(R.kind===Wt&&Rt(R.group,R.bounds,R.localEventX,R.localEventY)!==void 0||(x==null||x(R),!R.isTouch&&qe!==!0&&qe!==R.kind&&R.button<3&&R.button!==1&&v.preventDefault()))},[O,qe,Te,Rt,Tt,x]);Ke("touchstart",fo,$e,!1),Ke("mousedown",fo,$e,!1);const ho=y.useRef(0),go=y.useCallback(v=>{var ie,Q;const M=ho.current;ho.current=Date.now();const W=K.current;if(Fn.current=!1,w===void 0||W===null)return;const T=O==null?void 0:O.current,H=v.target!==W&&v.target!==T;let R,Y,_=!0;if(v instanceof MouseEvent){if(R=v.clientX,Y=v.clientY,_=v.button<3,v.pointerType==="touch")return}else R=v.changedTouches[0].clientX,Y=v.changedTouches[0].clientY;let N=Te(W,R,Y,v);N.isTouch&&Mn.current!==0&&Date.now()-Mn.current>500&&(N={...N,isLongTouch:!0}),M!==0&&Date.now()-M<(N.isTouch?1e3:500)&&(N={...N,isDoubleClick:!0}),Fe.current!==N.isTouch&&te(N.isTouch),!H&&v.cancelable&&_&&v.preventDefault();const[Pe]=N.location,X=Tt(W,Pe,R,Y);if(N.kind===Ft&&X!==void 0){(N.button!==0||((ie=_t.current)==null?void 0:ie[0])!==Pe||((Q=_t.current)==null?void 0:Q[1])!==-1)&&w(N,!0);return}else if(N.kind===Wt){const Z=Rt(N.group,N.bounds,N.localEventX,N.localEventY);if(Z!==void 0){N.button===0&&Z.onClick(N);return}}w(N,H)},[w,O,Te,Tt,Rt]);Ke("mouseup",go,$e,!1),Ke("touchend",go,$e,!1);const Ci=y.useCallback(v=>{var Pe,X;const M=K.current;if(M===null)return;const W=O==null?void 0:O.current,T=v.target!==M&&v.target!==W;let H,R,Y=!0;v instanceof MouseEvent?(H=v.clientX,R=v.clientY,Y=v.button<3):(H=v.changedTouches[0].clientX,R=v.changedTouches[0].clientY);const _=Te(M,H,R,v);Fe.current!==_.isTouch&&te(_.isTouch),!T&&v.cancelable&&Y&&v.preventDefault();const[N]=_.location;if(_.kind===Ft){const ie=Tt(M,N,H,R);ie!==void 0&&_.button===0&&((Pe=_t.current)==null?void 0:Pe[0])===N&&((X=_t.current)==null?void 0:X[1])===-1&&(ie.area==="menu"?u==null||u(N,ie.bounds):ie.area==="indicator"&&(b==null||b(N,ie.bounds)))}else if(_.kind===Wt){const ie=Rt(_.group,_.bounds,_.localEventX,_.localEventY);ie!==void 0&&_.button===0&&ie.onClick(_)}},[O,Te,Tt,u,b,Rt]);Ke("click",Ci,$e,!1);const Si=y.useCallback(v=>{const M=K.current,W=O==null?void 0:O.current;if(M===null||v.target!==M&&v.target!==W||z===void 0)return;const T=Te(M,v.clientX,v.clientY,v);z(T,()=>{v.cancelable&&v.preventDefault()})},[O,Te,z]);Ke("contextmenu",Si,(O==null?void 0:O.current)??null,!1);const mo=y.useCallback(v=>{Me.current=new Qt(v.map(M=>M.item)),Bt.current=v,Yt.current(),Me.current=void 0},[]),yo=y.useMemo(()=>new Yr(mo),[mo]),vo=y.useRef(yo);vo.current=yo,y.useLayoutEffect(()=>{const v=vo.current;if(St===void 0||St[1]<0){v.setHovered(St);return}const M=h(St,!0),W=de(M),T=W===void 0&&M.kind===ae.Custom||(W==null?void 0:W.needsHover)!==void 0&&(typeof W.needsHover=="boolean"?W.needsHover:W.needsHover(M));v.setHovered(T?St:void 0)},[h,de,St]);const bo=y.useRef(),Ii=y.useCallback(v=>{var _;const M=K.current;if(M===null)return;const W=O==null?void 0:O.current,T=v.target!==M&&v.target!==W,H=Te(M,v.clientX,v.clientY,v);if(H.kind!=="out-of-bounds"&&T&&!Fn.current&&!H.isTouch)return;const R=(N,Pe)=>{xt(X=>X===N||(X==null?void 0:X[0][0])===(N==null?void 0:N[0][0])&&(X==null?void 0:X[0][1])===(N==null?void 0:N[0][1])&&((X==null?void 0:X[1][0])===(N==null?void 0:N[1][0])&&(X==null?void 0:X[1][1])===(N==null?void 0:N[1][1])||!Pe)?X:N)};if(!Ur(H,bo.current))et(void 0),q==null||q(H),R(H.kind===Wo?void 0:[H.location,[H.localEventX,H.localEventY]],!0),bo.current=H;else if(H.kind==="cell"||H.kind===Ft||H.kind===Wt){let N=!1,Pe=!0;if(H.kind==="cell"){const ie=h(H.location);Pe=((_=de(ie))==null?void 0:_.needsHoverPosition)??ie.kind===ae.Custom,N=Pe}else N=!0;const X=[H.location,[H.localEventX,H.localEventY]];R(X,Pe),Ht.current=X,N&&Dt(new Qt([H.location]))}const Y=H.location[0]>=(se?0:1);be(H.kind===Ft&&H.isEdge&&Y&&rt===!0),wi(H.kind==="cell"&&H.isFillHandle),U==null||U(v),V(H)},[O,Te,se,rt,U,V,q,h,de,Dt]);Ke("mousemove",Ii,$e,!0);const Ei=y.useCallback(v=>{const M=K.current;if(M===null)return;let W,T;I.current!==void 0&&(W=De(M,I.current.cell[0],I.current.cell[1]),T=I.current.cell),fe==null||fe({bounds:W,stopPropagation:()=>v.stopPropagation(),preventDefault:()=>v.preventDefault(),cancel:()=>{},ctrlKey:v.ctrlKey,metaKey:v.metaKey,shiftKey:v.shiftKey,altKey:v.altKey,key:v.key,keyCode:v.keyCode,rawEvent:v,location:T})},[fe,I,De]),Mi=y.useCallback(v=>{const M=K.current;if(M===null)return;let W,T;I.current!==void 0&&(W=De(M,I.current.cell[0],I.current.cell[1]),T=I.current.cell),he==null||he({bounds:W,stopPropagation:()=>v.stopPropagation(),preventDefault:()=>v.preventDefault(),cancel:()=>{},ctrlKey:v.ctrlKey,metaKey:v.metaKey,shiftKey:v.shiftKey,altKey:v.altKey,key:v.key,keyCode:v.keyCode,rawEvent:v,location:T})},[he,I,De]),Fi=y.useCallback(v=>{if(K.current=v,j!==void 0&&(j.current=v),$!=null&&$.eventTarget)He.current=$.eventTarget;else if(v===null)He.current=window;else{const M=v.getRootNode();M===document&&(He.current=window),He.current=M}},[j,$==null?void 0:$.eventTarget]),Bi=y.useCallback(v=>{const M=K.current;if(M===null||qe===!1||pe){v.preventDefault();return}let W,T;const H=Te(M,v.clientX,v.clientY);if(qe!==!0&&H.kind!==qe){v.preventDefault();return}const R=(ie,Q)=>{W=ie,T=Q};let Y,_,N;const Pe=(ie,Q,Z)=>{Y=ie,_=Q,N=Z};let X=!1;if(Ae==null||Ae({...H,setData:R,setDragImage:Pe,preventDefault:()=>X=!0,defaultPrevented:()=>X}),!X&&W!==void 0&&T!==void 0&&v.dataTransfer!==null)if(v.dataTransfer.setData(W,T),v.dataTransfer.effectAllowed="copyLink",Y!==void 0&&_!==void 0&&N!==void 0)v.dataTransfer.setDragImage(Y,_,N);else{const[ie,Q]=H.location;if(Q!==void 0){const Z=document.createElement("canvas"),Re=De(M,ie,Q);dt(Re!==void 0);const Ge=Math.ceil(window.devicePixelRatio??1);Z.width=Re.width*Ge,Z.height=Re.height*Ge;const Be=Z.getContext("2d");Be!==null&&(Be.scale(Ge,Ge),Be.textBaseline="middle",Q===-1?(Be.font=me.headerFontFull,Be.fillStyle=me.bgHeader,Be.fillRect(0,0,Z.width,Z.height),hi(Be,0,0,Re.width,Re.height,Ce[ie],!1,me,!1,void 0,void 0,!1,0,we,Xe,!1)):(Be.font=me.baseFontFull,Be.fillStyle=me.bgCell,Be.fillRect(0,0,Z.width,Z.height),di(Be,h([ie,Q]),0,Q,!1,!1,0,0,Re.width,Re.height,!1,me,me.bgCell,Ye,we,1,void 0,!1,0,void 0,void 0,void 0,rn,de,()=>{}))),Z.style.left="-100%",Z.style.position="absolute",Z.style.width=`${Re.width}px`,Z.style.height=`${Re.height}px`,document.body.append(Z),v.dataTransfer.setDragImage(Z,Re.width/2,Re.height/2),window.setTimeout(()=>{Z.remove()},0)}}else v.preventDefault()},[qe,pe,Te,Ae,De,me,Ce,we,Xe,h,Ye,rn,de]);Ke("dragstart",Bi,(O==null?void 0:O.current)??null,!1,!1);const Bn=y.useRef(),Ai=y.useCallback(v=>{const M=K.current;if(J!==void 0&&v.preventDefault(),M===null||We===void 0)return;const W=Te(M,v.clientX,v.clientY),[T,H]=W.location,R=T-(se?0:1),[Y,_]=Bn.current??[];(Y!==R||_!==H)&&(Bn.current=[R,H],We([R,H],v.dataTransfer))},[se,Te,We,J]);Ke("dragover",Ai,(O==null?void 0:O.current)??null,!1,!1);const Hi=y.useCallback(()=>{Bn.current=void 0,Se==null||Se()},[Se]);Ke("dragend",Hi,(O==null?void 0:O.current)??null,!1,!1);const Di=y.useCallback(v=>{const M=K.current;if(M===null||J===void 0)return;v.preventDefault();const W=Te(M,v.clientX,v.clientY),[T,H]=W.location,R=T-(se?0:1);J([R,H],v.dataTransfer)},[se,Te,J]);Ke("drop",Di,(O==null?void 0:O.current)??null,!1,!1);const Pi=y.useCallback(()=>{ke==null||ke()},[ke]);Ke("dragleave",Pi,(O==null?void 0:O.current)??null,!1,!1);const po=y.useRef(I);po.current=I;const fn=y.useRef(null),An=y.useCallback(v=>{var M;K.current===null||!K.current.contains(document.activeElement)||(v===null&&po.current.current!==void 0?(M=j==null?void 0:j.current)==null||M.focus({preventScroll:!0}):v!==null&&v.focus({preventScroll:!0}),fn.current=v)},[j]);y.useImperativeHandle(t,()=>({focus:()=>{var M;const v=fn.current;v===null||!document.contains(v)?(M=j==null?void 0:j.current)==null||M.focus({preventScroll:!0}):v.focus({preventScroll:!0})},getBounds:(v,M)=>{if(!(j===void 0||j.current===null))return De(j.current,v??0,M??-1)},damage:so,getMouseArgsForPosition:(v,M,W)=>{if(!(j===void 0||j.current===null))return Te(j.current,v,M,W)}}),[j,so,De]);const Hn=y.useRef(),Ri=nr(()=>{var _,N,Pe;if(n<50||($==null?void 0:$.disableAccessibilityTree)===!0)return null;let v=Yn(Ce,ue,n,re,oe);const M=se?0:-1;!se&&((_=v[0])==null?void 0:_.sourceIndex)===0&&(v=v.slice(1));const[W,T]=((N=I.current)==null?void 0:N.cell)??[],H=(Pe=I.current)==null?void 0:Pe.range,R=v.map(X=>X.sourceIndex),Y=qi(s,Math.min(m,s+i));return W!==void 0&&T!==void 0&&!(R.includes(W)&&Y.includes(T))&&An(null),y.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Ce.length+M},y.createElement("thead",{role:"rowgroup"},y.createElement("tr",{role:"row","aria-rowindex":1},v.map(X=>y.createElement("th",{role:"columnheader","aria-selected":I.columns.hasIndex(X.sourceIndex),"aria-colindex":X.sourceIndex+1+M,tabIndex:-1,onFocus:ie=>{if(ie.target!==fn.current)return Ee==null?void 0:Ee([X.sourceIndex,-1])},key:X.sourceIndex},X.title)))),y.createElement("tbody",{role:"rowgroup"},Y.map(X=>y.createElement("tr",{role:"row","aria-selected":I.rows.hasIndex(X),key:X,"aria-rowindex":X+2},v.map(ie=>{const Q=ie.sourceIndex,Z=Ze(Q,X),Re=W===Q&&T===X,Ge=H!==void 0&&Q>=H.x&&Q<H.x+H.width&&X>=H.y&&X<H.y+H.height,Be=`glide-cell-${Q}-${X}`,at=[Q,X],yt=h(at,!0);return y.createElement("td",{key:Z,role:"gridcell","aria-colindex":Q+1+M,"aria-selected":Ge,"aria-readonly":qo(yt)||!Qi(yt),id:Be,"data-testid":Be,onClick:()=>{const Je=j==null?void 0:j.current;if(Je!=null)return fe==null?void 0:fe({bounds:De(Je,Q,X),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:at})},onFocusCapture:Je=>{var ge,Qe;if(!(Je.target===fn.current||((ge=Hn.current)==null?void 0:ge[0])===Q&&((Qe=Hn.current)==null?void 0:Qe[1])===X))return Hn.current=at,Ee==null?void 0:Ee(at)},ref:Re?An:void 0,tabIndex:-1},jr(yt,de))})))))},[n,Ce,ue,re,oe,m,s,i,I,An,h,j,fe,De,Ee],200),hn=A===0||!P?0:ue>A?1:pn(-oe/100,0,1),Ti=-s*32+xe,gn=F?pn(-Ti/100,0,1):0,Wi=y.useMemo(()=>{if(!hn&&!gn)return null;const v={position:"absolute",top:0,left:Sn,width:n-Sn,height:o,opacity:hn,pointerEvents:"none",transition:ye?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},M={position:"absolute",top:nt,left:0,width:n,height:o,opacity:gn,pointerEvents:"none",transition:L?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return y.createElement(y.Fragment,null,hn>0&&y.createElement("div",{id:"shadow-x",style:v}),gn>0&&y.createElement("div",{id:"shadow-y",style:M}))},[hn,gn,Sn,n,ye,nt,o,L]),zi=y.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return y.createElement(y.Fragment,null,y.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Ei,onKeyUp:Mi,onFocus:E,onBlur:B,ref:Fi,style:In},Ri),y.createElement("canvas",{ref:Ne,style:zi}),Wi)},ul=y.memo(y.forwardRef(Kr));function Gr(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case ae.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===jn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ae.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ae.Image:case ae.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ae.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ae.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ae.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ae.Markdown:case ae.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ae.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ae.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ae.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Un()}}function Jr(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:Gr(l))})}function Lo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Qr(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>Lo(l,!0)).join(",")):i.push(Lo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Wn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function No(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Zr(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function es(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${Wn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${No(i.rawValue[s])}>`+Wn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${No(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${Wn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ts(e,t){const n=Jr(e,t),o=Qr(n),i=es(n);return{textPlain:o,textHtml:i}}function fl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),f=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(f==null?void 0:f.children.length)===1&&f.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const u of m)u.replaceWith(`
`);const h=a.getAttribute("gdg-raw-value"),d=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:d});else if(a.querySelector("ol")!==null){const u=a.querySelectorAll("li");r==null||r.push({rawValue:[...u].map(b=>b.getAttribute("gdg-raw-value")??""),formatted:[...u].map(b=>b.textContent??""),format:"string-array"})}else if(h!==null)r==null||r.push({rawValue:Zr(h),formatted:a.textContent??"",format:d});else{let u=a.textContent??"";g&&(u=u.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:u??"",formatted:u??"",format:d})}}}return r!==void 0&&i.push(r),i}function hl(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,c=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;c.push(...m);const h=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof h=="function")return r;c.push(...h)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;c.push(...m)}let f=a.x-n,g=a.x+a.width-1-n;for(const m of c)for(const h of m)h.span!==void 0&&(f=Math.min(h.span[0],f),g=Math.max(h.span[1],g));f===a.x-n&&g===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:f+n,y:a.y,width:g-f+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Oo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function gl(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(Oo(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(Oo(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function ml(e,t,n){var s;const o=ts(e,t),i=a=>{var c;(c=window.navigator.clipboard)==null||c.writeText(a)},r=(a,c)=>{var f;return((f=window.navigator.clipboard)==null?void 0:f.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},l=(a,c)=>{var f,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(f=n==null?void 0:n.clipboardData)==null||f.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",c)}catch{r(a,c)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function ns(e){return e!==!0}const mi=20;function Xo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:c}=i,f=t.maxSize??mi,g=Math.floor(i.y+s/2),m=Ko(f,s,r.cellVerticalPadding),h=jo(t.contentAlign??"center",a,l,r.cellHorizontalPadding,m),d=Uo(h,g,m),u=Go(a+n,c+o,d);return Kn(t)&&u}const os={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ae.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>is(e,e.cell.data,Kn(e.cell),e.cell.maxSize??mi,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Xo(e)&&e.preventDefault()},onClick:e=>{if(Xo(e))return{...e.cell,data:ns(e.cell.data)}},onPaste:(e,t)=>{let n=wn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=jn),n===t.data?void 0:{...t,data:n}}};function is(e,t,n,o,i){if(!n&&t===wn)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:c,hoverX:f,hoverY:g,cell:{contentAlign:m}}=e,{x:h,y:d,width:u,height:b}=a;let p=!1;if(i>0){let k=n?1-i+i*l:.4;if(t===wn&&(k*=l),k===0)return;k<1&&(p=!0,r.globalAlpha=k)}to(r,s,t,h,d,u,b,c,f,g,o,m),p&&(r.globalAlpha=1)}const rs=ft("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),ss=e=>{const{bubbles:t}=e;return y.createElement(rs,null,t.map((n,o)=>y.createElement("div",{key:o,className:"boe-bubble"},n)),y.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},ls={getAccessibilityString:e=>Jo(e.data),kind:ae.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>cs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return y.createElement(ss,{bubbles:t.data})},onPaste:()=>{}},as=4;function cs(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:c}=n,f=20,g=8,m=as;let h=l+o.cellHorizontalPadding;const d=[];for(const u of t){if(h>l+a)break;const b=$t(u,i,o.baseFontFull).width;d.push({x:h,width:b}),h+=b+g*2+m}i.beginPath();for(const u of d)it(i,u.x,s+(c-f)/2,u.width+g*2,f,o.roundingRadius??f/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[u,b]of d.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[u],b.x+g,s+c/2+pt(i,o))}const ds=ft("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),us=e=>{const{drilldowns:t}=e;return y.createElement(ds,null,t.map((n,o)=>y.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&y.createElement("img",{src:n.img}),y.createElement("div",null,n.text))))},fs={getAccessibilityString:e=>Jo(e.data.map(t=>t.text)),kind:ae.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+20+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>ms(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return y.createElement(us,{drilldowns:t.data})},onPaste:()=>{}},hs=4,zn={};function gs(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,c=o+r,f=o*3,g=(f+r*2)*i,m=`${e},${t},${i},${n}`;if(zn[m]!==void 0)return{el:zn[m],height:a,width:g,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const h=document.createElement("canvas"),d=h.getContext("2d");return d===null?null:(h.width=g,h.height=a,d.scale(i,i),zn[m]=h,d.beginPath(),it(d,r,r,f,l,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),it(d,r+.5,r+.5,f,l,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:h,height:a,width:g,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function ms(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:c}=n,f=o.baseFontFull,g=oi(i,f),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),h=Math.floor(n.y+(n.height-m)/2),d=m-10,u=8,b=hs;let p=a+o.cellHorizontalPadding;const k=o.roundingRadius??6,E=gs(o.bgCell,o.drilldownBorder,m,k),B=[];for(const D of t){if(p>a+c)break;const A=$t(D.text,i,f).width;let z=0;D.img!==void 0&&r.loadOrGetImage(D.img,l,s)!==void 0&&(z=d-8+4);const S=A+z+u*2;B.push({x:p,width:S}),p+=S+b}if(E!==null){const{el:D,height:I,middleWidth:A,sideWidth:z,width:S,dpr:P,padding:F}=E,C=z/P,x=F/P;for(const w of B){const U=Math.floor(w.x),V=Math.floor(w.width),q=V-(C-x)*2;i.imageSmoothingEnabled=!1,i.drawImage(D,0,0,z,I,U-x,h,C,m),q>0&&i.drawImage(D,z,0,A,I,U+(C-x),h,q,m),i.drawImage(D,S-z,0,z,I,U+V-(C-x),h,C,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[D,I]of B.entries()){const A=t[D];let z=I.x+u;if(A.img!==void 0){const S=r.loadOrGetImage(A.img,l,s);if(S!==void 0){const P=d-8;let F=0,C=0,x=S.width,w=S.height;x>w?(F+=(x-w)/2,x=w):w>x&&(C+=(w-x)/2,w=x),i.beginPath(),it(i,z,h+m/2-P/2,P,P,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(S,F,C,x,w,z,h+m/2-P/2,P,P),i.restore(),z+=P+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(A.text,z,h+m/2+pt(i,o))}}const ys=ft("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),vs=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return y.createElement(ys,{"data-testid":"GDG-default-image-overlay-editor"},y.createElement(Ui.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},r.map(s=>{const a=(i==null?void 0:i(s))??y.createElement("img",{draggable:!1,src:s});return y.createElement("div",{className:"gdg-centering-container",key:s},a)})),n&&o&&y.createElement("button",{className:"gdg-edit-icon",onClick:o},y.createElement(Gn,null)))},bs={getAccessibilityString:e=>e.data.join(", "),kind:ae.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ps(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??vs;return y.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Ln=4;function ps(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:c}=e,{x:f,y:g,height:m,width:h}=i,d=m-s.cellVerticalPadding*2,u=[];let b=0;for(let k=0;k<t.length;k++){const E=t[k];if(E.length===0)continue;const B=c.loadOrGetImage(E,r,l);if(B!==void 0){u[k]=B;const D=B.width*(d/B.height);b+=D+Ln}}if(b===0)return;b-=Ln;let p=f+s.cellHorizontalPadding;o==="right"?p=Math.floor(f+h-s.cellHorizontalPadding-b):o==="center"&&(p=Math.floor(f+h/2-b/2));for(const k of u){if(k===void 0)continue;const E=k.width*(d/k.height);n>0&&(a.beginPath(),it(a,p,g+s.cellVerticalPadding,E,d,n),a.save(),a.clip()),a.drawImage(k,p,g+s.cellVerticalPadding,E,d),n>0&&a.restore(),p+=E+Ln}}function ws(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const ks={getAccessibilityString:()=>"",kind:ae.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(ws(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);it(i,r.x+a,r.y+(r.height-c)/2,s,c,l.roundingRadius??3),i.fillStyle=on(l.textDark,.1),i.fill()},onPaste:()=>{}},xs=ft("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Cs extends Zt.PureComponent{constructor(){super(...arguments);ne(this,"targetElement",null);ne(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=Ki(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const f=document.createElement("template");f.innerHTML=l,a=f.content}n.append(a);const c=n.getElementsByTagName("a");for(const f of c)f.target="_blank",f.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Zt.createElement(xs,{ref:this.containerRefHook})}}const Ss=ft("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Is=ft("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Es=ft("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let $o=0;const xn=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:c}=s,f=y.useRef(null),g=n??"";dt(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=y.useState(()=>"input-box-"+($o=($o+1)%1e7));y.useEffect(()=>{const d=f.current;if(d===null||d.disabled)return;const u=g.toString().length;d.focus(),d.setSelectionRange(i?0:u,u)},[]),y.useLayoutEffect(()=>{var d;if(l!==void 0){const u=typeof l=="number"?[l,null]:l;(d=f.current)==null||d.setSelectionRange(u[0],u[1])}},[l]);const h=y.useCallback(d=>{d.key==="Enter"&&d.shiftKey&&r===!0||o==null||o(d)},[r,o]);return y.createElement(Es,{className:"gdg-growing-entry"},y.createElement(Is,{className:c},g+`
`),y.createElement(Ss,{...s,className:(c??"")+" gdg-input",id:m,ref:f,onKeyDown:h,value:g,placeholder:t,dir:"auto"}))},Ms=()=>e=>e.targetWidth,Yo=ft("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Ms(),"px"]}}),Fs=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,c=t.readonly===!0,[f,g]=y.useState(a===""||o),m=y.useCallback(()=>{g(d=>!d)},[]),h=a?"gdg-ml-6":"";return f?y.createElement(Yo,{targetWidth:r.width-20},y.createElement(xn,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:d=>{d.key==="Enter"&&d.stopPropagation()},onChange:n}),y.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${h}`,onClick:()=>l(t)},y.createElement(tr,null))):y.createElement(Yo,{targetWidth:r.width},y.createElement(Cs,{contents:a,createNode:i}),!c&&y.createElement(y.Fragment,null,y.createElement("div",{className:"spacer"}),y.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${h}`,onClick:m},y.createElement(Gn,null))),y.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Bs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:nn,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>ut(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return y.createElement(Fs,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},As={getAccessibilityString:e=>e.row.toString(),kind:en.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Hs,measure:()=>44,draw:e=>Ps(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Hs(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Ds,n.textAlign="center",r}function Ds(e){const{ctx:t}=e;t.textAlign="start"}function Ps(e,t,n,o,i,r){const{ctx:l,rect:s,hoverAmount:a,theme:c}=e,{x:f,y:g,width:m,height:h}=s,d=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&d>0){l.globalAlpha=d;const u=7*(n?a:1);if(to(l,c,n,i?f+u:f,g,i?m-u:m,h,!0,void 0,void 0,18,"center",r),i){l.globalAlpha=a,l.beginPath();for(const b of[3,6])for(const p of[-5,-1,3])l.rect(f+b,g+h/2+p,2,2);l.fillStyle=c.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const u=t.toString(),b=c.markerFontFull,p=f+m/2;o==="both"&&a!==0&&(l.globalAlpha=1-a),l.fillStyle=c.textLight,l.font=b,l.fillText(u,p,g+h/2+pt(l,b)),a!==0&&(l.globalAlpha=1)}}const Rs={getAccessibilityString:()=>"",kind:en.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Ts(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Ts(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:c,width:f,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,c+1,f,g-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let h=0;if(n!==void 0){const u=g-8,b=a+8/2,p=c+8/2;s.drawSprite(n,"normal",o,b,p,u,l,m?1:r),h=u}else{h=24;const d=12,u=m?d:r*d,b=m?0:(1-r)*d*.5,p=l.cellHorizontalPadding+4;u>0&&(o.moveTo(a+p+b,c+g/2),o.lineTo(a+p+b+u,c+g/2),o.moveTo(a+p+b+u*.5,c+g/2-u*.5),o.lineTo(a+p+b+u*.5,c+g/2+u*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,h+a+l.cellHorizontalPadding+.5,c+g/2+pt(o,l)),o.beginPath()}function yi(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=Ws(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),it(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??on(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function Ws(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=$t(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,c=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const zs=y.lazy(async()=>await Oi(()=>import("./number-overlay-editor-B8mhwLvG.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Ls={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:nn,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:c}=n;s===!0&&t>0&&yi(o,i,c,a,r,t,l),ut(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return y.createElement(y.Suspense,{fallback:null},y.createElement(zs,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Ns={getAccessibilityString:()=>"",measure:()=>108,kind:ae.Protected,needsHover:!1,needsHoverPosition:!1,draw:Os,onPaste:()=>{}};function Os(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const c=r+l/2,f=Math.cos(xo(30))*s,g=Math.sin(xo(30))*s;for(let m=0;m<12;m++)t.moveTo(a,c-s),t.lineTo(a,c+s),t.moveTo(a+f,c-g),t.lineTo(a-f,c+g),t.moveTo(a-f,c-g),t.lineTo(a+f,c+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Xs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>nn(e,t,e.theme.textLight),draw:e=>ut(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return Zt.createElement(xn,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},$s={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:nn,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:c,hoverEffect:f,allowWrapping:g,hoverEffectTheme:m}=t;f===!0&&n>0&&yi(i,l,m,a,r,n,s),ut(e,a,c,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return y.createElement(xn,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Ys=ft("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),_s=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=y.useState(!i&&(t===""||o)),c=y.useCallback(()=>{a(!0)},[]);return s?y.createElement(xn,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):y.createElement(Ys,null,y.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!i&&y.createElement("div",{className:"gdg-edit-icon",onClick:c},y.createElement(Gn,null)),y.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function vi(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function _o(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ti(l,r.baseFontFull);if(s===void 0)return!1;const a=vi(s,n,r,t.contentAlign);return zt({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const Vs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:nn,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const f=$t(a,s,n.baseFontFull),g=vi(f,l,n,t.contentAlign),{x:m,y:h,width:d,height:u}=g;if(i>=m-4&&i<=m-4+d+8&&r>=h-4&&r<=h-4+u+8){const b=pt(s,n.baseFontFull);o("pointer");const p=5,k=h-b;s.beginPath(),s.moveTo(l.x+m,Math.floor(l.y+k+u+p)+.5),s.lineTo(l.x+m+d,Math.floor(l.y+k+u+p)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,ut({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),ut({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),ut({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),ut({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,ut(e,a,t.contentAlign)},onSelect:e=>{_o(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;_o(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return y.createElement(_s,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},yl=[As,Rs,os,ls,fs,bs,ks,Bs,Ls,Ns,Xs,$s,Vs],Nn=[];class vl extends ri{constructor(){super(...arguments);ne(this,"imageLoaded",()=>{});ne(this,"loadedLocations",[]);ne(this,"cache",{});ne(this,"sendLoaded",ji(()=>{this.imageLoaded(new Qt(this.loadedLocations)),this.loadedLocations=[]},20));ne(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=Nn.pop()??new Image;let a=!1;const c={img:void 0,cells:[Ze(o,i)],url:n,cancel:()=>{a||(a=!0,Nn.length<12?Nn.unshift(s):l||(s.src=""))}},f=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await f,await s.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=s;for(const m of g.cells)this.loadedLocations.push(eo(m));l=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=Ze(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}export{yl as A,Ft as B,Xn as C,Ur as D,cl as E,Un as F,ae as G,Ji as H,en as I,tl as J,rl as K,fl as L,gl as M,Co as N,sl as O,ml as P,vl as Q,ul as R,To as S,al as T,Vr as U,el as V,Gi as a,dt as b,dl as c,il as d,ol as e,hl as f,ll as g,Ot as h,Qs as i,on as j,Js as k,Xt as l,As as m,Wt as n,Wo as o,zt as p,$n as q,Zs as r,ar as s,ns as t,Ke as u,qo as v,nl as w,Qi as x,Sr as y,vn as z};
