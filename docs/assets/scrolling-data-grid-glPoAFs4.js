import{j,a as ue,F as we,s as ve}from"./marked.esm-dbrxtycE.js";import{r as t}from"./index-BMVQvedj.js";import{c as me}from"./throttle-7EuXLZa7.js";import{Q as Ce,R as he,u as ge}from"./image-window-loader-wgODAEJI.js";function ce(e,u,v,o){return me(Math.round(u-(e.growOffset??0)),Math.ceil(v),Math.floor(o))}const Re=e=>{const[u,v]=t.useState(),[o,D]=t.useState(),[l,X]=t.useState(),[f,h]=t.useState(),[x,b]=t.useState(!1),[L,i]=t.useState(),[m,Y]=t.useState(),[$,te]=t.useState(),[oe,ee]=t.useState(!1),[ne,re]=t.useState(),{onHeaderMenuClick:F,getCellContent:se,onColumnMoved:C,onColumnResize:y,onColumnResizeStart:G,onColumnResizeEnd:W,gridRef:_,maxColumnWidth:z,minColumnWidth:H,onRowMoved:A,lockColumns:B,onColumnProposeMove:K,onMouseDown:J,onMouseUp:P,onItemHovered:Z,onDragStart:n,canvasRef:M}=e,I=(y??W??G)!==void 0,{columns:a,selection:Q}=e,r=Q.columns,R=t.useCallback(s=>{const[g,w]=s.location;l!==void 0&&f!==g&&g>=B?(b(!0),h(g)):m!==void 0&&w!==void 0?(ee(!0),te(Math.max(0,w))):o===void 0&&!x&&!oe&&(Z==null||Z(s))},[l,m,f,Z,B,o,x,oe]),c=C!==void 0,U=t.useCallback(s=>{var g;if(s.button===0){const[w,d]=s.location;if(s.kind==="out-of-bounds"&&s.isEdge&&I){const k=(g=_==null?void 0:_.current)==null?void 0:g.getBounds(a.length-1,-1);k!==void 0&&(v(k.x),D(a.length-1))}else if(s.kind==="header"&&w>=B){const k=M==null?void 0:M.current;if(s.isEdge&&I&&k){v(s.bounds.x),D(w);const ae=k.getBoundingClientRect().width/k.offsetWidth,ie=s.bounds.width/ae;G==null||G(a[w],ie,w,ie+(a[w].growOffset??0))}else s.kind==="header"&&c&&(i(s.bounds.x),X(w))}else s.kind==="cell"&&B>0&&w===0&&d!==void 0&&A!==void 0&&(re(s.bounds.y),Y(d))}J==null||J(s)},[J,I,B,A,_,a,c,G,M]),V=t.useCallback((s,g)=>{x||oe||F==null||F(s,g)},[x,oe,F]),T=t.useRef(-1),q=t.useCallback(()=>{T.current=-1,Y(void 0),te(void 0),re(void 0),ee(!1),X(void 0),h(void 0),i(void 0),b(!1),D(void 0),v(void 0)},[]),N=t.useCallback((s,g)=>{if(s.button===0){if(o!==void 0){if((r==null?void 0:r.hasIndex(o))===!0)for(const d of r){if(d===o)continue;const k=a[d],p=ce(k,T.current,H,z);y==null||y(k,p,d,p+(k.growOffset??0))}const w=ce(a[o],T.current,H,z);if(W==null||W(a[o],w,o,w+(a[o].growOffset??0)),r.hasIndex(o))for(const d of r){if(d===o)continue;const k=a[d],p=ce(k,T.current,H,z);W==null||W(k,p,d,p+(k.growOffset??0))}}q(),l!==void 0&&f!==void 0&&(C==null||C(l,f)),m!==void 0&&$!==void 0&&(A==null||A(m,$))}P==null||P(s,g)},[P,o,l,f,m,$,r,W,a,H,z,y,C,A,q]),S=t.useMemo(()=>{if(!(l===void 0||f===void 0)&&l!==f&&(K==null?void 0:K(l,f))!==!1)return{src:l,dest:f}},[l,f,K]),E=t.useCallback(s=>{const g=M==null?void 0:M.current;if(l!==void 0&&L!==void 0)Math.abs(s.clientX-L)>20&&b(!0);else if(m!==void 0&&ne!==void 0)Math.abs(s.clientY-ne)>20&&ee(!0);else if(o!==void 0&&u!==void 0&&g){const d=g.getBoundingClientRect().width/g.offsetWidth,k=(s.clientX-u)/d,p=a[o],ae=ce(p,k,H,z);if(y==null||y(p,ae,o,ae+(p.growOffset??0)),T.current=k,(r==null?void 0:r.first())===o)for(const ie of r){if(ie===o)continue;const de=a[ie],fe=ce(de,T.current,H,z);y==null||y(de,fe,ie,fe+(de.growOffset??0))}}},[l,L,m,ne,o,u,a,H,z,y,r,M]),O=t.useCallback((s,g)=>{if(m===void 0||$===void 0)return se(s,g);let[w,d]=s;return d===$?d=m:(d>$&&(d-=1),d>=m&&(d+=1)),se([w,d],g)},[m,$,se]),le=t.useCallback(s=>{n==null||n(s),s.defaultPrevented()||q()},[q,n]);return j(Ce,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,width:e.width,getCellContent:O,isResizing:o!==void 0,onHeaderMenuClick:V,isDragging:x,onItemHovered:R,onDragStart:le,onMouseDown:U,allowResize:I,onMouseUp:N,dragAndDropState:S,onMouseMoveRaw:E,ref:_})},Se=Re;function De(e){const u=t.useRef(null),[v,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const D=X=>{for(const f of X){const{width:h,height:x}=f&&f.contentRect||{};o(b=>b.width===h&&b.height===x?b:{width:h,height:x})}},l=new window.ResizeObserver(D);return u.current&&l.observe(u.current,void 0),()=>{l.disconnect()}},[u.current]),{ref:u,...v}}const be=(e,u,v)=>{const o=t.useRef(null),D=t.useRef(null),l=t.useRef(null),X=t.useRef(0),f=t.useRef(u);f.current=u;const h=v.current;t.useEffect(()=>{const x=()=>{var i,m;if(D.current===!1&&h!==null){const Y=[h.scrollLeft,h.scrollTop];if(((i=l.current)==null?void 0:i[0])===Y[0]&&((m=l.current)==null?void 0:m[1])===Y[1])if(X.current>10){l.current=null,D.current=null;return}else X.current++;else X.current=0,f.current(Y[0],Y[1]),l.current=Y;o.current=window.setTimeout(x,8.333333333333334)}},b=()=>{D.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},L=i=>{i.touches.length===0&&(D.current=!1,X.current=0,o.current=window.setTimeout(x,8.333333333333334))};if(e&&h!==null){const i=h;return i.addEventListener("touchstart",b),i.addEventListener("touchend",L),()=>{i.removeEventListener("touchstart",b),i.removeEventListener("touchend",L),o.current!==null&&window.clearTimeout(o.current)}}},[e,h])},ye=be,xe=()=>e=>e.isSafari?"scroll":"auto",He=ve("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[xe()]}});function Me(e){const[u,v]=t.useState(!1),o=typeof window>"u"?null:window,D=t.useRef(0);return ge("touchstart",t.useCallback(()=>{window.clearTimeout(D.current),v(!0)},[]),o,!0,!1),ge("touchend",t.useCallback(l=>{l.touches.length===0&&(D.current=window.setTimeout(()=>v(!1),e))},[e]),o,!0,!1),u}const ke=e=>{var a,Q;const{children:u,clientHeight:v,scrollHeight:o,scrollWidth:D,update:l,draggable:X,className:f,preventDiagonalScrolling:h=!1,paddingBottom:x=0,paddingRight:b=0,rightElement:L,rightElementProps:i,kineticScrollPerfHack:m=!1,scrollRef:Y,initialSize:$}=e,te=[],oe=(i==null?void 0:i.sticky)??!1,ee=(i==null?void 0:i.fill)??!1,ne=t.useRef(0),re=t.useRef(0),F=t.useRef(null),se=typeof window>"u"?1:window.devicePixelRatio,C=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),y=t.useRef(null),G=Me(200),[W,_]=t.useState(!0),z=t.useRef(0);t.useLayoutEffect(()=>{if(!W||G||C.current.lockDirection===void 0)return;const r=F.current;if(r===null)return;const[R,c]=C.current.lockDirection;R!==void 0?r.scrollLeft=R:c!==void 0&&(r.scrollTop=c),C.current.lockDirection=void 0},[G,W]);const H=t.useCallback((r,R)=>{var g;const c=F.current;if(c===null)return;R=R??c.scrollTop,r=r??c.scrollLeft;const U=C.current.scrollTop,V=C.current.scrollLeft,T=r-V,q=R-U;G&&T!==0&&q!==0&&(Math.abs(T)>3||Math.abs(q)>3)&&h&&C.current.lockDirection===void 0&&(C.current.lockDirection=Math.abs(T)<Math.abs(q)?[V,void 0]:[void 0,U]);const N=C.current.lockDirection;r=(N==null?void 0:N[0])??r,R=(N==null?void 0:N[1])??R,C.current.scrollLeft=r,C.current.scrollTop=R;const S=c.clientWidth,E=c.clientHeight,O=R,le=re.current-O,s=c.scrollHeight-E;if(re.current=O,s>0&&(Math.abs(le)>2e3||O===0||O===s)&&o>c.scrollHeight+5){const w=O/s,d=(o-E)*w;ne.current=d-O}N!==void 0&&(window.clearTimeout(z.current),_(!1),z.current=window.setTimeout(()=>_(!0),200)),l({x:r,y:O+ne.current,width:S-b,height:E-x,paddingRight:((g=y.current)==null?void 0:g.clientWidth)??0})},[x,b,o,l,h,G]);ye(m&&he.value,H,F);const A=t.useRef(H);A.current=H;const B=t.useRef(),K=t.useRef(!1);t.useLayoutEffect(()=>{K.current?H():K.current=!0},[H,x,b]);const J=t.useCallback(r=>{F.current=r,Y!==void 0&&(Y.current=r)},[Y]);let P=0,Z=0;for(te.push(j("div",{style:{width:D,height:0}},P++));Z<o;){const r=Math.min(5e6,o-Z);te.push(j("div",{style:{width:0,height:r}},P++)),Z+=r}const{ref:n,width:M,height:I}=De($);return typeof window<"u"&&(((a=B.current)==null?void 0:a.height)!==I||((Q=B.current)==null?void 0:Q.width)!==M)&&(window.setTimeout(()=>A.current(),0),B.current={width:M,height:I}),(M??0)===0||(I??0)===0?j("div",{ref:n}):j("div",{ref:n,children:ue(He,{isSafari:he.value,children:[j("div",{className:"dvn-underlay",children:u}),j("div",{ref:J,style:B.current,draggable:X,onDragStart:r=>{X||(r.stopPropagation(),r.preventDefault())},className:"dvn-scroller "+(f??""),onScroll:()=>H(),children:ue("div",{className:"dvn-scroll-inner"+(L===void 0?" dvn-hidden":""),children:[j("div",{className:"dvn-stack",children:te}),L!==void 0&&ue(we,{children:[!ee&&j("div",{className:"dvn-spacer"}),j("div",{ref:y,style:{height:I,maxHeight:v-Math.ceil(se%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:b,flexGrow:ee?1:void 0,right:oe?b??0:void 0,pointerEvents:"auto"},children:L})]})]})})]})})},Te=e=>{const{columns:u,rows:v,rowHeight:o,headerHeight:D,groupHeaderHeight:l,enableGroups:X,freezeColumns:f,experimental:h,nonGrowWidth:x,clientSize:b,className:L,onVisibleRegionChanged:i,scrollRef:m,preventDiagonalScrolling:Y,rightElement:$,rightElementProps:te,overscrollX:oe,overscrollY:ee,initialSize:ne,smoothScrollX:re=!1,smoothScrollY:F=!1,isDraggable:se}=e,{paddingRight:C,paddingBottom:y}=h??{},[G,W]=b,_=t.useRef(),z=t.useRef(),H=t.useRef(),A=t.useRef(),B=x+Math.max(0,oe??0);let K=X?D+l:D;if(typeof o=="number")K+=v*o;else for(let n=0;n<v;n++)K+=o(n);ee!==void 0&&(K+=ee);const J=t.useRef(),P=t.useCallback(()=>{var q,N;if(J.current===void 0)return;const n={...J.current};let M=0,I=n.x<0?-n.x:0,a=0,Q=0;n.x=n.x<0?0:n.x;let r=0;for(let S=0;S<f;S++)r+=u[S].width;for(const S of u){const E=M-r;if(n.x>=E+S.width)M+=S.width,Q++,a++;else if(n.x>E)M+=S.width,re?I+=E-n.x:Q++,a++;else if(n.x+n.width>E)M+=S.width,a++;else break}let R=0,c=0,U=0;if(typeof o=="number")F?(c=Math.floor(n.y/o),R=c*o-n.y):c=Math.ceil(n.y/o),U=Math.ceil(n.height/o)+c,R<0&&U++;else{let S=0;for(let E=0;E<v;E++){const O=o(E),le=S+(F?0:O/2);if(n.y>=S+O)S+=O,c++,U++;else if(n.y>le)S+=O,F?R+=le-n.y:c++,U++;else if(n.y+n.height>O/2+S)S+=O,U++;else break}}const V={x:Q,y:c,width:a-Q,height:U-c},T=_.current;(T===void 0||T.y!==V.y||T.x!==V.x||T.height!==V.height||T.width!==V.width||z.current!==I||H.current!==R||n.width!==((q=A.current)==null?void 0:q[0])||n.height!==((N=A.current)==null?void 0:N[1]))&&(i==null||i({x:Q,y:c,width:a-Q,height:U-c},n.width,n.height,n.paddingRight??0,I,R),_.current=V,z.current=I,H.current=R,A.current=[n.width,n.height])},[u,o,v,i,f,re,F]),Z=t.useCallback(n=>{J.current=n,P()},[P]);return t.useEffect(()=>{P()},[P]),j(ke,{scrollRef:m,className:L,kineticScrollPerfHack:h==null?void 0:h.kineticScrollPerfHack,preventDiagonalScrolling:Y,draggable:se===!0||typeof se=="string",scrollWidth:B+(C??0),scrollHeight:K+(y??0),clientHeight:W,rightElement:$,paddingBottom:y,paddingRight:C,rightElementProps:te,update:Z,initialSize:ne,children:j(Se,{eventTargetRef:m,width:G,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY})})},We=Te;export{We as G};
