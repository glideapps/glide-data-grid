const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-CG3IiYp6.js","./iframe-DwLDHopF.js","./index-C6oAC5fS.js","./marked.esm-CNwiN7tY.js","./throttle-8qIMkzPD.js","./flatten-DbQfLfVW.js","./number-overlay-editor-DOiGpaaN.js","./react-number-format.es-4zt8Ynfs.js"])))=>i.map(i=>d[i]);
var Xs=Object.defineProperty;var Ys=(e,t,n)=>t in e?Xs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ge=(e,t,n)=>Ys(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as pt,_ as El}from"./iframe-DwLDHopF.js";import{h as Gs,g as Il,j as _s,k as Ks,v as Us,l as Vs,m as sn,r as fo,t as qs}from"./throttle-8qIMkzPD.js";import{u as js,f as Ji}from"./flatten-DbQfLfVW.js";import{s as Jt,a as Zs}from"./marked.esm-CNwiN7tY.js";function Dl(e="This should not happen"){throw new Error(e)}function jt(e,t="Assertion failed"){if(!e)return Dl(t)}function rr(e,t){return Dl(t??"Hell froze over")}function Js(e,t){try{return e()}catch{return t}}const Qi=Object.prototype.hasOwnProperty;function Ao(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ao(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Qi.call(e,n)&&++o&&!Qi.call(t,n)||!(n in t)||!Ao(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const $r=null,Si=void 0;var j;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(j||(j={}));var el;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(el||(el={}));var Nr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Nr||(Nr={}));function Tr(e){return"width"in e&&typeof e.width=="number"}async function tl(e){return typeof e=="object"?e:await e()}function Ho(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown)}function xu(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown||e.kind===j.Boolean||e.kind===j.Image||e.kind===j.Custom)}function Fo(e){return e.kind===cn.Marker||e.kind===cn.NewRow}function er(e){if(!Ho(e)||e.kind===j.Image)return!1;switch(e.kind){case j.Text:case j.Number:case j.Markdown:case j.Uri:case j.Custom:case j.Boolean:return e.readonly!==!0;default:rr(e,"A cell was passed with an invalid kind")}}function Qs(e){return Gs(e,"editor")}function Mi(e){return!(e.readonly??!1)}var cn;(function(e){e.NewRow="new-row",e.Marker="marker"})(cn||(cn={}));function ea(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let nl;const Pn=class Pn{constructor(t){Ge(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Pn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ea([...this.items,n]);return new Pn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,c]=a;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Pn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Ge(Pn,"empty",()=>nl??(nl=new Pn([]))),Ge(Pn,"fromSingleSelection",t=>Pn.empty().add(t));let nt=Pn;const ta=Jt("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function _t(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=c=>{var f;(f=i.current)==null||f.call(a,c)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function Zn(e,t){return e===void 0?void 0:t}const na=Math.PI;function ol(e){return e*na/180}const Hl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Fl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Tl=(e,t,n)=>Math.min(e,t-n*2),Al=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ri=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},oa=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ra(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Il(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const ia="֑-߿יִ-﷽ﹰ-ﻼ",la="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",sa=new RegExp("^[^"+la+"]*["+ia+"]");function Ei(e){return sa.test(e)?"rtl":"not-rtl"}let Ar;function yi(){if(typeof document>"u")return 0;if(Ar!==void 0)return Ar;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Ar=n-o,Ar}const uo=Symbol();function aa(e){const t=s.useRef([uo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==uo&&(l=typeof l=="function"?l(c):l,l===c)||(c!==uo&&r({}),o(f=>typeof l=="function"?l(c===uo?f:c):l),t.current[0]=uo)},[]),a=s.useCallback(()=>{t.current[0]=uo,r({})},[]);return[t.current[0]===uo?n:t.current[0],i,a]}function zl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ca(e){const t=s.useRef(e);return Ao(e,t.current)||(t.current=e),t.current}const da=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(ta,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(_s.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Ri,null)))},ua=Jt("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class fa extends pt.PureComponent{constructor(){super(...arguments);Ge(this,"targetElement",null);Ge(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=Zs(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const u=document.createElement("template");u.innerHTML=a,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),pt.createElement(ua,{ref:this.containerRefHook})}}const ha=Jt("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),ga=Jt("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),ma=Jt("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let rl=0;const Gr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...l}=e,{onChange:c,className:f}=l,u=s.useRef(null),g=n??"";jt(c!==void 0,"GrowingEntry must be a controlled input area");const[m]=s.useState(()=>"input-box-"+(rl=(rl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=g.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(a!==void 0){const b=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[a]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(ma,{className:"gdg-growing-entry"},s.createElement(ga,{className:f},g+`
`),s.createElement(ha,{...l,className:(f??"")+" gdg-input",id:m,ref:u,onKeyDown:w,value:g,placeholder:t,dir:"auto"}))},ui={};let qn=null;function wa(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function zo(e){const t=e.toLowerCase().trim();if(ui[t]!==void 0)return ui[t];qn=qn||wa(),qn.style.color="#000",qn.style.color=t;const n=getComputedStyle(qn).color;qn.style.color="#fff",qn.style.color=t;const o=getComputedStyle(qn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),ui[t]=r,r}function go(e,t){const[n,o,r]=zo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const il=new Map;function ll(e,t){const n=`${e}-${t}`,o=il.get(n);if(o!==void 0)return o;const r=Zt(e,t);return il.set(n,r),r}function Zt(e,t){if(t===void 0)return e;const[n,o,r,i]=zo(e);if(i===1)return e;const[a,l,c,f]=zo(t),u=i+f*(1-i),g=(i*n+f*a*(1-i))/u,m=(i*o+f*l*(1-i))/u,w=(i*r+f*c*(1-i))/u;return`rgba(${g}, ${m}, ${w}, ${u})`}function ku(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...zo(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...zo(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,a=1-n,l=o[3]*a+r[3]*i,c=Math.floor((o[0]*a+r[0]*i)/l),f=Math.floor((o[1]*a+r[1]*i)/l),u=Math.floor((o[2]*a+r[2]*i)/l);return`rgba(${c}, ${f}, ${u}, ${l})`}function Su(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=zo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function ba(e,t){return pt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function ya(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(tr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function ir(e,t){return(e??"")===(t??"")}function pa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Pl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function tr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Bl(e){return[e.x+e.width-1,e.y+e.height-1]}function sl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function va(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&sl(e,t,i)&&r++;for(const a of n.current.rangeStack)sl(e,t,a)&&r++;return r}function Ll(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Po(e,t){let n=0;const o=Ll(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function mo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function pi(e,t,n,o,r){const i=Ll(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||a.push(u)}return a}function Ca(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function xa(e,t,n,o,r,i,a,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let g=t;for(let h=0;h<f;h++){const b=i-1-h,x=typeof a=="number"?a:a(b);if(g-=x,e>=g)return b}const m=i-f,w=e-(c??0);if(typeof a=="number"){const h=Math.floor((w-u)/a)+l;return h>=m?void 0:h}else{let h=u;for(let b=l;b<m;b++){const x=a(b);if(w<=h+x)return b;h+=x}return}}let Wr=0,nr={};const ka=typeof window>"u";async function Sa(){var e;ka||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Wr=0,nr={},Us())}Sa();function Wl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Bo(e,t,n,o="middle"){const r=Wl(e,t,o,n);let i=nr[r];return i===void 0&&(i=t.measureText(e),nr[r]=i,Wr++),Wr>1e4&&(nr={},Wr=0),i}function $l(e,t){const n=Wl(e,void 0,"middle",t);return nr[n]}function Qn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ma(e,t)}function al(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const cl=[];function Ma(e,t){for(const i of cl)if(i.key===t)return i.val;const n=al(e,"alphabetic"),r=-(al(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return cl.push({key:t,val:r}),r}function Ra(e,t,n,o,r,i){const{ctx:a,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const g=1-f/u;a.globalAlpha=g,a.fillStyle=c.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function sr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function Mu(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,Rn({ctx:a,rect:i,theme:l},t,n,o,r)}function Nl(e,t,n,o,r,i,a,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function Ol(e,t){const n=Bo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ea(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ia(e,t,n,o,r,i,a,l,c,f){const u=l.baseFontFull,g=Ks(e,t,u,r-l.cellHorizontalPadding*2,f??!1),m=Ol(e,u),w=l.lineHeight*m,h=m+w*(g.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let C=Math.max(o+l.cellVerticalPadding,x);for(const v of g)if(Nl(e,v,n,C,r,m,a,l,c),C+=w,C>o+i)break;b&&e.restore()}function Rn(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:c,y:f,width:u,height:g}=a;o=o??!1,o||(t=Ea(t,u));const m=Qn(i,l),w=Ei(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ia(i,t,c,f,u,g,m,l,n,r):Nl(i,t,c,f,u,g,m,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function En(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Da(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Ha(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,g=Math.sqrt(f*f+u*u),m=f/g,w=u/g;return{x:f,y:c.y-l.y,len:g,nx:m,ny:w,ang:Math.atan2(w,m)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,a),g=o(c,f),m=u.nx*g.ny-u.ny*g.nx,w=u.nx*g.nx-u.ny*-g.ny;let h=Math.asin(m<-1?-1:m>1?1:m),b=1,x=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,x=!0):h>0&&(b=-1,x=!0),r=c.radius!==void 0?c.radius:n;const C=h/2;let v=Math.abs(Math.cos(C)*r/Math.sin(C)),R;v>Math.min(u.len/2,g.len/2)?(v=Math.min(u.len/2,g.len/2),R=Math.abs(v*Math.sin(C)/Math.cos(C))):R=r;let X=c.x+g.nx*v,N=c.y+g.ny*v;X+=-g.ny*R*b,N+=g.nx*R*b,e.arc(X,N,R,u.ang+Math.PI/2*b,g.ang-Math.PI/2*b,x),a=c,c=f}e.closePath()}function vi(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h){const b={x:0,y:i+f,width:0,height:0};if(e>=w.length||t>=u||t<-2||e<0)return b;const x=i-r;if(e>=g){const C=a>e?-1:1,v=Po(w);b.x+=v+c;for(let R=a;R!==e;R+=C)b.x+=w[C===1?R:R-1].width*C}else for(let C=0;C<e;C++)b.x+=w[C].width;if(b.width=w[e].width+1,t===-1)b.y=r,b.height=x;else if(t===-2){b.y=0,b.height=r;let C=e;const v=w[e].group,R=w[e].sticky;for(;C>0&&ir(w[C-1].group,v)&&w[C-1].sticky===R;){const N=w[C-1];b.x-=N.width,b.width+=N.width,C--}let X=e;for(;X+1<w.length&&ir(w[X+1].group,v)&&w[X+1].sticky===R;){const N=w[X+1];b.width+=N.width,X++}if(!R){const N=Po(w),A=b.x-N;A<0&&(b.x-=A,b.width+=A),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-m){let C=u-t;for(b.y=o;C>0;){const v=t+C-1;b.height=typeof h=="number"?h:h(v),b.y-=b.height,C--}b.height+=1}else{const C=l>t?-1:1;if(typeof h=="number"){const v=t-l;b.y+=v*h}else for(let v=l;v!==t;v+=C)b.y+=h(v)*C;b.height=(typeof h=="number"?h:h(t))+1}return b}const Ii=1<<21;function wn(e,t){return(t+2)*Ii+e}function Xl(e){return e%Ii}function Di(e){return Math.floor(e/Ii)-2}function Hi(e){const t=Xl(e),n=Di(e);return[t,n]}class Yl{constructor(){Ge(this,"visibleWindow",{x:0,y:0,width:0,height:0});Ge(this,"freezeCols",0);Ge(this,"freezeRows",[]);Ge(this,"isInWindow",t=>{const n=Xl(t),o=Di(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ao(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Fa extends Yl{constructor(){super(...arguments);Ge(this,"cache",new Map);Ge(this,"setValue",(n,o)=>{this.cache.set(wn(n[0],n[1]),o)});Ge(this,"getValue",n=>this.cache.get(wn(n[0],n[1])));Ge(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class or{constructor(t=[]){Ge(this,"cells");this.cells=new Set(t.map(n=>wn(n[0],n[1])))}add(t){this.cells.add(wn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(wn(t[0],t[1]))}remove(t){this.cells.delete(wn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Di(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(wn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Hi(t)}}function Ta(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Gl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function _l(){return Gl}const Kl=pt.createContext(Gl);function Ru(){return pt.useContext(Kl)}function Bn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Zt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ci=150;function Aa(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ci}function Ul(e,t,n,o,r,i,a,l,c){let f=0;const u=r===void 0?[]:r.map(w=>{const h=Aa(e,w[o],t,c);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const b of u)w+=b;const h=w/u.length;for(let b=0;b<u.length;b++)u[b]>=h*2?u[b]=0:f=Math.max(f,u[b])}const g=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=g;const m=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:m}}function za(e,t,n,o,r,i,a,l,c){const f=s.useRef(t),u=s.useRef(n),g=s.useRef(a);f.current=t,u.current=n,g.current=a;const[m,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const v=document.createElement("canvas");return v.style.display="none",v.style.opacity="0",v.style.position="fixed",[v,v.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(m&&document.documentElement.append(m),()=>{m==null||m.remove()}),[m]);const h=s.useRef({}),b=s.useRef(),[x,C]=s.useState();return s.useLayoutEffect(()=>{const v=u.current;if(v===void 0||e.every(Tr))return;let R=Math.max(1,10-Math.floor(e.length/1e4)),X=0;R<f.current&&R>1&&(R--,X=1);const N={x:0,y:0,width:e.length,height:Math.min(f.current,R)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const G=v(N,c.signal),M=X>0?v(A,c.signal):void 0;let W;typeof G=="object"?W=G:W=await tl(G),M!==void 0&&(typeof M=="object"?W=[...W,...M]:W=[...W,...await tl(M)]),b.current=e,C(W)})()},[c.signal,e]),s.useMemo(()=>{let R=e.every(Tr)?e:w===null?e.map(L=>Tr(L)?L:{...L,width:Ci}):(w.font=g.current.baseFontFull,e.map((L,G)=>{if(Tr(L))return L;if(h.current[L.id]!==void 0)return{...L,width:h.current[L.id]};if(x===void 0||b.current!==e||L.id===void 0)return{...L,width:Ci};const M=Ul(w,a,L,G,x,r,i,!0,l);return h.current[L.id]=M.width,M})),X=0,N=0;const A=[];for(const[L,G]of R.entries())X+=G.width,G.grow!==void 0&&G.grow>0&&(N+=G.grow,A.push(L));if(X<o&&A.length>0){const L=[...R],G=o-X;let M=G;for(let W=0;W<A.length;W++){const $=A[W],F=(R[$].grow??0)/N,E=W===A.length-1?M:Math.min(M,Math.floor(G*F));L[$]={...R[$],growOffset:E,width:R[$].width+E},M-=E}R=L}return{sizedColumns:R,nonGrowWidth:X}},[o,e,w,x,a,r,i,l])}const ut='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Pa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Ba=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},La=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Wa=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},$a=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Vl=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Na=e=>{const t=e.bgColor;return`${ut}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Oa=Vl,Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},_a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Ka=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ut}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},ac=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},cc={headerRowID:Pa,headerNumber:La,headerCode:Ba,headerString:Wa,headerBoolean:$a,headerAudioUri:Oa,headerVideoUri:Xa,headerEmoji:Ya,headerImage:Ga,headerUri:Vl,headerPhone:_a,headerMarkdown:Ka,headerDate:Ua,headerTime:Va,headerEmail:qa,headerReference:ja,headerIfThenElse:Za,headerSingleValue:Ja,headerLookup:Qa,headerTextTemplate:ec,headerMath:tc,headerRollup:nc,headerJoinStrings:oc,headerSplitString:rc,headerGeoDistance:ic,headerArray:lc,rowOwnerOverlay:sc,protectedColumnOverlay:ac,renameIcon:Na};function dc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class uc{constructor(t,n){Ge(this,"onSettled");Ge(this,"spriteMap",new Map);Ge(this,"headerIcons");Ge(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,c=1){const[f,u]=dc(n,l),g=a*Math.ceil(window.devicePixelRatio),m=`${f}_${u}_${g}_${t}`;let w=this.spriteMap.get(m);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(m,w);const C=x.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{b.drawImage(x,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(w,0,0,g,g,r,i,a,a),c<1&&(o.globalAlpha=1)}}function ql(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function _r(e,t,n,o,r,i,a,l,c){l=l??t;let f=t,u=e;const g=o-i;let m=!1;for(;f<n&&u<g;){const w=r(u);if(f+w>l&&c(f,u,w,!1,a&&u===o-1)===!0){m=!0;break}f+=w,u++}if(!m){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,c(f,u,h,!0,a&&u===o-1)}}}function eo(e,t,n,o,r,i){let a=0,l=0;const c=r+o;for(const f of e){const u=f.sticky?l:a+n;if(i(f,u,c,f.sticky?0:l,t)===!0)break;a+=f.width,l+=f.sticky?f.width:0}}function jl(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const c=e[l];let f=l+1,u=c.width;for(c.sticky&&(a+=u);f<e.length&&ir(e[f].group,c.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(a+=b.width)}const g=c.sticky?0:n,m=i+g,w=c.sticky?0:Math.max(0,a-m),h=Math.min(u-w,t-(m+w));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",m+w,0,h,o),i+=u}}function Zl(e,t,n,o,r,i,a){var m;const[l,c]=e;let f,u;const g=((m=a.find(w=>!w.sticky))==null?void 0:m.sourceIndex)??0;if(c>g){const w=Math.max(l,g);let h=t,b=o;for(let x=i.sourceIndex-1;x>=w;x--)h-=a[x].width,b+=a[x].width;for(let x=i.sourceIndex+1;x<=c;x++)b+=a[x].width;u={x:h,y:n,width:b,height:r}}if(g>l){const w=Math.min(c,g-1);let h=t,b=o;for(let x=i.sourceIndex-1;x>=l;x--)h-=a[x].width,b+=a[x].width;for(let x=i.sourceIndex+1;x<=w;x++)b+=a[x].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function fc(e,t,n,o){if(o==="any")return Jl(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Pl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function lr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function ho(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Jl(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function hc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function gc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,c=r-e.x,f=e.x+e.width-a,u=i-e.y,g=e.y+e.height-l,m=c>0?e.x+Math.floor(c/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:h,width:w-m,height:b-h}}function mc(e,t,n,o,r){const[i,a,l,c]=t,[f,u,g,m]=r,{x:w,y:h,width:b,height:x}=e,C=[];if(b<=0||x<=0)return C;const v=w+b,R=h+x,X=w<i,N=h<a,A=w+b>l,L=h+x>c,G=w>=i&&w<l||v>i&&v<=l||w<i&&v>l,M=h>=a&&h<c||R>a&&R<=c||h<a&&R>c;if(G&&M){const $=Math.max(w,i),F=Math.max(h,a),E=Math.min(v,l),k=Math.min(R,c);C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:f,y:u,width:g-f+1,height:m-u+1}})}if(X&&N){const $=w,F=h,E=Math.min(v,i),k=Math.min(R,a);C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:0,y:0,width:f+1,height:u+1}})}if(N&&G){const $=Math.max(w,i),F=h,E=Math.min(v,l),k=Math.min(R,a);C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:f,y:0,width:g-f+1,height:u+1}})}if(N&&A){const $=Math.max(w,l),F=h,E=v,k=Math.min(R,a);C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(X&&M){const $=w,F=Math.max(h,a),E=Math.min(v,i),k=Math.min(R,c);C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:0,y:u,width:f+1,height:m-u+1}})}if(A&&M){const $=Math.max(w,l),F=Math.max(h,a),E=v,k=Math.min(R,c);C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(X&&L){const $=w,F=Math.max(h,c),E=Math.min(v,i),k=R;C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:0,y:m,width:f+1,height:o-m+1}})}if(L&&G){const $=Math.max(w,i),F=Math.max(h,c),E=Math.min(v,l),k=R;C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:f,y:m,width:g-f+1,height:o-m+1}})}if(A&&L){const $=Math.max(w,l),F=Math.max(h,c),E=v,k=R;C.push({rect:{x:$,y:F,width:E-$,height:k-F},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return C}const wc={kind:j.Loading,allowOverlay:!1};function dl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,v,R,X,N,A,L,G,M,W,$,F,E,k,ce,ne,oe,Re){let Ce=(R==null?void 0:R.size)??Number.MAX_SAFE_INTEGER;const J=performance.now();let K=E.baseFontFull;e.font=K;const ve={ctx:e},Q=[0,0],me=x>0?mo(c,x,f):0;let Xe,U;const re=ql(v);return eo(t,l,i,a,r,(de,ze,tt,Ct,st)=>{const Pe=Math.max(0,Ct-ze),Ye=ze+Pe,He=r+1,at=de.width-Pe,rt=o-r-1;if(v.length>0){let _e=!1;for(let Ne=0;Ne<v.length;Ne++){const Oe=v[Ne];if(lr(Ye,He,at,rt,Oe.x,Oe.y,Oe.width,Oe.height)){_e=!0;break}}if(!_e)return}const je=()=>{e.save(),e.beginPath(),e.rect(Ye,He,at,rt),e.clip()},V=X.columns.hasIndex(de.sourceIndex),Ie=g(de.group??"").overrideTheme,ke=de.themeOverride===void 0&&Ie===void 0?E:Bn(E,Ie,de.themeOverride),Me=ke.baseFontFull;Me!==K&&(K=Me,e.font=Me),je();let ge;return _r(st,tt,o,c,f,x,C,re,(_e,Ne,Oe,ue,fe)=>{var yn,Qt,en;if(Ne<0||(Q[0]=de.sourceIndex,Q[1]=Ne,R!==void 0&&!R.has(Q)))return;if(v.length>0){let Le=!1;for(let Ht=0;Ht<v.length;Ht++){const ht=v[Ht];if(lr(ze,_e,de.width,Oe,ht.x,ht.y,ht.width,ht.height)){Le=!0;break}}if(!Le)return}const Qe=X.rows.hasIndex(Ne),Ke=w.hasIndex(Ne),Ve=Ne<c?u(Q):wc;let ft=ze,Ze=de.width,De=!1,xt=!1;if(Ve.span!==void 0){const[Le,Ht]=Ve.span,ht=`${Ne},${Le},${Ht},${de.sticky}`;if(U===void 0&&(U=new Set),U.has(ht)){Ce--;return}else{const Nt=Zl(Ve.span,ze,_e,de.width,Oe,de,n),zt=de.sticky?Nt[0]:Nt[1];if(!de.sticky&&Nt[0]!==void 0&&(xt=!0),zt!==void 0){ft=zt.x,Ze=zt.width,U.add(ht),e.restore(),ge=void 0,e.save(),e.beginPath();const Kt=Math.max(0,Ct-zt.x);e.rect(zt.x+Kt,_e,zt.width-Kt,Oe),Xe===void 0&&(Xe=[]),Xe.push({x:zt.x+Kt,y:_e,width:zt.width-Kt,height:Oe}),e.clip(),De=!0}}}const $t=m==null?void 0:m(Ne),kt=fe&&((yn=de.trailingRowOptions)==null?void 0:yn.themeOverride)!==void 0?(Qt=de.trailingRowOptions)==null?void 0:Qt.themeOverride:void 0,Dt=Ve.themeOverride===void 0&&$t===void 0&&kt===void 0?ke:Bn(ke,$t,kt,Ve.themeOverride);e.beginPath();const Wt=pa(Q,Ve,X);let bt=va(Q,Ve,X,b);const bn=Ve.span!==void 0&&X.columns.some(Le=>Ve.span!==void 0&&Le>=Ve.span[0]&&Le<=Ve.span[1]);Wt&&!h&&b?bt=0:Wt&&b&&(bt=Math.max(bt,1)),bn&&bt++,Wt||(Qe&&bt++,V&&!fe&&bt++);const Ln=Ve.kind===j.Protected?Dt.bgCellMedium:Dt.bgCell;let ct;if((ue||Ln!==E.bgCell)&&(ct=Zt(Ln,ct)),bt>0||Ke){Ke&&(ct=Zt(Dt.bgHeader,ct));for(let Le=0;Le<bt;Le++)ct=Zt(Dt.accentLight,ct)}else if(N!==void 0){for(const Le of N)if(Le[0]===de.sourceIndex&&Le[1]===Ne){ct=Zt(Dt.bgSearchResult,ct);break}}if(A!==void 0)for(let Le=0;Le<A.length;Le++){const Ht=A[Le],ht=Ht.range;Ht.style!=="solid-outline"&&ht.x<=de.sourceIndex&&de.sourceIndex<ht.x+ht.width&&ht.y<=Ne&&Ne<ht.y+ht.height&&(ct=Zt(Ht.color,ct))}let In=!1;if(R!==void 0){const Le=_e+1,ht=(ue?Le+Oe-1:Math.min(Le+Oe-1,o-me))-Le;(ht!==Oe-1||ft+1<=Ct)&&(In=!0,e.save(),e.beginPath(),e.rect(ft+1,Le,Ze-1,ht),e.clip()),ct=ct===void 0?Dt.bgCell:Zt(ct,Dt.bgCell)}const dn=de.sourceIndex===n.length-1,pe=Ne===c-1;ct!==void 0&&(e.fillStyle=ct,ge!==void 0&&(ge.fillStyle=ct),R!==void 0?e.fillRect(ft+1,_e+1,Ze-(dn?2:1),Oe-(pe?2:1)):e.fillRect(ft,_e,Ze,Oe)),Ve.style==="faded"&&(e.globalAlpha=.6);let yt;for(let Le=0;Le<M.length;Le++){const Ht=M[Le];if(Ht.item[0]===de.sourceIndex&&Ht.item[1]===Ne){yt=Ht;break}}if(Ze>Re&&!xt){const Le=Dt.baseFontFull;Le!==K&&(e.font=Le,K=Le),ge=Ql(e,Ve,de.sourceIndex,Ne,dn,pe,ft,_e,Ze,Oe,bt>0,Dt,ct??Dt.bgCell,L,G,(yt==null?void 0:yt.hoverAmount)??0,W,F,J,$,ge,k,ce,ne,oe)}return In&&e.restore(),Ve.style==="faded"&&(e.globalAlpha=1),Ce--,De&&(e.restore(),(en=ge==null?void 0:ge.deprep)==null||en.call(ge,ve),ge=void 0,je(),K=Me,e.font=Me),Ce<=0}),e.restore(),Ce<=0}),Xe}const jo=[0,0],Zo={x:0,y:0,width:0,height:0},fi=[void 0,()=>{}];let xi=!1;function bc(){xi=!0}function Ql(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,v,R,X,N,A,L,G){var ce,ne;let M,W;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(M=x[1][0],W=x[1][1]);let $;jo[0]=n,jo[1]=o,Zo.x=a,Zo.y=l,Zo.width=c,Zo.height=f,fi[0]=A.getValue(jo),fi[1]=oe=>A.setValue(jo,oe),xi=!1;const F={ctx:e,theme:g,col:n,row:o,cell:t,rect:Zo,highlighted:u,cellFillColor:m,hoverAmount:b,frameTime:v,hoverX:M,drawState:fi,hoverY:W,imageLoader:w,spriteManager:h,hyperWrapping:C,overrideCursor:M!==void 0?G:void 0,requestAnimationFrame:bc},E=Ra(F,t.lastUpdated,v,X,r,i),k=L(t);if(k!==void 0){(X==null?void 0:X.renderer)!==k&&((ce=X==null?void 0:X.deprep)==null||ce.call(X,F),X=void 0);const oe=(ne=k.drawPrep)==null?void 0:ne.call(k,F,X);R!==void 0&&!Fo(F.cell)?R(F,()=>k.draw(F,t)):k.draw(F,t),$=oe===void 0?void 0:{deprep:oe==null?void 0:oe.deprep,fillStyle:oe==null?void 0:oe.fillStyle,font:oe==null?void 0:oe.font,renderer:k}}return(E||xi)&&(N==null||N(jo)),$}function Fi(e,t,n,o,r,i,a,l,c=-20,f=-20,u=void 0,g="center",m="square"){const w=Math.floor(r+a/2),h=m==="circle"?1e4:t.roundingRadius??4;let b=Tl(u??t.checkboxMaxSize,a,t.cellVerticalPadding),x=b/2;const C=Fl(g,o,i,t.cellHorizontalPadding,b),v=Hl(C,w,b),R=Al(o+c,r+f,v);switch(n){case!0:{e.beginPath(),En(e,C-b/2,w-b/2,b,b,h),m==="circle"&&(x*=.8,b*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-x+b/4.23,w-x+b/1.97),e.lineTo(C-x+b/2.42,w-x+b/1.44),e.lineTo(C-x+b/1.29,w-x+b/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case $r:case!1:{e.beginPath(),En(e,C-b/2+.5,w-b/2+.5,b-1,b-1,h),e.lineWidth=1,e.strokeStyle=R?t.textDark:t.textMedium,e.stroke();break}case Si:{e.beginPath(),En(e,C-b/2,w-b/2,b,b,h),e.fillStyle=R?t.textMedium:t.textLight,e.fill(),m==="circle"&&(x*=.8,b*=.8),e.beginPath(),e.moveTo(C-b/3,w),e.lineTo(C+b/3,w),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:rr()}}function yc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,v){var M,W,$,F;const R=a+l;if(R<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,r,R);const X=(M=o==null?void 0:o[0])==null?void 0:M[0],N=(W=o==null?void 0:o[0])==null?void 0:W[1],A=($=o==null?void 0:o[1])==null?void 0:$[0],L=(F=o==null?void 0:o[1])==null?void 0:F[1],G=g.headerFontFull;e.font=G,eo(t,0,i,0,R,(E,k,ce,ne)=>{var de;if(x!==void 0&&!x.has([E.sourceIndex,-1]))return;const oe=Math.max(0,ne-k);e.save(),e.beginPath(),e.rect(k+oe,l,E.width-oe,a),e.clip();const Re=b(E.group??"").overrideTheme,Ce=E.themeOverride===void 0&&Re===void 0?g:Bn(g,Re,E.themeOverride);Ce.bgHeader!==g.bgHeader&&(e.fillStyle=Ce.bgHeader,e.fill()),Ce!==g&&(e.font=Ce.headerFontFull);const J=u.columns.hasIndex(E.sourceIndex),K=c!==void 0||f||E.headerRowMarkerDisabled===!0,ve=!K&&N===-1&&X===E.sourceIndex,Q=K?0:((de=w.find(ze=>ze.item[0]===E.sourceIndex&&ze.item[1]===-1))==null?void 0:de.hoverAmount)??0,me=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===E.sourceIndex,Xe=J?Ce.accentColor:me?Ce.bgHeaderHasFocus:Ce.bgHeader,U=n?l:0,re=E.sourceIndex===0?0:1;J?(e.fillStyle=Xe,e.fillRect(k+re,U,E.width-re,a)):(me||Q>0)&&(e.beginPath(),e.rect(k+re,U,E.width-re,a),me&&(e.fillStyle=Ce.bgHeaderHasFocus,e.fill()),Q>0&&(e.globalAlpha=Q,e.fillStyle=Ce.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ns(e,k,U,E.width,a,E,J,Ce,ve,ve?A:void 0,ve?L:void 0,me,Q,m,C,v),e.restore()}),n&&pc(e,t,r,i,l,o,g,m,w,h,b,x)}function pc(e,t,n,o,r,i,a,l,c,f,u,g){const[w,h]=(i==null?void 0:i[0])??[];let b=0;jl(t,n,o,r,(x,C,v,R,X,N)=>{if(g!==void 0&&!g.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(v,R,X,N),e.clip();const A=u(C),L=(A==null?void 0:A.overrideTheme)===void 0?a:Bn(a,A.overrideTheme),G=h===-2&&w!==void 0&&w>=x[0]&&w<=x[1],M=G?L.bgGroupHeaderHovered??L.bgHeaderHovered:L.bgGroupHeader??L.bgHeader;if(M!==a.bgHeader&&(e.fillStyle=M,e.fill()),e.fillStyle=L.textGroupHeader??L.textHeader,A!==void 0){let W=v;if(A.icon!==void 0&&(l.drawSprite(A.icon,"normal",e,W+8,(r-20)/2,20,L),W+=26),e.fillText(A.name,W+8,r/2+Qn(e,a.headerFontFull)),A.actions!==void 0&&G){const $=es({x:v,y:R,width:X,height:N},A.actions);e.beginPath();const F=$[0].x-10,E=v+X-F;e.rect(F,0,E,r);const k=e.createLinearGradient(F,0,F+E,0),ce=go(M,0);k.addColorStop(0,ce),k.addColorStop(10/E,M),k.addColorStop(1,M),e.fillStyle=k,e.fill(),e.globalAlpha=.6;const[ne,oe]=(i==null?void 0:i[1])??[-1,-1];for(let Re=0;Re<A.actions.length;Re++){const Ce=A.actions[Re],J=$[Re],K=ho(J,ne+v,oe);K&&(e.globalAlpha=1),l.drawSprite(Ce.icon,"normal",e,J.x+J.width/2-10,J.y+J.height/2-10,20,L),K&&(e.globalAlpha=.6)}e.globalAlpha=1}}v!==0&&f(x[0])&&(e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=v+X}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const zr=30;function vc(e,t,n,o,r){return{x:e+n-zr,y:Math.max(t,t+o/2-zr/2),width:zr,height:Math.min(zr,o)}}function es(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function Jo(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ts(e,t,n,o,r,i,a,l){var C;const c=a.cellHorizontalPadding,f=a.headerIconSize,u=vc(n,o,r,i);let g=n+c;const m=t.icon===void 0?void 0:{x:g,y:o+(i-f)/2,width:f,height:f},w=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(f*1.3));const h={x:g,y:o,width:r-g,height:i};let b;if(t.indicatorIcon!==void 0){const v=e===void 0?((C=$l(t.title,a.headerFontFull))==null?void 0:C.width)??0:Bo(t.title,e,a.headerFontFull).width;h.width=v,g+=v+c,b={x:g,y:o+(i-f)/2,width:f,height:f}}const x=n+r/2;return{menuBounds:Jo(u,x,l),iconBounds:Jo(m,x,l),iconOverlayBounds:Jo(w,x,l),textBounds:Jo(h,x,l),indicatorIconBounds:Jo(b,x,l)}}function ul(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const v=i.rowMarkerChecked;v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const R=i.headerRowMarkerTheme!==void 0?Bn(l,i.headerRowMarkerTheme):l;Fi(e,R,v,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=a?l.textHeaderSelected:l.textHeader,C=i.hasMenu===!0&&(c||w&&a)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let v=a?"selected":"normal";i.style==="highlight"&&(v=a?"selected":"special"),m.drawSprite(i.icon,v,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&m.drawSprite(i.overlayIcon,a?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(C&&o>35){const R=h?35:o-35,X=h?35*.7:o-35*.7,N=R/o,A=X/o,L=e.createLinearGradient(t,0,t+o,0),G=go(x,0);L.addColorStop(h?1:0,x),L.addColorStop(N,x),L.addColorStop(A,G),L.addColorStop(h?0:1,G),e.fillStyle=L}else e.fillStyle=x;if(h&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,h?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+Qn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!C||!lr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let v=a?"selected":"normal";i.style==="highlight"&&(v=a?"selected":"special"),m.drawSprite(i.indicatorIcon,v,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(C&&b.menuBounds!==void 0){const v=b.menuBounds,R=f!==void 0&&u!==void 0&&ho(v,f+t,u+n);if(R||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Nr.Triangle){e.beginPath();const X=v.x+v.width/2-5.5,N=v.y+v.height/2-3;Ha(e,[{x:X,y:N},{x:X+11,y:N},{x:X+5.5,y:N+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Nr.Dots){e.beginPath();const X=v.x+v.width/2,N=v.y+v.height/2;Da(e,X,N),e.fillStyle=x,e.fill()}else{const X=v.x+(v.width-l.headerIconSize)/2,N=v.y+(v.height-l.headerIconSize)/2;m.drawSprite(i.menuIcon,"normal",e,X,N,l.headerIconSize,l)}R||(e.globalAlpha=1)}}function ns(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){const x=Ei(i.title)==="rtl",C=ts(e,i,t,n,o,r,l,x);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:m,isHovered:c,hasSelectedCell:g,spriteManager:w,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>ul(e,t,n,o,r,i,a,l,c,f,u,m,w,b,x,C)):ul(e,t,n,o,r,i,a,l,c,f,u,m,w,b,x,C)}function Cc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,v){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const R=ql(x);eo(t,c,a,l,i,(X,N,A,L,G)=>{if(X!==t[t.length-1])return;N+=X.width;const M=Math.max(N,L);M>o||(e.save(),e.beginPath(),e.rect(M,i+1,1e4,r-i-1),e.clip(),_r(G,A,r,f,u,h,b,R,(W,$,F,E)=>{if(!E&&x.length>0&&!x.some(Re=>lr(N,W,1e4,F,Re.x,Re.y,Re.width,Re.height)))return;const k=m.hasIndex($),ce=w.hasIndex($);e.beginPath();const ne=g==null?void 0:g($),oe=ne===void 0?v:Bn(v,ne);oe.bgCell!==v.bgCell&&(e.fillStyle=oe.bgCell,e.fillRect(N,W,1e4,F)),ce&&(e.fillStyle=oe.bgHeader,e.fillRect(N,W,1e4,F)),k&&(e.fillStyle=oe.accentLight,e.fillRect(N,W,1e4,F))}),e.restore())})}function xc(e,t,n,o,r,i,a,l,c){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,g=c.borderColor,m=f?Po(t):0;let w;if(m!==0&&(w=ll(g,c.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=g===u&&w!==void 0?w:ll(u,c.bgCell),b=mo(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const os=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function kc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h){var F;const b=h.bgCell,{minX:x,maxX:C,minY:v,maxY:R}=os(l,i,a),X=[],N=a-mo(w,m,f);let A=c,L=n,G=0;for(;A+r<N;){const E=A+r,k=f(L);if(E>=v&&E<=R-1){const ce=u==null?void 0:u(L),ne=ce==null?void 0:ce.bgCell;ne!==void 0&&ne!==b&&L>=w-m&&X.push({x,y:E,w:C-x,h:k,color:ne})}A+=k,L<w-m&&(G=A),L++}let M=0;const W=Math.min(N,R)-G;if(W>0)for(let E=0;E<t.length;E++){const k=t[E];if(k.width===0)continue;const ce=k.sticky?M:M+o,ne=(F=k.themeOverride)==null?void 0:F.bgCell;ne!==void 0&&ne!==b&&ce>=x&&ce<=C&&g(E+1)&&X.push({x:ce,y:G,w:k.width,h:W,color:ne}),M+=k.width}if(X.length===0)return;let $;e.beginPath();for(let E=X.length-1;E>=0;E--){const k=X[E];$===void 0?$=k.color:k.color!==$&&(e.fillStyle=$,e.fill(),e.beginPath(),$=k.color),e.rect(k.x,k.y,k.w,k.h)}$!==void 0&&(e.fillStyle=$,e.fill()),e.beginPath()}function fl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const F of c)e.rect(F.x+1,F.y+1,F.width-1,F.height-1);e.clip("evenodd")}const v=x.horizontalBorderColor??x.borderColor,R=x.borderColor,{minX:X,maxX:N,minY:A,maxY:L}=os(l,i,a),G=[];e.beginPath();let M=.5;for(let F=0;F<t.length;F++){const E=t[F];if(E.width===0)continue;M+=E.width;const k=E.sticky?M:M+o;k>=X&&k<=N&&w(F+1)&&G.push({x1:k,y1:Math.max(f,A),x2:k,y2:Math.min(a,L),color:R})}let W=a+.5;for(let F=b-h;F<b;F++){const E=g(F);W-=E,G.push({x1:X,y1:W,x2:N,y2:W,color:v})}if(C!==!0){let F=u+.5,E=n;const k=W;for(;F+r<k;){const ce=F+r;if(ce>=A&&ce<=L-1){const ne=m==null?void 0:m(E);G.push({x1:X,y1:ce,x2:N,y2:ce,color:(ne==null?void 0:ne.horizontalBorderColor)??(ne==null?void 0:ne.borderColor)??v})}F+=g(E),E++}}const $=Vs(G,F=>F.color);for(const F of Object.keys($)){e.strokeStyle=F;for(const E of $[F])e.moveTo(E.x1,E.y1),e.lineTo(E.x2,E.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Sc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x,C,v){const R=[];e.imageSmoothingEnabled=!1;const X=Math.min(r.cellYOffset,a),N=Math.max(r.cellYOffset,a);let A=0;if(typeof C=="number")A+=(N-X)*C;else for(let k=X;k<N;k++)A+=C(k);a>r.cellYOffset&&(A=-A),A+=c-r.translateY;const L=Math.min(r.cellXOffset,i),G=Math.max(r.cellXOffset,i);let M=0;for(let k=L;k<G;k++)M+=b[k].width;i>r.cellXOffset&&(M=-M),M+=l-r.translateX;const W=Po(x);if(M!==0&&A!==0)return{regions:[]};const $=f>0?mo(m,f,C):0,F=u-W-Math.abs(M),E=g-w-$-Math.abs(A)-1;if(F>150&&E>150){const k={sx:0,sy:0,sw:u*h,sh:g*h,dx:0,dy:0,dw:u*h,dh:g*h};if(A>0?(k.sy=(w+1)*h,k.sh=E*h,k.dy=(A+w+1)*h,k.dh=E*h,R.push({x:0,y:w,width:u,height:A+1})):A<0&&(k.sy=(-A+w+1)*h,k.sh=E*h,k.dy=(w+1)*h,k.dh=E*h,R.push({x:0,y:g+A-$,width:u,height:-A+$})),M>0?(k.sx=W*h,k.sw=F*h,k.dx=(M+W)*h,k.dw=F*h,R.push({x:W-1,y:0,width:M+2,height:g})):M<0&&(k.sx=(W-M)*h,k.sw=F*h,k.dx=W*h,k.dw=F*h,R.push({x:u+M,y:0,width:-M,height:g})),e.setTransform(1,0,0,1,0,0),v){if(W>0&&M!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ce=W*h,ne=g*h;e.drawImage(t,0,0,ce,ne,0,0,ce,ne)}if($>0&&M===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ce=(g-$)*h,ne=u*h,oe=$*h;e.drawImage(t,0,ce,ne,oe,0,ce,ne,oe)}}e.drawImage(t,k.sx,k.sy,k.sw,k.sh,k.dx,k.dy,k.dw,k.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:R}}function Mc(e,t,n,o,r,i,a,l,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||eo(c,n,o,r,l,(g,m,w,h)=>{if(g.sourceIndex===f){const b=Math.max(m,h)+1;return u.push({x:b,y:0,width:i-b,height:a}),!0}}),u}function Rc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Ao(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:c,...f}=i;if(!Ao(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function hl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){const x=h==null?void 0:h.filter(L=>L.style!=="no-outline");if(x===void 0||x.length===0)return;const C=Po(l),v=mo(w,m,g),R=[c,0,l.length,w-m],X=[C,0,t,n-v],N=x.map(L=>{const G=L.range,M=L.style??"dashed";return mc(G,R,t,n,X).map(W=>{const $=W.rect,F=vi($.x,$.y,t,n,u,f+u,o,r,i,a,w,c,m,l,g),E=$.width===1&&$.height===1?F:vi($.x+$.width-1,$.y+$.height-1,t,n,u,f+u,o,r,i,a,w,c,m,l,g);return $.x+$.width>=l.length&&(E.width-=1),$.y+$.height>=w&&(E.height-=1),{color:L.color,style:M,clip:W.clip,rect:gc({x:F.x,y:F.y,width:E.x+E.width-F.x,height:E.y+E.height-F.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let L=!1;for(const G of N)for(const M of G)if((M==null?void 0:M.rect)!==void 0&&lr(0,0,t,n,M.rect.x,M.rect.y,M.rect.width,M.rect.height)){const W=L,$=!hc(M.clip,M.rect);e.beginPath(),$&&(e.save(),e.rect(M.clip.x,M.clip.y,M.clip.width,M.clip.height),e.clip()),M.style==="dashed"&&!L?(e.setLineDash([5,3]),L=!0):(M.style==="solid"||M.style==="solid-outline")&&L&&(e.setLineDash([]),L=!1),e.strokeStyle=M.style==="solid-outline"?Zt(Zt(M.color,b.borderColor),b.bgCell):go(M.color,1),e.closePath(),e.strokeRect(M.rect.x+.5,M.rect.y+.5,M.rect.width-1,M.rect.height-1),$&&(e.restore(),L=W)}L&&e.setLineDash([])};return A(),A}function gl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function hi(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,x){if(u.current===void 0)return;const C=u.current.range,v=u.current.cell,R=[C.x+C.width-1,C.y+C.height-1];if(v[1]>=x&&R[1]>=x||!a.some(k=>k.sourceIndex===v[0]||k.sourceIndex===R[0]))return;const[N,A]=u.current.cell,L=m(u.current.cell),G=L.span??[N,N],M=A>=x-w,W=w>0&&!M?mo(x,w,g)-1:0,$=R[1];let F;if(eo(a,o,r,i,f,(k,ce,ne,oe,Re)=>{if(k.sticky&&N>k.sourceIndex)return;const Ce=k.sourceIndex<G[0],J=k.sourceIndex>G[1],K=k.sourceIndex===R[0];if(!(!K&&(Ce||J)))return _r(Re,ne,n,x,g,w,h,void 0,(ve,Q,me)=>{if(Q!==A&&Q!==$)return;let Xe=ce,U=k.width;if(L.span!==void 0){const de=Zl(L.span,ce,ve,k.width,me,k,l),ze=k.sticky?de[0]:de[1];ze!==void 0&&(Xe=ze.x,U=ze.width)}return Q===$&&K&&b&&(F=()=>{var de;oe>Xe&&!k.sticky&&(e.beginPath(),e.rect(oe,0,t-oe,n),e.clip()),e.beginPath(),e.rect(Xe+U-4,ve+me-4,4,4),e.fillStyle=((de=k.themeOverride)==null?void 0:de.accentColor)??c.accentColor,e.fill()}),F!==void 0}),F!==void 0}),F===void 0)return;const E=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-W),e.clip(),F==null||F(),e.restore()};return E(),E}function Ec(e,t,n,o,r,i,a,l,c){c===void 0||c.size===0||(e.beginPath(),jl(t,n,i,o,(f,u,g,m,w,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(g,m,w,h)}),eo(t,l,i,a,r,(f,u,g,m)=>{const w=Math.max(0,m-u),h=u+w+1,b=f.width-w-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function Ic(e,t,n,o,r,i,a,l,c,f){let u=0;return eo(e,i,o,r,n,(g,m,w,h,b)=>(_r(b,w,t,a,l,c,f,void 0,(x,C,v,R)=>{R||(u=Math.max(C,u))}),!0)),u}function ml(e,t){var dn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:x,groupHeaderHeight:C,disabledRows:v,rowHeight:R,verticalBorder:X,overrideCursor:N,isResizing:A,selection:L,fillHandle:G,freezeTrailingRows:M,rows:W,getCellContent:$,getGroupDetails:F,getRowThemeOverride:E,isFocused:k,drawHeaderCallback:ce,prelightCells:ne,drawCellCallback:oe,highlightRegions:Re,resizeCol:Ce,imageLoader:J,lastBlitData:K,hoverValues:ve,hyperWrapping:Q,hoverInfo:me,spriteManager:Xe,maxScaleFactor:U,hasAppendRow:re,touchMode:de,enqueue:ze,renderStateProvider:tt,getCellRenderer:Ct,renderStrategy:st,bufferACtx:Pe,bufferBCtx:Ye,damage:He,minimumCellWidth:at,resizeIndicator:rt}=e;if(r===0||i===0)return;const je=st==="double-buffer",V=Math.min(U,Math.ceil(window.devicePixelRatio??1)),Ie=st!=="direct"&&Rc(e,t),ke=n.canvas;(ke.width!==r*V||ke.height!==i*V)&&(ke.width=r*V,ke.height=i*V,ke.style.width=r+"px",ke.style.height=i+"px");const Me=o.canvas,ge=g?C+x:x,_e=ge+1;(Me.width!==r*V||Me.height!==_e*V)&&(Me.width=r*V,Me.height=_e*V,Me.style.width=r+"px",Me.style.height=_e+"px");const Ne=Pe.canvas,Oe=Ye.canvas;je&&(Ne.width!==r*V||Ne.height!==i*V)&&(Ne.width=r*V,Ne.height=i*V,K.current!==void 0&&(K.current.aBufferScroll=void 0)),je&&(Oe.width!==r*V||Oe.height!==i*V)&&(Oe.width=r*V,Oe.height=i*V,K.current!==void 0&&(K.current.bBufferScroll=void 0));const ue=K.current;if(Ie===!0&&a===(ue==null?void 0:ue.cellXOffset)&&l===(ue==null?void 0:ue.cellYOffset)&&c===(ue==null?void 0:ue.translateX)&&f===(ue==null?void 0:ue.translateY))return;let fe=null;je&&(fe=n);const Qe=o;let Ke;je?He!==void 0?Ke=(ue==null?void 0:ue.lastBuffer)==="b"?Ye:Pe:Ke=(ue==null?void 0:ue.lastBuffer)==="b"?Pe:Ye:Ke=n;const Ve=Ke.canvas,ft=je?Ve===Ne?Oe:Ne:ke,Ze=typeof R=="number"?()=>R:R;Qe.save(),Ke.save(),Qe.beginPath(),Ke.beginPath(),Qe.textBaseline="middle",Ke.textBaseline="middle",V!==1&&(Qe.scale(V,V),Ke.scale(V,V));const De=pi(u,a,r,w,c);let xt=[];const $t=b&&((dn=L.current)==null?void 0:dn.cell[1])===l&&f===0;let kt=!1;if(Re!==void 0){for(const pe of Re)if(pe.style!=="no-outline"&&pe.range.y===l&&f===0){kt=!0;break}}const Dt=()=>{yc(Qe,De,g,me,r,c,x,C,w,A,L,h,Xe,ve,X,F,He,ce,de),fl(Qe,De,l,c,f,r,i,void 0,void 0,C,ge,Ze,E,X,M,W,h,!0),Qe.beginPath(),Qe.moveTo(0,_e-.5),Qe.lineTo(r,_e-.5),Qe.strokeStyle=Zt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Qe.stroke(),kt&&hl(Qe,r,i,a,l,c,f,u,m,x,C,R,M,W,Re,h),$t&&hi(Qe,r,i,l,c,f,De,u,h,ge,L,Ze,$,M,re,G,W)};if(He!==void 0){const pe=De[De.length-1].sourceIndex+1,yt=He.hasItemInRegion([{x:a,y:-2,width:pe,height:2},{x:a,y:l,width:pe,height:300},{x:0,y:l,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:a,y:W-M,width:pe,height:M,when:M>0}]),yn=Qt=>{dl(Qt,De,u,i,ge,c,f,l,W,Ze,$,F,E,v,k,b,M,re,xt,He,L,ne,Re,J,Xe,ve,me,oe,Q,h,ze,tt,Ct,N,at);const en=L.current;G&&b&&en!==void 0&&He.has(Bl(en.range))&&hi(Qt,r,i,l,c,f,De,u,h,ge,L,Ze,$,M,re,G,W)};yt&&(yn(Ke),fe!==null&&(fe.save(),fe.scale(V,V),fe.textBaseline="middle",yn(fe),fe.restore()),He.hasHeader()&&(Ec(Qe,De,r,C,ge,c,f,l,He),Dt())),Ke.restore(),Qe.restore();return}if((Ie!==!0||a!==(ue==null?void 0:ue.cellXOffset)||c!==(ue==null?void 0:ue.translateX)||$t!==(ue==null?void 0:ue.mustDrawFocusOnHeader)||kt!==(ue==null?void 0:ue.mustDrawHighlightRingsOnHeader))&&Dt(),Ie===!0){jt(ft!==void 0&&ue!==void 0);const{regions:pe}=Sc(Ke,ft,ft===Ne?ue.aBufferScroll:ue.bBufferScroll,ft===Ne?ue.bBufferScroll:ue.aBufferScroll,ue,a,l,c,f,M,r,i,W,ge,V,u,De,R,je);xt=pe}else Ie!==!1&&(jt(ue!==void 0),xt=Mc(ue,a,l,c,f,r,i,ge,De,Ie));xc(Ke,De,r,i,M,W,X,Ze,h);const Wt=hl(Ke,r,i,a,l,c,f,u,m,x,C,R,M,W,Re,h),bt=b?hi(Ke,r,i,l,c,f,De,u,h,ge,L,Ze,$,M,re,G,W):void 0;if(Ke.fillStyle=h.bgCell,xt.length>0){Ke.beginPath();for(const pe of xt)Ke.rect(pe.x,pe.y,pe.width,pe.height);Ke.clip(),Ke.fill(),Ke.beginPath()}else Ke.fillRect(0,0,r,i);const bn=dl(Ke,De,u,i,ge,c,f,l,W,Ze,$,F,E,v,k,b,M,re,xt,He,L,ne,Re,J,Xe,ve,me,oe,Q,h,ze,tt,Ct,N,at);Cc(Ke,De,u,r,i,ge,c,f,l,W,Ze,E,L.rows,v,M,re,xt,He,h),kc(Ke,De,l,c,f,r,i,xt,ge,Ze,E,X,M,W,h),fl(Ke,De,l,c,f,r,i,xt,bn,C,ge,Ze,E,X,M,W,h),Wt==null||Wt(),bt==null||bt(),A&&rt!=="none"&&eo(De,0,c,0,ge,(pe,yt)=>pe.sourceIndex===Ce?(gl(Qe,yt+pe.width,0,ge+1,Zt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),rt==="full"&&gl(Ke,yt+pe.width,ge,i,Zt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),fe!==null&&(fe.fillStyle=h.bgCell,fe.fillRect(0,0,r,i),fe.drawImage(Ke.canvas,0,0));const Ln=Ic(De,i,ge,c,f,l,W,Ze,M,re);J==null||J.setWindow({x:a,y:l,width:De.length,height:Ln-l},m,Array.from({length:M},(pe,yt)=>W-1-yt));const ct=ue!==void 0&&(a!==ue.cellXOffset||c!==ue.translateX),In=ue!==void 0&&(l!==ue.cellYOffset||f!==ue.translateY);K.current={cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:$t,mustDrawHighlightRingsOnHeader:kt,lastBuffer:je?Ve===Ne?"a":"b":void 0,aBufferScroll:Ve===Ne?[ct,In]:ue==null?void 0:ue.aBufferScroll,bBufferScroll:Ve===Oe?[ct,In]:ue==null?void 0:ue.bBufferScroll},Ke.restore(),Qe.restore()}const Dc=80;function Hc(e){const t=e-1;return t*t*t+1}class Fc{constructor(t){Ge(this,"callback");Ge(this,"currentHoveredItem");Ge(this,"leavingItems",[]);Ge(this,"lastAnimationTime");Ge(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>tr(o.item,t.item))||this.leavingItems.push(t)});Ge(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>tr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Ge(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Ge(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Ge(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Hc(t.hoverAmount)})));Ge(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Dc;for(const i of this.leavingItems)i.hoverAmount=sn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=sn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Ge(this,"setHovered",t=>{var n;if(!tr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Tc{constructor(t){Ge(this,"fn");Ge(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Ti(e){return new Tc(e)}const Ac=Ti(()=>window.navigator.userAgent.includes("Firefox")),Or=Ti(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Xr=Ti(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function zc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Hi);t.current=[],o.current(new or(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=wn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Jn="header",an="group-header",Yr="out-of-bounds";var To;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(To||(To={}));function rs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const wl=6,Pc=(e,t)=>{if(e.kind===j.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Bc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:b,onHeaderIndicatorClick:x,enableGroups:C,isFilling:v,onCanvasFocused:R,onCanvasBlur:X,isFocused:N,selection:A,freezeColumns:L,onContextMenu:G,freezeTrailingRows:M,fixedShadowX:W=!0,fixedShadowY:$=!0,drawFocusRing:F,onMouseDown:E,onMouseUp:k,onMouseMoveRaw:ce,onMouseMove:ne,onItemHovered:oe,dragAndDropState:Re,firstColAccessible:Ce,onKeyDown:J,onKeyUp:K,highlightRegions:ve,canvasRef:Q,onDragStart:me,onDragEnd:Xe,eventTargetRef:U,isResizing:re,resizeColumn:de,isDragging:ze,isDraggable:tt=!1,allowResize:Ct,disabledRows:st,hasAppendRow:Pe,getGroupDetails:Ye,theme:He,prelightCells:at,headerIcons:rt,verticalBorder:je,drawCell:V,drawHeader:Ie,onCellFocused:ke,onDragOverCell:Me,onDrop:ge,onDragLeave:_e,imageWindowLoader:Ne,smoothScrollX:Oe=!1,smoothScrollY:ue=!1,experimental:fe,getCellRenderer:Qe,resizeIndicator:Ke="full"}=e,Ve=e.translateX??0,ft=e.translateY??0,Ze=Math.max(L,Math.min(i.length-1,a)),De=s.useRef(null),xt=s.useRef((fe==null?void 0:fe.eventTarget)??window),$t=xt.current,kt=Ne,Dt=s.useRef(),[Wt,bt]=s.useState(!1),bn=s.useRef([]),Ln=s.useRef(),[ct,In]=s.useState(),[dn,pe]=s.useState(),yt=s.useRef(null),[yn,Qt]=s.useState(),[en,Le]=s.useState(!1),Ht=s.useRef(en);Ht.current=en;const ht=s.useMemo(()=>new uc(rt,()=>{wo.current=void 0,no.current()}),[rt]),Nt=C?u+c:c,zt=s.useRef(-1),Kt=((fe==null?void 0:fe.enableFirefoxRescaling)??!1)&&Ac.value,Wn=((fe==null?void 0:fe.enableSafariRescaling)??!1)&&Or.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Kt&&!Wn||(zt.current!==-1&&bt(!0),window.clearTimeout(zt.current),zt.current=window.setTimeout(()=>{bt(!1),zt.current=-1},200))},[l,Ze,Ve,ft,Kt,Wn]);const St=ba(i,L),vt=s.useMemo(()=>W?Po(St,Re):0,[St,Re,W]),At=s.useCallback((S,_,le)=>{const ee=S.getBoundingClientRect();if(_>=St.length||le>=m)return;const q=ee.width/n,se=vi(_,le,n,o,u,Nt,Ze,l,Ve,ft,m,L,M,St,g);return q!==1&&(se.x*=q,se.y*=q,se.width*=q,se.height*=q),se.x+=ee.x,se.y+=ee.y,se},[n,o,u,Nt,Ze,l,Ve,ft,m,L,M,St,g]),Pt=s.useCallback((S,_,le,ee)=>{const q=S.getBoundingClientRect(),se=q.width/n,Fe=(_-q.left)/se,Te=(le-q.top)/se,we=5,lt=pi(St,Ze,n,void 0,Ve);let ie=0,Ee=0;const Ae=typeof PointerEvent<"u"&&ee instanceof PointerEvent&&ee.pointerType==="mouse"||typeof MouseEvent<"u"&&ee instanceof MouseEvent,Be=typeof PointerEvent<"u"&&ee instanceof PointerEvent&&ee.pointerType==="touch"||typeof TouchEvent<"u"&&ee instanceof TouchEvent;Ae&&(ie=ee.button,Ee=ee.buttons);const ot=Ca(Fe,lt,Ve),Mt=xa(Te,o,C,c,u,m,g,l,ft,M),Rt=(ee==null?void 0:ee.shiftKey)===!0,mt=(ee==null?void 0:ee.ctrlKey)===!0,Et=(ee==null?void 0:ee.metaKey)===!0,Ut=[Fe<0?-1:n<Fe?1:0,Te<Nt?-1:o<Te?1:0];let on;if(ot===-1||Te<0||Fe<0||Mt===void 0||Fe>n||Te>o){const et=Fe>n?1:Fe<0?-1:0,un=Te>o?1:Te<0?-1:0;let Vt=et*2,qe=un*2;et===0&&(Vt=ot===-1?To.EndPadding:To.Center),un===0&&(qe=Mt===void 0?To.EndPadding:To.Center);let It=!1;if(ot===-1&&Mt===-1){const Kn=At(S,St.length-1,-1);jt(Kn!==void 0),It=_<Kn.x+Kn.width+we}const _n=Fe>n&&Fe<n+yi()||Te>o&&Te<o+yi();on={kind:Yr,location:[ot!==-1?ot:Fe<0?0:St.length-1,Mt??m-1],region:[Vt,qe],shiftKey:Rt,ctrlKey:mt,metaKey:Et,isEdge:It,isTouch:Be,button:ie,buttons:Ee,scrollEdge:Ut,isMaybeScrollbar:_n}}else if(Mt<=-1){let et=At(S,ot,Mt);jt(et!==void 0);let un=et!==void 0&&et.x+et.width-_<=we;const Vt=ot-1;_-et.x<=we&&Vt>=0?(un=!0,et=At(S,Vt,Mt),jt(et!==void 0),on={kind:C&&Mt===-2?an:Jn,location:[Vt,Mt],bounds:et,group:St[Vt].group??"",isEdge:un,shiftKey:Rt,ctrlKey:mt,metaKey:Et,isTouch:Be,localEventX:_-et.x,localEventY:le-et.y,button:ie,buttons:Ee,scrollEdge:Ut}):on={kind:C&&Mt===-2?an:Jn,group:St[ot].group??"",location:[ot,Mt],bounds:et,isEdge:un,shiftKey:Rt,ctrlKey:mt,metaKey:Et,isTouch:Be,localEventX:_-et.x,localEventY:le-et.y,button:ie,buttons:Ee,scrollEdge:Ut}}else{const et=At(S,ot,Mt);jt(et!==void 0);const un=et!==void 0&&et.x+et.width-_<we;let Vt=!1;if(f&&A.current!==void 0){const qe=Bl(A.current.range),It=At(S,qe[0],qe[1]);if(It!==void 0){const _n=It.x+It.width-2,Kn=It.y+It.height-2;Vt=Math.abs(_n-_)<wl&&Math.abs(Kn-le)<wl}}on={kind:"cell",location:[ot,Mt],bounds:et,isEdge:un,shiftKey:Rt,ctrlKey:mt,isFillHandle:Vt,metaKey:Et,isTouch:Be,localEventX:_-et.x,localEventY:le-et.y,button:ie,buttons:Ee,scrollEdge:Ut}}return on},[n,St,Ze,Ve,o,C,c,u,m,g,l,ft,M,At,f,A,Nt]),[Dn]=ct??[],ar=s.useRef(()=>{}),$n=s.useRef(ct);$n.current=ct;const[Hn,Fn]=s.useMemo(()=>{const S=document.createElement("canvas"),_=document.createElement("canvas");return S.style.display="none",S.style.opacity="0",S.style.position="fixed",_.style.display="none",_.style.opacity="0",_.style.position="fixed",[S.getContext("2d",{alpha:!1}),_.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Hn===null||Fn===null))return document.documentElement.append(Hn.canvas),document.documentElement.append(Fn.canvas),()=>{Hn.canvas.remove(),Fn.canvas.remove()}},[Hn,Fn]);const pn=s.useMemo(()=>new Fa,[]),cr=Kt&&Wt?1:Wn&&Wt?2:5,dr=(fe==null?void 0:fe.disableMinimumCellWidth)===!0?1:10,wo=s.useRef(),bo=s.useRef(null),yo=s.useRef(null),to=s.useCallback(()=>{var Fe;const S=De.current,_=yt.current;if(S===null||_===null||(bo.current===null&&(bo.current=S.getContext("2d",{alpha:!1}),S.width=0,S.height=0),yo.current===null&&(yo.current=_.getContext("2d",{alpha:!1}),_.width=0,_.height=0),bo.current===null||yo.current===null||Hn===null||Fn===null))return;let le=!1;const ee=Te=>{le=!0,Qt(Te)},q=wo.current,se={headerCanvasCtx:yo.current,canvasCtx:bo.current,bufferACtx:Hn,bufferBCtx:Fn,width:n,height:o,cellXOffset:Ze,cellYOffset:l,translateX:Math.round(Ve),translateY:Math.round(ft),mappedColumns:St,enableGroups:C,freezeColumns:L,dragAndDropState:Re,theme:He,headerHeight:c,groupHeaderHeight:u,disabledRows:st??nt.empty(),rowHeight:g,verticalBorder:je,isResizing:re,resizeCol:de,isFocused:N,selection:A,fillHandle:f,drawCellCallback:V,hasAppendRow:Pe,overrideCursor:ee,maxScaleFactor:cr,freezeTrailingRows:M,rows:m,drawFocus:F,getCellContent:w,getGroupDetails:Ye??(Te=>({name:Te})),getRowThemeOverride:h,drawHeaderCallback:Ie,prelightCells:at,highlightRegions:ve,imageLoader:kt,lastBlitData:Ln,damage:Dt.current,hoverValues:bn.current,hoverInfo:$n.current,spriteManager:ht,scrolling:Wt,hyperWrapping:(fe==null?void 0:fe.hyperWrapping)??!1,touchMode:en,enqueue:ar.current,renderStateProvider:pn,renderStrategy:(fe==null?void 0:fe.renderStrategy)??(Or.value?"double-buffer":"single-buffer"),getCellRenderer:Qe,minimumCellWidth:dr,resizeIndicator:Ke};se.damage===void 0?(wo.current=se,ml(se,q)):ml(se,void 0),!le&&(se.damage===void 0||se.damage.has((Fe=$n==null?void 0:$n.current)==null?void 0:Fe[0]))&&Qt(void 0)},[Hn,Fn,n,o,Ze,l,Ve,ft,St,C,L,Re,He,c,u,st,g,je,re,Pe,de,N,A,f,M,m,F,cr,w,Ye,h,V,Ie,at,ve,kt,ht,Wt,fe==null?void 0:fe.hyperWrapping,fe==null?void 0:fe.renderStrategy,en,pn,Qe,dr,Ke]),no=s.useRef(to);s.useLayoutEffect(()=>{to(),no.current=to},[to]),s.useLayoutEffect(()=>{(async()=>{var _;((_=document==null?void 0:document.fonts)==null?void 0:_.ready)!==void 0&&(await document.fonts.ready,wo.current=void 0,no.current())})()},[]);const Nn=s.useCallback(S=>{Dt.current=S,no.current(),Dt.current=void 0},[]),Kr=zc(Nn);ar.current=Kr;const ur=s.useCallback(S=>{Nn(new or(S.map(_=>_.cell)))},[Nn]);kt.setCallback(Nn);const[fr,Ur]=s.useState(!1),[oo,On]=Dn??[],Lo=oo!==void 0&&On===-1&&i[oo].headerRowMarkerDisabled!==!0,Vr=oo!==void 0&&On===-2;let Wo=!1,$o=!1,po=yn;if(po===void 0&&oo!==void 0&&On!==void 0&&On>-1&&On<m){const S=w([oo,On],!0);Wo=S.kind===cn.NewRow||S.kind===cn.Marker&&S.markerKind!=="number",$o=S.kind===j.Boolean&&Mi(S),po=S.cursor}const it=ze?"grabbing":(dn??!1)||re?"col-resize":fr||v?"crosshair":po!==void 0?po:Lo||Wo||$o||Vr?"pointer":"default",Yt=s.useMemo(()=>({contain:"strict",display:"block",cursor:it}),[it]),hr=s.useRef("default"),vo=U==null?void 0:U.current;vo!=null&&hr.current!==Yt.cursor&&(vo.style.cursor=hr.current=Yt.cursor);const Tn=s.useCallback((S,_,le,ee)=>{if(Ye===void 0)return;const q=Ye(S);if(q.actions!==void 0){const se=es(_,q.actions);for(const[Fe,Te]of se.entries())if(ho(Te,le+_.x,ee+Te.y))return q.actions[Fe]}},[Ye]),An=s.useCallback((S,_,le,ee)=>{const q=St[_];if(!ze&&!re&&!(dn??!1)){const se=At(S,_,-1);jt(se!==void 0);const Fe=ts(void 0,q,se.x,se.y,se.width,se.height,He,Ei(q.title)==="rtl");if(q.hasMenu===!0&&Fe.menuBounds!==void 0&&ho(Fe.menuBounds,le,ee))return{area:"menu",bounds:Fe.menuBounds};if(q.indicatorIcon!==void 0&&Fe.indicatorIconBounds!==void 0&&ho(Fe.indicatorIconBounds,le,ee))return{area:"indicator",bounds:Fe.indicatorIconBounds}}},[St,At,dn,ze,re,He]),Co=s.useRef(0),zn=s.useRef(),Xn=s.useRef(!1),Yn=s.useCallback(S=>{const _=De.current,le=U==null?void 0:U.current;if(_===null||S.target!==_&&S.target!==le)return;Xn.current=!0;const ee=S.clientX,q=S.clientY;if(S.target===le&&le!==null){const Fe=le.getBoundingClientRect();if(ee>Fe.right||q>Fe.bottom)return}const se=Pt(_,ee,q,S);zn.current=se.location,se.isTouch&&(Co.current=Date.now()),Ht.current!==se.isTouch&&Le(se.isTouch),!(se.kind===Jn&&An(_,se.location[0],ee,q)!==void 0)&&(se.kind===an&&Tn(se.group,se.bounds,se.localEventX,se.localEventY)!==void 0||(E==null||E(se),!se.isTouch&&tt!==!0&&tt!==se.kind&&se.button<3&&se.button!==1&&S.preventDefault()))},[U,tt,Pt,Tn,An,E]);_t("pointerdown",Yn,$t,!1);const ro=s.useRef(0),jr=s.useCallback(S=>{var Ee,Ae;const _=ro.current;ro.current=Date.now();const le=De.current;if(Xn.current=!1,k===void 0||le===null)return;const ee=U==null?void 0:U.current,q=S.target!==le&&S.target!==ee,se=S.clientX,Fe=S.clientY,Te=S.pointerType==="mouse"?S.button<3:!0;let we=Pt(le,se,Fe,S);we.isTouch&&Co.current!==0&&Date.now()-Co.current>500&&(we={...we,isLongTouch:!0}),_!==0&&Date.now()-_<(we.isTouch?1e3:500)&&(we={...we,isDoubleClick:!0}),Ht.current!==we.isTouch&&Le(we.isTouch),!q&&S.cancelable&&Te&&S.preventDefault();const[lt]=we.location,ie=An(le,lt,se,Fe);if(we.kind===Jn&&ie!==void 0){(we.button!==0||((Ee=zn.current)==null?void 0:Ee[0])!==lt||((Ae=zn.current)==null?void 0:Ae[1])!==-1)&&k(we,!0);return}else if(we.kind===an){const Be=Tn(we.group,we.bounds,we.localEventX,we.localEventY);if(Be!==void 0){we.button===0&&Be.onClick(we);return}}k(we,q)},[k,U,Pt,An,Tn]);_t("pointerup",jr,$t,!1);const gr=s.useCallback(S=>{var lt,ie;const _=De.current;if(_===null)return;const le=U==null?void 0:U.current,ee=S.target!==_&&S.target!==le;let q,se,Fe=!0;S instanceof MouseEvent?(q=S.clientX,se=S.clientY,Fe=S.button<3):(q=S.changedTouches[0].clientX,se=S.changedTouches[0].clientY);const Te=Pt(_,q,se,S);Ht.current!==Te.isTouch&&Le(Te.isTouch),!ee&&S.cancelable&&Fe&&S.preventDefault();const[we]=Te.location;if(Te.kind===Jn){const Ee=An(_,we,q,se);Ee!==void 0&&Te.button===0&&((lt=zn.current)==null?void 0:lt[0])===we&&((ie=zn.current)==null?void 0:ie[1])===-1&&(Ee.area==="menu"?b==null||b(we,Ee.bounds):Ee.area==="indicator"&&(x==null||x(we,Ee.bounds)))}else if(Te.kind===an){const Ee=Tn(Te.group,Te.bounds,Te.localEventX,Te.localEventY);Ee!==void 0&&Te.button===0&&Ee.onClick(Te)}},[U,Pt,An,b,x,Tn]);_t("click",gr,$t,!1);const Se=s.useCallback(S=>{const _=De.current,le=U==null?void 0:U.current;if(_===null||S.target!==_&&S.target!==le||G===void 0)return;const ee=Pt(_,S.clientX,S.clientY,S);G(ee,()=>{S.cancelable&&S.preventDefault()})},[U,Pt,G]);_t("contextmenu",Se,(U==null?void 0:U.current)??null,!1);const No=s.useCallback(S=>{Dt.current=new or(S.map(_=>_.item)),bn.current=S,no.current(),Dt.current=void 0},[]),mr=s.useMemo(()=>new Fc(No),[No]),tn=s.useRef(mr);tn.current=mr,s.useLayoutEffect(()=>{const S=tn.current;if(Dn===void 0||Dn[1]<0){S.setHovered(Dn);return}const _=w(Dn,!0),le=Qe(_),ee=le===void 0&&_.kind===j.Custom||(le==null?void 0:le.needsHover)!==void 0&&(typeof le.needsHover=="boolean"?le.needsHover:le.needsHover(_));S.setHovered(ee?Dn:void 0)},[w,Qe,Dn]);const wr=s.useRef(),vn=s.useCallback(S=>{var Te;const _=De.current;if(_===null)return;const le=U==null?void 0:U.current,ee=S.target!==_&&S.target!==le,q=Pt(_,S.clientX,S.clientY,S);if(q.kind!=="out-of-bounds"&&ee&&!Xn.current&&!q.isTouch)return;const se=(we,lt)=>{In(ie=>ie===we||(ie==null?void 0:ie[0][0])===(we==null?void 0:we[0][0])&&(ie==null?void 0:ie[0][1])===(we==null?void 0:we[0][1])&&((ie==null?void 0:ie[1][0])===(we==null?void 0:we[1][0])&&(ie==null?void 0:ie[1][1])===(we==null?void 0:we[1][1])||!lt)?ie:we)};if(!rs(q,wr.current))Qt(void 0),oe==null||oe(q),se(q.kind===Yr?void 0:[q.location,[q.localEventX,q.localEventY]],!0),wr.current=q;else if(q.kind==="cell"||q.kind===Jn||q.kind===an){let we=!1,lt=!0;if(q.kind==="cell"){const Ee=w(q.location);lt=((Te=Qe(Ee))==null?void 0:Te.needsHoverPosition)??Ee.kind===j.Custom,we=lt}else we=!0;const ie=[q.location,[q.localEventX,q.localEventY]];se(ie,lt),$n.current=ie,we&&Nn(new or([q.location]))}const Fe=q.location[0]>=(Ce?0:1);pe(q.kind===Jn&&q.isEdge&&Fe&&Ct===!0),Ur(q.kind==="cell"&&q.isFillHandle),ce==null||ce(S),ne(q)},[U,Pt,Ce,Ct,ce,ne,oe,w,Qe,Nn]);_t("pointermove",vn,$t,!0);const Oo=s.useCallback(S=>{const _=De.current;if(_===null)return;let le,ee;A.current!==void 0&&(le=At(_,A.current.cell[0],A.current.cell[1]),ee=A.current.cell),J==null||J({bounds:le,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:ee})},[J,A,At]),br=s.useCallback(S=>{const _=De.current;if(_===null)return;let le,ee;A.current!==void 0&&(le=At(_,A.current.cell[0],A.current.cell[1]),ee=A.current.cell),K==null||K({bounds:le,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:ee})},[K,A,At]),yr=s.useCallback(S=>{if(De.current=S,Q!==void 0&&(Q.current=S),fe!=null&&fe.eventTarget)xt.current=fe.eventTarget;else if(S===null)xt.current=window;else{const _=S.getRootNode();_===document&&(xt.current=window),xt.current=_}},[Q,fe==null?void 0:fe.eventTarget]),Zr=s.useCallback(S=>{const _=De.current;if(_===null||tt===!1||re){S.preventDefault();return}let le,ee;const q=Pt(_,S.clientX,S.clientY);if(tt!==!0&&q.kind!==tt){S.preventDefault();return}const se=(Ee,Ae)=>{le=Ee,ee=Ae};let Fe,Te,we;const lt=(Ee,Ae,Be)=>{Fe=Ee,Te=Ae,we=Be};let ie=!1;if(me==null||me({...q,setData:se,setDragImage:lt,preventDefault:()=>ie=!0,defaultPrevented:()=>ie}),!ie&&le!==void 0&&ee!==void 0&&S.dataTransfer!==null)if(S.dataTransfer.setData(le,ee),S.dataTransfer.effectAllowed="copyLink",Fe!==void 0&&Te!==void 0&&we!==void 0)S.dataTransfer.setDragImage(Fe,Te,we);else{const[Ee,Ae]=q.location;if(Ae!==void 0){const Be=document.createElement("canvas"),ot=At(_,Ee,Ae);jt(ot!==void 0);const Mt=Math.ceil(window.devicePixelRatio??1);Be.width=ot.width*Mt,Be.height=ot.height*Mt;const Rt=Be.getContext("2d");Rt!==null&&(Rt.scale(Mt,Mt),Rt.textBaseline="middle",Ae===-1?(Rt.font=He.headerFontFull,Rt.fillStyle=He.bgHeader,Rt.fillRect(0,0,Be.width,Be.height),ns(Rt,0,0,ot.width,ot.height,St[Ee],!1,He,!1,void 0,void 0,!1,0,ht,Ie,!1)):(Rt.font=He.baseFontFull,Rt.fillStyle=He.bgCell,Rt.fillRect(0,0,Be.width,Be.height),Ql(Rt,w([Ee,Ae]),0,Ae,!1,!1,0,0,ot.width,ot.height,!1,He,He.bgCell,kt,ht,1,void 0,!1,0,void 0,void 0,void 0,pn,Qe,()=>{}))),Be.style.left="-100%",Be.style.position="absolute",Be.style.width=`${ot.width}px`,Be.style.height=`${ot.height}px`,document.body.append(Be),S.dataTransfer.setDragImage(Be,ot.width/2,ot.height/2),window.setTimeout(()=>{Be.remove()},0)}}else S.preventDefault()},[tt,re,Pt,me,At,He,St,ht,Ie,w,kt,pn,Qe]);_t("dragstart",Zr,(U==null?void 0:U.current)??null,!1,!1);const Xo=s.useRef(),Cn=s.useCallback(S=>{const _=De.current;if(ge!==void 0&&S.preventDefault(),_===null||Me===void 0)return;const le=Pt(_,S.clientX,S.clientY),[ee,q]=le.location,se=ee-(Ce?0:1),[Fe,Te]=Xo.current??[];(Fe!==se||Te!==q)&&(Xo.current=[se,q],Me([se,q],S.dataTransfer))},[Ce,Pt,Me,ge]);_t("dragover",Cn,(U==null?void 0:U.current)??null,!1,!1);const Gn=s.useCallback(()=>{Xo.current=void 0,Xe==null||Xe()},[Xe]);_t("dragend",Gn,(U==null?void 0:U.current)??null,!1,!1);const nn=s.useCallback(S=>{const _=De.current;if(_===null||ge===void 0)return;S.preventDefault();const le=Pt(_,S.clientX,S.clientY),[ee,q]=le.location,se=ee-(Ce?0:1);ge([se,q],S.dataTransfer)},[Ce,Pt,ge]);_t("drop",nn,(U==null?void 0:U.current)??null,!1,!1);const D=s.useCallback(()=>{_e==null||_e()},[_e]);_t("dragleave",D,(U==null?void 0:U.current)??null,!1,!1);const gt=s.useRef(A);gt.current=A;const xn=s.useRef(null),Yo=s.useCallback(S=>{var _;De.current===null||!De.current.contains(document.activeElement)||(S===null&&gt.current.current!==void 0?(_=Q==null?void 0:Q.current)==null||_.focus({preventScroll:!0}):S!==null&&S.focus({preventScroll:!0}),xn.current=S)},[Q]);s.useImperativeHandle(t,()=>({focus:()=>{var _;const S=xn.current;S===null||!document.contains(S)?(_=Q==null?void 0:Q.current)==null||_.focus({preventScroll:!0}):S.focus({preventScroll:!0})},getBounds:(S,_)=>{if(!(Q===void 0||Q.current===null))return At(Q.current,S??0,_??-1)},damage:ur,getMouseArgsForPosition:(S,_,le)=>{if(!(Q===void 0||Q.current===null))return Pt(Q.current,S,_,le)}}),[Q,ur,At]);const xo=s.useRef(),Jr=ra(()=>{var Te,we,lt;if(n<50||(fe==null?void 0:fe.disableAccessibilityTree)===!0)return null;let S=pi(St,Ze,n,Re,Ve);const _=Ce?0:-1;!Ce&&((Te=S[0])==null?void 0:Te.sourceIndex)===0&&(S=S.slice(1));const[le,ee]=((we=A.current)==null?void 0:we.cell)??[],q=(lt=A.current)==null?void 0:lt.range,se=S.map(ie=>ie.sourceIndex),Fe=fo(l,Math.min(m,l+r));return le!==void 0&&ee!==void 0&&!(se.includes(le)&&Fe.includes(ee))&&Yo(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":St.length+_},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},S.map(ie=>s.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(ie.sourceIndex),"aria-colindex":ie.sourceIndex+1+_,tabIndex:-1,onFocus:Ee=>{if(Ee.target!==xn.current)return ke==null?void 0:ke([ie.sourceIndex,-1])},key:ie.sourceIndex},ie.title)))),s.createElement("tbody",{role:"rowgroup"},Fe.map(ie=>s.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(ie),key:ie,"aria-rowindex":ie+2},S.map(Ee=>{const Ae=Ee.sourceIndex,Be=wn(Ae,ie),ot=le===Ae&&ee===ie,Mt=q!==void 0&&Ae>=q.x&&Ae<q.x+q.width&&ie>=q.y&&ie<q.y+q.height,Rt=`glide-cell-${Ae}-${ie}`,mt=[Ae,ie],Et=w(mt,!0);return s.createElement("td",{key:Be,role:"gridcell","aria-colindex":Ae+1+_,"aria-selected":Mt,"aria-readonly":Fo(Et)||!er(Et),id:Rt,"data-testid":Rt,onClick:()=>{const Ut=Q==null?void 0:Q.current;if(Ut!=null)return J==null?void 0:J({bounds:At(Ut,Ae,ie),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:mt})},onFocusCapture:Ut=>{var on,et;if(!(Ut.target===xn.current||((on=xo.current)==null?void 0:on[0])===Ae&&((et=xo.current)==null?void 0:et[1])===ie))return xo.current=mt,ke==null?void 0:ke(mt)},ref:ot?Yo:void 0,tabIndex:-1},Pc(Et,Qe))})))))},[n,St,Ze,Re,Ve,m,l,r,A,Yo,w,Q,J,At,ke],200),ko=L===0||!W?0:Ze>L?1:sn(-Ve/100,0,1),zi=-l*32+ft,z=$?sn(-zi/100,0,1):0,Ot=s.useMemo(()=>{if(!ko&&!z)return null;const S={position:"absolute",top:0,left:vt,width:n-vt,height:o,opacity:ko,pointerEvents:"none",transition:Oe?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},_={position:"absolute",top:Nt,left:0,width:n,height:o,opacity:z,pointerEvents:"none",transition:ue?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,ko>0&&s.createElement("div",{id:"shadow-x",style:S}),z>0&&s.createElement("div",{id:"shadow-y",style:_}))},[ko,z,vt,n,Oe,Nt,o,ue]),Bt=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Oo,onKeyUp:br,onFocus:R,onBlur:X,ref:yr,style:Yt},Jr),s.createElement("canvas",{ref:yt,style:Bt}),Ot)},Lc=s.memo(s.forwardRef(Bc));function Qo(e,t,n,o){return sn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Wc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,c]=s.useState(),[f,u]=s.useState(!1),[g,m]=s.useState(),[w,h]=s.useState(),[b,x]=s.useState(),[C,v]=s.useState(!1),[R,X]=s.useState(),{onHeaderMenuClick:N,onHeaderIndicatorClick:A,getCellContent:L,onColumnMoved:G,onColumnResize:M,onColumnResizeStart:W,onColumnResizeEnd:$,gridRef:F,maxColumnWidth:E,minColumnWidth:k,onRowMoved:ce,lockColumns:ne,onColumnProposeMove:oe,onMouseDown:Re,onMouseUp:Ce,onItemHovered:J,onDragStart:K,canvasRef:ve}=e,Q=(M??$??W)!==void 0,{columns:me,selection:Xe}=e,U=Xe.columns,re=s.useCallback(V=>{const[Ie,ke]=V.location;i!==void 0&&l!==Ie&&Ie>=ne?(u(!0),c(Ie)):w!==void 0&&ke!==void 0?(v(!0),x(Math.max(0,ke))):o===void 0&&!f&&!C&&(J==null||J(V))},[i,w,l,J,ne,o,f,C]),de=G!==void 0,ze=s.useCallback(V=>{var Ie;if(V.button===0){const[ke,Me]=V.location;if(V.kind==="out-of-bounds"&&V.isEdge&&Q){const ge=(Ie=F==null?void 0:F.current)==null?void 0:Ie.getBounds(me.length-1,-1);ge!==void 0&&(n(ge.x),r(me.length-1))}else if(V.kind==="header"&&ke>=ne){const ge=ve==null?void 0:ve.current;if(V.isEdge&&Q&&ge){n(V.bounds.x),r(ke);const Ne=ge.getBoundingClientRect().width/ge.offsetWidth,Oe=V.bounds.width/Ne;W==null||W(me[ke],Oe,ke,Oe+(me[ke].growOffset??0))}else V.kind==="header"&&de&&(m(V.bounds.x),a(ke))}else V.kind==="cell"&&ne>0&&ke===0&&Me!==void 0&&ce!==void 0&&(X(V.bounds.y),h(Me))}Re==null||Re(V)},[Re,Q,ne,ce,F,me,de,W,ve]),tt=s.useCallback((V,Ie)=>{f||C||N==null||N(V,Ie)},[f,C,N]),Ct=s.useCallback((V,Ie)=>{f||C||A==null||A(V,Ie)},[f,C,A]),st=s.useRef(-1),Pe=s.useCallback(()=>{st.current=-1,h(void 0),x(void 0),X(void 0),v(!1),a(void 0),c(void 0),m(void 0),u(!1),r(void 0),n(void 0)},[]),Ye=s.useCallback((V,Ie)=>{if(V.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const Me of U){if(Me===o)continue;const ge=me[Me],_e=Qo(ge,st.current,k,E);M==null||M(ge,_e,Me,_e+(ge.growOffset??0))}const ke=Qo(me[o],st.current,k,E);if($==null||$(me[o],ke,o,ke+(me[o].growOffset??0)),U.hasIndex(o))for(const Me of U){if(Me===o)continue;const ge=me[Me],_e=Qo(ge,st.current,k,E);$==null||$(ge,_e,Me,_e+(ge.growOffset??0))}}Pe(),i!==void 0&&l!==void 0&&(oe==null?void 0:oe(i,l))!==!1&&(G==null||G(i,l)),w!==void 0&&b!==void 0&&(ce==null||ce(w,b))}Ce==null||Ce(V,Ie)},[Ce,o,i,l,w,b,U,$,me,k,E,M,G,ce,Pe,oe]),He=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(oe==null?void 0:oe(i,l))!==!1)return{src:i,dest:l}},[i,l,oe]),at=s.useCallback(V=>{const Ie=ve==null?void 0:ve.current;if(i!==void 0&&g!==void 0)Math.abs(V.clientX-g)>20&&u(!0);else if(w!==void 0&&R!==void 0)Math.abs(V.clientY-R)>20&&v(!0);else if(o!==void 0&&t!==void 0&&Ie){const Me=Ie.getBoundingClientRect().width/Ie.offsetWidth,ge=(V.clientX-t)/Me,_e=me[o],Ne=Qo(_e,ge,k,E);if(M==null||M(_e,Ne,o,Ne+(_e.growOffset??0)),st.current=ge,(U==null?void 0:U.first())===o)for(const Oe of U){if(Oe===o)continue;const ue=me[Oe],fe=Qo(ue,st.current,k,E);M==null||M(ue,fe,Oe,fe+(ue.growOffset??0))}}},[i,g,w,R,o,t,me,k,E,M,U,ve]),rt=s.useCallback((V,Ie)=>{if(w===void 0||b===void 0)return L(V,Ie);let[ke,Me]=V;return Me===b?Me=w:(Me>b&&(Me-=1),Me>=w&&(Me+=1)),L([ke,Me],Ie)},[w,b,L]),je=s.useCallback(V=>{K==null||K(V),V.defaultPrevented()||Pe()},[Pe,K]);return s.createElement(Lc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:rt,isResizing:o!==void 0,onHeaderMenuClick:tt,onHeaderIndicatorClick:Ct,isDragging:f,onItemHovered:re,onDragStart:je,onMouseDown:ze,allowResize:Q,onMouseUp:Ye,dragAndDropState:He,onMouseMoveRaw:at,ref:F})};function $c(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Nc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const f=()=>{var m,w;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((m=i.current)==null?void 0:m[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=m=>{m.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const m=c;return m.addEventListener("touchstart",u),m.addEventListener("touchend",g),()=>{m.removeEventListener("touchstart",u),m.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Oc=()=>e=>e.isSafari?"scroll":"auto",Xc=Jt("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Oc()]}}),Yc=33554400,Gc=5e6;function _c(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return _t("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),_t("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Kc=e=>{var Xe,U;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:g,rightElementProps:m,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,x=[],C=(m==null?void 0:m.sticky)??!1,v=(m==null?void 0:m.fill)??!1,R=s.useRef(0),X=s.useRef(0),N=s.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,L=s.useRef(A);s.useEffect(()=>{if(L.current!==A){R.current=0,X.current=0,L.current=A;const re=N.current;re!==null&&ce.current(re.scrollLeft,re.scrollTop)}},[A]);const G=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),M=s.useRef(null),W=_c(200),[$,F]=s.useState(!0),E=s.useRef(0);s.useLayoutEffect(()=>{if(!$||W||G.current.lockDirection===void 0)return;const re=N.current;if(re===null)return;const[de,ze]=G.current.lockDirection;de!==void 0?re.scrollLeft=de:ze!==void 0&&(re.scrollTop=ze),G.current.lockDirection=void 0},[W,$]);const k=s.useCallback((re,de)=>{var ke;const ze=N.current;if(ze===null)return;de=de??ze.scrollTop,re=re??ze.scrollLeft;const tt=G.current.scrollTop,Ct=G.current.scrollLeft,st=re-Ct,Pe=de-tt;W&&st!==0&&Pe!==0&&(Math.abs(st)>3||Math.abs(Pe)>3)&&c&&G.current.lockDirection===void 0&&(G.current.lockDirection=Math.abs(st)<Math.abs(Pe)?[Ct,void 0]:[void 0,tt]);const Ye=G.current.lockDirection;re=(Ye==null?void 0:Ye[0])??re,de=(Ye==null?void 0:Ye[1])??de,G.current.scrollLeft=re,G.current.scrollTop=de;const He=ze.clientWidth,at=ze.clientHeight,rt=de,je=X.current-rt,V=ze.scrollHeight-at;X.current=rt;let Ie;if(V>0&&o>ze.scrollHeight+5)if(Math.abs(je)>2e3||rt===0||rt===V){const Me=Math.max(0,Math.min(1,rt/V)),ge=o-at;Ie=Me*ge,R.current=Ie}else R.current-=je,Ie=R.current;else Ie=rt,R.current=Ie;Ie=Math.max(0,Math.min(Ie,o-at)),R.current=Ie,Ye!==void 0&&(window.clearTimeout(E.current),F(!1),E.current=window.setTimeout(()=>F(!0),200)),i({x:re,y:Ie,width:He-u,height:at-f,paddingRight:((ke=M.current)==null?void 0:ke.clientWidth)??0})},[f,u,o,i,c,W]);Nc(w&&Or.value,k,N);const ce=s.useRef(k);ce.current=k;const ne=s.useRef(),oe=s.useRef(!1);s.useLayoutEffect(()=>{oe.current?k():oe.current=!0},[k,f,u]);const Re=s.useCallback(re=>{N.current=re,h!==void 0&&(h.current=re)},[h]);let Ce=0,J=0;const K=Math.min(o,Yc);for(x.push(s.createElement("div",{key:Ce++,style:{width:r,height:0}}));J<K;){const re=Math.min(Gc,K-J);x.push(s.createElement("div",{key:Ce++,style:{width:0,height:re}})),J+=re}const{ref:ve,width:Q,height:me}=$c(b);return typeof window<"u"&&(((Xe=ne.current)==null?void 0:Xe.height)!==me||((U=ne.current)==null?void 0:U.width)!==Q)&&(window.setTimeout(()=>ce.current(),0),ne.current={width:Q,height:me}),(Q??0)===0||(me??0)===0?s.createElement("div",{ref:ve}):s.createElement("div",{ref:ve},s.createElement(Xc,{isSafari:Or.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:Re,style:ne.current,draggable:a,onDragStart:re=>{a||(re.stopPropagation(),re.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>k()},s.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),g!==void 0&&s.createElement(s.Fragment,null,!v&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:M,style:{height:me,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:v?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},g))))))},Uc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:g,onVisibleRegionChanged:m,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:x,overscrollX:C,overscrollY:v,initialSize:R,smoothScrollX:X=!1,smoothScrollY:N=!1,isDraggable:A}=e,{paddingRight:L,paddingBottom:G}=c??{},[M,W]=u,$=s.useRef(),F=s.useRef(),E=s.useRef(),k=s.useRef(),ce=f+Math.max(0,C??0);let ne=a?r+i:r;if(typeof o=="number")ne+=n*o;else for(let J=0;J<n;J++)ne+=o(J);v!==void 0&&(ne+=v);const oe=s.useRef(),Re=s.useCallback(()=>{var Ct,st;if(oe.current===void 0)return;const J={...oe.current};let K=0,ve=J.x<0?-J.x:0,Q=0,me=0;J.x=J.x<0?0:J.x;let Xe=0;for(let Pe=0;Pe<l;Pe++)Xe+=t[Pe].width;for(const Pe of t){const Ye=K-Xe;if(J.x>=Ye+Pe.width)K+=Pe.width,me++,Q++;else if(J.x>Ye)K+=Pe.width,X?ve+=Ye-J.x:me++,Q++;else if(J.x+J.width>Ye)K+=Pe.width,Q++;else break}let U=0,re=0,de=0;if(typeof o=="number")N?(re=Math.floor(J.y/o),U=re*o-J.y):re=Math.ceil(J.y/o),de=Math.ceil(J.height/o)+re,U<0&&de++;else{let Pe=0;for(let Ye=0;Ye<n;Ye++){const He=o(Ye),at=Pe+(N?0:He/2);if(J.y>=Pe+He)Pe+=He,re++,de++;else if(J.y>at)Pe+=He,N?U+=at-J.y:re++,de++;else if(J.y+J.height>He/2+Pe)Pe+=He,de++;else break}}re=Math.max(0,Math.min(re,n-1)),de=Math.max(re,Math.min(de,n));const ze={x:me,y:re,width:Q-me,height:de-re},tt=$.current;(tt===void 0||tt.y!==ze.y||tt.x!==ze.x||tt.height!==ze.height||tt.width!==ze.width||F.current!==ve||E.current!==U||J.width!==((Ct=k.current)==null?void 0:Ct[0])||J.height!==((st=k.current)==null?void 0:st[1]))&&(m==null||m({x:me,y:re,width:Q-me,height:de-re},J.width,J.height,J.paddingRight??0,ve,U),$.current=ze,F.current=ve,E.current=U,k.current=[J.width,J.height])},[t,o,n,m,l,X,N]),Ce=s.useCallback(J=>{oe.current=J,Re()},[Re]);return s.useEffect(()=>{Re()},[Re]),s.createElement(Kc,{scrollRef:w,className:g,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:A===!0||typeof A=="string",scrollWidth:ce+(L??0),scrollHeight:ne+(G??0),clientHeight:W,rightElement:b,paddingBottom:G,paddingRight:L,rightElementProps:x,update:Ce,initialSize:R},s.createElement(Wc,{eventTargetRef:w,width:M,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Vc=Jt("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),qc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),jc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Zc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Jc=10,Qc=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:g=!1,onSearchClose:m}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),x=a??h,C=s.useCallback(K=>{b(K),c==null||c(K)},[c]),[v,R]=s.useState(),X=s.useRef(v);X.current=v,s.useEffect(()=>{l!==void 0&&(l.length>0?R(K=>({rowsSearched:o,results:l.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):R(void 0))},[o,l]);const N=s.useRef();N.current===void 0&&(N.current=new AbortController);const A=s.useRef(),[L,G]=s.useState([]),M=l??L,W=s.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0,N.current.abort())},[]),$=s.useRef(n);$.current=n;const F=s.useCallback(K=>{const ve=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Q=$.current,me=Math.min(10,o),Xe=0;R(void 0),G([]);const U=[],re=async()=>{var rt;if(f===void 0)return;const de=performance.now(),ze=o-Xe;let tt=f({x:0,y:Q,width:r.length,height:Math.min(me,ze,o-Q)},N.current.signal);typeof tt=="function"&&(tt=await tt());let Ct=!1;for(const[je,V]of tt.entries())for(const[Ie,ke]of V.entries()){let Me;switch(ke.kind){case j.Text:case j.Number:Me=ke.displayData;break;case j.Uri:case j.Markdown:Me=ke.data;break;case j.Boolean:Me=typeof ke.data=="boolean"?ke.data.toString():void 0;break;case j.Image:case j.Bubble:Me=ke.data.join("🐳");break;case j.Custom:Me=ke.copyData;break}Me!==void 0&&ve.test(Me)&&(U.push([Ie,je+Q]),Ct=!0)}const st=performance.now();Ct&&G([...U]),Xe+=tt.length,jt(Xe<=o);const Pe=((rt=X.current)==null?void 0:rt.selectedIndex)??-1;R({results:U.length,rowsSearched:Xe,selectedIndex:Pe}),u==null||u(U,Pe),Q+me>=o?Q=0:Q+=me;const Ye=st-de,He=Math.max(Ye,1),at=Jc/He;me=Math.ceil(me*at),Xe<o&&U.length<1e3&&(A.current=window.requestAnimationFrame(re))};W(),A.current=window.requestAnimationFrame(re)},[W,r.length,f,u,o]),E=s.useCallback(()=>{var K;m==null||m(),R(void 0),G([]),u==null||u([],-1),W(),(K=t==null?void 0:t.current)==null||K.focus()},[W,t,m,u]),k=s.useCallback(K=>{C(K.target.value),l===void 0&&(K.target.value===""?(R(void 0),G([]),W()):F(K.target.value))},[F,W,C,l]);s.useEffect(()=>{g&&i.current!==null&&(C(""),i.current.focus({preventScroll:!0}))},[g,i,C]);const ce=s.useCallback(K=>{var Q;if((Q=K==null?void 0:K.stopPropagation)==null||Q.call(K),v===void 0)return;const ve=(v.selectedIndex+1)%v.results;R({...v,selectedIndex:ve}),u==null||u(M,ve)},[v,u,M]),ne=s.useCallback(K=>{var Q;if((Q=K==null?void 0:K.stopPropagation)==null||Q.call(K),v===void 0)return;let ve=(v.selectedIndex-1)%v.results;ve<0&&(ve+=v.results),R({...v,selectedIndex:ve}),u==null||u(M,ve)},[u,M,v]),oe=s.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(E(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?ne():ce())},[E,ce,ne]);s.useEffect(()=>()=>{W()},[W]);const[Re,Ce]=s.useState(!1);s.useEffect(()=>{if(g)Ce(!0);else{const K=setTimeout(()=>Ce(!1),150);return()=>clearTimeout(K)}},[g]);const J=s.useMemo(()=>{if(!g&&!Re)return null;let K;v!==void 0&&(K=v.results>=1e3?"over 1000":`${v.results} result${v.results!==1?"s":""}`,v.selectedIndex>=0&&(K=`${v.selectedIndex+1} of ${K}`));const ve=Xe=>{Xe.stopPropagation()},me={width:`${Math.floor(((v==null?void 0:v.rowsSearched)??0)/o*100)}%`};return s.createElement(Vc,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:ve,onMouseMove:ve,onMouseUp:ve,onClick:ve},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:k,value:x,tabIndex:g?void 0:-1,onKeyDownCapture:oe}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:ne,disabled:((v==null?void 0:v.results)??0)===0},qc),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:ce,disabled:((v==null?void 0:v.results)??0)===0},jc),m!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:E},Zc)),v!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},K)),s.createElement("div",{className:"gdg-search-progress",style:me})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[g,Re,v,o,w,i,k,x,oe,ne,ce,m,E]);return s.createElement(s.Fragment,null,s.createElement(Uc,{prelightCells:M,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),J)};class ed extends s.PureComponent{constructor(){super(...arguments);Ge(this,"wrapperRef",s.createRef());Ge(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const td=()=>e=>Math.max(16,e.targetHeight-10),nd=Jt("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[td(),"px"]}}),od=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=pt.useState(n);return pt.createElement(ed,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},pt.createElement(nd,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function rd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function We(e,t,n){const o=is(e,t);return o&&(n.didMatch=!0),o}function is(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(is(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!rd(l,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Xr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function id(e,t,n,o,r,i,a){const l=pt.useCallback((u,g,m,w)=>{var R;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(m||w==="drag"),b=o==="mixed"&&h,x=r==="mixed"&&h;let C={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((R=e.current)==null?void 0:R.rangeStack)??[]:[]},columns:b?e.columns:nt.empty(),rows:x?e.rows:nt.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,g)},[o,e,n,i,a,r,t]),c=pt.useCallback((u,g,m)=>{u=u??e.rows,g!==void 0&&(u=u.add(g));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:nt.empty(),rows:u};else{const h=m&&n==="mixed",b=m&&o==="mixed";w={current:h?e.current:void 0,columns:b?e.columns:nt.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=pt.useCallback((u,g,m)=>{u=u??e.columns,g!==void 0&&(u=u.add(g));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:nt.empty(),columns:u};else{const h=m&&n==="mixed",b=m&&r==="mixed";w={current:h?e.current:void 0,rows:b?e.rows:nt.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,c,f]}function ld(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let g=f.y;g<f.y+f.height;g++){const m=[];for(let w=f.x;w<f.x+f.width;w++)w<0||g>=r?m.push({kind:j.Loading,allowOverlay:!1}):m.push(t([w,g]));u.push(m)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const g=a(u,o.signal);return typeof g=="function"?async()=>(await g()).map(m=>[{kind:j.Loading,allowOverlay:!1},...m]):g.map(m=>[{kind:j.Loading,allowOverlay:!1},...m])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function sd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case j.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Si?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case j.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case j.Image:case j.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case j.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case j.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case j.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case j.Markdown:case j.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case j.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case j.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case j.Protected:return{formatted:"************",rawValue:"",format:"string"};default:rr()}}function ad(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:sd(a))})}function bl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function cd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>bl(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:bl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function gi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function yl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function dd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ud(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${gi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${yl(r.rawValue[l])}>`+gi(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${yl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${gi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function fd(e,t){const n=ad(e,t),o=cd(n),r=ud(n);return{textPlain:o,textHtml:r}}function pl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=c.querySelectorAll("br");for(const b of m)b.replaceWith(`
`);const w=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const b=c.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...b].map(x=>x.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:dd(w),formatted:c.textContent??"",format:h});else{let b=c.textContent??"";g&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function hd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const m=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m);const w=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const m=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}let u=c.x-n,g=c.x+c.width-1-n;for(const m of f)for(const w of m)w.span!==void 0&&(u=Math.min(w.span[0],u),g=Math.max(w.span[1],g));u===c.x-n&&g===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:g-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function vl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function gd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(vl(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(vl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Cl(e,t,n){var l;const o=fd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(c,f)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function ls(e){return e!==!0}function xl(e){return typeof e=="string"?e:`${e}px`}const md=()=>e=>e.innerWidth,wd=()=>e=>e.innerHeight,bd=Jt("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[md()],"wmyidgi-1":[wd()]}}),yd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(bd,{innerHeight:xl(n),innerWidth:xl(t),...r},o)},pd=2,vd=1300;function Cd(e,t,n){const o=pt.useRef(0),[r,i]=e??[0,0];pt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const c=f=>{var u;if(!a){if(l===0)l=f;else{const g=f-l;o.current=Math.min(1,o.current+g/vd);const m=o.current**1.618*g*pd;(u=t.current)==null||u.scrollBy(r*m,i*m),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function xd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[c,f,u,g,m,w]=pt.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,x=_l();return[typeof b=="number"?b*h:C=>Math.ceil(b(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,a,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:g,overscrollX:m,overscrollY:w}}const jn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function $e(e,t){return e===!0?t:e===!1?"":e}function kl(e){const t=Xr.value;return{activateCell:$e(e.activateCell," |Enter|shift+Enter"),clear:$e(e.clear,"any+Escape"),closeOverlay:$e(e.closeOverlay,"any+Escape"),acceptOverlayDown:$e(e.acceptOverlayDown,"Enter"),acceptOverlayUp:$e(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:$e(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:$e(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:$e(e.delete,t?"Backspace|Delete":"Delete"),downFill:$e(e.downFill,"primary+_68"),scrollToSelectedCell:$e(e.scrollToSelectedCell,"primary+Enter"),goDownCell:$e(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:$e(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:$e(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:$e(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:$e(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:$e(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:$e(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:$e(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:$e(e.goToFirstCell,"primary+Home"),goToFirstColumn:$e(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:$e(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:$e(e.goToLastCell,"primary+End"),goToLastColumn:$e(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:$e(e.goToLastRow,"primary+ArrowDown"),goToNextPage:$e(e.goToNextPage,"PageDown"),goToPreviousPage:$e(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:$e(e.rightFill,"primary+_82"),search:$e(e.search,"primary+f"),selectAll:$e(e.selectAll,"primary+a"),selectColumn:$e(e.selectColumn,"ctrl+ "),selectGrowDown:$e(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:$e(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:$e(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:$e(e.selectGrowUp,"shift+ArrowUp"),selectRow:$e(e.selectRow,"shift+ "),selectToFirstCell:$e(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:$e(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:$e(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:$e(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:$e(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:$e(e.selectToLastRow,"primary+shift+ArrowDown")}}function kd(e){const t=ca(e);return pt.useMemo(()=>{if(t===void 0)return kl(jn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??jn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??jn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??jn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??jn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??jn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??jn.selectToLastCell};return kl({...jn,...n})},[t])}function Sd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Ai(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let g=0;g<l.subGroups.length;g++){const m=g<l.subGroups.length-1?l.subGroups[g+1].headerIndex:c;o(l.subGroups[g],m,f||l.isCollapsed)}}const r=Sd(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function ki(e,t){if(t===void 0||Ai.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Md(e,t,n,o){const r=pt.useMemo(()=>e===void 0?void 0:Ai(e,t),[e,t]),i=pt.useMemo(()=>r==null?void 0:r.reduce((u,g)=>(u[g.rowIndex]=g,u),{}),[r]),a=pt.useMemo(()=>r===void 0?t:r.reduce((u,g)=>u+(g.isCollapsed?1:g.rows+1),0),[r,t]),l=pt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=pt.useCallback(u=>{if(r===void 0)return u;let g=u;for(const m of r){if(g===0)return;if(g--,!m.isCollapsed){if(g<m.rows)return m.contentIndex+g;g-=m.rows}}return u},[r]),f=Zn(o??(e==null?void 0:e.themeOverride),pt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:m,groupIndex:w}=ki(u,r);return g?e.themeOverride:o==null?void 0:o(u,w,m)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:a,rowNumberMapper:c,getRowThemeOverride:f}}function Rd(e,t){const n=pt.useMemo(()=>e===void 0?void 0:Ai(e,t),[e,t]);return{getRowGroupingForPath:as,updateRowGroupingByPath:ss,mapper:pt.useCallback(o=>{if(typeof o=="number")return ki(o,n);const r=ki(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function ss(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:ss(i.subGroups??[],r,n)}:i)}function as(e,t){const[n,...o]=t;return o[0]===-1?e[n]:as(e[n].subGroups??[],o)}function Ed(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Id(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[c,f,u]=aa(l),g=s.useRef(r);g.current=r;const m=Ed(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&m.current!==null&&w){if(m.current.scrollTop===t)return;m.current.scrollTop=t,m.current.scrollTop!==t&&u(),g.current()}},[t,w,u,m]);const h=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&m.current!==null&&h){if(m.current.scrollLeft===e)return;m.current.scrollLeft=e,m.current.scrollLeft!==e&&u(),g.current()}},[e,h,u,m]),{visibleRegion:c,setVisibleRegion:f,scrollRef:m}}const Dd=s.lazy(async()=>await El(()=>import("./data-grid-overlay-editor-CG3IiYp6.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));let Hd=0;function Fd(e){return js(Ji(Ji(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return fo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Pr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Br={kind:j.Loading,allowOverlay:!1},Lr={columns:nt.empty(),rows:nt.empty(),current:void 0},Td=(e,t)=>{var qi,ji,Zi;const[n,o]=s.useState(Lr),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[c,f]=s.useState(),u=s.useRef(),g=typeof window>"u"?null:window,{imageEditorOverride:m,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:x,columns:C,rows:v,getCellContent:R,onCellClicked:X,onCellActivated:N,onFillPattern:A,onFinishedEditing:L,coercePasteValue:G,drawHeader:M,drawCell:W,editorBloom:$,onHeaderClicked:F,onColumnProposeMove:E,rangeSelectionColumnSpanning:k=!0,spanRangeBehavior:ce="default",onGroupHeaderClicked:ne,onCellContextMenu:oe,className:Re,onHeaderContextMenu:Ce,getCellsForSelection:J,onGroupHeaderContextMenu:K,onGroupHeaderRenamed:ve,onCellEdited:Q,onCellsEdited:me,onSearchResultsChanged:Xe,searchResults:U,onSearchValueChange:re,searchValue:de,onKeyDown:ze,onKeyUp:tt,keybindings:Ct,editOnType:st=!0,onRowAppended:Pe,onColumnMoved:Ye,validateCell:He,highlightRegions:at,rangeSelect:rt="rect",columnSelect:je="multi",rowSelect:V="multi",rangeSelectionBlending:Ie="exclusive",columnSelectionBlending:ke="exclusive",rowSelectionBlending:Me="exclusive",onDelete:ge,onDragStart:_e,onMouseMove:Ne,onPaste:Oe,copyHeaders:ue=!1,freezeColumns:fe=0,cellActivationBehavior:Qe="second-click",rowSelectionMode:Ke="auto",onHeaderMenuClick:Ve,onHeaderIndicatorClick:ft,getGroupDetails:Ze,rowGrouping:De,onSearchClose:xt,onItemHovered:$t,onSelectionCleared:kt,showSearch:Dt,onVisibleRegionChanged:Wt,gridSelection:bt,onGridSelectionChange:bn,minColumnWidth:Ln=50,maxColumnWidth:ct=500,maxColumnAutoWidth:In,provideEditor:dn,trailingRowOptions:pe,freezeTrailingRows:yt=0,allowedFillDirections:yn="orthogonal",scrollOffsetX:Qt,scrollOffsetY:en,verticalBorder:Le,onDragOverCell:Ht,onDrop:ht,onColumnResize:Nt,onColumnResizeEnd:zt,onColumnResizeStart:Kt,customRenderers:Wn,fillHandle:St,experimental:vt,fixedShadowX:At,fixedShadowY:Pt,headerIcons:Dn,imageWindowLoader:ar,initialSize:$n,isDraggable:Hn,onDragLeave:Fn,onRowMoved:pn,overscrollX:cr,overscrollY:dr,preventDiagonalScrolling:wo,rightElement:bo,rightElementProps:yo,trapFocus:to=!1,smoothScrollX:no,smoothScrollY:Nn,scaleToRem:Kr=!1,rowHeight:ur=34,headerHeight:fr=36,groupHeaderHeight:Ur=fr,theme:oo,isOutsideClick:On,renderers:Lo,resizeIndicator:Vr,scrollToActiveCell:Wo=!0,drawFocusRing:$o=!0,portalElementRef:po}=e,qr=$o==="no-editor"?r===void 0:$o,it=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Yt=(it==null?void 0:it.kind)??e.rowMarkers??"none",hr=(it==null?void 0:it.width)??e.rowMarkerWidth,vo=(it==null?void 0:it.startIndex)??e.rowMarkerStartIndex??1,Tn=(it==null?void 0:it.theme)??e.rowMarkerTheme,An=it==null?void 0:it.headerTheme,Co=it==null?void 0:it.headerAlwaysVisible,zn=V!=="multi"||(it==null?void 0:it.headerDisabled)===!0,Xn=(it==null?void 0:it.checkboxStyle)??"square",Yn=Math.max(Ln,20),ro=Math.max(ct,Yn),jr=Math.max(In??ro,Yn),gr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Se,rowNumberMapper:No,rowHeight:mr,getRowThemeOverride:tn}=Md(De,v,ur,w),wr=s.useMemo(()=>Number.parseFloat(gr.fontSize),[gr]),{rowHeight:vn,headerHeight:Oo,groupHeaderHeight:br,theme:yr,overscrollX:Zr,overscrollY:Xo}=xd({groupHeaderHeight:Ur,headerHeight:fr,overscrollX:cr,overscrollY:dr,remSize:wr,rowHeight:mr,scaleToRem:Kr,theme:oo}),Cn=kd(Ct),Gn=hr??(v>1e4?48:v>1e3?44:v>100?36:32),nn=Yt!=="none",D=nn?1:0,gt=Pe!==void 0,xn=(pe==null?void 0:pe.sticky)===!0,[Yo,xo]=s.useState(!1),Jr=Dt??Yo,ko=s.useCallback(()=>{xt!==void 0?xt():xo(!1)},[xt]),z=s.useMemo(()=>bt===void 0?void 0:Pr(bt,D),[bt,D])??n,Ot=s.useRef();Ot.current===void 0&&(Ot.current=new AbortController),s.useEffect(()=>()=>Ot==null?void 0:Ot.current.abort(),[]);const[Bt,S]=ld(J,R,D,Ot.current,Se),_=s.useCallback((d,y,p)=>{if(He===void 0)return!0;const I=[d[0]-D,d[1]];return He==null?void 0:He(I,y,p)},[D,He]),le=s.useRef(bt),ee=s.useCallback((d,y)=>{y&&(d=hd(d,Bt,D,ce,Ot.current)),bn!==void 0?(le.current=Pr(d,-D),bn(le.current)):o(d)},[bn,Bt,D,ce]),q=Zn(Nt,s.useCallback((d,y,p,I)=>{Nt==null||Nt(C[p-D],y,p-D,I)},[Nt,D,C])),se=Zn(zt,s.useCallback((d,y,p,I)=>{zt==null||zt(C[p-D],y,p-D,I)},[zt,D,C])),Fe=Zn(Kt,s.useCallback((d,y,p,I)=>{Kt==null||Kt(C[p-D],y,p-D,I)},[Kt,D,C])),Te=Zn(M,s.useCallback((d,y)=>(M==null?void 0:M({...d,columnIndex:d.columnIndex-D},y))??!1,[M,D])),we=Zn(W,s.useCallback((d,y)=>(W==null?void 0:W({...d,col:d.col-D},y))??!1,[W,D])),lt=s.useCallback(d=>{if(ge!==void 0){const y=ge(Pr(d,-D));return typeof y=="boolean"?y:Pr(y,D)}return!0},[ge,D]),[ie,Ee,Ae]=id(z,ee,Ie,ke,Me,rt,k),Be=s.useMemo(()=>Bn(_l(),yr),[yr]),[ot,Mt]=s.useState([0,0,0]),Rt=s.useMemo(()=>{if(Lo===void 0)return{};const d={};for(const y of Lo)d[y.kind]=y;return d},[Lo]),mt=s.useCallback(d=>d.kind!==j.Custom?Rt[d.kind]:Wn==null?void 0:Wn.find(y=>y.isMatch(d)),[Wn,Rt]);let{sizedColumns:Et,nonGrowWidth:Ut}=za(C,Se,S,ot[0]-(D===0?0:Gn)-ot[2],Yn,jr,Be,mt,Ot.current);Yt!=="none"&&(Ut+=Gn);const on=s.useMemo(()=>Et.some(d=>d.group!==void 0),[Et]),et=on?Oo+br:Oo,un=z.rows.length,Vt=Yt==="none"?void 0:un===0?!1:un===Se?!0:void 0,qe=s.useMemo(()=>Yt==="none"?Et:[{title:"",width:Gn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Tn,rowMarker:Xn,rowMarkerChecked:Vt,headerRowMarkerTheme:An,headerRowMarkerAlwaysVisible:Co,headerRowMarkerDisabled:zn},...Et],[Yt,Et,Gn,Tn,Xn,Vt,An,Co,zn]),It=s.useRef({height:1,width:1,x:0,y:0}),_n=s.useRef(!1),{setVisibleRegion:Kn,visibleRegion:io,scrollRef:dt}=Id(Qt,en,vn,It,()=>_n.current=!0);It.current=io;const us=io.x+D,pr=io.y,Lt=s.useRef(null),Gt=s.useCallback(d=>{var y;d===!0?(y=Lt.current)==null||y.focus():window.requestAnimationFrame(()=>{var p;(p=Lt.current)==null||p.focus()})},[]),Xt=gt?Se+1:Se,rn=s.useCallback(d=>{const y=D===0?d:d.map(I=>({...I,location:[I.location[0]-D,I.location[1]]})),p=me==null?void 0:me(y);if(p!==!0)for(const I of y)Q==null||Q(I.location,I.value);return p},[Q,me,D]),[lo,Qr]=s.useState(),vr=z.current!==void 0&&z.current.range.width*z.current.range.height>1?z.current.range:void 0,So=qr?(qi=z.current)==null?void 0:qi.cell:void 0,Cr=So==null?void 0:So[0],xr=So==null?void 0:So[1],fs=s.useMemo(()=>{if((at===void 0||at.length===0)&&(vr??Cr??xr??lo)===void 0)return;const d=[];if(at!==void 0)for(const y of at){const p=qe.length-y.range.x-D;p>0&&d.push({color:y.color,range:{...y.range,x:y.range.x+D,width:Math.min(p,y.range.width)},style:y.style})}return lo!==void 0&&d.push({color:go(Be.accentColor,0),range:lo,style:"dashed"}),vr!==void 0&&d.push({color:go(Be.accentColor,.5),range:vr,style:"solid-outline"}),Cr!==void 0&&xr!==void 0&&d.push({color:Be.accentColor,range:{x:Cr,y:xr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[lo,vr,Cr,xr,at,qe.length,Be.accentColor,D]),Pi=s.useRef(qe);Pi.current=qe;const qt=s.useCallback(([d,y],p=!1)=>{var B,T,P,O,Y,Z,he;const I=gt&&y===Xt-1;if(d===0&&nn){if(I)return Br;const te=No(y);return te===void 0?Br:{kind:cn.Marker,allowOverlay:!1,checkboxStyle:Xn,checked:(z==null?void 0:z.rows.hasIndex(y))===!0,markerKind:Yt==="clickable-number"?"number":Yt,row:vo+te,drawHandle:pn!==void 0,cursor:Yt==="clickable-number"?"pointer":void 0}}else if(I){const ye=d===D?(pe==null?void 0:pe.hint)??"":"",ae=Pi.current[d];if(((B=ae==null?void 0:ae.trailingRowOptions)==null?void 0:B.disabled)===!0)return Br;{const Ue=((T=ae==null?void 0:ae.trailingRowOptions)==null?void 0:T.hint)??ye,xe=((P=ae==null?void 0:ae.trailingRowOptions)==null?void 0:P.addIcon)??(pe==null?void 0:pe.addIcon);return{kind:cn.NewRow,hint:Ue,allowOverlay:!1,icon:xe}}}else{const te=d-D;if(p||(vt==null?void 0:vt.strict)===!0){const ae=It.current,Ue=ae.x>te||te>ae.x+ae.width||ae.y>y||y>ae.y+ae.height||y>=ti.current,xe=te===((Y=(O=ae.extras)==null?void 0:O.selected)==null?void 0:Y[0])&&y===((Z=ae.extras)==null?void 0:Z.selected[1]);let be=!1;if(((he=ae.extras)==null?void 0:he.freezeRegions)!==void 0){for(const Je of ae.extras.freezeRegions)if(ho(Je,te,y)){be=!0;break}}if(Ue&&!xe&&!be)return Br}let ye=R([te,y]);return D!==0&&ye.span!==void 0&&(ye={...ye,span:[ye.span[0]+D,ye.span[1]+D]}),ye}},[gt,Xt,nn,No,Xn,z==null?void 0:z.rows,Yt,vo,pn,D,pe==null?void 0:pe.hint,pe==null?void 0:pe.addIcon,vt==null?void 0:vt.strict,R]),ei=s.useCallback(d=>{let y=(Ze==null?void 0:Ze(d))??{name:d};return ve!==void 0&&d!==""&&(y={icon:y.icon,name:y.name,overrideTheme:y.overrideTheme,actions:[...y.actions??[],{title:"Rename",icon:"renameIcon",onClick:p=>oi({group:y.name,bounds:p.bounds})}]}),y},[Ze,ve]),kr=s.useCallback(d=>{var P;const[y,p]=d.cell,I=qe[y],H=(I==null?void 0:I.group)!==void 0?(P=ei(I.group))==null?void 0:P.overrideTheme:void 0,B=I==null?void 0:I.themeOverride,T=tn==null?void 0:tn(p);i({...d,theme:Bn(Be,H,B,T,d.content.themeOverride)})},[tn,qe,ei,Be]),Mo=s.useCallback((d,y,p)=>{var T;if(z.current===void 0)return;const[I,H]=z.current.cell,B=qt([I,H]);if(B.kind!==j.Boolean&&B.allowOverlay){let P=B;if(p!==void 0)switch(P.kind){case j.Number:{const O=Js(()=>p==="-"?-0:Number.parseFloat(p),0);P={...P,data:Number.isNaN(O)?0:O};break}case j.Text:case j.Markdown:case j.Uri:P={...P,data:p};break}kr({target:d,content:P,initialValue:p,cell:[I,H],highlight:p===void 0,forceEditMode:p!==void 0})}else B.kind===j.Boolean&&y&&B.readonly!==!0&&(rn([{location:z.current.cell,value:{...B,data:ls(B.data)}}]),(T=Lt.current)==null||T.damage([{cell:z.current.cell}]))},[qt,z,rn,kr]),Bi=s.useCallback((d,y)=>{var H;const p=(H=Lt.current)==null?void 0:H.getBounds(d,y);if(p===void 0||dt.current===null)return;const I=qt([d,y]);I.allowOverlay&&kr({target:p,content:I,initialValue:void 0,highlight:!0,cell:[d,y],forceEditMode:!0})},[qt,dt,kr]),Ft=s.useCallback((d,y,p="both",I=0,H=0,B=void 0)=>{if(dt.current!==null){const T=Lt.current,P=l.current,O=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,Z=typeof d!="number"&&d.unit==="px"?d.amount:void 0,he=typeof y!="number"&&y.unit==="px"?y.amount:void 0;if(T!==null&&P!==null){let te={x:0,y:0,width:0,height:0},ye=0,ae=0;if((O!==void 0||Y!==void 0)&&(te=T.getBounds((O??0)+D,Y??0)??te,te.width===0||te.height===0))return;const Ue=P.getBoundingClientRect(),xe=Ue.width/P.offsetWidth;if(Z!==void 0&&(te={...te,x:Z-Ue.left-dt.current.scrollLeft,width:1}),he!==void 0&&(te={...te,y:he+Ue.top-dt.current.scrollTop,height:1}),te!==void 0){const be={x:te.x-I,y:te.y-H,width:te.width+2*I,height:te.height+2*H};let Je=0;for(let di=0;di<fe;di++)Je+=Et[di].width;let wt=0;const Tt=yt+(xn?1:0);Tt>0&&(wt=mo(Xt,Tt,vn));let gn=Je*xe+Ue.left+D*Gn*xe,Sn=Ue.right,mn=Ue.top+et*xe,Mn=Ue.bottom-wt*xe;const Hr=te.width+I*2;switch(B==null?void 0:B.hAlign){case"start":Sn=gn+Hr;break;case"end":gn=Sn-Hr;break;case"center":gn=Math.floor((gn+Sn)/2)-Hr/2,Sn=gn+Hr;break}const Fr=te.height+H*2;switch(B==null?void 0:B.vAlign){case"start":Mn=mn+Fr;break;case"end":mn=Mn-Fr;break;case"center":mn=Math.floor((mn+Mn)/2)-Fr/2,Mn=mn+Fr;break}gn>be.x?ye=be.x-gn:Sn<be.x+be.width&&(ye=be.x+be.width-Sn),mn>be.y?ae=be.y-mn:Mn<be.y+be.height&&(ae=be.y+be.height-Mn),p==="vertical"||typeof d=="number"&&d<fe?ye=0:(p==="horizontal"||typeof y=="number"&&y>=Xt-Tt)&&(ae=0),(ye!==0||ae!==0)&&(xe!==1&&(ye/=xe,ae/=xe),dt.current.scrollTo({left:ye+dt.current.scrollLeft,top:ae+dt.current.scrollTop,behavior:(B==null?void 0:B.behavior)??"auto"}))}}}},[D,yt,Gn,dt,et,fe,Et,Xt,xn,vn]),Li=s.useRef(Bi),Wi=s.useRef(R),ti=s.useRef(Se);Li.current=Bi,Wi.current=R,ti.current=Se;const Ro=s.useCallback(async(d,y=!0,p)=>{var Y;const I=qe[d];if(((Y=I==null?void 0:I.trailingRowOptions)==null?void 0:Y.disabled)===!0)return;const H=Pe==null?void 0:Pe();let B,T=!0;H!==void 0&&(B=await H,B==="top"&&(T=!1),typeof B=="number"&&(T=!1));let P=0;const O=()=>{if(ti.current<=Se){P<500&&window.setTimeout(O,P),P=50+P*2;return}const Z=typeof B=="number"?B:T?Se:0;Dr.current(d-D,Z,"both",0,0,p?{behavior:p}:void 0),ie({cell:[d,Z],range:{x:d,y:Z,width:1,height:1}},!1,!1,"edit");const he=Wi.current([d-D,Z]);he.allowOverlay&&er(he)&&he.readonly!==!0&&y&&window.setTimeout(()=>{Li.current(d,Z)},0)};O()},[qe,Pe,D,Se,ie]),Sr=s.useCallback(d=>{var p,I;const y=((I=(p=Et[d])==null?void 0:p.trailingRowOptions)==null?void 0:I.targetColumn)??(pe==null?void 0:pe.targetColumn);if(typeof y=="number")return y+(nn?1:0);if(typeof y=="object"){const H=C.indexOf(y);if(H>=0)return H+(nn?1:0)}},[Et,C,nn,pe==null?void 0:pe.targetColumn]),Un=s.useRef(),Eo=s.useRef(),Go=s.useCallback((d,y)=>{var H;const[p,I]=y;return Bn(Be,(H=qe[p])==null?void 0:H.themeOverride,tn==null?void 0:tn(I),d.themeOverride)},[tn,qe,Be]),{mapper:so}=Rd(De,v),fn=De==null?void 0:De.navigationBehavior,_o=s.useCallback(d=>{var Z,he,te;const y=Xr.value?d.metaKey:d.ctrlKey,p=y&&V==="multi",I=y&&je==="multi",[H,B]=d.location,T=z.columns,P=z.rows,[O,Y]=((Z=z.current)==null?void 0:Z.cell)??[];if(d.kind==="cell"){if(Eo.current=void 0,ao.current=[H,B],H===0&&nn){if(gt===!0&&B===Se||Yt==="number"||V==="none")return;const ye=qt(d.location);if(ye.kind!==cn.Marker)return;if(pn!==void 0){const xe=mt(ye);jt((xe==null?void 0:xe.kind)===cn.Marker);const be=(he=xe==null?void 0:xe.onClick)==null?void 0:he.call(xe,{...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Go(ye,d.location),preventDefault:()=>{}});if(be===void 0||be.checked===ye.checked)return}i(void 0),Gt();const ae=P.hasIndex(B),Ue=Un.current;if(V==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&Ue!==void 0&&P.hasIndex(Ue)){const xe=[Math.min(Ue,B),Math.max(Ue,B)+1];p||Ke==="multi"?Ee(void 0,xe,!0):Ee(nt.fromSingleSelection(xe),void 0,p)}else V==="multi"&&(p||d.isTouch||Ke==="multi")?ae?Ee(P.remove(B),void 0,!0):(Ee(void 0,B,!0),Un.current=B):ae&&P.length===1?Ee(nt.empty(),void 0,y):(Ee(nt.fromSingleSelection(B),void 0,y),Un.current=B)}else if(H>=D&&gt&&B===Se){const ye=Sr(H);Ro(ye??H)}else if(O!==H||Y!==B){const ye=qt(d.location),ae=mt(ye);if((ae==null?void 0:ae.onSelect)!==void 0){let be=!1;if(ae.onSelect({...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>be=!0,theme:Go(ye,d.location)}),be)return}if(fn==="block"&&so(B).isGroupHeader)return;const Ue=xn&&B===Se,xe=xn&&z!==void 0&&((te=z.current)==null?void 0:te.cell[1])===Se;if((d.shiftKey||d.isLongTouch===!0)&&O!==void 0&&Y!==void 0&&z.current!==void 0&&!xe){if(Ue)return;const be=Math.min(H,O),Je=Math.max(H,O),wt=Math.min(B,Y),Tt=Math.max(B,Y);ie({...z.current,range:{x:be,y:wt,width:Je-be+1,height:Tt-wt+1}},!0,y,"click"),Un.current=void 0,Gt()}else ie({cell:[H,B],range:{x:H,y:B,width:1,height:1}},!0,y,"click"),Un.current=void 0,i(void 0),Gt()}}else if(d.kind==="header")if(ao.current=[H,B],i(void 0),nn&&H===0)Un.current=void 0,Eo.current=void 0,!zn&&V==="multi"&&(P.length!==Se?Ee(nt.fromSingleSelection([0,Se]),void 0,y):Ee(nt.empty(),void 0,y),Gt());else{const ye=Eo.current;if(je==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&ye!==void 0&&T.hasIndex(ye)){const ae=[Math.min(ye,H),Math.max(ye,H)+1];I?Ae(void 0,ae,y):Ae(nt.fromSingleSelection(ae),void 0,y)}else I?(T.hasIndex(H)?Ae(T.remove(H),void 0,y):Ae(void 0,H,y),Eo.current=H):je!=="none"&&(T.hasIndex(H)?Ae(T.remove(H),void 0,y):Ae(nt.fromSingleSelection(H),void 0,y),Eo.current=H);Un.current=void 0,Gt()}else d.kind===an?ao.current=[H,B]:d.kind===Yr&&!d.isMaybeScrollbar&&(ee(Lr,!1),i(void 0),Gt(),kt==null||kt(),Un.current=void 0,Eo.current=void 0)},[V,je,z,nn,D,gt,Se,Yt,qt,pn,Gt,Ke,mt,Go,Ee,Sr,Ro,fn,so,xn,ie,Ae,ee,kt]),Ko=s.useRef(!1),ao=s.useRef(),$i=s.useRef(io),ln=s.useRef(),hs=s.useCallback(d=>{if(Io.current=!1,$i.current=It.current,d.button!==0&&d.button!==1){ln.current=void 0;return}const y=performance.now();ln.current={button:d.button,time:y,location:d.location},(d==null?void 0:d.kind)==="header"&&(Ko.current=!0);const p=d.kind==="cell"&&d.isFillHandle;!p&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:z,fillHandle:p}),ao.current=void 0,!d.isTouch&&d.button===0&&!p?_o(d):!d.isTouch&&d.button===1&&(ao.current=d.location))},[z,_o]),[ni,oi]=s.useState(),Ni=s.useCallback(d=>{if(d.kind!==an||je!=="multi")return;const y=Xr.value?d.metaKey:d.ctrlKey,[p]=d.location,I=z.columns;if(p<D)return;const H=qe[p];let B=p,T=p;for(let P=p-1;P>=D&&ir(H.group,qe[P].group);P--)B--;for(let P=p+1;P<qe.length&&ir(H.group,qe[P].group);P++)T++;if(Gt(),y)if(I.hasAll([B,T+1])){let P=I;for(let O=B;O<=T;O++)P=P.remove(O);Ae(P,void 0,y)}else Ae(void 0,[B,T+1],y);else Ae(nt.fromSingleSelection([B,T+1]),void 0,y)},[je,Gt,z.columns,qe,D,Ae]),Io=s.useRef(!1),Mr=s.useCallback(async d=>{if(Bt!==void 0&&q!==void 0){const y=It.current.y,p=It.current.height;let I=Bt({x:d,y,width:1,height:Math.min(p,Se-y)},Ot.current.signal);typeof I!="object"&&(I=await I());const H=Et[d-D],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=Be.baseFontFull;const P=Ul(T,Be,H,0,I,Yn,ro,!1,mt);q==null||q(H,P.width,d,P.width)}}},[Et,Bt,ro,Be,Yn,q,D,Se,mt]),[gs,ri]=s.useState(),Do=s.useCallback(async(d,y)=>{var P,O;const p=(P=d.current)==null?void 0:P.range;if(p===void 0||Bt===void 0||y.current===void 0)return;const I=y.current.range;if(A!==void 0){let Y=!1;if(A({fillDestination:{...I,x:I.x-D},patternSource:{...p,x:p.x-D},preventDefault:()=>Y=!0}),Y)return}let H=Bt(p,Ot.current.signal);typeof H!="object"&&(H=await H());const B=H,T=[];for(let Y=0;Y<I.width;Y++)for(let Z=0;Z<I.height;Z++){const he=[I.x+Y,I.y+Z];if(Pl(he,p))continue;const te=B[Z%p.height][Y%p.width];Fo(te)||!er(te)||T.push({location:he,value:{...te}})}rn(T),(O=Lt.current)==null||O.damage(T.map(Y=>({cell:Y.location})))},[Bt,rn,A,D]),Oi=s.useCallback(()=>{if(z.current===void 0||z.current.range.width<=1)return;const d={...z,current:{...z.current,range:{...z.current.range,width:1}}};Do(d,z)},[Do,z]),Xi=s.useCallback(()=>{if(z.current===void 0||z.current.range.height<=1)return;const d={...z,current:{...z.current,range:{...z.current.range,height:1}}};Do(d,z)},[Do,z]),ms=s.useCallback((d,y)=>{var Z,he;const p=c;if(f(void 0),Qr(void 0),ri(void 0),Ko.current=!1,y)return;if((p==null?void 0:p.fillHandle)===!0&&z.current!==void 0&&((Z=p.previousSelection)==null?void 0:Z.current)!==void 0){if(lo===void 0)return;const te={...z,current:{...z.current,range:Jl(p.previousSelection.current.range,lo)}};Do(p.previousSelection,te),ee(te,!0);return}const[I,H]=d.location,[B,T]=ao.current??[],P=()=>{Io.current=!0},O=te=>{var ae,Ue,xe;const ye=te.isTouch||B===I&&T===H;if(ye&&(X==null||X([I-D,H],{...te,preventDefault:P})),te.button===1)return!Io.current;if(!Io.current){const be=qt(d.location),Je=mt(be);if(Je!==void 0&&Je.onClick!==void 0&&ye){const Tt=Je.onClick({...te,cell:be,posX:te.localEventX,posY:te.localEventY,bounds:te.bounds,theme:Go(be,d.location),preventDefault:P});Tt!==void 0&&!Fo(Tt)&&Ho(Tt)&&(rn([{location:te.location,value:Tt}]),(ae=Lt.current)==null||ae.damage([{cell:te.location}]))}if(Io.current||z.current===void 0)return!1;let wt=!1;switch(be.activationBehaviorOverride??Qe){case"double-click":case"second-click":{if(((xe=(Ue=p==null?void 0:p.previousSelection)==null?void 0:Ue.current)==null?void 0:xe.cell)===void 0)break;const[Tt,gn]=z.current.cell,[Sn,mn]=p.previousSelection.current.cell;wt=I===Tt&&I===Sn&&H===gn&&H===mn&&(te.isDoubleClick===!0||Qe==="second-click");break}case"single-click":{wt=!0;break}}if(wt)return N==null||N([I-D,H]),Mo(te.bounds,!1),!0}return!1},Y=d.location[0]-D;if(d.isTouch){const te=It.current,ye=$i.current;if(te.x!==ye.x||te.y!==ye.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&tr((he=z.current)==null?void 0:he.cell,d.location)){oe==null||oe([Y,d.location[1]],{...d,preventDefault:P});return}else if(d.kind==="header"&&z.columns.hasIndex(I)){Ce==null||Ce(Y,{...d,preventDefault:P});return}else if(d.kind===an){if(Y<0)return;K==null||K(Y,{...d,preventDefault:P});return}}d.kind==="cell"?O(d)||_o(d):d.kind===an?ne==null||ne(Y,{...d,preventDefault:P}):(d.kind===Jn&&(F==null||F(Y,{...d,preventDefault:P})),_o(d));return}if(d.kind==="header"){if(Y<0)return;d.isEdge?d.isDoubleClick===!0&&Mr(I):d.button===0&&I===B&&H===T&&(F==null||F(Y,{...d,preventDefault:P}))}if(d.kind===an){if(Y<0)return;d.button===0&&I===B&&H===T&&(ne==null||ne(Y,{...d,preventDefault:P}),Io.current||Ni(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&O(d),ao.current=void 0},[c,z,D,lo,Do,ee,X,qt,mt,Qe,Go,rn,N,Mo,oe,Ce,K,_o,ne,F,Mr,Ni]),ws=s.useCallback(d=>{const y={...d,location:[d.location[0]-D,d.location[1]]};Ne==null||Ne(y),c!==void 0&&d.buttons===0&&(f(void 0),Qr(void 0),ri(void 0),Ko.current=!1),ri(p=>{var I;return Ko.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(p==null?void 0:p[0])&&d.scrollEdge[1]===p[1]?p:c===void 0||(((I=ln.current)==null?void 0:I.location[0])??0)<D?void 0:d.scrollEdge})},[c,Ne,D]),bs=s.useCallback((d,y)=>{Ve==null||Ve(d-D,y)},[Ve,D]),ys=s.useCallback((d,y)=>{ft==null||ft(d-D,y)},[ft,D]),kn=(ji=z==null?void 0:z.current)==null?void 0:ji.cell,ps=s.useCallback((d,y,p,I,H,B)=>{_n.current=!1;let T=kn;T!==void 0&&(T=[T[0]-D,T[1]]);const P=fe===0?void 0:{x:0,y:d.y,width:fe,height:d.height},O=[];P!==void 0&&O.push(P),yt>0&&(O.push({x:d.x-D,y:Se-yt,width:d.width,height:yt}),fe>0&&O.push({x:0,y:Se-yt,width:fe,height:yt}));const Y={x:d.x-D,y:d.y,width:d.width,height:gt&&d.y+d.height>=Se?d.height-1:d.height,tx:H,ty:B,extras:{selected:T,freezeRegion:P,freezeRegions:O}};It.current=Y,Kn(Y),Mt([y,p,I]),Wt==null||Wt(Y,Y.tx,Y.ty,Y.extras)},[kn,D,gt,Se,fe,yt,Kn,Wt]),vs=Zn(E,s.useCallback((d,y)=>(E==null?void 0:E(d-D,y-D))!==!1,[E,D])),Cs=Zn(Ye,s.useCallback((d,y)=>{Ye==null||Ye(d-D,y-D),je!=="none"&&Ae(nt.fromSingleSelection(y),void 0,!0)},[je,Ye,D,Ae])),ii=s.useRef(!1),xs=s.useCallback(d=>{if(d.location[0]===0&&D>0){d.preventDefault();return}_e==null||_e({...d,location:[d.location[0]-D,d.location[1]]}),d.defaultPrevented()||(ii.current=!0),f(void 0)},[_e,D]),ks=s.useCallback(()=>{ii.current=!1},[]),Yi=De==null?void 0:De.selectionBehavior,Rr=s.useCallback(d=>{if(Yi!=="block-spanning")return;const{isGroupHeader:y,path:p,groupRows:I}=so(d);if(y)return[d,d];const H=p[p.length-1],B=d-H,T=d+I-H-1;return[B,T]},[so,Yi]),li=s.useRef(),si=s.useCallback(d=>{var y,p,I;if(!rs(d,li.current)&&(li.current=d,!(((y=ln==null?void 0:ln.current)==null?void 0:y.button)!==void 0&&ln.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((p=ln.current)==null?void 0:p.location[0])===0&&d.location[0]===0&&D===1&&V==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(ln.current.location[1])&&z.rows.hasIndex(ln.current.location[1])){const H=Math.min(ln.current.location[1],d.location[1]),B=Math.max(ln.current.location[1],d.location[1])+1;Ee(nt.fromSingleSelection([H,B]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&z.current!==void 0&&!ii.current&&!Ko.current&&(rt==="rect"||rt==="multi-rect")){const[H,B]=z.current.cell;let[T,P]=d.location;if(P<0&&(P=It.current.y),c.fillHandle===!0&&((I=c.previousSelection)==null?void 0:I.current)!==void 0){const O=c.previousSelection.current.range;P=Math.min(P,gt?Se-1:Se);const Y=fc(O,T,P,yn);Qr(Y)}else{if(gt&&B===Se)return;if(gt&&P===Se)if(d.kind===Yr)P--;else return;T=Math.max(T,D);const Z=Rr(B);P=Z===void 0?P:sn(P,Z[0],Z[1]);const he=T-H,te=P-B,ye={x:he>=0?H:T,y:te>=0?B:P,width:Math.abs(he)+1,height:Math.abs(te)+1};ie({...z.current,range:ye},!0,!1,"drag")}}$t==null||$t({...d,location:[d.location[0]-D,d.location[1]]})}},[c,D,V,z,rt,$t,Ee,gt,Se,yn,Rr,ie]),Ss=s.useCallback(()=>{var T,P;const d=li.current;if(d===void 0)return;const[y,p]=d.scrollEdge;let[I,H]=d.location;const B=It.current;y===-1?I=((P=(T=B.extras)==null?void 0:T.freezeRegion)==null?void 0:P.x)??B.x:y===1&&(I=B.x+B.width),p===-1?H=Math.max(0,B.y):p===1&&(H=Math.min(Se-1,B.y+B.height)),I=sn(I,0,qe.length-1),H=sn(H,0,Se-1),si({...d,location:[I,H]})},[qe.length,si,Se]);Cd(gs,dt,Ss);const hn=s.useCallback(d=>{if(z.current===void 0)return;const[y,p]=d,[I,H]=z.current.cell,B=z.current.range;let T=B.x,P=B.x+B.width,O=B.y,Y=B.y+B.height;const[Z,he]=Rr(H)??[0,Se-1],te=he+1;if(p!==0)switch(p){case 2:{Y=te,O=H,Ft(0,Y,"vertical");break}case-2:{O=Z,Y=H+1,Ft(0,O,"vertical");break}case 1:{O<H?(O++,Ft(0,O,"vertical")):(Y=Math.min(te,Y+1),Ft(0,Y,"vertical"));break}case-1:{Y>H+1?(Y--,Ft(0,Y,"vertical")):(O=Math.max(Z,O-1),Ft(0,O,"vertical"));break}default:rr()}if(y!==0)if(y===2)P=qe.length,T=I,Ft(P-1-D,0,"horizontal");else if(y===-2)T=D,P=I+1,Ft(T-D,0,"horizontal");else{let ye=[];if(Bt!==void 0){const ae=Bt({x:T,y:O,width:P-T-D,height:Y-O},Ot.current.signal);typeof ae=="object"&&(ye=Fd(ae))}if(y===1){let ae=!1;if(T<I){if(ye.length>0){const Ue=fo(T+1,I+1).find(xe=>!ye.includes(xe-D));Ue!==void 0&&(T=Ue,ae=!0)}else T++,ae=!0;ae&&Ft(T,0,"horizontal")}ae||(P=Math.min(qe.length,P+1),Ft(P-1-D,0,"horizontal"))}else if(y===-1){let ae=!1;if(P>I+1){if(ye.length>0){const Ue=fo(P-1,I,-1).find(xe=>!ye.includes(xe-D));Ue!==void 0&&(P=Ue,ae=!0)}else P--,ae=!0;ae&&Ft(P-D,0,"horizontal")}ae||(T=Math.max(D,T-1),Ft(T-D,0,"horizontal"))}else rr()}ie({cell:z.current.cell,range:{x:T,y:O,width:P-T,height:Y-O}},!0,!1,"keyboard-select")},[Bt,Rr,z,qe.length,D,Se,Ft,ie]),ai=s.useRef(Wo);ai.current=Wo;const Vn=s.useCallback((d,y,p,I)=>{const H=Xt-(p?0:1);d=sn(d,D,Et.length-1+D),y=sn(y,0,H);const B=kn==null?void 0:kn[0],T=kn==null?void 0:kn[1];if(d===B&&y===T)return!1;if(I&&z.current!==void 0){const P=[...z.current.rangeStack];(z.current.range.width>1||z.current.range.height>1)&&P.push(z.current.range),ee({...z,current:{cell:[d,y],range:{x:d,y,width:1,height:1},rangeStack:P}},!0)}else ie({cell:[d,y],range:{x:d,y,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===y&&(u.current=void 0),ai.current&&Ft(d-D,y),!0},[Xt,D,Et.length,kn,z,Ft,ee,ie]),Ms=s.useCallback((d,y)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&Ho(d)&&(rn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var H;(H=Lt.current)==null||H.damage([{cell:r.cell}])})),Gt(!0),i(void 0);const[p,I]=y;if(z.current!==void 0&&(p!==0||I!==0)){const H=z.current.cell[1]===Xt-1&&d!==void 0;Vn(sn(z.current.cell[0]+p,0,qe.length-1),sn(z.current.cell[1]+I,0,Xt-1),H,!1)}L==null||L(d,y)},[r==null?void 0:r.cell,Gt,z,L,rn,Xt,Vn,qe.length]),Rs=s.useMemo(()=>`gdg-overlay-${Hd++}`,[]),co=s.useCallback(d=>{var p,I,H,B;Gt();const y=[];for(let T=d.x;T<d.x+d.width;T++)for(let P=d.y;P<d.y+d.height;P++){const O=R([T-D,P]);if(!O.allowOverlay&&O.kind!==j.Boolean)continue;let Y;if(O.kind===j.Custom){const Z=mt(O),he=(p=Z==null?void 0:Z.provideEditor)==null?void 0:p.call(Z,{...O,location:[T-D,P]});(Z==null?void 0:Z.onDelete)!==void 0?Y=Z.onDelete(O):Qs(he)&&(Y=(I=he==null?void 0:he.deletedValue)==null?void 0:I.call(he,O))}else if(Ho(O)&&O.allowOverlay||O.kind===j.Boolean){const Z=mt(O);Y=(H=Z==null?void 0:Z.onDelete)==null?void 0:H.call(Z,O)}Y!==void 0&&!Fo(Y)&&Ho(Y)&&y.push({location:[T,P],value:Y})}rn(y),(B=Lt.current)==null||B.damage(y.map(T=>({cell:T.location})))},[Gt,R,mt,rn,D]),Uo=r!==void 0,Gi=s.useCallback(d=>{var Ue,xe;const y=()=>{d.stopPropagation(),d.preventDefault()},p={didMatch:!1},{bounds:I}=d,H=z.columns,B=z.rows,T=Cn;if(!Uo&&We(T.clear,d,p))ee(Lr,!1),kt==null||kt();else if(!Uo&&We(T.selectAll,d,p))ee({columns:nt.empty(),rows:nt.empty(),current:{cell:((Ue=z.current)==null?void 0:Ue.cell)??[D,0],range:{x:D,y:0,width:C.length,height:Se},rangeStack:[]}},!1);else if(We(T.search,d,p))(xe=a==null?void 0:a.current)==null||xe.focus({preventScroll:!0}),xo(!0);else if(We(T.delete,d,p)){const be=(lt==null?void 0:lt(z))??!0;if(be!==!1){const Je=be===!0?z:be;if(Je.current!==void 0){co(Je.current.range);for(const wt of Je.current.rangeStack)co(wt)}for(const wt of Je.rows)co({x:D,y:wt,width:C.length,height:1});for(const wt of Je.columns)co({x:wt,y:0,width:1,height:Se})}}if(p.didMatch)return y(),!0;if(z.current===void 0)return!1;let[P,O]=z.current.cell;const[,Y]=z.current.cell;let Z=!1,he=!1;if(We(T.scrollToSelectedCell,d,p)?Dr.current(P-D,O):je!=="none"&&We(T.selectColumn,d,p)?H.hasIndex(P)?Ae(H.remove(P),void 0,!0):je==="single"?Ae(nt.fromSingleSelection(P),void 0,!0):Ae(void 0,P,!0):V!=="none"&&We(T.selectRow,d,p)?B.hasIndex(O)?Ee(B.remove(O),void 0,!0):V==="single"?Ee(nt.fromSingleSelection(O),void 0,!0):Ee(void 0,O,!0):!Uo&&I!==void 0&&We(T.activateCell,d,p)?O===Se&&gt?window.setTimeout(()=>{const be=Sr(P);Ro(be??P)},0):(N==null||N([P-D,O]),Mo(I,!0)):z.current.range.height>1&&We(T.downFill,d,p)?Xi():z.current.range.width>1&&We(T.rightFill,d,p)?Oi():We(T.goToNextPage,d,p)?O+=Math.max(1,It.current.height-4):We(T.goToPreviousPage,d,p)?O-=Math.max(1,It.current.height-4):We(T.goToFirstCell,d,p)?(i(void 0),O=0,P=0):We(T.goToLastCell,d,p)?(i(void 0),O=Number.MAX_SAFE_INTEGER,P=Number.MAX_SAFE_INTEGER):We(T.selectToFirstCell,d,p)?(i(void 0),hn([-2,-2])):We(T.selectToLastCell,d,p)?(i(void 0),hn([2,2])):Uo?(We(T.closeOverlay,d,p)&&i(void 0),We(T.acceptOverlayDown,d,p)&&(i(void 0),O++),We(T.acceptOverlayUp,d,p)&&(i(void 0),O--),We(T.acceptOverlayLeft,d,p)&&(i(void 0),P--),We(T.acceptOverlayRight,d,p)&&(i(void 0),P++)):(We(T.goDownCell,d,p)?O+=1:We(T.goUpCell,d,p)?O-=1:We(T.goRightCell,d,p)?P+=1:We(T.goLeftCell,d,p)?P-=1:We(T.goDownCellRetainSelection,d,p)?(O+=1,Z=!0):We(T.goUpCellRetainSelection,d,p)?(O-=1,Z=!0):We(T.goRightCellRetainSelection,d,p)?(P+=1,Z=!0):We(T.goLeftCellRetainSelection,d,p)?(P-=1,Z=!0):We(T.goToLastRow,d,p)?O=Se-1:We(T.goToFirstRow,d,p)?O=Number.MIN_SAFE_INTEGER:We(T.goToLastColumn,d,p)?P=Number.MAX_SAFE_INTEGER:We(T.goToFirstColumn,d,p)?P=Number.MIN_SAFE_INTEGER:(rt==="rect"||rt==="multi-rect")&&(We(T.selectGrowDown,d,p)?hn([0,1]):We(T.selectGrowUp,d,p)?hn([0,-1]):We(T.selectGrowRight,d,p)?hn([1,0]):We(T.selectGrowLeft,d,p)?hn([-1,0]):We(T.selectToLastRow,d,p)?hn([0,2]):We(T.selectToFirstRow,d,p)?hn([0,-2]):We(T.selectToLastColumn,d,p)?hn([2,0]):We(T.selectToFirstColumn,d,p)&&hn([-2,0])),he=p.didMatch),fn!==void 0&&fn!=="normal"&&O!==Y){const be=fn==="skip-up"||fn==="skip"||fn==="block",Je=fn==="skip-down"||fn==="skip"||fn==="block",wt=O<Y;if(wt&&be){for(;O>=0&&so(O).isGroupHeader;)O--;O<0&&(O=Y)}else if(!wt&&Je){for(;O<Se&&so(O).isGroupHeader;)O++;O>=Se&&(O=Y)}}const ye=Vn(P,O,!1,Z),ae=p.didMatch;return ae&&(ye||!he||to)&&y(),ae},[fn,Uo,z,Cn,je,V,rt,D,so,Se,Vn,ee,kt,C.length,lt,to,co,Ae,Ee,gt,Sr,Ro,N,Mo,Xi,Oi,hn]),Vo=s.useCallback(d=>{let y=!1;if(ze!==void 0&&ze({...d,...d.location&&{location:[d.location[0]-D,d.location[1]]},cancel:()=>{y=!0}}),y||Gi(d)||z.current===void 0)return;const[p,I]=z.current.cell,H=It.current;if(st&&!d.metaKey&&!d.ctrlKey&&z.current!==void 0&&d.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(d.key)&&d.bounds!==void 0&&er(R([p-D,Math.max(0,Math.min(I,Se-1))]))){if((!gt||I!==Se)&&(H.y>I||I>H.y+H.height||H.x>p||p>H.x+H.width))return;N==null||N([p-D,I]),Mo(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[st,ze,Gi,z,R,D,Se,gt,N,Mo]),Es=s.useCallback((d,y)=>{const p=d.location[0]-D;if(d.kind==="header"&&(Ce==null||Ce(p,{...d,preventDefault:y})),d.kind===an){if(p<0)return;K==null||K(p,{...d,preventDefault:y})}if(d.kind==="cell"){const[I,H]=d.location;oe==null||oe([p,H],{...d,preventDefault:y}),ya(z,d.location)||Vn(I,H,!1,!1)}},[z,oe,K,Ce,D,Vn]),ci=s.useCallback(async d=>{var T,P,O;if(!Cn.paste)return;function y(Y,Z,he,te){var ae,Ue;const ye=typeof he=="object"?(he==null?void 0:he.join(`
`))??"":(he==null?void 0:he.toString())??"";if(!Fo(Y)&&er(Y)&&Y.readonly!==!0){const xe=G==null?void 0:G(ye,Y);if(xe!==void 0&&Ho(xe))return{location:Z,value:xe};const be=mt(Y);if(be===void 0)return;if(be.kind===j.Custom){jt(Y.kind===j.Custom);const Je=(ae=be.onPaste)==null?void 0:ae.call(be,ye,Y.data);return Je===void 0?void 0:{location:Z,value:{...Y,data:Je}}}else{const Je=(Ue=be.onPaste)==null?void 0:Ue.call(be,ye,Y,{formatted:te,formattedString:typeof te=="string"?te:te==null?void 0:te.join(`
`),rawValue:he});return Je===void 0?void 0:(jt(Je.kind===Y.kind),{location:Z,value:Je})}}}const p=z.columns,I=z.rows,H=((T=dt.current)==null?void 0:T.contains(document.activeElement))===!0||((P=l.current)==null?void 0:P.contains(document.activeElement))===!0;let B;if(z.current!==void 0?B=[z.current.range.x,z.current.range.y]:p.length===1?B=[p.first()??0,0]:I.length===1&&(B=[D,I.first()??0]),H&&B!==void 0){let Y,Z;const he="text/plain",te="text/html";if(navigator.clipboard.read!==void 0){const xe=await navigator.clipboard.read();for(const be of xe){if(be.types.includes(te)){const wt=await(await be.getType(te)).text(),Tt=pl(wt);if(Tt!==void 0){Y=Tt;break}}be.types.includes(he)&&(Z=await(await be.getType(he)).text())}}else if(navigator.clipboard.readText!==void 0)Z=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(te)){const xe=d.clipboardData.getData(te);Y=pl(xe)}Y===void 0&&d.clipboardData.types.includes(he)&&(Z=d.clipboardData.getData(he))}else return;const[ye,ae]=B,Ue=[];do{if(Oe===void 0){const xe=qt(B),be=Z??(Y==null?void 0:Y.map(wt=>wt.map(Tt=>Tt.rawValue).join("	")).join("	"))??"",Je=y(xe,B,be,void 0);Je!==void 0&&Ue.push(Je);break}if(Y===void 0){if(Z===void 0)return;Y=gd(Z)}if(Oe===!1||typeof Oe=="function"&&(Oe==null?void 0:Oe([B[0]-D,B[1]],Y.map(xe=>xe.map(be=>{var Je;return((Je=be.rawValue)==null?void 0:Je.toString())??""}))))!==!0)return;for(const[xe,be]of Y.entries()){if(xe+ae>=Se)break;for(const[Je,wt]of be.entries()){const Tt=[Je+ye,xe+ae],[gn,Sn]=Tt;if(gn>=qe.length||Sn>=Xt)continue;const mn=qt(Tt),Mn=y(mn,Tt,wt.rawValue,wt.formatted);Mn!==void 0&&Ue.push(Mn)}}}while(!1);rn(Ue),(O=Lt.current)==null||O.damage(Ue.map(xe=>({cell:xe.location})))}},[G,mt,qt,z,Cn.paste,dt,qe.length,rn,Xt,Oe,D,Se]);_t("paste",ci,g,!1,!0);const qo=s.useCallback(async(d,y)=>{var T,P;if(!Cn.copy)return;const p=y===!0||((T=dt.current)==null?void 0:T.contains(document.activeElement))===!0||((P=l.current)==null?void 0:P.contains(document.activeElement))===!0,I=z.columns,H=z.rows,B=(O,Y)=>{if(!ue)Cl(O,Y,d);else{const Z=Y.map(he=>({kind:j.Text,data:C[he].title,displayData:C[he].title,allowOverlay:!1}));Cl([Z,...O],Y,d)}};if(p&&Bt!==void 0){if(z.current!==void 0){let O=Bt(z.current.range,Ot.current.signal);typeof O!="object"&&(O=await O()),B(O,fo(z.current.range.x-D,z.current.range.x+z.current.range.width-D))}else if(H!==void 0&&H.length>0){const Y=[...H].map(Z=>{const he=Bt({x:D,y:Z,width:C.length,height:1},Ot.current.signal);return typeof he=="object"?he[0]:he().then(te=>te[0])});if(Y.some(Z=>Z instanceof Promise)){const Z=await Promise.all(Y);B(Z,fo(C.length))}else B(Y,fo(C.length))}else if(I.length>0){const O=[],Y=[];for(const Z of I){let he=Bt({x:Z,y:0,width:1,height:Se},Ot.current.signal);typeof he!="object"&&(he=await he()),O.push(he),Y.push(Z-D)}if(O.length===1)B(O[0],Y);else{const Z=O.reduce((he,te)=>he.map((ye,ae)=>[...ye,...te[ae]]));B(Z,Y)}}}},[C,Bt,z,Cn.copy,D,dt,Se,ue]);_t("copy",qo,g,!1,!1);const Is=s.useCallback(async d=>{var p,I;if(!(!Cn.cut||!(((p=dt.current)==null?void 0:p.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0))&&(await qo(d),z.current!==void 0)){let H={current:{cell:z.current.cell,range:z.current.range,rangeStack:[]},rows:nt.empty(),columns:nt.empty()};const B=lt==null?void 0:lt(H);if(B===!1||(H=B===!0?H:B,H.current===void 0))return;co(H.current.range)}},[co,z,Cn.cut,qo,dt,lt]);_t("cut",Is,g,!1,!1);const Ds=s.useCallback((d,y)=>{if(Xe!==void 0){D!==0&&(d=d.map(H=>[H[0]-D,H[1]])),Xe(d,y);return}if(d.length===0||y===-1)return;const[p,I]=d[y];u.current!==void 0&&u.current[0]===p&&u.current[1]===I||(u.current=[p,I],Vn(p,I,!1,!1))},[Xe,D,Vn]),[Er,Ir]=((Zi=bt==null?void 0:bt.current)==null?void 0:Zi.cell)??[],Dr=s.useRef(Ft);Dr.current=Ft,s.useLayoutEffect(()=>{var d,y,p,I;ai.current&&!_n.current&&Er!==void 0&&Ir!==void 0&&(Er!==((y=(d=le.current)==null?void 0:d.current)==null?void 0:y.cell[0])||Ir!==((I=(p=le.current)==null?void 0:p.current)==null?void 0:I.cell[1]))&&Dr.current(Er,Ir),_n.current=!1},[Er,Ir]);const _i=z.current!==void 0&&(z.current.cell[0]>=qe.length||z.current.cell[1]>=Xt);s.useLayoutEffect(()=>{_i&&ee(Lr,!1)},[_i,ee]);const Hs=s.useMemo(()=>gt===!0&&(pe==null?void 0:pe.tint)===!0?nt.fromSingleSelection(Xt-1):nt.empty(),[Xt,gt,pe==null?void 0:pe.tint]),Fs=s.useCallback(d=>typeof Le=="boolean"?Le:(Le==null?void 0:Le(d-D))??!0,[D,Le]),Ts=s.useMemo(()=>{if(ni===void 0||l.current===null)return null;const{bounds:d,group:y}=ni,p=l.current.getBoundingClientRect();return s.createElement(od,{bounds:d,group:y,canvasBounds:p,onClose:()=>oi(void 0),onFinish:I=>{oi(void 0),ve==null||ve(y,I)}})},[ve,ni]),As=Math.min(qe.length,fe+(nn?1:0));s.useImperativeHandle(t,()=>({appendRow:(d,y)=>Ro(d+D,y),updateCells:d=>{var y;return D!==0&&(d=d.map(p=>({cell:[p.cell[0]+D,p.cell[1]]}))),(y=Lt.current)==null?void 0:y.damage(d)},getBounds:(d,y)=>{var p;if(!((l==null?void 0:l.current)===null||(dt==null?void 0:dt.current)===null)){if(d===void 0&&y===void 0){const I=l.current.getBoundingClientRect(),H=I.width/dt.current.clientWidth;return{x:I.x-dt.current.scrollLeft*H,y:I.y-dt.current.scrollTop*H,width:dt.current.scrollWidth*H,height:dt.current.scrollHeight*H}}return(p=Lt.current)==null?void 0:p.getBounds((d??0)+D,y)}},focus:()=>{var d;return(d=Lt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await qo(void 0,!0);break;case"paste":await ci();break}},scrollTo:Ft,remeasureColumns:d=>{for(const y of d)Mr(y+D)},getMouseArgsForPosition:(d,y,p)=>{if((Lt==null?void 0:Lt.current)===null)return;const I=Lt.current.getMouseArgsForPosition(d,y,p);if(I!==void 0)return{...I,location:[I.location[0]-D,I.location[1]]}}}),[Ro,Mr,dt,qo,Vo,ci,D,Ft]);const[Ki,Ui]=kn??[],zs=s.useCallback(d=>{const[y,p]=d;if(p===-1){je!=="none"&&(Ae(nt.fromSingleSelection(y),void 0,!1),Gt());return}Ki===y&&Ui===p||(ie({cell:d,range:{x:y,y:p,width:1,height:1}},!0,!1,"keyboard-nav"),Ft(y,p))},[je,Gt,Ft,Ki,Ui,ie,Ae]),[Ps,Bs]=s.useState(!1),Vi=s.useRef(Il(d=>{Bs(d)},5)),Ls=s.useCallback(()=>{Vi.current(!0),z.current===void 0&&z.columns.length===0&&z.rows.length===0&&c===void 0&&ie({cell:[D,pr],range:{x:D,y:pr,width:1,height:1}},!0,!1,"keyboard-select")},[pr,z,c,D,ie]),Ws=s.useCallback(()=>{Vi.current(!1)},[]),[$s,Ns]=s.useMemo(()=>{let d;const y=(vt==null?void 0:vt.scrollbarWidthOverride)??yi(),p=Se+(gt?1:0);if(typeof vn=="number")d=et+p*vn;else{let H=0;const B=Math.min(p,10);for(let T=0;T<B;T++)H+=vn(T);H=Math.floor(H/B),d=et+p*H}d+=y;const I=qe.reduce((H,B)=>B.width+H,0)+y;return[`${Math.min(1e5,I)}px`,`${Math.min(1e5,d)}px`]},[qe,vt==null?void 0:vt.scrollbarWidthOverride,vn,Se,gt,et]),Os=s.useMemo(()=>Ta(Be),[Be]);return s.createElement(Kl.Provider,{value:Be},s.createElement(yd,{style:Os,className:Re,inWidth:b??$s,inHeight:x??Ns},s.createElement(Qc,{fillHandle:St,drawFocusRing:qr,experimental:vt,fixedShadowX:At,fixedShadowY:Pt,getRowThemeOverride:tn,headerIcons:Dn,imageWindowLoader:ar,initialSize:$n,isDraggable:Hn,onDragLeave:Fn,onRowMoved:pn,overscrollX:Zr,overscrollY:Xo,preventDiagonalScrolling:wo,rightElement:bo,rightElementProps:yo,smoothScrollX:no,smoothScrollY:Nn,className:Re,enableGroups:on,onCanvasFocused:Ls,onCanvasBlur:Ws,canvasRef:l,onContextMenu:Es,theme:Be,cellXOffset:us,cellYOffset:pr,accessibilityHeight:io.height,onDragEnd:ks,columns:qe,nonGrowWidth:Ut,drawHeader:Te,onColumnProposeMove:vs,drawCell:we,disabledRows:Hs,freezeColumns:As,lockColumns:D,firstColAccessible:D===0,getCellContent:qt,minColumnWidth:Yn,maxColumnWidth:ro,searchInputRef:a,showSearch:Jr,onSearchClose:ko,highlightRegions:fs,getCellsForSelection:Bt,getGroupDetails:ei,headerHeight:Oo,isFocused:Ps,groupHeaderHeight:on?br:0,freezeTrailingRows:yt+(gt&&(pe==null?void 0:pe.sticky)===!0?1:0),hasAppendRow:gt,onColumnResize:q,onColumnResizeEnd:se,onColumnResizeStart:Fe,onCellFocused:zs,onColumnMoved:Cs,onDragStart:xs,onHeaderMenuClick:bs,onHeaderIndicatorClick:ys,onItemHovered:si,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:ws,onKeyDown:Vo,onKeyUp:tt,onMouseDown:hs,onMouseUp:ms,onDragOverCell:Ht,onDrop:ht,onSearchResultsChanged:Ds,onVisibleRegionChanged:ps,clientSize:ot,rowHeight:vn,searchResults:U,searchValue:de,onSearchValueChange:re,rows:Xt,scrollRef:dt,selection:z,translateX:io.tx,translateY:io.ty,verticalBorder:Fs,gridRef:Lt,getCellRenderer:mt,resizeIndicator:Vr}),Ts,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Dd,{...r,validateCell:_,bloom:$,id:Rs,getCellRenderer:mt,className:(vt==null?void 0:vt.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:dn,imageEditorOverride:m,portalElementRef:po,onFinishEditing:Ms,markdownDivCreateNode:h,isOutsideClick:On,customEventTarget:vt==null?void 0:vt.eventTarget}))))},Ad=s.forwardRef(Td);function Sl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+l/2),m=Tl(u,l,i.cellVerticalPadding),w=Fl(t.contentAlign??"center",c,a,i.cellHorizontalPadding,m),h=Hl(w,g,m),b=Al(c+n,f+o,h);return Mi(t)&&b}const zd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:j.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Pd(e,e.cell.data,Mi(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Sl(e)&&e.preventDefault()},onClick:e=>{if(Sl(e))return{...e.cell,data:ls(e.cell.data)}},onPaste:(e,t)=>{let n=$r;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Si),n===t.data?void 0:{...t,data:n}}};function Pd(e,t,n,o,r){if(!n&&t===$r)return;const{ctx:i,hoverAmount:a,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:g,cell:{contentAlign:m}}=e,{x:w,y:h,width:b,height:x}=c;let C=!1;if(r>0){let v=n?1-r+r*a:.4;if(t===$r&&(v*=a),v===0)return;v<1&&(C=!0,i.globalAlpha=v)}Fi(i,l,t,w,h,b,x,f,u,g,o,m),C&&(i.globalAlpha=1)}const Bd=Jt("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Ld=e=>{const{bubbles:t}=e;return s.createElement(Bd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Wd={getAccessibilityString:e=>zl(e.data),kind:j.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>$d(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Ld,{bubbles:t.data})},onPaste:()=>{}};function $d(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:c,height:f}=n;let u=a+o.cellHorizontalPadding;const g=[];for(const m of t){if(u>a+c)break;const w=Bo(m,r,o.baseFontFull).width;g.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const m of g)En(r,m.x,l+(f-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,w]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],w.x+o.bubblePadding,l+f/2+Qn(r,o))}const Nd=Jt("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Od=e=>{const{drilldowns:t}=e;return s.createElement(Nd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Xd={getAccessibilityString:e=>zl(e.data.map(t=>t.text)),kind:j.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Gd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Od,{drilldowns:t.data})},onPaste:()=>{}},mi={};function Yd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,c=n*r,f=o+i,u=o*3,g=(u+i*2)*r,m=`${e},${t},${r},${n}`;if(mi[m]!==void 0)return{el:mi[m],height:c,width:g,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=g,w.height=c,h.scale(r,r),mi[m]=w,h.beginPath(),En(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),En(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:c,width:g,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Gd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,g=Ol(r,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-m)/2),h=m-10,b=o.bubblePadding,x=o.bubbleMargin;let C=c+o.cellHorizontalPadding;const v=o.roundingRadius??6,R=Yd(o.bgCell,o.drilldownBorder,m,v),X=[];for(const N of t){if(C>c+f)break;const L=Bo(N.text,r,u).width;let G=0;N.img!==void 0&&i.loadOrGetImage(N.img,a,l)!==void 0&&(G=h-8+4);const M=L+G+b*2;X.push({x:C,width:M}),C+=M+x}if(R!==null){const{el:N,height:A,middleWidth:L,sideWidth:G,width:M,dpr:W,padding:$}=R,F=G/W,E=$/W;for(const k of X){const ce=Math.floor(k.x),ne=Math.floor(k.width),oe=ne-(F-E)*2;r.imageSmoothingEnabled=!1,r.drawImage(N,0,0,G,A,ce-E,w,F,m),oe>0&&r.drawImage(N,G,0,L,A,ce+(F-E),w,oe,m),r.drawImage(N,M-G,0,G,A,ce+ne-(F-E),w,F,m),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[N,A]of X.entries()){const L=t[N];let G=A.x+b;if(L.img!==void 0){const M=i.loadOrGetImage(L.img,a,l);if(M!==void 0){const W=h-8;let $=0,F=0,E=M.width,k=M.height;E>k?($+=(E-k)/2,E=k):k>E&&(F+=(k-E)/2,k=E),r.beginPath(),En(r,G,w+m/2-W/2,W,W,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(M,$,F,E,k,G,w+m/2-W/2,W,W),r.restore(),G+=W+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(L.text,G,w+m/2+Qn(r,o))}}const _d={getAccessibilityString:e=>e.data.join(", "),kind:j.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Kd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??da;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},wi=4;function Kd(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:g,height:m,width:w}=r,h=m-l.cellVerticalPadding*2,b=[];let x=0;for(let v=0;v<t.length;v++){const R=t[v];if(R.length===0)continue;const X=f.loadOrGetImage(R,i,a);if(X!==void 0){b[v]=X;const N=X.width*(h/X.height);x+=N+wi}}if(x===0)return;x-=wi;let C=u+l.cellHorizontalPadding;o==="right"?C=Math.floor(u+w-l.cellHorizontalPadding-x):o==="center"&&(C=Math.floor(u+w/2-x/2));for(const v of b){if(v===void 0)continue;const R=v.width*(h/v.height);n>0&&(c.beginPath(),En(c,C,g+l.cellVerticalPadding,R,h,n),c.save(),c.clip()),c.drawImage(v,C,g+l.cellVerticalPadding,R,h),n>0&&c.restore(),C+=R+wi}}function Ud(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Vd={getAccessibilityString:()=>"",kind:j.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Ud(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);En(r,i.x+c,i.y+(i.height-f)/2,l,f,a.roundingRadius??3),r.fillStyle=go(a.textDark,.1),r.fill()},onPaste:()=>{}},qd=()=>e=>e.targetWidth,Ml=Jt("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[qd(),"px"]}}),jd=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,g]=s.useState(c===""||o),m=s.useCallback(()=>{g(h=>!h)},[]),w=c?"gdg-ml-6":"";return u?s.createElement(Ml,{targetWidth:i.width-20},s.createElement(Gr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>a(t)},s.createElement(oa,null))):s.createElement(Ml,{targetWidth:i.width},s.createElement(fa,{contents:c,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:m},s.createElement(Ri,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Zd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:sr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(jd,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Jd={getAccessibilityString:e=>e.row.toString(),kind:cn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Qd,measure:()=>44,draw:e=>tu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Qd(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=eu,n.textAlign="center",i}function eu(e){const{ctx:t}=e;t.textAlign="start"}function tu(e,t,n,o,r,i){const{ctx:a,rect:l,hoverAmount:c,theme:f}=e,{x:u,y:g,width:m,height:w}=l,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const b=7*(n?c:1);if(Fi(a,f,n,r?u+b:u,g,r?m-b:m,w,!0,void 0,void 0,f.checkboxMaxSize,"center",i),r){a.globalAlpha=c,a.beginPath();for(const x of[3,6])for(const C of[-5,-1,3])a.rect(u+x,g+w/2+C,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),x=f.markerFontFull,C=u+m/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=f.textLight,a.font=x,a.fillText(b,C,g+w/2+Qn(a,x)),c!==0&&(a.globalAlpha=1)}}const nu={getAccessibilityString:()=>"",kind:cn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>ou(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function ou(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:c,y:f,width:u,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let w=0;if(n!==void 0){const b=g-8,x=c+8/2,C=f+8/2;l.drawSprite(n,"normal",o,x,C,b,a,m?1:i),w=b}else{w=24;const h=12,b=m?h:i*h,x=m?0:(1-i)*h*.5,C=a.cellHorizontalPadding+4;b>0&&(o.moveTo(c+C+x,f+g/2),o.lineTo(c+C+x+b,f+g/2),o.moveTo(c+C+x+b*.5,f+g/2-b*.5),o.lineTo(c+C+x+b*.5,f+g/2+b*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,w+c+a.cellHorizontalPadding+.5,f+g/2+Qn(o,a)),o.beginPath()}function cs(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=ru(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),En(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??go(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function ru(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=Bo(n,e,o.baseFontFull,"alphabetic"),c=t.height-a,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const iu=s.lazy(async()=>await El(()=>import("./number-overlay-editor-DOiGpaaN.js"),__vite__mapDeps([6,1,3,7]),import.meta.url)),lu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:sr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&cs(o,r,f,c,i,t,a),Rn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(iu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},su={getAccessibilityString:()=>"",measure:()=>108,kind:j.Protected,needsHover:!1,needsHoverPosition:!1,draw:au,onPaste:()=>{}};function au(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+a/2,u=Math.cos(ol(30))*l,g=Math.sin(ol(30))*l;for(let m=0;m<12;m++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-g),t.lineTo(c-u,f+g),t.moveTo(c-u,f-g),t.lineTo(c+u,f+g),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const cu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>sr(e,t,e.theme.textLight),draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return pt.createElement(Gr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},du={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:sr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:g,hoverEffectTheme:m}=t;u===!0&&n>0&&cs(r,a,m,c,i,n,l),Rn(e,c,f,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Gr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},uu=Jt("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),fu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[l,c]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{c(!0)},[]);return l?s.createElement(Gr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(uu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Ri,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ds(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function Rl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=$l(a,i.baseFontFull);if(l===void 0)return!1;const c=ds(l,n,i,t.contentAlign);return ho({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:sr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Bo(c,l,n.baseFontFull),g=ds(u,a,n,t.contentAlign),{x:m,y:w,width:h,height:b}=g;if(r>=m-4&&r<=m-4+h+8&&i>=w-4&&i<=w-4+b+8){const x=Qn(l,n.baseFontFull);o("pointer");const C=5,v=w-x;l.beginPath(),l.moveTo(a.x+m,Math.floor(a.y+v+b+C)+.5),l.lineTo(a.x+m+h,Math.floor(a.y+v+b+C)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Rn({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),Rn({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),Rn({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),Rn({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Rn(e,c,t.contentAlign)},onSelect:e=>{Rl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Rl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(fu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},gu=[Jd,nu,zd,Wd,Xd,_d,Vd,Zd,lu,su,cu,du,hu],bi=[];class mu extends Yl{constructor(){super(...arguments);Ge(this,"imageLoaded",()=>{});Ge(this,"loadedLocations",[]);Ge(this,"cache",{});Ge(this,"sendLoaded",qs(()=>{this.imageLoaded(new or(this.loadedLocations)),this.loadedLocations=[]},20));Ge(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=bi.pop()??new Image;let c=!1;const f={img:void 0,cells:[wn(o,r)],url:n,cancel:()=>{c||(c=!0,bi.length<12?bi.unshift(l):a||(l.src=""))}},u=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const g=this.cache[i];if(g!==void 0&&!c){g.img=l;for(const m of g.cells)this.loadedLocations.push(Hi(m));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=wn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const wu=(e,t)=>{const n=s.useMemo(()=>({...cc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??gu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new mu,[e.imageWindowLoader]);return s.createElement(Ad,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Eu=s.forwardRef(wu);export{ed as C,Eu as D,j as G,Kl as T,Gr as a,Ol as b,Zt as c,Mu as d,Su as e,xu as f,Qn as g,Ho as h,ku as i,el as j,Fo as k,Qs as l,Bo as m,Ta as n,zo as p,En as r,Ru as u};
