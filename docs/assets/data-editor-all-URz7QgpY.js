var Sr=Object.defineProperty;var Tr=(t,n,d)=>n in t?Sr(t,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[n]=d;var ll=(t,n,d)=>(Tr(t,typeof n!="symbol"?n+"":n,d),d);import{s as sl,a as qt,j as X,F as Bl}from"./marked.esm-dbrxtycE.js";import{r,R as it}from"./index-BMVQvedj.js";import{_ as zr}from"./iframe-8T_ww7sJ.js";import{G as j,b as Eo,i as So,r as Xl,c as $o,C as V,g as on,d as Lr,e as Hr,w as Lt,m as nl,f as Dr,h as Yl,I as To,p as Er,j as $r,t as Fr,k as Ar,l as Ht,o as _l,n as jl,q as Ir,s as zo,v as Lo,x as Or,y as Pr,z as Kr,A as Wr,B as Nr,D as ql,E as jt,F as Gr,H as Ur,J as Zl,K as Vr,u as rl,L as Br,M as Xr,T as Yr,N as Jl,O as _r,P as jr}from"./image-window-loader--0ktsihR.js";import{c as Dt,r as Et,d as qr}from"./throttle-7EuXLZa7.js";import{u as Zr,f as Ql}from"./flatten-qRvRBp6y.js";import{G as Jr}from"./scrolling-data-grid-F9iLdN7s.js";const Y='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Qr=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}<rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${n}"/></svg>`},ei=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}<rect x="2" y="2" width="16" height="16" rx="4" fill="${d}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${n}"/></svg>`},ti=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${n}"/>
  </svg>`},oi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${n}"/>
</svg>`},li=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${d}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${n}"
    />
</svg>`},ln=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${n}"/>
</svg>
  `},ni=t=>{const n=t.bgColor;return`${Y}
    <path stroke="${n}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${n}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${n}"/>
  </svg>
`},ri=ln,ii=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${n}"/>
</svg>`},ci=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${n}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${n}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${n}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${n}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${n}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${n}"/>
  </svg>`},si=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${n}"/>
</svg>`},ai=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path fill="${n}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${d}"/>
  </svg>`},ui=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${n}"/>
  </svg>`},di=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${n}"/>
</svg>`},fi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${n}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${n}"/>
  </svg>`},hi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${n}"/>
</svg>`},gi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${d}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${d}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${n}"/>
  </svg>`},vi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path fill="${n}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${d}"/>
</svg>`},mi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${n}"/>
  </svg>`},Ci=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${n}"/>
  </svg>`},wi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${n}"/>
</svg>`},pi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${n}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${n}"/>
</svg>`},bi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${n}"/>
  </svg>`},yi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${n}"/>
</svg>`},Mi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${n}"/>
  </svg>`},xi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${n}"/>
</svg>`},Ri=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${n}"/>
</svg>`},ki=t=>{const n=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${n}" stroke-width="2"/>
  </svg>`},Si=t=>{const n=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${n}" stroke-width="2"/>
  </svg>
`},Ti={headerRowID:Qr,headerNumber:ti,headerCode:ei,headerString:oi,headerBoolean:li,headerAudioUri:ri,headerVideoUri:ii,headerEmoji:ci,headerImage:si,headerUri:ln,headerPhone:ai,headerMarkdown:ui,headerDate:di,headerTime:fi,headerEmail:hi,headerReference:gi,headerIfThenElse:vi,headerSingleValue:mi,headerLookup:Ci,headerTextTemplate:wi,headerMath:pi,headerRollup:bi,headerJoinStrings:yi,headerSplitString:Mi,headerGeoDistance:xi,headerArray:Ri,rowOwnerOverlay:ki,protectedColumnOverlay:Si,renameIcon:ni},zi=sl("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),Li=X("svg",{className:"button-icon",viewBox:"0 0 512 512",children:X("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})}),Hi=X("svg",{className:"button-icon",viewBox:"0 0 512 512",children:X("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})}),Di=X("svg",{className:"button-icon",viewBox:"0 0 512 512",children:X("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})}),Ei=10,$i=t=>{const{canvasRef:n,cellYOffset:d,rows:C,columns:k,searchInputRef:H,searchValue:P,searchResults:F,onSearchValueChange:E,getCellsForSelection:M,onSearchResultsChanged:m,showSearch:T=!1,onSearchClose:$}=t,[N]=r.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[O,be]=r.useState(""),ne=P??O,Fe=r.useCallback(z=>{be(z),E==null||E(z)},[E]),[x,p]=r.useState(),le=r.useRef(x);le.current=x,r.useEffect(()=>{F!==void 0&&(F.length>0?p(z=>({rowsSearched:C,results:F.length,selectedIndex:(z==null?void 0:z.selectedIndex)??-1})):p(void 0))},[C,F]);const ye=r.useRef();ye.current===void 0&&(ye.current=new AbortController);const Z=r.useRef(),[_,q]=r.useState([]),J=F??_,U=r.useCallback(()=>{Z.current!==void 0&&(window.cancelAnimationFrame(Z.current),Z.current=void 0,ye.current.abort())},[]),Re=r.useRef(d);Re.current=d;const wt=r.useCallback(z=>{const ee=new RegExp(z.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let re=Re.current,ze=Math.min(10,C),Oe=0;p(void 0),q([]);const st=[],Jt=async()=>{var Ge;if(M===void 0)return;const Ao=performance.now(),Ft=C-Oe;let at=M({x:0,y:re,width:k.length,height:Math.min(ze,Ft,C-re)},ye.current.signal);typeof at=="function"&&(at=await at());let Qt=!1;for(const[he,Le]of at.entries())for(const[Io,_e]of Le.entries()){let je;switch(_e.kind){case j.Text:case j.Number:je=_e.displayData;break;case j.Uri:case j.Markdown:je=_e.data;break;case j.Boolean:je=typeof _e.data=="boolean"?_e.data.toString():void 0;break;case j.Image:case j.Bubble:je=_e.data.join("üê≥");break;case j.Custom:je=_e.copyData;break}je!==void 0&&ee.test(je)&&(st.push([Io,he+re]),Qt=!0)}const eo=performance.now();Qt&&q([...st]),Oe+=at.length,Eo(Oe<=C);const Qe=((Ge=le.current)==null?void 0:Ge.selectedIndex)??-1;p({results:st.length,rowsSearched:Oe,selectedIndex:Qe}),m==null||m(st,Qe),re+ze>=C?re=0:re+=ze;const ut=eo-Ao,dt=Math.max(ut,1),ft=Ei/dt;ze=Math.ceil(ze*ft),Oe<C&&st.length<1e3&&(Z.current=window.requestAnimationFrame(Jt))};U(),Z.current=window.requestAnimationFrame(Jt)},[U,k.length,M,m,C]),se=r.useCallback(()=>{var z;$==null||$(),p(void 0),q([]),m==null||m([],-1),U(),(z=n==null?void 0:n.current)==null||z.focus()},[U,n,$,m]),Zt=r.useCallback(z=>{Fe(z.target.value),F===void 0&&(z.target.value===""?(p(void 0),q([]),U()):wt(z.target.value))},[wt,U,Fe,F]);r.useEffect(()=>{T&&H.current!==null&&(Fe(""),H.current.focus({preventScroll:!0}))},[T,H,Fe]);const ct=r.useCallback(z=>{var re;if((re=z==null?void 0:z.stopPropagation)==null||re.call(z),x===void 0)return;const ee=(x.selectedIndex+1)%x.results;p({...x,selectedIndex:ee}),m==null||m(J,ee)},[x,m,J]),Te=r.useCallback(z=>{var re;if((re=z==null?void 0:z.stopPropagation)==null||re.call(z),x===void 0)return;let ee=(x.selectedIndex-1)%x.results;ee<0&&(ee+=x.results),p({...x,selectedIndex:ee}),m==null||m(J,ee)},[m,J,x]),Ae=r.useCallback(z=>{(z.ctrlKey||z.metaKey)&&z.nativeEvent.code==="KeyF"||z.key==="Escape"?(se(),z.stopPropagation(),z.preventDefault()):z.key==="Enter"&&(z.shiftKey?Te():ct())},[se,ct,Te]);r.useEffect(()=>()=>{U()},[U]);const[$t,Ie]=r.useState(!1);r.useEffect(()=>{if(T)Ie(!0);else{const z=setTimeout(()=>Ie(!1),150);return()=>clearTimeout(z)}},[T]);const Fo=r.useMemo(()=>{if(!T&&!$t)return null;let z;x!==void 0&&(z=x.results>=1e3?"over 1000":`${x.results} result${x.results!==1?"s":""}`,x.selectedIndex>=0&&(z=`${x.selectedIndex+1} of ${z}`));const ee=Oe=>{Oe.stopPropagation()},ze={width:`${Math.floor(((x==null?void 0:x.rowsSearched)??0)/C*100)}%`};return qt(zi,{className:T?"":"out",onMouseDown:ee,onMouseMove:ee,onMouseUp:ee,onClick:ee,children:[qt("div",{className:"gdg-search-bar-inner",children:[X("input",{id:N,"aria-hidden":!T,"data-testid":"search-input",ref:H,onChange:Zt,value:ne,tabIndex:T?void 0:-1,onKeyDownCapture:Ae}),X("button",{"aria-label":"Previous Result","aria-hidden":!T,tabIndex:T?void 0:-1,onClick:Te,disabled:((x==null?void 0:x.results)??0)===0,children:Li}),X("button",{"aria-label":"Next Result","aria-hidden":!T,tabIndex:T?void 0:-1,onClick:ct,disabled:((x==null?void 0:x.results)??0)===0,children:Hi}),$!==void 0&&X("button",{"aria-label":"Close Search","aria-hidden":!T,"data-testid":"search-close-button",tabIndex:T?void 0:-1,onClick:se,children:Di})]}),x!==void 0?qt(Bl,{children:[X("div",{className:"gdg-search-status",children:X("div",{"data-testid":"search-result-area",children:z})}),X("div",{className:"gdg-search-progress",style:ze})]}):X("div",{className:"gdg-search-status",children:X("label",{htmlFor:N,children:"Type to search"})})]})},[T,$t,x,C,N,H,Zt,ne,Ae,Te,ct,$,se]);return qt(Bl,{children:[X(Jr,{prelightCells:J,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY}),Fo]})},Fi=$i;class Ai extends r.PureComponent{constructor(){super(...arguments);ll(this,"wrapperRef",r.createRef());ll(this,"clickOutside",d=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(d))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(d.target)){let C=d.target;for(;C!==null;){if(C.classList.contains("click-outside-ignore"))return;C=C.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:d,isOutsideClick:C,...k}=this.props;return X("div",{...k,ref:this.wrapperRef,children:this.props.children})}}const Ii=()=>t=>Math.max(16,t.targetHeight-10),Oi=sl("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Ii(),"px"]}}),Pi=t=>{const{bounds:n,group:d,onClose:C,canvasBounds:k,onFinish:H}=t,[P,F]=it.useState(d);return X(Ai,{style:{position:"absolute",left:n.x-k.left+1,top:n.y-k.top,width:n.width-2,height:n.height},className:"c181oggi",onClickOutside:C,children:X(Oi,{targetHeight:n.height,"data-testid":"group-rename-input",value:P,onBlur:C,onFocus:E=>E.target.setSelectionRange(0,P.length),onChange:E=>F(E.target.value),onKeyDown:E=>{E.key==="Enter"?H(P):E.key==="Escape"&&C()},autoFocus:!0})})},cl=150;function Ki(t,n,d,C){var H;const k=C(n);return((H=k==null?void 0:k.measure)==null?void 0:H.call(k,t,n,d))??cl}function nn(t,n,d,C,k,H,P,F,E){let M=0;const m=k===void 0?[]:k.map($=>{const N=Ki(t,$[C],n,E);return M=Math.max(M,N),N});if(m.length>5&&F){M=0;let $=0;for(const O of m)$+=O;const N=$/m.length;for(let O=0;O<m.length;O++)m[O]>=N*2?m[O]=0:M=Math.max(M,m[O])}M=Math.max(M,t.measureText(d.title).width+16+(d.icon===void 0?0:28));const T=Math.max(Math.ceil(H),Math.min(Math.floor(P),Math.ceil(M)));return{...d,width:T}}function Wi(t,n,d,C,k,H,P,F,E){const M=r.useRef(n),m=r.useRef(d),T=r.useRef(P);M.current=n,m.current=d,T.current=P;const[$,N]=r.useMemo(()=>{if(typeof window>"u")return[null,null];const x=document.createElement("canvas");return x.style.display="none",x.style.opacity="0",x.style.position="fixed",[x,x.getContext("2d",{alpha:!1})]},[]);r.useLayoutEffect(()=>($&&document.documentElement.append($),()=>{$==null||$.remove()}),[$]);const O=r.useRef({}),be=r.useRef(),[ne,Fe]=r.useState();return r.useLayoutEffect(()=>{const x=m.current;if(x===void 0||t.every(So))return;let p=Math.max(1,10-Math.floor(t.length/1e4)),le=0;p<M.current&&p>1&&(p--,le=1);const ye={x:0,y:0,width:t.length,height:Math.min(M.current,p)},Z={x:0,y:M.current-1,width:t.length,height:1};(async()=>{const q=x(ye,E.signal),J=le>0?x(Z,E.signal):void 0;let U;typeof q=="object"?U=q:U=await Xl(q),J!==void 0&&(typeof J=="object"?U=[...U,...J]:U=[...U,...await Xl(J)]),be.current=t,Fe(U)})()},[E.signal,t]),r.useMemo(()=>{let p=t.every(So)?t:N===null?t.map(_=>So(_)?_:{..._,width:cl}):(N.font=T.current.baseFontFull,t.map((_,q)=>{if(So(_))return _;if(O.current[_.id]!==void 0)return{..._,width:O.current[_.id]};if(ne===void 0||be.current!==t||_.id===void 0)return{..._,width:cl};const J=nn(N,P,_,q,ne,k,H,!0,F);return O.current[_.id]=J.width,J})),le=0,ye=0;const Z=[];for(const[_,q]of p.entries())le+=q.width,q.grow!==void 0&&q.grow>0&&(ye+=q.grow,Z.push(_));if(le<C&&Z.length>0){const _=[...p],q=C-le;let J=q;for(let U=0;U<Z.length;U++){const Re=Z[U],wt=(p[Re].grow??0)/ye,se=U===Z.length-1?J:Math.min(J,Math.floor(q*wt));_[Re]={...p[Re],growOffset:se,width:p[Re].width+se},J-=se}p=_}return{sizedColumns:p,nonGrowWidth:le}},[C,t,N,ne,P,k,H,F])}function Ni(t,n){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===n.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===n.keyCode:t===n.key}function A(t,n,d){const C=rn(t,n);return C&&(d.didMatch=!0),C}function rn(t,n){if(t.length===0)return!1;if(t.includes("|")){const E=t.split("|");for(const M of E)if(rn(M,n))return!0;return!1}let d=!1,C=!1,k=!1,H=!1;const P=t.split("+"),F=P.pop();if(!Ni(F,n))return!1;if(P[0]==="any")return!0;for(const E of P)switch(E){case"ctrl":d=!0;break;case"shift":C=!0;break;case"alt":k=!0;break;case"meta":H=!0;break;case"primary":$o.value?H=!0:d=!0;break}return n.altKey===k&&n.ctrlKey===d&&n.shiftKey===C&&n.metaKey===H}function Gi(t,n,d,C,k,H){const P=it.useCallback((M,m,T,$)=>{var x;(H==="cell"||H==="multi-cell")&&M!==void 0&&(M={...M,range:{x:M.cell[0],y:M.cell[1],width:1,height:1}});const N=d==="mixed"&&(T||$==="drag"),O=C==="mixed"&&N,be=k==="mixed"&&N;let ne={current:M===void 0?void 0:{...M,rangeStack:$==="drag"?((x=t.current)==null?void 0:x.rangeStack)??[]:[]},columns:O?t.columns:V.empty(),rows:be?t.rows:V.empty()};T&&(H==="multi-rect"||H==="multi-cell")&&ne.current!==void 0&&t.current!==void 0&&(ne={...ne,current:{...ne.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),n(ne,m)},[C,t,d,H,k,n]),F=it.useCallback((M,m,T)=>{M=M??t.rows,m!==void 0&&(M=M.add(m));let $;if(k==="exclusive"&&M.length>0)$={current:void 0,columns:V.empty(),rows:M};else{const N=T&&d==="mixed",O=T&&C==="mixed";$={current:N?t.current:void 0,columns:O?t.columns:V.empty(),rows:M}}n($,!1)},[C,t,d,k,n]),E=it.useCallback((M,m,T)=>{M=M??t.columns,m!==void 0&&(M=M.add(m));let $;if(C==="exclusive"&&M.length>0)$={current:void 0,rows:V.empty(),columns:M};else{const N=T&&d==="mixed",O=T&&k==="mixed";$={current:N?t.current:void 0,rows:O?t.rows:V.empty(),columns:M}}n($,!1)},[C,t,d,k,n]);return[P,F,E]}function Ui(t,n,d,C,k){const H=r.useCallback(M=>{if(t===!0){const m=[];for(let T=M.y;T<M.y+M.height;T++){const $=[];for(let N=M.x;N<M.x+M.width;N++)N<0||T>=k?$.push({kind:j.Loading,allowOverlay:!1}):$.push(n([N,T]));m.push($)}return m}return(t==null?void 0:t(M,C.signal))??[]},[C.signal,n,t,k]),P=t!==void 0?H:void 0,F=r.useCallback(M=>{if(P===void 0)return[];const m={...M,x:M.x-d};if(m.x<0){m.x=0,m.width--;const T=P(m,C.signal);return typeof T=="function"?async()=>(await T()).map($=>[{kind:j.Loading,allowOverlay:!1},...$]):T.map($=>[{kind:j.Loading,allowOverlay:!1},...$])}return P(m,C.signal)},[C.signal,P,d]);return[t!==void 0?F:void 0,P]}function en(t){return typeof t=="string"?t:`${t}px`}const Vi=()=>t=>t.innerWidth,Bi=()=>t=>t.innerHeight,Xi=sl("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[Vi()],"w2q57ts-1":[Bi()]}}),Yi=t=>{const{inWidth:n,inHeight:d,children:C,...k}=t;return X(Xi,{innerHeight:en(d),innerWidth:en(n),...k,children:C})},_i=2,ji=1300;function qi(t,n,d){const C=it.useRef(0),[k,H]=t??[0,0];it.useEffect(()=>{if(k===0&&H===0){C.current=0;return}let P=!1,F=0;const E=M=>{var m;if(!P){if(F===0)F=M;else{const T=M-F;C.current=Math.min(1,C.current+T/ji);const $=C.current**1.618*T*_i;(m=n.current)==null||m.scrollBy(k*$,H*$),F=M,d==null||d()}window.requestAnimationFrame(E)}};return window.requestAnimationFrame(E),()=>{P=!0}},[n,k,H,d])}function Zi({rowHeight:t,headerHeight:n,groupHeaderHeight:d,theme:C,overscrollX:k,overscrollY:H,scaleToRem:P,remSize:F}){const[E,M,m,T,$,N]=it.useMemo(()=>{if(!P||F===16)return[t,n,d,C,k,H];const O=F/16,be=t,ne=on();return[typeof be=="number"?be*O:Fe=>Math.ceil(be(Fe)*O),Math.ceil(n*O),Math.ceil(d*O),{...C,headerIconSize:((C==null?void 0:C.headerIconSize)??ne.headerIconSize)*O,cellHorizontalPadding:((C==null?void 0:C.cellHorizontalPadding)??ne.cellHorizontalPadding)*O,cellVerticalPadding:((C==null?void 0:C.cellVerticalPadding)??ne.cellVerticalPadding)*O},Math.ceil((k??0)*O),Math.ceil((H??0)*O)]},[d,n,k,H,F,t,P,C]);return{rowHeight:E,headerHeight:M,groupHeaderHeight:m,theme:T,overscrollX:$,overscrollY:N}}const rt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function I(t,n){return t===!0?n:t===!1?"":t}function tn(t){const n=$o.value;return{activateCell:I(t.activateCell," |Enter|shift+Enter"),clear:I(t.clear,"any+Escape"),closeOverlay:I(t.closeOverlay,"any+Escape"),acceptOverlayDown:I(t.acceptOverlayDown,"Enter"),acceptOverlayUp:I(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:I(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:I(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:I(t.delete,n?"Backspace|Delete":"Delete"),downFill:I(t.downFill,"primary+_68"),scrollToSelectedCell:I(t.scrollToSelectedCell,"primary+Enter"),goDownCell:I(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:I(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:I(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:I(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:I(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:I(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:I(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:I(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:I(t.goToFirstCell,"primary+Home"),goToFirstColumn:I(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:I(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:I(t.goToLastCell,"primary+End"),goToLastColumn:I(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:I(t.goToLastRow,"primary+ArrowDown"),goToNextPage:I(t.goToNextPage,"PageDown"),goToPreviousPage:I(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:I(t.rightFill,"primary+_82"),search:I(t.search,"primary+f"),selectAll:I(t.selectAll,"primary+a"),selectColumn:I(t.selectColumn,"ctrl+ "),selectGrowDown:I(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:I(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:I(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:I(t.selectGrowUp,"shift+ArrowUp"),selectRow:I(t.selectRow,"shift+ "),selectToFirstCell:I(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:I(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:I(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:I(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:I(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:I(t.selectToLastRow,"primary+shift+ArrowDown")}}function Ji(t){const n=Lr(t);return it.useMemo(()=>{if(n===void 0)return tn(rt);const d={...n,goToNextPage:(n==null?void 0:n.goToNextPage)??(n==null?void 0:n.pageDown)??rt.goToNextPage,goToPreviousPage:(n==null?void 0:n.goToPreviousPage)??(n==null?void 0:n.pageUp)??rt.goToPreviousPage,goToFirstCell:(n==null?void 0:n.goToFirstCell)??(n==null?void 0:n.first)??rt.goToFirstCell,goToLastCell:(n==null?void 0:n.goToLastCell)??(n==null?void 0:n.last)??rt.goToLastCell,selectToFirstCell:(n==null?void 0:n.selectToFirstCell)??(n==null?void 0:n.first)??rt.selectToFirstCell,selectToLastCell:(n==null?void 0:n.selectToLastCell)??(n==null?void 0:n.last)??rt.selectToLastCell};return tn({...rt,...d})},[n])}const Qi=r.lazy(async()=>await zr(()=>import("./data-grid-overlay-editor-XfDxbRV5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));let ec=0;function tc(t){return Zr(Ql(Ql(t).filter(n=>n.span!==void 0).map(n=>{var d,C;return Et((((d=n.span)==null?void 0:d[0])??0)+1,(((C=n.span)==null?void 0:C[1])??0)+1)})))}function Ho(t,n){return t===void 0||n===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+n,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+n},rangeStack:t.current.rangeStack.map(d=>({...d,x:d.x+n}))},rows:t.rows,columns:t.columns.offset(n)}}const il={kind:j.Loading,allowOverlay:!1},Do={columns:V.empty(),rows:V.empty(),current:void 0},oc=(t,n)=>{var Gl,Ul,Vl;const[d,C]=r.useState(Do),[k,H]=r.useState(),P=r.useRef(null),F=r.useRef(null),[E,M]=r.useState(),m=r.useRef(null),T=r.useRef(),$=typeof window>"u"?null:window,{imageEditorOverride:N,getRowThemeOverride:O,markdownDivCreateNode:be,width:ne,height:Fe,columns:x,rows:p,getCellContent:le,onCellClicked:ye,onCellActivated:Z,onFillPattern:_,onFinishedEditing:q,coercePasteValue:J,drawHeader:U,drawCell:Re,editorBloom:wt,onHeaderClicked:se,onColumnProposeMove:Zt,spanRangeBehavior:ct="default",onGroupHeaderClicked:Te,onCellContextMenu:Ae,className:$t,onHeaderContextMenu:Ie,getCellsForSelection:Fo,onGroupHeaderContextMenu:z,onGroupHeaderRenamed:ee,onCellEdited:re,onCellsEdited:ze,onSearchResultsChanged:Oe,searchResults:st,onSearchValueChange:Jt,searchValue:Ao,onKeyDown:Ft,onKeyUp:at,keybindings:Qt,editOnType:eo=!0,onRowAppended:Qe,onColumnMoved:ut,validateCell:dt,highlightRegions:ft,rangeSelect:Ge="rect",columnSelect:he="multi",rowSelect:Le="multi",rangeSelectionBlending:Io="exclusive",columnSelectionBlending:_e="exclusive",rowSelectionBlending:je="exclusive",onDelete:Oo,onDragStart:to,onMouseMove:oo,onPaste:ht,copyHeaders:al=!1,freezeColumns:qe=0,cellActivationBehavior:Po="second-click",rowSelectionMode:Ko="auto",onHeaderMenuClick:lo,onHeaderIndicatorClick:no,getGroupDetails:ro,onSearchClose:Wo,onItemHovered:io,onSelectionCleared:et,showSearch:cn,onVisibleRegionChanged:co,gridSelection:gt,onGridSelectionChange:No,minColumnWidth:sn=50,maxColumnWidth:an=500,maxColumnAutoWidth:un,provideEditor:dn,trailingRowOptions:W,freezeTrailingRows:Ze=0,allowedFillDirections:ul="orthogonal",scrollOffsetX:At,scrollOffsetY:Ue,verticalBorder:pt,onDragOverCell:fn,onDrop:hn,onColumnResize:It,onColumnResizeEnd:Ot,onColumnResizeStart:Pt,customRenderers:so,fillHandle:gn,drawFocusRing:dl=!0,experimental:ae,fixedShadowX:vn,fixedShadowY:mn,headerIcons:Cn,imageWindowLoader:wn,initialSize:pn,isDraggable:bn,onDragLeave:yn,onRowMoved:Kt,overscrollX:Mn,overscrollY:xn,preventDiagonalScrolling:Rn,rightElement:kn,rightElementProps:Sn,trapFocus:fl=!1,smoothScrollX:Tn,smoothScrollY:zn,scaleToRem:Ln=!1,rowHeight:Hn=34,headerHeight:hl=36,groupHeaderHeight:Dn=hl,theme:En,isOutsideClick:$n,renderers:Go}=t,ge=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,Pe=(ge==null?void 0:ge.kind)??t.rowMarkers??"none",Fn=(ge==null?void 0:ge.width)??t.rowMarkerWidth,gl=(ge==null?void 0:ge.startIndex)??t.rowMarkerStartIndex??1,vl=(ge==null?void 0:ge.theme)??t.rowMarkerTheme,ao=(ge==null?void 0:ge.checkboxStyle)??"square",bt=Math.max(sn,20),uo=Math.max(an,bt),An=Math.max(un??uo,bt),ml=r.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),In=r.useMemo(()=>Number.parseFloat(ml.fontSize),[ml]),{rowHeight:He,headerHeight:Uo,groupHeaderHeight:Cl,theme:wl,overscrollX:On,overscrollY:Pn}=Zi({groupHeaderHeight:Dn,headerHeight:hl,overscrollX:Mn,overscrollY:xn,remSize:In,rowHeight:Hn,scaleToRem:Ln,theme:En}),tt=Ji(Qt),yt=Fn??(p>1e4?48:p>1e3?44:p>100?36:32),Ve=Pe!=="none",s=Ve?1:0,Q=Qe!==void 0,Wt=(W==null?void 0:W.sticky)===!0,[Kn,pl]=r.useState(!1),Wn=cn??Kn,Nn=r.useCallback(()=>{Wo!==void 0?Wo():pl(!1)},[Wo]),u=r.useMemo(()=>gt===void 0?void 0:Ho(gt,s),[gt,s])??d,Me=r.useRef();Me.current===void 0&&(Me.current=new AbortController),r.useEffect(()=>()=>Me==null?void 0:Me.current.abort(),[]);const[ce,Gn]=Ui(Fo,le,s,Me.current,p),Un=r.useCallback((e,l,o)=>{if(dt===void 0)return!0;const i=[e[0]-s,e[1]];return dt==null?void 0:dt(i,l,o)},[s,dt]),fo=r.useRef(gt),De=r.useCallback((e,l)=>{l&&(e=Hr(e,ce,s,ct,Me.current)),No!==void 0?(fo.current=Ho(e,-s),No(fo.current)):C(e)},[No,ce,s,ct]),Mt=Lt(It,r.useCallback((e,l,o,i)=>{It==null||It(x[o-s],l,o-s,i)},[It,s,x])),Vn=Lt(Ot,r.useCallback((e,l,o,i)=>{Ot==null||Ot(x[o-s],l,o-s,i)},[Ot,s,x])),Bn=Lt(Pt,r.useCallback((e,l,o,i)=>{Pt==null||Pt(x[o-s],l,o-s,i)},[Pt,s,x])),Xn=Lt(U,r.useCallback((e,l)=>(U==null?void 0:U({...e,columnIndex:e.columnIndex-s},l))??!1,[U,s])),Yn=Lt(Re,r.useCallback((e,l)=>(Re==null?void 0:Re({...e,col:e.col-s},l))??!1,[Re,s])),ot=r.useCallback(e=>{if(Oo!==void 0){const l=Oo(Ho(e,-s));return typeof l=="boolean"?l:Ho(l,s)}return!0},[Oo,s]),[ve,me,ie]=Gi(u,De,Io,_e,je,Ge),ue=r.useMemo(()=>nl(on(),wl),[wl]),[Vo,_n]=r.useState([0,0,0]),bl=r.useMemo(()=>{if(Go===void 0)return{};const e={};for(const l of Go)e[l.kind]=l;return e},[Go]),Ce=r.useCallback(e=>e.kind!==j.Custom?bl[e.kind]:so==null?void 0:so.find(l=>l.isMatch(e)),[so,bl]);let{sizedColumns:ke,nonGrowWidth:yl}=Wi(x,p,Gn,Vo[0]-(s===0?0:yt)-Vo[2],bt,An,ue,Ce,Me.current);Pe!=="none"&&(yl+=yt);const Bo=r.useMemo(()=>ke.some(e=>e.group!==void 0),[ke]),Nt=Bo?Uo+Cl:Uo,Ml=u.rows.length,xl=Pe==="none"?void 0:Ml===0?!1:Ml===p?!0:void 0,G=r.useMemo(()=>Pe==="none"?ke:[{title:"",width:yt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:vl,rowMarker:ao,rowMarkerChecked:xl},...ke],[Pe,ke,yt,vl,ao,xl]),[Rl,kl]=r.useMemo(()=>[Ue!==void 0&&typeof He=="number"?Math.floor(Ue/He):0,Ue!==void 0&&typeof He=="number"?-(Ue%He):0],[Ue,He]),we=r.useRef({height:1,width:1,x:0,y:0}),jn=r.useMemo(()=>({x:we.current.x,y:Rl,width:we.current.width??1,height:we.current.height??1,ty:kl}),[kl,Rl]),Gt=r.useRef(!1),[Je,Sl,ho]=Dr(jn);we.current=Je;const Tl=(Je.height??1)>1;r.useLayoutEffect(()=>{if(Ue!==void 0&&m.current!==null&&Tl){if(m.current.scrollTop===Ue)return;m.current.scrollTop=Ue,m.current.scrollTop!==Ue&&ho(),Gt.current=!0}},[Ue,Tl,ho]);const zl=(Je.width??1)>1;r.useLayoutEffect(()=>{if(At!==void 0&&m.current!==null&&zl){if(m.current.scrollLeft===At)return;m.current.scrollLeft=At,m.current.scrollLeft!==At&&ho(),Gt.current=!0}},[At,zl,ho]);const qn=Je.x+s,go=Je.y,xe=r.useRef(null),pe=r.useCallback(e=>{var l;e===!0?(l=xe.current)==null||l.focus():window.requestAnimationFrame(()=>{var o;(o=xe.current)==null||o.focus()})},[]),de=Q?p+1:p,Ee=r.useCallback(e=>{const l=s===0?e:e.map(i=>({...i,location:[i.location[0]-s,i.location[1]]})),o=ze==null?void 0:ze(l);if(o!==!0)for(const i of l)re==null||re(i.location,i.value);return o},[re,ze,s]),[vt,Xo]=r.useState(),vo=u.current!==void 0&&u.current.range.width*u.current.range.height>1?u.current.range:void 0,xt=dl?(Gl=u.current)==null?void 0:Gl.cell:void 0,mo=xt==null?void 0:xt[0],Co=xt==null?void 0:xt[1],Zn=r.useMemo(()=>{if((ft===void 0||ft.length===0)&&(vo??mo??Co??vt)===void 0)return;const e=[];if(ft!==void 0)for(const l of ft){const o=G.length-l.range.x-s;o>0&&e.push({color:l.color,range:{...l.range,x:l.range.x+s,width:Math.min(o,l.range.width)},style:l.style})}return vt!==void 0&&e.push({color:Yl(ue.accentColor,0),range:vt,style:"dashed"}),vo!==void 0&&e.push({color:Yl(ue.accentColor,.5),range:vo,style:"solid-outline"}),mo!==void 0&&Co!==void 0&&e.push({color:ue.accentColor,range:{x:mo,y:Co,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[vt,vo,mo,Co,ft,G.length,ue.accentColor,s]),Ll=r.useRef(G);Ll.current=G;const Se=r.useCallback(([e,l],o=!1)=>{var h,a,f,v,g,b,y;const i=Q&&l===de-1;if(e===0&&Ve)return i?il:{kind:To.Marker,allowOverlay:!1,checkboxStyle:ao,checked:(u==null?void 0:u.rows.hasIndex(l))===!0,markerKind:Pe==="clickable-number"?"number":Pe,row:gl+l,drawHandle:Kt!==void 0,cursor:Pe==="clickable-number"?"pointer":void 0};if(i){const S=e===s?(W==null?void 0:W.hint)??"":"",L=Ll.current[e];if(((h=L==null?void 0:L.trailingRowOptions)==null?void 0:h.disabled)===!0)return il;{const K=((a=L==null?void 0:L.trailingRowOptions)==null?void 0:a.hint)??S,D=((f=L==null?void 0:L.trailingRowOptions)==null?void 0:f.addIcon)??(W==null?void 0:W.addIcon);return{kind:To.NewRow,hint:K,allowOverlay:!1,icon:D}}}else{const w=e-s;if(o||(ae==null?void 0:ae.strict)===!0){const L=we.current,K=L.x>w||w>L.x+L.width||L.y>l||l>L.y+L.height||l>=_o.current,D=w===((g=(v=L.extras)==null?void 0:v.selected)==null?void 0:g[0])&&l===((b=L.extras)==null?void 0:b.selected[1]);let R=!1;if(((y=L.extras)==null?void 0:y.freezeRegions)!==void 0){for(const B of L.extras.freezeRegions)if(Er(B,w,l)){R=!0;break}}if(K&&!D&&!R)return il}let S=le([w,l]);return s!==0&&S.span!==void 0&&(S={...S,span:[S.span[0]+s,S.span[1]+s]}),S}},[Q,de,Ve,ao,u==null?void 0:u.rows,Pe,gl,Kt,s,W==null?void 0:W.hint,W==null?void 0:W.addIcon,ae==null?void 0:ae.strict,le]),Yo=r.useCallback(e=>{let l=(ro==null?void 0:ro(e))??{name:e};return ee!==void 0&&e!==""&&(l={icon:l.icon,name:l.name,overrideTheme:l.overrideTheme,actions:[...l.actions??[],{title:"Rename",icon:"renameIcon",onClick:o=>qo({group:l.name,bounds:o.bounds})}]}),l},[ro,ee]),wo=r.useCallback(e=>{var f;const[l,o]=e.cell,i=G[l],c=(i==null?void 0:i.group)!==void 0?(f=Yo(i.group))==null?void 0:f.overrideTheme:void 0,h=i==null?void 0:i.themeOverride,a=O==null?void 0:O(o);H({...e,theme:nl(ue,c,h,a,e.content.themeOverride)})},[O,G,Yo,ue]),Rt=r.useCallback((e,l,o)=>{var a;if(u.current===void 0)return;const[i,c]=u.current.cell,h=Se([i,c]);if(h.kind!==j.Boolean&&h.allowOverlay){let f=h;if(o!==void 0)switch(f.kind){case j.Number:{const v=$r(()=>o==="-"?-0:Number.parseFloat(o),0);f={...f,data:Number.isNaN(v)?0:v};break}case j.Text:case j.Markdown:case j.Uri:f={...f,data:o};break}wo({target:e,content:f,initialValue:o,cell:[i,c],highlight:o===void 0,forceEditMode:o!==void 0})}else h.kind===j.Boolean&&l&&h.readonly!==!0&&(Ee([{location:u.current.cell,value:{...h,data:Fr(h.data)}}]),(a=xe.current)==null||a.damage([{cell:u.current.cell}]))},[Se,u,Ee,wo]),Hl=r.useCallback((e,l)=>{var c;const o=(c=xe.current)==null?void 0:c.getBounds(e,l);if(o===void 0||m.current===null)return;const i=Se([e,l]);i.allowOverlay&&wo({target:o,content:i,initialValue:void 0,highlight:!0,cell:[e,l],forceEditMode:!0})},[Se,wo]),te=r.useCallback((e,l,o="both",i=0,c=0,h=void 0)=>{if(m.current!==null){const a=xe.current,f=F.current,v=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,g=typeof l!="number"?l.unit==="cell"?l.amount:void 0:l,b=typeof e!="number"&&e.unit==="px"?e.amount:void 0,y=typeof l!="number"&&l.unit==="px"?l.amount:void 0;if(a!==null&&f!==null){let w={x:0,y:0,width:0,height:0},S=0,L=0;if((v!==void 0||g!==void 0)&&(w=a.getBounds((v??0)+s,g??0)??w,w.width===0||w.height===0))return;const K=f.getBoundingClientRect(),D=K.width/f.offsetWidth;if(b!==void 0&&(w={...w,x:b-K.left-m.current.scrollLeft,width:1}),y!==void 0&&(w={...w,y:y+K.top-m.current.scrollTop,height:1}),w!==void 0){const R={x:w.x-i,y:w.y-c,width:w.width+2*i,height:w.height+2*c};let B=0;for(let ol=0;ol<qe;ol++)B+=ke[ol].width;let fe=0;const oe=Ze+(Wt?1:0);oe>0&&(fe=Ar(de,oe,He));let We=B*D+K.left+s*yt*D,Xe=K.right,Ne=K.top+Nt*D,Ye=K.bottom-fe*D;const Ro=w.width+i*2;switch(h==null?void 0:h.hAlign){case"start":Xe=We+Ro;break;case"end":We=Xe-Ro;break;case"center":We=Math.floor((We+Xe)/2)-Ro/2,Xe=We+Ro;break}const ko=w.height+c*2;switch(h==null?void 0:h.vAlign){case"start":Ye=Ne+ko;break;case"end":Ne=Ye-ko;break;case"center":Ne=Math.floor((Ne+Ye)/2)-ko/2,Ye=Ne+ko;break}We>R.x?S=R.x-We:Xe<R.x+R.width&&(S=R.x+R.width-Xe),Ne>R.y?L=R.y-Ne:Ye<R.y+R.height&&(L=R.y+R.height-Ye),o==="vertical"||typeof e=="number"&&e<qe?S=0:(o==="horizontal"||typeof l=="number"&&l>=de-oe)&&(L=0),(S!==0||L!==0)&&(D!==1&&(S/=D,L/=D),m.current.scrollTo(S+m.current.scrollLeft,L+m.current.scrollTop))}}}},[s,Ze,yt,Nt,qe,ke,de,Wt,He]),Dl=r.useRef(Hl),El=r.useRef(le),_o=r.useRef(p);Dl.current=Hl,El.current=le,_o.current=p;const kt=r.useCallback(async(e,l=!0)=>{var v;const o=G[e];if(((v=o==null?void 0:o.trailingRowOptions)==null?void 0:v.disabled)===!0)return;const i=Qe==null?void 0:Qe();let c,h=!0;i!==void 0&&(c=await i,c==="top"&&(h=!1),typeof c=="number"&&(h=!1));let a=0;const f=()=>{if(_o.current<=p){a<500&&window.setTimeout(f,a),a=50+a*2;return}const g=typeof c=="number"?c:h?p:0;xo.current(e-s,g),ve({cell:[e,g],range:{x:e,y:g,width:1,height:1}},!1,!1,"edit");const b=El.current([e-s,g]);b.allowOverlay&&Lo(b)&&b.readonly!==!0&&l&&window.setTimeout(()=>{Dl.current(e,g)},0)};f()},[G,Qe,s,p,ve]),po=r.useCallback(e=>{var o,i;const l=((i=(o=ke[e])==null?void 0:o.trailingRowOptions)==null?void 0:i.targetColumn)??(W==null?void 0:W.targetColumn);if(typeof l=="number")return l+(Ve?1:0);if(typeof l=="object"){const c=x.indexOf(l);if(c>=0)return c+(Ve?1:0)}},[ke,x,Ve,W==null?void 0:W.targetColumn]),lt=r.useRef(),St=r.useRef(),Ut=r.useCallback((e,l)=>{var c;const[o,i]=l;return nl(ue,(c=G[o])==null?void 0:c.themeOverride,O==null?void 0:O(i),e.themeOverride)},[O,G,ue]),Vt=r.useCallback(e=>{var b,y,w;const l=$o.value?e.metaKey:e.ctrlKey,o=l&&Le==="multi",i=l&&he==="multi",[c,h]=e.location,a=u.columns,f=u.rows,[v,g]=((b=u.current)==null?void 0:b.cell)??[];if(e.kind==="cell"){if(St.current=void 0,mt.current=[c,h],c===0&&Ve){if(Q===!0&&h===p||Pe==="number"||Le==="none")return;const S=Se(e.location);if(S.kind!==To.Marker)return;if(Kt!==void 0){const D=Ce(S);Eo((D==null?void 0:D.kind)===To.Marker);const R=(y=D==null?void 0:D.onClick)==null?void 0:y.call(D,{...e,cell:S,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:Ut(S,e.location),preventDefault:()=>{}});if(R===void 0||R.checked===S.checked)return}H(void 0),pe();const L=f.hasIndex(h),K=lt.current;if(Le==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&K!==void 0&&f.hasIndex(K)){const D=[Math.min(K,h),Math.max(K,h)+1];o||Ko==="multi"?me(void 0,D,!0):me(V.fromSingleSelection(D),void 0,o)}else o||e.isTouch||Ko==="multi"?L?me(f.remove(h),void 0,!0):(me(void 0,h,!0),lt.current=h):L&&f.length===1?me(V.empty(),void 0,l):(me(V.fromSingleSelection(h),void 0,l),lt.current=h)}else if(c>=s&&Q&&h===p){const S=po(c);kt(S??c)}else if(v!==c||g!==h){const S=Se(e.location),L=Ce(S);if((L==null?void 0:L.onSelect)!==void 0){let R=!1;if(L.onSelect({...e,cell:S,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>R=!0,theme:Ut(S,e.location)}),R)return}const K=Wt&&h===p,D=Wt&&u!==void 0&&((w=u.current)==null?void 0:w.cell[1])===p;if((e.shiftKey||e.isLongTouch===!0)&&v!==void 0&&g!==void 0&&u.current!==void 0&&!D){if(K)return;const R=Math.min(c,v),B=Math.max(c,v),fe=Math.min(h,g),oe=Math.max(h,g);ve({...u.current,range:{x:R,y:fe,width:B-R+1,height:oe-fe+1}},!0,l,"click"),lt.current=void 0,pe()}else ve({cell:[c,h],range:{x:c,y:h,width:1,height:1}},!0,l,"click"),lt.current=void 0,H(void 0),pe()}}else if(e.kind==="header")if(mt.current=[c,h],H(void 0),Ve&&c===0)lt.current=void 0,St.current=void 0,Le==="multi"&&(f.length!==p?me(V.fromSingleSelection([0,p]),void 0,l):me(V.empty(),void 0,l),pe());else{const S=St.current;if(he==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&S!==void 0&&a.hasIndex(S)){const L=[Math.min(S,c),Math.max(S,c)+1];i?ie(void 0,L,l):ie(V.fromSingleSelection(L),void 0,l)}else i?(a.hasIndex(c)?ie(a.remove(c),void 0,l):ie(void 0,c,l),St.current=c):he!=="none"&&(ie(V.fromSingleSelection(c),void 0,l),St.current=c);lt.current=void 0,pe()}else e.kind===Ht?mt.current=[c,h]:e.kind===_l&&!e.isMaybeScrollbar&&(De(Do,!1),H(void 0),pe(),et==null||et(),lt.current=void 0,St.current=void 0)},[kt,he,pe,Ce,po,Se,u,Ve,Wt,et,Kt,s,Pe,Le,Ko,p,ve,De,ie,me,Q,Ut]),Bt=r.useRef(!1),mt=r.useRef(),$l=r.useRef(Je),$e=r.useRef(),Jn=r.useCallback(e=>{if(Tt.current=!1,$l.current=we.current,e.button!==0&&e.button!==1){$e.current=void 0;return}const l=performance.now();$e.current={button:e.button,time:l,location:e.location},(e==null?void 0:e.kind)==="header"&&(Bt.current=!0);const o=e.kind==="cell"&&e.isFillHandle;!o&&e.kind!=="cell"&&e.isEdge||(M({previousSelection:u,fillHandle:o}),mt.current=void 0,!e.isTouch&&e.button===0&&!o?Vt(e):!e.isTouch&&e.button===1&&(mt.current=e.location))},[u,Vt]),[jo,qo]=r.useState(),Fl=r.useCallback(e=>{if(e.kind!==Ht||he!=="multi")return;const l=$o.value?e.metaKey:e.ctrlKey,[o]=e.location,i=u.columns;if(o<s)return;const c=G[o];let h=o,a=o;for(let f=o-1;f>=s&&jl(c.group,G[f].group);f--)h--;for(let f=o+1;f<G.length&&jl(c.group,G[f].group);f++)a++;if(pe(),l)if(i.hasAll([h,a+1])){let f=i;for(let v=h;v<=a;v++)f=f.remove(v);ie(f,void 0,l)}else ie(void 0,[h,a+1],l);else ie(V.fromSingleSelection([h,a+1]),void 0,l)},[he,pe,u.columns,G,s,ie]),Tt=r.useRef(!1),bo=r.useCallback(async e=>{if(ce!==void 0&&Mt!==void 0){const l=we.current.y,o=we.current.height;let i=ce({x:e,y:l,width:1,height:Math.min(o,p-l)},Me.current.signal);typeof i!="object"&&(i=await i());const c=ke[e-s],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=ue.baseFontFull;const f=nn(a,ue,c,0,i,bt,uo,!1,Ce);Mt==null||Mt(c,f.width,e,f.width)}}},[ke,ce,uo,ue,bt,Mt,s,p,Ce]),[Qn,Zo]=r.useState(),zt=r.useCallback(async(e,l)=>{var f,v;const o=(f=e.current)==null?void 0:f.range;if(o===void 0||ce===void 0||l.current===void 0)return;const i=l.current.range;if(_!==void 0){let g=!1;if(_({fillDestination:{...i,x:i.x-s},patternSource:{...o,x:o.x-s},preventDefault:()=>g=!0}),g)return}let c=ce(o,Me.current.signal);typeof c!="object"&&(c=await c());const h=c,a=[];for(let g=0;g<i.width;g++)for(let b=0;b<i.height;b++){const y=[i.x+g,i.y+b];if(Ir(y,o))continue;const w=h[b%o.height][g%o.width];zo(w)||!Lo(w)||a.push({location:y,value:{...w}})}Ee(a),(v=xe.current)==null||v.damage(a.map(g=>({cell:g.location})))},[ce,Ee,_,s]),Al=r.useCallback(()=>{if(u.current===void 0||u.current.range.width<=1)return;const e={...u,current:{...u.current,range:{...u.current.range,width:1}}};zt(e,u)},[zt,u]),Il=r.useCallback(()=>{if(u.current===void 0||u.current.range.height<=1)return;const e={...u,current:{...u.current,range:{...u.current.range,height:1}}};zt(e,u)},[zt,u]),er=r.useCallback((e,l)=>{var b,y;const o=E;if(M(void 0),Xo(void 0),Zo(void 0),Bt.current=!1,l)return;if((o==null?void 0:o.fillHandle)===!0&&u.current!==void 0&&((b=o.previousSelection)==null?void 0:b.current)!==void 0){if(vt===void 0)return;const w={...u,current:{...u.current,range:Or(o.previousSelection.current.range,vt)}};zt(o.previousSelection,w),De(w,!0);return}const[i,c]=e.location,[h,a]=mt.current??[],f=()=>{Tt.current=!0},v=w=>{var L,K,D;const S=w.isTouch||h===i&&a===c;if(S&&(ye==null||ye([i-s,c],{...w,preventDefault:f})),w.button===1)return!Tt.current;if(!Tt.current){const R=Se(e.location),B=Ce(R);if(B!==void 0&&B.onClick!==void 0&&S){const oe=B.onClick({...w,cell:R,posX:w.localEventX,posY:w.localEventY,bounds:w.bounds,theme:Ut(R,e.location),preventDefault:f});oe!==void 0&&!zo(oe)&&jt(oe)&&(Ee([{location:w.location,value:oe}]),(L=xe.current)==null||L.damage([{cell:w.location}]))}if(Tt.current||u.current===void 0)return!1;let fe=!1;switch(R.activationBehaviorOverride??Po){case"double-click":case"second-click":{if(((D=(K=o==null?void 0:o.previousSelection)==null?void 0:K.current)==null?void 0:D.cell)===void 0)break;const[oe,We]=u.current.cell,[Xe,Ne]=o.previousSelection.current.cell;fe=i===oe&&i===Xe&&c===We&&c===Ne&&(w.isDoubleClick===!0||Po==="second-click");break}case"single-click":{fe=!0;break}}if(fe)return Z==null||Z([i-s,c]),Rt(w.bounds,!1),!0}return!1},g=e.location[0]-s;if(e.isTouch){const w=we.current,S=$l.current;if(w.x!==S.x||w.y!==S.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&Pr((y=u.current)==null?void 0:y.cell,e.location)){Ae==null||Ae([g,e.location[1]],{...e,preventDefault:f});return}else if(e.kind==="header"&&u.columns.hasIndex(i)){Ie==null||Ie(g,{...e,preventDefault:f});return}else if(e.kind===Ht){if(g<0)return;z==null||z(g,{...e,preventDefault:f});return}}e.kind==="cell"?v(e)||Vt(e):e.kind===Ht?Te==null||Te(g,{...e,preventDefault:f}):(e.kind===Kr&&(se==null||se(g,{...e,preventDefault:f})),Vt(e));return}if(e.kind==="header"){if(g<0)return;e.isEdge?e.isDoubleClick===!0&&bo(i):e.button===0&&i===h&&c===a&&(se==null||se(g,{...e,preventDefault:f}))}if(e.kind===Ht){if(g<0)return;e.button===0&&i===h&&c===a&&(Te==null||Te(g,{...e,preventDefault:f}),Tt.current||Fl(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&v(e),mt.current=void 0},[E,u,s,vt,zt,De,ye,Se,Ce,Po,Ut,Ee,Z,Rt,Ae,Ie,z,Vt,Te,se,bo,Fl]),tr=r.useCallback(e=>{const l={...e,location:[e.location[0]-s,e.location[1]]};oo==null||oo(l),E!==void 0&&e.buttons===0&&(M(void 0),Xo(void 0),Zo(void 0),Bt.current=!1),Zo(o=>{var i;return Bt.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(o==null?void 0:o[0])&&e.scrollEdge[1]===o[1]?o:E===void 0||(((i=$e.current)==null?void 0:i.location[0])??0)<s?void 0:e.scrollEdge})},[E,oo,s]),or=r.useCallback((e,l)=>{lo==null||lo(e-s,l)},[lo,s]),lr=r.useCallback((e,l)=>{no==null||no(e-s,l)},[no,s]),Be=(Ul=u==null?void 0:u.current)==null?void 0:Ul.cell,nr=r.useCallback((e,l,o,i,c,h)=>{Gt.current=!1;let a=Be;a!==void 0&&(a=[a[0]-s,a[1]]);const f=qe===0?void 0:{x:0,y:e.y,width:qe,height:e.height},v=[];f!==void 0&&v.push(f),Ze>0&&(v.push({x:e.x-s,y:p-Ze,width:e.width,height:Ze}),qe>0&&v.push({x:0,y:p-Ze,width:qe,height:Ze}));const g={x:e.x-s,y:e.y,width:e.width,height:Q&&e.y+e.height>=p?e.height-1:e.height,tx:c,ty:h,extras:{selected:a,freezeRegion:f,freezeRegions:v}};we.current=g,Sl(g),_n([l,o,i]),co==null||co(g,g.tx,g.ty,g.extras)},[Be,s,Q,p,qe,Ze,Sl,co]),rr=Lt(ut,r.useCallback((e,l)=>{ut==null||ut(e-s,l-s),he!=="none"&&ie(V.fromSingleSelection(l),void 0,!0)},[he,ut,s,ie])),Jo=r.useRef(!1),ir=r.useCallback(e=>{if(e.location[0]===0&&s>0){e.preventDefault();return}to==null||to({...e,location:[e.location[0]-s,e.location[1]]}),e.defaultPrevented()||(Jo.current=!0),M(void 0)},[to,s]),cr=r.useCallback(()=>{Jo.current=!1},[]),Qo=r.useRef(),el=r.useCallback(e=>{var l,o,i;if(!Wr(e,Qo.current)&&(Qo.current=e,!(((l=$e==null?void 0:$e.current)==null?void 0:l.button)!==void 0&&$e.current.button>=1))){if(e.buttons!==0&&E!==void 0&&((o=$e.current)==null?void 0:o.location[0])===0&&e.location[0]===0&&s===1&&Le==="multi"&&E.previousSelection&&!E.previousSelection.rows.hasIndex($e.current.location[1])&&u.rows.hasIndex($e.current.location[1])){const c=Math.min($e.current.location[1],e.location[1]),h=Math.max($e.current.location[1],e.location[1])+1;me(V.fromSingleSelection([c,h]),void 0,!1)}if(e.buttons!==0&&E!==void 0&&u.current!==void 0&&!Jo.current&&!Bt.current&&(Ge==="rect"||Ge==="multi-rect")){const[c,h]=u.current.cell;let[a,f]=e.location;if(f<0&&(f=we.current.y),E.fillHandle===!0&&((i=E.previousSelection)==null?void 0:i.current)!==void 0){const v=E.previousSelection.current.range;f=Math.min(f,Q?p-1:p);const g=Nr(v,a,f,ul);Xo(g)}else{if(Q&&h===p)return;if(Q&&f===p)if(e.kind===_l)f--;else return;a=Math.max(a,s);const b=a-c,y=f-h,w={x:b>=0?c:a,y:y>=0?h:f,width:Math.abs(b)+1,height:Math.abs(y)+1};ve({...u.current,range:w},!0,!1,"drag")}}io==null||io({...e,location:[e.location[0]-s,e.location[1]]})}},[ul,E,s,Le,u,Ge,io,me,Q,p,ve]),sr=r.useCallback(()=>{var a,f;const e=Qo.current;if(e===void 0)return;const[l,o]=e.scrollEdge;let[i,c]=e.location;const h=we.current;l===-1?i=((f=(a=h.extras)==null?void 0:a.freezeRegion)==null?void 0:f.x)??h.x:l===1&&(i=h.x+h.width),o===-1?c=Math.max(0,h.y):o===1&&(c=Math.min(p-1,h.y+h.height)),i=Dt(i,0,G.length-1),c=Dt(c,0,p-1),el({...e,location:[i,c]})},[G.length,el,p]);qi(Qn,m,sr);const Ke=r.useCallback(e=>{if(u.current===void 0)return;const[l,o]=e,[i,c]=u.current.cell,h=u.current.range;let a=h.x,f=h.x+h.width,v=h.y,g=h.y+h.height;if(o!==0)switch(o){case 2:{g=p,v=c,te(0,g,"vertical");break}case-2:{v=0,g=c+1,te(0,v,"vertical");break}case 1:{v<c?(v++,te(0,v,"vertical")):(g=Math.min(p,g+1),te(0,g,"vertical"));break}case-1:{g>c+1?(g--,te(0,g,"vertical")):(v=Math.max(0,v-1),te(0,v,"vertical"));break}default:ql()}if(l!==0)if(l===2)f=G.length,a=i,te(f-1-s,0,"horizontal");else if(l===-2)a=s,f=i+1,te(a-s,0,"horizontal");else{let b=[];if(ce!==void 0){const y=ce({x:a,y:v,width:f-a-s,height:g-v},Me.current.signal);typeof y=="object"&&(b=tc(y))}if(l===1){let y=!1;if(a<i){if(b.length>0){const w=Et(a+1,i+1).find(S=>!b.includes(S-s));w!==void 0&&(a=w,y=!0)}else a++,y=!0;y&&te(a,0,"horizontal")}y||(f=Math.min(G.length,f+1),te(f-1-s,0,"horizontal"))}else if(l===-1){let y=!1;if(f>i+1){if(b.length>0){const w=Et(f-1,i,-1).find(S=>!b.includes(S-s));w!==void 0&&(f=w,y=!0)}else f--,y=!0;y&&te(f-s,0,"horizontal")}y||(a=Math.max(s,a-1),te(a-s,0,"horizontal"))}else ql()}ve({cell:u.current.cell,range:{x:a,y:v,width:f-a,height:g-v}},!0,!1,"keyboard-select")},[ce,u,G.length,s,p,te,ve]),nt=r.useCallback((e,l,o,i)=>{const c=de-(o?0:1);if(e=Dt(e,s,ke.length-1+s),l=Dt(l,0,c),e===(Be==null?void 0:Be[0])&&l===(Be==null?void 0:Be[1]))return!1;if(i&&u.current!==void 0){const h=[...u.current.rangeStack];(u.current.range.width>1||u.current.range.height>1)&&h.push(u.current.range),De({...u,current:{cell:[e,l],range:{x:e,y:l,width:1,height:1},rangeStack:h}},!0)}else ve({cell:[e,l],range:{x:e,y:l,width:1,height:1}},!0,!1,"keyboard-nav");return T.current!==void 0&&T.current[0]===e&&T.current[1]===l&&(T.current=void 0),te(e-s,l),!0},[de,s,ke.length,Be,u,te,De,ve]),ar=r.useCallback((e,l)=>{(k==null?void 0:k.cell)!==void 0&&e!==void 0&&jt(e)&&(Ee([{location:k.cell,value:e}]),window.requestAnimationFrame(()=>{var c;(c=xe.current)==null||c.damage([{cell:k.cell}])})),pe(!0),H(void 0);const[o,i]=l;if(u.current!==void 0&&(o!==0||i!==0)){const c=u.current.cell[1]===de-1&&e!==void 0;nt(Dt(u.current.cell[0]+o,0,G.length-1),Dt(u.current.cell[1]+i,0,de-1),c,!1)}q==null||q(e,l)},[k==null?void 0:k.cell,pe,u,q,Ee,de,nt,G.length]),ur=r.useMemo(()=>`gdg-overlay-${ec++}`,[]),Ct=r.useCallback(e=>{var o,i,c,h;pe();const l=[];for(let a=e.x;a<e.x+e.width;a++)for(let f=e.y;f<e.y+e.height;f++){const v=le([a-s,f]);if(!v.allowOverlay&&v.kind!==j.Boolean)continue;let g;if(v.kind===j.Custom){const b=Ce(v),y=(o=b==null?void 0:b.provideEditor)==null?void 0:o.call(b,v);(b==null?void 0:b.onDelete)!==void 0?g=b.onDelete(v):Gr(y)&&(g=(i=y==null?void 0:y.deletedValue)==null?void 0:i.call(y,v))}else if(jt(v)&&v.allowOverlay||v.kind===j.Boolean){const b=Ce(v);g=(c=b==null?void 0:b.onDelete)==null?void 0:c.call(b,v)}g!==void 0&&!zo(g)&&jt(g)&&l.push({location:[a,f],value:g})}Ee(l),(h=xe.current)==null||h.damage(l.map(a=>({cell:a.location})))},[pe,le,Ce,Ee,s]),Xt=k!==void 0,Ol=r.useCallback(e=>{var S,L;const l=()=>{e.stopPropagation(),e.preventDefault()},o={didMatch:!1},{bounds:i}=e,c=u.columns,h=u.rows,a=tt;if(!Xt&&A(a.clear,e,o))De(Do,!1),et==null||et();else if(!Xt&&A(a.selectAll,e,o))De({columns:V.empty(),rows:V.empty(),current:{cell:((S=u.current)==null?void 0:S.cell)??[s,0],range:{x:s,y:0,width:x.length,height:p},rangeStack:[]}},!1);else if(A(a.search,e,o))(L=P==null?void 0:P.current)==null||L.focus({preventScroll:!0}),pl(!0);else if(A(a.delete,e,o)){const K=(ot==null?void 0:ot(u))??!0;if(K!==!1){const D=K===!0?u:K;if(D.current!==void 0){Ct(D.current.range);for(const R of D.current.rangeStack)Ct(R)}for(const R of D.rows)Ct({x:s,y:R,width:x.length,height:1});for(const R of D.columns)Ct({x:R,y:0,width:1,height:p})}}if(o.didMatch)return l(),!0;if(u.current===void 0)return!1;let[f,v]=u.current.cell,g=!1,b=!1;A(a.scrollToSelectedCell,e,o)?xo.current(f-s,v):he!=="none"&&A(a.selectColumn,e,o)?c.hasIndex(f)?ie(c.remove(f),void 0,!0):he==="single"?ie(V.fromSingleSelection(f),void 0,!0):ie(void 0,f,!0):Le!=="none"&&A(a.selectRow,e,o)?h.hasIndex(v)?me(h.remove(v),void 0,!0):Le==="single"?me(V.fromSingleSelection(v),void 0,!0):me(void 0,v,!0):!Xt&&i!==void 0&&A(a.activateCell,e,o)?v===p&&Q?window.setTimeout(()=>{const K=po(f);kt(K??f)},0):(Z==null||Z([f-s,v]),Rt(i,!0)):u.current.range.height>1&&A(a.downFill,e,o)?Il():u.current.range.width>1&&A(a.rightFill,e,o)?Al():A(a.goToNextPage,e,o)?v+=Math.max(1,we.current.height-4):A(a.goToPreviousPage,e,o)?v-=Math.max(1,we.current.height-4):A(a.goToFirstCell,e,o)?(H(void 0),v=0,f=0):A(a.goToLastCell,e,o)?(H(void 0),v=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):A(a.selectToFirstCell,e,o)?(H(void 0),Ke([-2,-2])):A(a.selectToLastCell,e,o)?(H(void 0),Ke([2,2])):Xt?(A(a.closeOverlay,e,o)&&H(void 0),A(a.acceptOverlayDown,e,o)&&(H(void 0),v++),A(a.acceptOverlayUp,e,o)&&(H(void 0),v--),A(a.acceptOverlayLeft,e,o)&&(H(void 0),f--),A(a.acceptOverlayRight,e,o)&&(H(void 0),f++)):(A(a.goDownCell,e,o)?v+=1:A(a.goUpCell,e,o)?v-=1:A(a.goRightCell,e,o)?f+=1:A(a.goLeftCell,e,o)?f-=1:A(a.goDownCellRetainSelection,e,o)?(v+=1,g=!0):A(a.goUpCellRetainSelection,e,o)?(v-=1,g=!0):A(a.goRightCellRetainSelection,e,o)?(f+=1,g=!0):A(a.goLeftCellRetainSelection,e,o)?(f-=1,g=!0):A(a.goToLastRow,e,o)?v=p-1:A(a.goToFirstRow,e,o)?v=Number.MIN_SAFE_INTEGER:A(a.goToLastColumn,e,o)?f=Number.MAX_SAFE_INTEGER:A(a.goToFirstColumn,e,o)?f=Number.MIN_SAFE_INTEGER:(Ge==="rect"||Ge==="multi-rect")&&(A(a.selectGrowDown,e,o)?Ke([0,1]):A(a.selectGrowUp,e,o)?Ke([0,-1]):A(a.selectGrowRight,e,o)?Ke([1,0]):A(a.selectGrowLeft,e,o)?Ke([-1,0]):A(a.selectToLastRow,e,o)?Ke([0,2]):A(a.selectToFirstRow,e,o)?Ke([0,-2]):A(a.selectToLastColumn,e,o)?Ke([2,0]):A(a.selectToFirstColumn,e,o)&&Ke([-2,0])),b=o.didMatch);const y=nt(f,v,!1,g),w=o.didMatch;return w&&(y||!b||fl)&&l(),w},[Xt,u,tt,he,Le,Ge,s,p,nt,De,et,x.length,ot,fl,Ct,ie,me,Q,po,kt,Z,Rt,Il,Al,Ke]),Yt=r.useCallback(e=>{let l=!1;if(Ft!==void 0&&Ft({...e,cancel:()=>{l=!0}}),l||Ol(e)||u.current===void 0)return;const[o,i]=u.current.cell,c=we.current;if(eo&&!e.metaKey&&!e.ctrlKey&&u.current!==void 0&&e.key.length===1&&/[ -~]/g.test(e.key)&&e.bounds!==void 0&&Lo(le([o-s,Math.max(0,Math.min(i,p-1))]))){if((!Q||i!==p)&&(c.y>i||i>c.y+c.height||c.x>o||o>c.x+c.width))return;Rt(e.bounds,!0,e.key),e.stopPropagation(),e.preventDefault()}},[eo,Ft,Ol,u,le,s,p,Q,Rt]),dr=r.useCallback((e,l)=>{const o=e.location[0]-s;if(e.kind==="header"&&(Ie==null||Ie(o,{...e,preventDefault:l})),e.kind===Ht){if(o<0)return;z==null||z(o,{...e,preventDefault:l})}if(e.kind==="cell"){const[i,c]=e.location;Ae==null||Ae([o,c],{...e,preventDefault:l}),Ur(u,e.location)||nt(i,c,!1,!1)}},[u,Ae,z,Ie,s,nt]),tl=r.useCallback(async e=>{var a,f,v;if(!tt.paste)return;function l(g,b,y,w){var L,K;const S=typeof y=="object"?(y==null?void 0:y.join(`
`))??"":(y==null?void 0:y.toString())??"";if(!zo(g)&&Lo(g)&&g.readonly!==!0){const D=J==null?void 0:J(S,g);if(D!==void 0&&jt(D))return{location:b,value:D};const R=Ce(g);if(R===void 0)return;if(R.kind===j.Custom){Eo(g.kind===j.Custom);const B=(L=R.onPaste)==null?void 0:L.call(R,S,g.data);return B===void 0?void 0:{location:b,value:{...g,data:B}}}else{const B=(K=R.onPaste)==null?void 0:K.call(R,S,g,{formatted:w,formattedString:typeof w=="string"?w:w==null?void 0:w.join(`
`),rawValue:y});return B===void 0?void 0:(Eo(B.kind===g.kind),{location:b,value:B})}}}const o=u.columns,i=u.rows,c=((a=m.current)==null?void 0:a.contains(document.activeElement))===!0||((f=F.current)==null?void 0:f.contains(document.activeElement))===!0;let h;if(u.current!==void 0?h=[u.current.range.x,u.current.range.y]:o.length===1?h=[o.first()??0,0]:i.length===1&&(h=[s,i.first()??0]),c&&h!==void 0){let g,b;const y="text/plain",w="text/html";if(navigator.clipboard.read!==void 0){const D=await navigator.clipboard.read();for(const R of D){if(R.types.includes(w)){const fe=await(await R.getType(w)).text(),oe=Zl(fe);if(oe!==void 0){g=oe;break}}R.types.includes(y)&&(b=await(await R.getType(y)).text())}}else if(navigator.clipboard.readText!==void 0)b=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(w)){const D=e.clipboardData.getData(w);g=Zl(D)}g===void 0&&e.clipboardData.types.includes(y)&&(b=e.clipboardData.getData(y))}else return;const[S,L]=h,K=[];do{if(ht===void 0){const D=Se(h),R=b??(g==null?void 0:g.map(fe=>fe.map(oe=>oe.rawValue).join("	")).join("	"))??"",B=l(D,h,R,void 0);B!==void 0&&K.push(B);break}if(g===void 0){if(b===void 0)return;g=Vr(b)}if(ht===!1||typeof ht=="function"&&(ht==null?void 0:ht([h[0]-s,h[1]],g.map(D=>D.map(R=>{var B;return((B=R.rawValue)==null?void 0:B.toString())??""}))))!==!0)return;for(const[D,R]of g.entries()){if(D+L>=p)break;for(const[B,fe]of R.entries()){const oe=[B+S,D+L],[We,Xe]=oe;if(We>=G.length||Xe>=de)continue;const Ne=Se(oe),Ye=l(Ne,oe,fe.rawValue,fe.formatted);Ye!==void 0&&K.push(Ye)}}}while(!1);Ee(K),(v=xe.current)==null||v.damage(K.map(D=>({cell:D.location})))}},[J,Ce,Se,u,tt.paste,G.length,Ee,de,ht,s,p]);rl("paste",tl,$,!1,!0);const _t=r.useCallback(async(e,l)=>{var a,f;if(!tt.copy)return;const o=l===!0||((a=m.current)==null?void 0:a.contains(document.activeElement))===!0||((f=F.current)==null?void 0:f.contains(document.activeElement))===!0,i=u.columns,c=u.rows,h=(v,g)=>{if(!al)Jl(v,g,e);else{const b=g.map(y=>({kind:j.Text,data:x[y].title,displayData:x[y].title,allowOverlay:!1}));Jl([b,...v],g,e)}};if(o&&ce!==void 0){if(u.current!==void 0){let v=ce(u.current.range,Me.current.signal);typeof v!="object"&&(v=await v()),h(v,Et(u.current.range.x-s,u.current.range.x+u.current.range.width-s))}else if(c!==void 0&&c.length>0){const g=[...c].map(b=>{const y=ce({x:s,y:b,width:x.length,height:1},Me.current.signal);return typeof y=="object"?y[0]:y().then(w=>w[0])});if(g.some(b=>b instanceof Promise)){const b=await Promise.all(g);h(b,Et(x.length))}else h(g,Et(x.length))}else if(i.length>0){const v=[],g=[];for(const b of i){let y=ce({x:b,y:0,width:1,height:p},Me.current.signal);typeof y!="object"&&(y=await y()),v.push(y),g.push(b-s)}if(v.length===1)h(v[0],g);else{const b=v.reduce((y,w)=>y.map((S,L)=>[...S,...w[L]]));h(b,g)}}}},[x,ce,u,tt.copy,s,p,al]);rl("copy",_t,$,!1,!1);const fr=r.useCallback(async e=>{var o,i;if(!(!tt.cut||!(((o=m.current)==null?void 0:o.contains(document.activeElement))===!0||((i=F.current)==null?void 0:i.contains(document.activeElement))===!0))&&(await _t(e),u.current!==void 0)){let c={current:{cell:u.current.cell,range:u.current.range,rangeStack:[]},rows:V.empty(),columns:V.empty()};const h=ot==null?void 0:ot(c);if(h===!1||(c=h===!0?c:h,c.current===void 0))return;Ct(c.current.range)}},[Ct,u,tt.cut,_t,ot]);rl("cut",fr,$,!1,!1);const hr=r.useCallback((e,l)=>{if(Oe!==void 0){s!==0&&(e=e.map(c=>[c[0]-s,c[1]])),Oe(e,l);return}if(e.length===0||l===-1)return;const[o,i]=e[l];T.current!==void 0&&T.current[0]===o&&T.current[1]===i||(T.current=[o,i],nt(o,i,!1,!1))},[Oe,s,nt]),[yo,Mo]=((Vl=gt==null?void 0:gt.current)==null?void 0:Vl.cell)??[],xo=r.useRef(te);xo.current=te,r.useLayoutEffect(()=>{var e,l,o,i;!Gt.current&&yo!==void 0&&Mo!==void 0&&(yo!==((l=(e=fo.current)==null?void 0:e.current)==null?void 0:l.cell[0])||Mo!==((i=(o=fo.current)==null?void 0:o.current)==null?void 0:i.cell[1]))&&xo.current(yo,Mo),Gt.current=!1},[yo,Mo]);const Pl=u.current!==void 0&&(u.current.cell[0]>=G.length||u.current.cell[1]>=de);r.useLayoutEffect(()=>{Pl&&De(Do,!1)},[Pl,De]);const gr=r.useMemo(()=>Q===!0&&(W==null?void 0:W.tint)===!0?V.fromSingleSelection(de-1):V.empty(),[de,Q,W==null?void 0:W.tint]),vr=r.useCallback(e=>typeof pt=="boolean"?pt:(pt==null?void 0:pt(e-s))??!0,[s,pt]),mr=r.useMemo(()=>{if(jo===void 0||F.current===null)return null;const{bounds:e,group:l}=jo,o=F.current.getBoundingClientRect();return X(Pi,{bounds:e,group:l,canvasBounds:o,onClose:()=>qo(void 0),onFinish:i=>{qo(void 0),ee==null||ee(l,i)}})},[ee,jo]),Cr=Math.min(G.length,qe+(Ve?1:0));r.useImperativeHandle(n,()=>({appendRow:(e,l)=>kt(e+s,l),updateCells:e=>{var l;return s!==0&&(e=e.map(o=>({cell:[o.cell[0]+s,o.cell[1]]}))),(l=xe.current)==null?void 0:l.damage(e)},getBounds:(e,l)=>{var o;if(!((F==null?void 0:F.current)===null||(m==null?void 0:m.current)===null)){if(e===void 0&&l===void 0){const i=F.current.getBoundingClientRect(),c=i.width/m.current.clientWidth;return{x:i.x-m.current.scrollLeft*c,y:i.y-m.current.scrollTop*c,width:m.current.scrollWidth*c,height:m.current.scrollHeight*c}}return(o=xe.current)==null?void 0:o.getBounds((e??0)+s,l)}},focus:()=>{var e;return(e=xe.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Yt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Yt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Yt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await _t(void 0,!0);break;case"paste":await tl();break}},scrollTo:te,remeasureColumns:e=>{for(const l of e)bo(l+s)}}),[kt,bo,_t,Yt,tl,s,te]);const[Kl,Wl]=Be??[],wr=r.useCallback(e=>{const[l,o]=e;if(o===-1){he!=="none"&&(ie(V.fromSingleSelection(l),void 0,!1),pe());return}Kl===l&&Wl===o||(ve({cell:e,range:{x:l,y:o,width:1,height:1}},!0,!1,"keyboard-nav"),te(l,o))},[he,pe,te,Kl,Wl,ve,ie]),[pr,br]=r.useState(!1),Nl=r.useRef(qr(e=>{br(e)},5)),yr=r.useCallback(()=>{Nl.current(!0),u.current===void 0&&u.columns.length===0&&u.rows.length===0&&E===void 0&&ve({cell:[s,go],range:{x:s,y:go,width:1,height:1}},!0,!1,"keyboard-select")},[go,u,E,s,ve]),Mr=r.useCallback(()=>{Nl.current(!1)},[]),[xr,Rr]=r.useMemo(()=>{let e;const l=(ae==null?void 0:ae.scrollbarWidthOverride)??Br(),o=p+(Q?1:0);if(typeof He=="number")e=Nt+o*He;else{let c=0;const h=Math.min(o,10);for(let a=0;a<h;a++)c+=He(a);c=Math.floor(c/h),e=Nt+o*c}e+=l;const i=G.reduce((c,h)=>h.width+c,0)+l;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,e)}px`]},[G,ae==null?void 0:ae.scrollbarWidthOverride,He,p,Q,Nt]),kr=r.useMemo(()=>Xr(ue),[ue]);return X(Yr.Provider,{value:ue,children:qt(Yi,{style:kr,className:$t,inWidth:ne??xr,inHeight:Fe??Rr,children:[X(Fi,{fillHandle:gn,drawFocusRing:dl,experimental:ae,fixedShadowX:vn,fixedShadowY:mn,getRowThemeOverride:O,headerIcons:Cn,imageWindowLoader:wn,initialSize:pn,isDraggable:bn,onDragLeave:yn,onRowMoved:Kt,overscrollX:On,overscrollY:Pn,preventDiagonalScrolling:Rn,rightElement:kn,rightElementProps:Sn,smoothScrollX:Tn,smoothScrollY:zn,className:$t,enableGroups:Bo,onCanvasFocused:yr,onCanvasBlur:Mr,canvasRef:F,onContextMenu:dr,theme:ue,cellXOffset:qn,cellYOffset:go,accessibilityHeight:Je.height,onDragEnd:cr,columns:G,nonGrowWidth:yl,drawHeader:Xn,onColumnProposeMove:Zt,drawCell:Yn,disabledRows:gr,freezeColumns:Cr,lockColumns:s,firstColAccessible:s===0,getCellContent:Se,minColumnWidth:bt,maxColumnWidth:uo,searchInputRef:P,showSearch:Wn,onSearchClose:Nn,highlightRegions:Zn,getCellsForSelection:ce,getGroupDetails:Yo,headerHeight:Uo,isFocused:pr,groupHeaderHeight:Bo?Cl:0,freezeTrailingRows:Ze+(Q&&(W==null?void 0:W.sticky)===!0?1:0),hasAppendRow:Q,onColumnResize:Mt,onColumnResizeEnd:Vn,onColumnResizeStart:Bn,onCellFocused:wr,onColumnMoved:rr,onDragStart:ir,onHeaderMenuClick:or,onHeaderIndicatorClick:lr,onItemHovered:el,isFilling:(E==null?void 0:E.fillHandle)===!0,onMouseMove:tr,onKeyDown:Yt,onKeyUp:at,onMouseDown:Jn,onMouseUp:er,onDragOverCell:fn,onDrop:hn,onSearchResultsChanged:hr,onVisibleRegionChanged:nr,clientSize:Vo,rowHeight:He,searchResults:st,searchValue:Ao,onSearchValueChange:Jt,rows:de,scrollRef:m,selection:u,translateX:Je.tx,translateY:Je.ty,verticalBorder:vr,gridRef:xe,getCellRenderer:Ce}),mr,k!==void 0&&X(r.Suspense,{fallback:null,children:X(Qi,{...k,validateCell:Un,bloom:wt,id:ur,getCellRenderer:Ce,className:(ae==null?void 0:ae.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:dn,imageEditorOverride:N,onFinishEditing:ar,markdownDivCreateNode:be,isOutsideClick:$n})})]})})},lc=r.forwardRef(oc),nc=(t,n)=>{const d=r.useMemo(()=>({...Ti,...t.headerIcons}),[t.headerIcons]),C=r.useMemo(()=>t.imageWindowLoader??new _r,[t.imageWindowLoader]);return X(lc,{...t,renderers:jr,headerIcons:d,ref:n,imageWindowLoader:C})},gc=r.forwardRef(nc);export{Ai as C,gc as D,rt as k};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-XfDxbRV5.js","./marked.esm-dbrxtycE.js","./index-BMVQvedj.js","./index-wocATsGp.js","./image-window-loader--0ktsihR.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./iframe-8T_ww7sJ.js","./image-window-loader-1jHxuE_X.css","./flatten-qRvRBp6y.js","./scrolling-data-grid-F9iLdN7s.js","./scrolling-data-grid-dE2iz8sf.css","./data-grid-overlay-editor-EbzU9_4i.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}