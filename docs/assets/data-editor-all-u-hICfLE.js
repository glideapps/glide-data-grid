const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-BghSPBKL.js","./iframe-DZSq2JGj.js","./index-CJ3Q-leR.js","./image-window-loader-YKrs8S9Y.js","./throttle-BcmITwxY.js","./marked.esm-CZzuroS4.js","./image-window-loader-Cz9c4fO9.css","./flatten-FVnj_Y6s.js","./scrolling-data-grid-BPikos3D.js","./scrolling-data-grid-DRMIUdoe.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var Kl=Object.defineProperty;var Nl=(e,o,i)=>o in e?Kl(e,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[o]=i;var sn=(e,o,i)=>Nl(e,typeof o!="symbol"?o+"":o,i);import{r as l,R as fe,_ as Ol}from"./iframe-DZSq2JGj.js";import{G as Q,b as $o,i as zo,r as er,c as Ao,C as Y,g as ur,d as Wl,w as ut,e as Ul,f as Bl,m as an,h as tr,I as Eo,p as Vl,j as _l,t as Xl,k as Yl,l as $t,o as or,n as nr,q as ql,s as Lo,v as Ho,x as jl,y as Zl,z as Jl,A as Ql,B as ei,D as rr,E as Zt,F as ti,H as oi,J as lr,K as ni,u as un,L as ri,M as li,T as ii,N as ir,O as ci,P as si}from"./image-window-loader-YKrs8S9Y.js";import{m as Rt,r as At,g as ai}from"./throttle-BcmITwxY.js";import{u as ui,f as cr}from"./flatten-FVnj_Y6s.js";import{G as di}from"./scrolling-data-grid-BPikos3D.js";import{s as hn}from"./marked.esm-CZzuroS4.js";const Z='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',fi=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},hi=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="4" fill="${i}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},gi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},mi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},vi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${i}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},dr=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},Ci=e=>{const o=e.bgColor;return`${Z}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},wi=dr,pi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},bi=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},yi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},xi=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${i}"/>
  </svg>`},Mi=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Ri=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},ki=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Si=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Ti=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${i}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${i}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},zi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${i}"/>
</svg>`},Ei=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},Li=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Hi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Di=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Ii=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Fi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},$i=e=>{const o=e.fgColor,i=e.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Ai=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Gi=e=>{const o=e.fgColor,i=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Pi=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Ki=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Ni={headerRowID:fi,headerNumber:gi,headerCode:hi,headerString:mi,headerBoolean:vi,headerAudioUri:wi,headerVideoUri:pi,headerEmoji:bi,headerImage:yi,headerUri:dr,headerPhone:xi,headerMarkdown:Mi,headerDate:Ri,headerTime:ki,headerEmail:Si,headerReference:Ti,headerIfThenElse:zi,headerSingleValue:Ei,headerLookup:Li,headerTextTemplate:Hi,headerMath:Di,headerRollup:Ii,headerJoinStrings:Fi,headerSplitString:$i,headerGeoDistance:Ai,headerArray:Gi,rowOwnerOverlay:Pi,protectedColumnOverlay:Ki,renameIcon:Ci},Oi=hn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),Wi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Ui=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Bi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Vi=10,_i=e=>{const{canvasRef:o,cellYOffset:i,rows:d,columns:w,searchInputRef:b,searchValue:I,searchResults:p,onSearchValueChange:R,getCellsForSelection:L,onSearchResultsChanged:v,showSearch:M=!1,onSearchClose:S}=e,[P]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[U,V]=l.useState(""),me=I??U,W=l.useCallback(H=>{V(H),R==null||R(H)},[R]),[$,N]=l.useState(),we=l.useRef($);we.current=$,l.useEffect(()=>{p!==void 0&&(p.length>0?N(H=>({rowsSearched:d,results:p.length,selectedIndex:(H==null?void 0:H.selectedIndex)??-1})):N(void 0))},[d,p]);const se=l.useRef();se.current===void 0&&(se.current=new AbortController);const he=l.useRef(),[q,ee]=l.useState([]),te=p??q,X=l.useCallback(()=>{he.current!==void 0&&(window.cancelAnimationFrame(he.current),he.current=void 0,se.current.abort())},[]),qe=l.useRef(i);qe.current=i;const Le=l.useCallback(H=>{const ne=new RegExp(H.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ae=qe.current,De=Math.min(10,d),Pe=0;N(void 0),ee([]);const ft=[],Qt=async()=>{var Be;if(L===void 0)return;const Po=performance.now(),Pt=d-Pe;let ht=L({x:0,y:ae,width:w.length,height:Math.min(De,Pt,d-ae)},se.current.signal);typeof ht=="function"&&(ht=await ht());let eo=!1;for(const[pe,ke]of ht.entries())for(const[Ko,je]of ke.entries()){let Ze;switch(je.kind){case Q.Text:case Q.Number:Ze=je.displayData;break;case Q.Uri:case Q.Markdown:Ze=je.data;break;case Q.Boolean:Ze=typeof je.data=="boolean"?je.data.toString():void 0;break;case Q.Image:case Q.Bubble:Ze=je.data.join("🐳");break;case Q.Custom:Ze=je.copyData;break}Ze!==void 0&&ne.test(Ze)&&(ft.push([Ko,pe+ae]),eo=!0)}const to=performance.now();eo&&ee([...ft]),Pe+=ht.length,$o(Pe<=d);const tt=((Be=we.current)==null?void 0:Be.selectedIndex)??-1;N({results:ft.length,rowsSearched:Pe,selectedIndex:tt}),v==null||v(ft,tt),ae+De>=d?ae=0:ae+=De;const gt=to-Po,mt=Math.max(gt,1),vt=Vi/mt;De=Math.ceil(De*vt),Pe<d&&ft.length<1e3&&(he.current=window.requestAnimationFrame(Qt))};X(),he.current=window.requestAnimationFrame(Qt)},[X,w.length,L,v,d]),Re=l.useCallback(()=>{var H;S==null||S(),N(void 0),ee([]),v==null||v([],-1),X(),(H=o==null?void 0:o.current)==null||H.focus()},[X,o,S,v]),Jt=l.useCallback(H=>{W(H.target.value),p===void 0&&(H.target.value===""?(N(void 0),ee([]),X()):Le(H.target.value))},[Le,X,W,p]);l.useEffect(()=>{M&&b.current!==null&&(W(""),b.current.focus({preventScroll:!0}))},[M,b,W]);const dt=l.useCallback(H=>{var ae;if((ae=H==null?void 0:H.stopPropagation)==null||ae.call(H),$===void 0)return;const ne=($.selectedIndex+1)%$.results;N({...$,selectedIndex:ne}),v==null||v(te,ne)},[$,v,te]),He=l.useCallback(H=>{var ae;if((ae=H==null?void 0:H.stopPropagation)==null||ae.call(H),$===void 0)return;let ne=($.selectedIndex-1)%$.results;ne<0&&(ne+=$.results),N({...$,selectedIndex:ne}),v==null||v(te,ne)},[v,te,$]),Ae=l.useCallback(H=>{(H.ctrlKey||H.metaKey)&&H.nativeEvent.code==="KeyF"||H.key==="Escape"?(Re(),H.stopPropagation(),H.preventDefault()):H.key==="Enter"&&(H.shiftKey?He():dt())},[Re,dt,He]);l.useEffect(()=>()=>{X()},[X]);const[Gt,Ge]=l.useState(!1);l.useEffect(()=>{if(M)Ge(!0);else{const H=setTimeout(()=>Ge(!1),150);return()=>clearTimeout(H)}},[M]);const Go=l.useMemo(()=>{if(!M&&!Gt)return null;let H;$!==void 0&&(H=$.results>=1e3?"over 1000":`${$.results} result${$.results!==1?"s":""}`,$.selectedIndex>=0&&(H=`${$.selectedIndex+1} of ${H}`));const ne=Pe=>{Pe.stopPropagation()},De={width:`${Math.floor((($==null?void 0:$.rowsSearched)??0)/d*100)}%`};return l.createElement(Oi,{className:M?"":"out",onMouseDown:ne,onMouseMove:ne,onMouseUp:ne,onClick:ne},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:P,"aria-hidden":!M,"data-testid":"search-input",ref:b,onChange:Jt,value:me,tabIndex:M?void 0:-1,onKeyDownCapture:Ae}),l.createElement("button",{"aria-label":"Previous Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:He,disabled:(($==null?void 0:$.results)??0)===0},Wi),l.createElement("button",{"aria-label":"Next Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:dt,disabled:(($==null?void 0:$.results)??0)===0},Ui),S!==void 0&&l.createElement("button",{"aria-label":"Close Search","aria-hidden":!M,"data-testid":"search-close-button",tabIndex:M?void 0:-1,onClick:Re},Bi)),$!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},H)),l.createElement("div",{className:"gdg-search-progress",style:De})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:P},"Type to search")))},[M,Gt,$,d,P,b,Jt,me,Ae,He,dt,S,Re]);return l.createElement(l.Fragment,null,l.createElement(di,{prelightCells:te,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Go)};class Xi extends l.PureComponent{constructor(){super(...arguments);sn(this,"wrapperRef",l.createRef());sn(this,"clickOutside",i=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(i))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(i.target)){let d=i.target;for(;d!==null;){if(d.classList.contains("click-outside-ignore"))return;d=d.parentElement}this.props.onClickOutside()}})}componentDidMount(){const i=this.props.customEventTarget??document;i.addEventListener("touchend",this.clickOutside,!0),i.addEventListener("mousedown",this.clickOutside,!0),i.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const i=this.props.customEventTarget??document;i.removeEventListener("touchend",this.clickOutside,!0),i.removeEventListener("mousedown",this.clickOutside,!0),i.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:i,isOutsideClick:d,customEventTarget:w,...b}=this.props;return l.createElement("div",{...b,ref:this.wrapperRef},this.props.children)}}const Yi=()=>e=>Math.max(16,e.targetHeight-10),qi=hn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Yi(),"px"]}}),ji=e=>{const{bounds:o,group:i,onClose:d,canvasBounds:w,onFinish:b}=e,[I,p]=fe.useState(i);return fe.createElement(Xi,{style:{position:"absolute",left:o.x-w.left+1,top:o.y-w.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:d},fe.createElement(qi,{targetHeight:o.height,"data-testid":"group-rename-input",value:I,onBlur:d,onFocus:R=>R.target.setSelectionRange(0,I.length),onChange:R=>p(R.target.value),onKeyDown:R=>{R.key==="Enter"?b(I):R.key==="Escape"&&d()},autoFocus:!0}))},dn=150;function Zi(e,o,i,d){var b;const w=d(o);return((b=w==null?void 0:w.measure)==null?void 0:b.call(w,e,o,i))??dn}function fr(e,o,i,d,w,b,I,p,R){let L=0;const v=w===void 0?[]:w.map(P=>{const U=Zi(e,P[d],o,R);return L=Math.max(L,U),U});if(v.length>5&&p){L=0;let P=0;for(const V of v)P+=V;const U=P/v.length;for(let V=0;V<v.length;V++)v[V]>=U*2?v[V]=0:L=Math.max(L,v[V])}const M=e.font;e.font=o.headerFontFull,L=Math.max(L,e.measureText(i.title).width+o.cellHorizontalPadding*2+(i.icon===void 0?0:28)),e.font=M;const S=Math.max(Math.ceil(b),Math.min(Math.floor(I),Math.ceil(L)));return{...i,width:S}}function Ji(e,o,i,d,w,b,I,p,R){const L=l.useRef(o),v=l.useRef(i),M=l.useRef(I);L.current=o,v.current=i,M.current=I;const[S,P]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const $=document.createElement("canvas");return $.style.display="none",$.style.opacity="0",$.style.position="fixed",[$,$.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(S&&document.documentElement.append(S),()=>{S==null||S.remove()}),[S]);const U=l.useRef({}),V=l.useRef(),[me,W]=l.useState();return l.useLayoutEffect(()=>{const $=v.current;if($===void 0||e.every(zo))return;let N=Math.max(1,10-Math.floor(e.length/1e4)),we=0;N<L.current&&N>1&&(N--,we=1);const se={x:0,y:0,width:e.length,height:Math.min(L.current,N)},he={x:0,y:L.current-1,width:e.length,height:1};(async()=>{const ee=$(se,R.signal),te=we>0?$(he,R.signal):void 0;let X;typeof ee=="object"?X=ee:X=await er(ee),te!==void 0&&(typeof te=="object"?X=[...X,...te]:X=[...X,...await er(te)]),V.current=e,W(X)})()},[R.signal,e]),l.useMemo(()=>{let N=e.every(zo)?e:P===null?e.map(q=>zo(q)?q:{...q,width:dn}):(P.font=M.current.baseFontFull,e.map((q,ee)=>{if(zo(q))return q;if(U.current[q.id]!==void 0)return{...q,width:U.current[q.id]};if(me===void 0||V.current!==e||q.id===void 0)return{...q,width:dn};const te=fr(P,I,q,ee,me,w,b,!0,p);return U.current[q.id]=te.width,te})),we=0,se=0;const he=[];for(const[q,ee]of N.entries())we+=ee.width,ee.grow!==void 0&&ee.grow>0&&(se+=ee.grow,he.push(q));if(we<d&&he.length>0){const q=[...N],ee=d-we;let te=ee;for(let X=0;X<he.length;X++){const qe=he[X],Le=(N[qe].grow??0)/se,Re=X===he.length-1?te:Math.min(te,Math.floor(ee*Le));q[qe]={...N[qe],growOffset:Re,width:N[qe].width+Re},te-=Re}N=q}return{sizedColumns:N,nonGrowWidth:we}},[d,e,P,me,I,w,b,p])}function Qi(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function A(e,o,i){const d=hr(e,o);return d&&(i.didMatch=!0),d}function hr(e,o){if(e.length===0)return!1;if(e.includes("|")){const R=e.split("|");for(const L of R)if(hr(L,o))return!0;return!1}let i=!1,d=!1,w=!1,b=!1;const I=e.split("+"),p=I.pop();if(!Qi(p,o))return!1;if(I[0]==="any")return!0;for(const R of I)switch(R){case"ctrl":i=!0;break;case"shift":d=!0;break;case"alt":w=!0;break;case"meta":b=!0;break;case"primary":Ao.value?b=!0:i=!0;break}return o.altKey===w&&o.ctrlKey===i&&o.shiftKey===d&&o.metaKey===b}function ec(e,o,i,d,w,b,I){const p=fe.useCallback((v,M,S,P)=>{var N;(b==="cell"||b==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!I&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const U=i==="mixed"&&(S||P==="drag"),V=d==="mixed"&&U,me=w==="mixed"&&U;let W={current:v===void 0?void 0:{...v,rangeStack:P==="drag"?((N=e.current)==null?void 0:N.rangeStack)??[]:[]},columns:V?e.columns:Y.empty(),rows:me?e.rows:Y.empty()};S&&(b==="multi-rect"||b==="multi-cell")&&W.current!==void 0&&e.current!==void 0&&(W={...W,current:{...W.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(W,M)},[d,e,i,b,I,w,o]),R=fe.useCallback((v,M,S)=>{v=v??e.rows,M!==void 0&&(v=v.add(M));let P;if(w==="exclusive"&&v.length>0)P={current:void 0,columns:Y.empty(),rows:v};else{const U=S&&i==="mixed",V=S&&d==="mixed";P={current:U?e.current:void 0,columns:V?e.columns:Y.empty(),rows:v}}o(P,!1)},[d,e,i,w,o]),L=fe.useCallback((v,M,S)=>{v=v??e.columns,M!==void 0&&(v=v.add(M));let P;if(d==="exclusive"&&v.length>0)P={current:void 0,rows:Y.empty(),columns:v};else{const U=S&&i==="mixed",V=S&&w==="mixed";P={current:U?e.current:void 0,rows:V?e.rows:Y.empty(),columns:v}}o(P,!1)},[d,e,i,w,o]);return[p,R,L]}function tc(e,o,i,d,w){const b=l.useCallback(L=>{if(e===!0){const v=[];for(let M=L.y;M<L.y+L.height;M++){const S=[];for(let P=L.x;P<L.x+L.width;P++)P<0||M>=w?S.push({kind:Q.Loading,allowOverlay:!1}):S.push(o([P,M]));v.push(S)}return v}return(e==null?void 0:e(L,d.signal))??[]},[d.signal,o,e,w]),I=e!==void 0?b:void 0,p=l.useCallback(L=>{if(I===void 0)return[];const v={...L,x:L.x-i};if(v.x<0){v.x=0,v.width--;const M=I(v,d.signal);return typeof M=="function"?async()=>(await M()).map(S=>[{kind:Q.Loading,allowOverlay:!1},...S]):M.map(S=>[{kind:Q.Loading,allowOverlay:!1},...S])}return I(v,d.signal)},[d.signal,I,i]);return[e!==void 0?p:void 0,I]}function sr(e){return typeof e=="string"?e:`${e}px`}const oc=()=>e=>e.innerWidth,nc=()=>e=>e.innerHeight,rc=hn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[oc()],"w2q57ts-1":[nc()]}}),lc=e=>{const{inWidth:o,inHeight:i,children:d,...w}=e;return l.createElement(rc,{innerHeight:sr(i),innerWidth:sr(o),...w},d)},ic=2,cc=1300;function sc(e,o,i){const d=fe.useRef(0),[w,b]=e??[0,0];fe.useEffect(()=>{if(w===0&&b===0){d.current=0;return}let I=!1,p=0;const R=L=>{var v;if(!I){if(p===0)p=L;else{const M=L-p;d.current=Math.min(1,d.current+M/cc);const S=d.current**1.618*M*ic;(v=o.current)==null||v.scrollBy(w*S,b*S),p=L,i==null||i()}window.requestAnimationFrame(R)}};return window.requestAnimationFrame(R),()=>{I=!0}},[o,w,b,i])}function ac({rowHeight:e,headerHeight:o,groupHeaderHeight:i,theme:d,overscrollX:w,overscrollY:b,scaleToRem:I,remSize:p}){const[R,L,v,M,S,P]=fe.useMemo(()=>{if(!I||p===16)return[e,o,i,d,w,b];const U=p/16,V=e,me=ur();return[typeof V=="number"?V*U:W=>Math.ceil(V(W)*U),Math.ceil(o*U),Math.ceil(i*U),{...d,headerIconSize:((d==null?void 0:d.headerIconSize)??me.headerIconSize)*U,cellHorizontalPadding:((d==null?void 0:d.cellHorizontalPadding)??me.cellHorizontalPadding)*U,cellVerticalPadding:((d==null?void 0:d.cellVerticalPadding)??me.cellVerticalPadding)*U},Math.ceil((w??0)*U),Math.ceil((b??0)*U)]},[i,o,w,b,p,e,I,d]);return{rowHeight:R,headerHeight:L,groupHeaderHeight:v,theme:M,overscrollX:S,overscrollY:P}}const at={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function G(e,o){return e===!0?o:e===!1?"":e}function ar(e){const o=Ao.value;return{activateCell:G(e.activateCell," |Enter|shift+Enter"),clear:G(e.clear,"any+Escape"),closeOverlay:G(e.closeOverlay,"any+Escape"),acceptOverlayDown:G(e.acceptOverlayDown,"Enter"),acceptOverlayUp:G(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:G(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:G(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:G(e.delete,o?"Backspace|Delete":"Delete"),downFill:G(e.downFill,"primary+_68"),scrollToSelectedCell:G(e.scrollToSelectedCell,"primary+Enter"),goDownCell:G(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:G(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:G(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:G(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:G(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:G(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:G(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:G(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:G(e.goToFirstCell,"primary+Home"),goToFirstColumn:G(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:G(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:G(e.goToLastCell,"primary+End"),goToLastColumn:G(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:G(e.goToLastRow,"primary+ArrowDown"),goToNextPage:G(e.goToNextPage,"PageDown"),goToPreviousPage:G(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:G(e.rightFill,"primary+_82"),search:G(e.search,"primary+f"),selectAll:G(e.selectAll,"primary+a"),selectColumn:G(e.selectColumn,"ctrl+ "),selectGrowDown:G(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:G(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:G(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:G(e.selectGrowUp,"shift+ArrowUp"),selectRow:G(e.selectRow,"shift+ "),selectToFirstCell:G(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:G(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:G(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:G(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:G(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:G(e.selectToLastRow,"primary+shift+ArrowDown")}}function uc(e){const o=Wl(e);return fe.useMemo(()=>{if(o===void 0)return ar(at);const i={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??at.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??at.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??at.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??at.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??at.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??at.selectToLastCell};return ar({...at,...i})},[o])}function dc(e){function o(d,w,b){if(typeof d=="number")return{headerIndex:d,isCollapsed:!1,depth:w,path:b};const I={headerIndex:d.headerIndex,isCollapsed:d.isCollapsed,depth:w,path:b};return d.subGroups!==void 0&&(I.subGroups=d.subGroups.map((p,R)=>o(p,w+1,[...b,R])).sort((p,R)=>p.headerIndex-R.headerIndex)),I}return e.map((d,w)=>o(d,0,[w])).sort((d,w)=>d.headerIndex-w.headerIndex)}function gn(e,o){const i=[];function d(p,R,L=!1){let v=R!==null?R-p.headerIndex:o-p.headerIndex;if(p.subGroups!==void 0&&(v=p.subGroups[0].headerIndex-p.headerIndex),v--,i.push({rowIndex:-1,headerIndex:p.headerIndex,contentIndex:-1,skip:L,isCollapsed:p.isCollapsed,depth:p.depth,path:p.path,rows:v}),p.subGroups)for(let M=0;M<p.subGroups.length;M++){const S=M<p.subGroups.length-1?p.subGroups[M+1].headerIndex:R;d(p.subGroups[M],S,L||p.isCollapsed)}}const w=dc(e.groups);for(let p=0;p<w.length;p++){const R=p<w.length-1?w[p+1].headerIndex:null;d(w[p],R)}let b=0,I=0;for(const p of i)p.contentIndex=I,I+=p.rows,p.rowIndex=b,b+=p.isCollapsed?1:p.rows+1;return i.filter(p=>p.skip===!1).map(p=>{const{skip:R,...L}=p;return L})}function fn(e,o){if(o===void 0||gn.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let i=e;for(const d of o){if(i===0)return{path:[...d.path,-1],originalIndex:d.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:d.rows};if(d.isCollapsed)i--;else{if(i<=d.rows)return{path:[...d.path,i-1],originalIndex:d.headerIndex+i,isGroupHeader:!1,groupIndex:i-1,contentIndex:d.contentIndex+i-1,groupRows:d.rows};i=i-d.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function fc(e,o,i,d){const w=fe.useMemo(()=>e===void 0?void 0:gn(e,o),[e,o]),b=fe.useMemo(()=>w==null?void 0:w.reduce((v,M)=>(v[M.rowIndex]=M,v),{}),[w]),I=fe.useMemo(()=>w===void 0?o:w.reduce((v,M)=>v+(M.isCollapsed?1:M.rows+1),0),[w,o]),p=fe.useMemo(()=>e===void 0||typeof i=="number"&&e.height===i?i:v=>b!=null&&b[v]?e.height:typeof i=="number"?i:i(v),[b,e,i]),R=fe.useCallback(v=>{if(w===void 0)return v;let M=v;for(const S of w){if(M===0)return;if(M--,!S.isCollapsed){if(M<S.rows)return S.contentIndex+M;M-=S.rows}}return v},[w]),L=ut(d??(e==null?void 0:e.themeOverride),fe.useCallback(v=>{if(e===void 0)return d==null?void 0:d(v,v,v);if(d===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:M,contentIndex:S,groupIndex:P}=fn(v,w);return M?e.themeOverride:d==null?void 0:d(v,P,S)},[w,d,e]));return e===void 0?{rowHeight:p,rows:o,rowNumberMapper:R,getRowThemeOverride:L}:{rowHeight:p,rows:I,rowNumberMapper:R,getRowThemeOverride:L}}function hc(e,o){const i=fe.useMemo(()=>e===void 0?void 0:gn(e,o),[e,o]);return{getRowGroupingForPath:mr,updateRowGroupingByPath:gr,mapper:fe.useCallback(d=>{if(typeof d=="number")return fn(d,i);const w=fn(d[1],i);return{...w,originalIndex:[d[0],w.originalIndex]}},[i])}}function gr(e,o,i){const[d,...w]=o;return w[0]===-1?e.map((b,I)=>I===d?{...b,...i}:b):e.map((b,I)=>I===d?{...b,subGroups:gr(b.subGroups??[],w,i)}:b)}function mr(e,o){const[i,...d]=o;return d[0]===-1?e[i]:mr(e[i].subGroups??[],d)}function gc(e,o){const[i]=l.useState(()=>({value:e,callback:o,facade:{get current(){return i.value},set current(d){const w=i.value;w!==d&&(i.value=d,i.callback(d,w))}}}));return i.callback=o,i.facade}function mc(e,o,i,d,w){const[b,I]=l.useMemo(()=>[o!==void 0&&typeof i=="number"?Math.floor(o/i):0,o!==void 0&&typeof i=="number"?-(o%i):0],[o,i]),p=l.useMemo(()=>({x:d.current.x,y:b,width:d.current.width??1,height:d.current.height??1,ty:I}),[d,I,b]),[R,L,v]=Ul(p),M=l.useRef(w);M.current=w;const S=gc(null,V=>{V!==null&&o!==void 0?V.scrollTop=o:V!==null&&e!==void 0&&(V.scrollLeft=e)}),P=(R.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&S.current!==null&&P){if(S.current.scrollTop===o)return;S.current.scrollTop=o,S.current.scrollTop!==o&&v(),M.current()}},[o,P,v,S]);const U=(R.width??1)>1;return l.useLayoutEffect(()=>{if(e!==void 0&&S.current!==null&&U){if(S.current.scrollLeft===e)return;S.current.scrollLeft=e,S.current.scrollLeft!==e&&v(),M.current()}},[e,U,v,S]),{visibleRegion:R,setVisibleRegion:L,scrollRef:S}}const vc=l.lazy(async()=>await Ol(()=>import("./data-grid-overlay-editor-BghSPBKL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url));let Cc=0;function wc(e){return ui(cr(cr(e).filter(o=>o.span!==void 0).map(o=>{var i,d;return At((((i=o.span)==null?void 0:i[0])??0)+1,(((d=o.span)==null?void 0:d[1])??0)+1)})))}function Do(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(i=>({...i,x:i.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const Io={kind:Q.Loading,allowOverlay:!1},Fo={columns:Y.empty(),rows:Y.empty(),current:void 0},pc=(e,o)=>{var Zn,Jn,Qn;const[i,d]=l.useState(Fo),[w,b]=l.useState(),I=l.useRef(null),p=l.useRef(null),[R,L]=l.useState(),v=l.useRef(),M=typeof window>"u"?null:window,{imageEditorOverride:S,getRowThemeOverride:P,markdownDivCreateNode:U,width:V,height:me,columns:W,rows:$,getCellContent:N,onCellClicked:we,onCellActivated:se,onFillPattern:he,onFinishedEditing:q,coercePasteValue:ee,drawHeader:te,drawCell:X,editorBloom:qe,onHeaderClicked:Le,onColumnProposeMove:Re,rangeSelectionColumnSpanning:Jt=!0,spanRangeBehavior:dt="default",onGroupHeaderClicked:He,onCellContextMenu:Ae,className:Gt,onHeaderContextMenu:Ge,getCellsForSelection:Go,onGroupHeaderContextMenu:H,onGroupHeaderRenamed:ne,onCellEdited:ae,onCellsEdited:De,onSearchResultsChanged:Pe,searchResults:ft,onSearchValueChange:Qt,searchValue:Po,onKeyDown:Pt,onKeyUp:ht,keybindings:eo,editOnType:to=!0,onRowAppended:tt,onColumnMoved:gt,validateCell:mt,highlightRegions:vt,rangeSelect:Be="rect",columnSelect:pe="multi",rowSelect:ke="multi",rangeSelectionBlending:Ko="exclusive",columnSelectionBlending:je="exclusive",rowSelectionBlending:Ze="exclusive",onDelete:No,onDragStart:oo,onMouseMove:no,onPaste:Ct,copyHeaders:mn=!1,freezeColumns:Je=0,cellActivationBehavior:Oo="second-click",rowSelectionMode:Wo="auto",onHeaderMenuClick:ro,onHeaderIndicatorClick:lo,getGroupDetails:io,rowGrouping:ot,onSearchClose:Uo,onItemHovered:co,onSelectionCleared:nt,showSearch:vr,onVisibleRegionChanged:so,gridSelection:wt,onGridSelectionChange:Bo,minColumnWidth:Cr=50,maxColumnWidth:wr=500,maxColumnAutoWidth:pr,provideEditor:br,trailingRowOptions:B,freezeTrailingRows:Qe=0,allowedFillDirections:vn="orthogonal",scrollOffsetX:yr,scrollOffsetY:xr,verticalBorder:kt,onDragOverCell:Mr,onDrop:Rr,onColumnResize:Kt,onColumnResizeEnd:Nt,onColumnResizeStart:Ot,customRenderers:ao,fillHandle:kr,experimental:ce,fixedShadowX:Sr,fixedShadowY:Tr,headerIcons:zr,imageWindowLoader:Er,initialSize:Lr,isDraggable:Hr,onDragLeave:Dr,onRowMoved:Wt,overscrollX:Ir,overscrollY:Fr,preventDiagonalScrolling:$r,rightElement:Ar,rightElementProps:Gr,trapFocus:Cn=!1,smoothScrollX:Pr,smoothScrollY:Kr,scaleToRem:Nr=!1,rowHeight:Or=34,headerHeight:wn=36,groupHeaderHeight:Wr=wn,theme:Ur,isOutsideClick:Br,renderers:Vo,resizeIndicator:Vr,scrollToActiveCell:pn=!0,drawFocusRing:bn=!0}=e,yn=bn==="no-editor"?w===void 0:bn,re=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Ke=(re==null?void 0:re.kind)??e.rowMarkers??"none",_r=(re==null?void 0:re.width)??e.rowMarkerWidth,xn=(re==null?void 0:re.startIndex)??e.rowMarkerStartIndex??1,Mn=(re==null?void 0:re.theme)??e.rowMarkerTheme,Rn=re==null?void 0:re.headerTheme,kn=re==null?void 0:re.headerAlwaysVisible,Sn=ke!=="multi",uo=(re==null?void 0:re.checkboxStyle)??"square",St=Math.max(Cr,20),fo=Math.max(wr,St),Xr=Math.max(pr??fo,St),Tn=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:zn,rowHeight:Yr,getRowThemeOverride:et}=fc(ot,$,Or,P),qr=l.useMemo(()=>Number.parseFloat(Tn.fontSize),[Tn]),{rowHeight:rt,headerHeight:_o,groupHeaderHeight:En,theme:Ln,overscrollX:jr,overscrollY:Zr}=ac({groupHeaderHeight:Wr,headerHeight:wn,overscrollX:Ir,overscrollY:Fr,remSize:qr,rowHeight:Yr,scaleToRem:Nr,theme:Ur}),lt=uc(eo),Tt=_r??($>1e4?48:$>1e3?44:$>100?36:32),Ve=Ke!=="none",a=Ve?1:0,oe=tt!==void 0,Ut=(B==null?void 0:B.sticky)===!0,[Jr,Hn]=l.useState(!1),Qr=vr??Jr,el=l.useCallback(()=>{Uo!==void 0?Uo():Hn(!1)},[Uo]),h=l.useMemo(()=>wt===void 0?void 0:Do(wt,a),[wt,a])??i,Se=l.useRef();Se.current===void 0&&(Se.current=new AbortController),l.useEffect(()=>()=>Se==null?void 0:Se.current.abort(),[]);const[ge,tl]=tc(Go,N,a,Se.current,F),ol=l.useCallback((t,r,n)=>{if(mt===void 0)return!0;const c=[t[0]-a,t[1]];return mt==null?void 0:mt(c,r,n)},[a,mt]),ho=l.useRef(wt),Ie=l.useCallback((t,r)=>{r&&(t=Bl(t,ge,a,dt,Se.current)),Bo!==void 0?(ho.current=Do(t,-a),Bo(ho.current)):d(t)},[Bo,ge,a,dt]),zt=ut(Kt,l.useCallback((t,r,n,c)=>{Kt==null||Kt(W[n-a],r,n-a,c)},[Kt,a,W])),nl=ut(Nt,l.useCallback((t,r,n,c)=>{Nt==null||Nt(W[n-a],r,n-a,c)},[Nt,a,W])),rl=ut(Ot,l.useCallback((t,r,n,c)=>{Ot==null||Ot(W[n-a],r,n-a,c)},[Ot,a,W])),ll=ut(te,l.useCallback((t,r)=>(te==null?void 0:te({...t,columnIndex:t.columnIndex-a},r))??!1,[te,a])),il=ut(X,l.useCallback((t,r)=>(X==null?void 0:X({...t,col:t.col-a},r))??!1,[X,a])),it=l.useCallback(t=>{if(No!==void 0){const r=No(Do(t,-a));return typeof r=="boolean"?r:Do(r,a)}return!0},[No,a]),[be,ye,ue]=ec(h,Ie,Ko,je,Ze,Be,Jt),ve=l.useMemo(()=>an(ur(),Ln),[Ln]),[Xo,cl]=l.useState([0,0,0]),Dn=l.useMemo(()=>{if(Vo===void 0)return{};const t={};for(const r of Vo)t[r.kind]=r;return t},[Vo]),xe=l.useCallback(t=>t.kind!==Q.Custom?Dn[t.kind]:ao==null?void 0:ao.find(r=>r.isMatch(t)),[ao,Dn]);let{sizedColumns:Te,nonGrowWidth:In}=Ji(W,F,tl,Xo[0]-(a===0?0:Tt)-Xo[2],St,Xr,ve,xe,Se.current);Ke!=="none"&&(In+=Tt);const Yo=l.useMemo(()=>Te.some(t=>t.group!==void 0),[Te]),Bt=Yo?_o+En:_o,Fn=h.rows.length,$n=Ke==="none"?void 0:Fn===0?!1:Fn===F?!0:void 0,_=l.useMemo(()=>Ke==="none"?Te:[{title:"",width:Tt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Mn,rowMarker:uo,rowMarkerChecked:$n,headerRowMarkerTheme:Rn,headerRowMarkerAlwaysVisible:kn,headerRowMarkerDisabled:Sn},...Te],[Ke,Te,Tt,Mn,uo,$n,Rn,kn,Sn]),ze=l.useRef({height:1,width:1,x:0,y:0}),go=l.useRef(!1),{setVisibleRegion:An,visibleRegion:pt,scrollRef:j}=mc(yr,xr,rt,ze,()=>go.current=!0);ze.current=pt;const sl=pt.x+a,mo=pt.y,de=l.useRef(null),Me=l.useCallback(t=>{var r;t===!0?(r=de.current)==null||r.focus():window.requestAnimationFrame(()=>{var n;(n=de.current)==null||n.focus()})},[]),Ce=oe?F+1:F,Fe=l.useCallback(t=>{const r=a===0?t:t.map(c=>({...c,location:[c.location[0]-a,c.location[1]]})),n=De==null?void 0:De(r);if(n!==!0)for(const c of r)ae==null||ae(c.location,c.value);return n},[ae,De,a]),[bt,qo]=l.useState(),vo=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,Et=yn?(Zn=h.current)==null?void 0:Zn.cell:void 0,Co=Et==null?void 0:Et[0],wo=Et==null?void 0:Et[1],al=l.useMemo(()=>{if((vt===void 0||vt.length===0)&&(vo??Co??wo??bt)===void 0)return;const t=[];if(vt!==void 0)for(const r of vt){const n=_.length-r.range.x-a;n>0&&t.push({color:r.color,range:{...r.range,x:r.range.x+a,width:Math.min(n,r.range.width)},style:r.style})}return bt!==void 0&&t.push({color:tr(ve.accentColor,0),range:bt,style:"dashed"}),vo!==void 0&&t.push({color:tr(ve.accentColor,.5),range:vo,style:"solid-outline"}),Co!==void 0&&wo!==void 0&&t.push({color:ve.accentColor,range:{x:Co,y:wo,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0},[bt,vo,Co,wo,vt,_.length,ve.accentColor,a]),Gn=l.useRef(_);Gn.current=_;const Ee=l.useCallback(([t,r],n=!1)=>{var g,u,f,m,C,y,T;const c=oe&&r===Ce-1;if(t===0&&Ve){if(c)return Io;const x=zn(r);return x===void 0?Io:{kind:Eo.Marker,allowOverlay:!1,checkboxStyle:uo,checked:(h==null?void 0:h.rows.hasIndex(r))===!0,markerKind:Ke==="clickable-number"?"number":Ke,row:xn+x,drawHandle:Wt!==void 0,cursor:Ke==="clickable-number"?"pointer":void 0}}else if(c){const E=t===a?(B==null?void 0:B.hint)??"":"",k=Gn.current[t];if(((g=k==null?void 0:k.trailingRowOptions)==null?void 0:g.disabled)===!0)return Io;{const K=((u=k==null?void 0:k.trailingRowOptions)==null?void 0:u.hint)??E,D=((f=k==null?void 0:k.trailingRowOptions)==null?void 0:f.addIcon)??(B==null?void 0:B.addIcon);return{kind:Eo.NewRow,hint:K,allowOverlay:!1,icon:D}}}else{const x=t-a;if(n||(ce==null?void 0:ce.strict)===!0){const k=ze.current,K=k.x>x||x>k.x+k.width||k.y>r||r>k.y+k.height||r>=Zo.current,D=x===((C=(m=k.extras)==null?void 0:m.selected)==null?void 0:C[0])&&r===((y=k.extras)==null?void 0:y.selected[1]);let z=!1;if(((T=k.extras)==null?void 0:T.freezeRegions)!==void 0){for(const O of k.extras.freezeRegions)if(Vl(O,x,r)){z=!0;break}}if(K&&!D&&!z)return Io}let E=N([x,r]);return a!==0&&E.span!==void 0&&(E={...E,span:[E.span[0]+a,E.span[1]+a]}),E}},[oe,Ce,Ve,zn,uo,h==null?void 0:h.rows,Ke,xn,Wt,a,B==null?void 0:B.hint,B==null?void 0:B.addIcon,ce==null?void 0:ce.strict,N]),jo=l.useCallback(t=>{let r=(io==null?void 0:io(t))??{name:t};return ne!==void 0&&t!==""&&(r={icon:r.icon,name:r.name,overrideTheme:r.overrideTheme,actions:[...r.actions??[],{title:"Rename",icon:"renameIcon",onClick:n=>Qo({group:r.name,bounds:n.bounds})}]}),r},[io,ne]),po=l.useCallback(t=>{var f;const[r,n]=t.cell,c=_[r],s=(c==null?void 0:c.group)!==void 0?(f=jo(c.group))==null?void 0:f.overrideTheme:void 0,g=c==null?void 0:c.themeOverride,u=et==null?void 0:et(n);b({...t,theme:an(ve,s,g,u,t.content.themeOverride)})},[et,_,jo,ve]),Lt=l.useCallback((t,r,n)=>{var u;if(h.current===void 0)return;const[c,s]=h.current.cell,g=Ee([c,s]);if(g.kind!==Q.Boolean&&g.allowOverlay){let f=g;if(n!==void 0)switch(f.kind){case Q.Number:{const m=_l(()=>n==="-"?-0:Number.parseFloat(n),0);f={...f,data:Number.isNaN(m)?0:m};break}case Q.Text:case Q.Markdown:case Q.Uri:f={...f,data:n};break}po({target:t,content:f,initialValue:n,cell:[c,s],highlight:n===void 0,forceEditMode:n!==void 0})}else g.kind===Q.Boolean&&r&&g.readonly!==!0&&(Fe([{location:h.current.cell,value:{...g,data:Xl(g.data)}}]),(u=de.current)==null||u.damage([{cell:h.current.cell}]))},[Ee,h,Fe,po]),Pn=l.useCallback((t,r)=>{var s;const n=(s=de.current)==null?void 0:s.getBounds(t,r);if(n===void 0||j.current===null)return;const c=Ee([t,r]);c.allowOverlay&&po({target:n,content:c,initialValue:void 0,highlight:!0,cell:[t,r],forceEditMode:!0})},[Ee,j,po]),le=l.useCallback((t,r,n="both",c=0,s=0,g=void 0)=>{if(j.current!==null){const u=de.current,f=p.current,m=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,C=typeof r!="number"?r.unit==="cell"?r.amount:void 0:r,y=typeof t!="number"&&t.unit==="px"?t.amount:void 0,T=typeof r!="number"&&r.unit==="px"?r.amount:void 0;if(u!==null&&f!==null){let x={x:0,y:0,width:0,height:0},E=0,k=0;if((m!==void 0||C!==void 0)&&(x=u.getBounds((m??0)+a,C??0)??x,x.width===0||x.height===0))return;const K=f.getBoundingClientRect(),D=K.width/f.offsetWidth;if(y!==void 0&&(x={...x,x:y-K.left-j.current.scrollLeft,width:1}),T!==void 0&&(x={...x,y:T+K.top-j.current.scrollTop,height:1}),x!==void 0){const z={x:x.x-c,y:x.y-s,width:x.width+2*c,height:x.height+2*s};let O=0;for(let cn=0;cn<Je;cn++)O+=Te[cn].width;let J=0;const ie=Qe+(Ut?1:0);ie>0&&(J=Yl(Ce,ie,rt));let We=O*D+K.left+a*Tt*D,Xe=K.right,Ue=K.top+Bt*D,Ye=K.bottom-J*D;const So=x.width+c*2;switch(g==null?void 0:g.hAlign){case"start":Xe=We+So;break;case"end":We=Xe-So;break;case"center":We=Math.floor((We+Xe)/2)-So/2,Xe=We+So;break}const To=x.height+s*2;switch(g==null?void 0:g.vAlign){case"start":Ye=Ue+To;break;case"end":Ue=Ye-To;break;case"center":Ue=Math.floor((Ue+Ye)/2)-To/2,Ye=Ue+To;break}We>z.x?E=z.x-We:Xe<z.x+z.width&&(E=z.x+z.width-Xe),Ue>z.y?k=z.y-Ue:Ye<z.y+z.height&&(k=z.y+z.height-Ye),n==="vertical"||typeof t=="number"&&t<Je?E=0:(n==="horizontal"||typeof r=="number"&&r>=Ce-ie)&&(k=0),(E!==0||k!==0)&&(D!==1&&(E/=D,k/=D),j.current.scrollTo(E+j.current.scrollLeft,k+j.current.scrollTop))}}}},[a,Qe,Tt,j,Bt,Je,Te,Ce,Ut,rt]),Kn=l.useRef(Pn),Nn=l.useRef(N),Zo=l.useRef(F);Kn.current=Pn,Nn.current=N,Zo.current=F;const Ht=l.useCallback(async(t,r=!0)=>{var m;const n=_[t];if(((m=n==null?void 0:n.trailingRowOptions)==null?void 0:m.disabled)===!0)return;const c=tt==null?void 0:tt();let s,g=!0;c!==void 0&&(s=await c,s==="top"&&(g=!1),typeof s=="number"&&(g=!1));let u=0;const f=()=>{if(Zo.current<=F){u<500&&window.setTimeout(f,u),u=50+u*2;return}const C=typeof s=="number"?s:g?F:0;ko.current(t-a,C),be({cell:[t,C],range:{x:t,y:C,width:1,height:1}},!1,!1,"edit");const y=Nn.current([t-a,C]);y.allowOverlay&&Ho(y)&&y.readonly!==!0&&r&&window.setTimeout(()=>{Kn.current(t,C)},0)};f()},[_,tt,a,F,be]),bo=l.useCallback(t=>{var n,c;const r=((c=(n=Te[t])==null?void 0:n.trailingRowOptions)==null?void 0:c.targetColumn)??(B==null?void 0:B.targetColumn);if(typeof r=="number")return r+(Ve?1:0);if(typeof r=="object"){const s=W.indexOf(r);if(s>=0)return s+(Ve?1:0)}},[Te,W,Ve,B==null?void 0:B.targetColumn]),ct=l.useRef(),Dt=l.useRef(),Vt=l.useCallback((t,r)=>{var s;const[n,c]=r;return an(ve,(s=_[n])==null?void 0:s.themeOverride,et==null?void 0:et(c),t.themeOverride)},[et,_,ve]),{mapper:yt}=hc(ot,$),Ne=ot==null?void 0:ot.navigationBehavior,_t=l.useCallback(t=>{var y,T,x;const r=Ao.value?t.metaKey:t.ctrlKey,n=r&&ke==="multi",c=r&&pe==="multi",[s,g]=t.location,u=h.columns,f=h.rows,[m,C]=((y=h.current)==null?void 0:y.cell)??[];if(t.kind==="cell"){if(Dt.current=void 0,xt.current=[s,g],s===0&&Ve){if(oe===!0&&g===F||Ke==="number"||ke==="none")return;const E=Ee(t.location);if(E.kind!==Eo.Marker)return;if(Wt!==void 0){const D=xe(E);$o((D==null?void 0:D.kind)===Eo.Marker);const z=(T=D==null?void 0:D.onClick)==null?void 0:T.call(D,{...t,cell:E,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:Vt(E,t.location),preventDefault:()=>{}});if(z===void 0||z.checked===E.checked)return}b(void 0),Me();const k=f.hasIndex(g),K=ct.current;if(ke==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&K!==void 0&&f.hasIndex(K)){const D=[Math.min(K,g),Math.max(K,g)+1];n||Wo==="multi"?ye(void 0,D,!0):ye(Y.fromSingleSelection(D),void 0,n)}else ke==="multi"&&(n||t.isTouch||Wo==="multi")?k?ye(f.remove(g),void 0,!0):(ye(void 0,g,!0),ct.current=g):k&&f.length===1?ye(Y.empty(),void 0,r):(ye(Y.fromSingleSelection(g),void 0,r),ct.current=g)}else if(s>=a&&oe&&g===F){const E=bo(s);Ht(E??s)}else if(m!==s||C!==g){const E=Ee(t.location),k=xe(E);if((k==null?void 0:k.onSelect)!==void 0){let z=!1;if(k.onSelect({...t,cell:E,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>z=!0,theme:Vt(E,t.location)}),z)return}if(Ne==="block"&&yt(g).isGroupHeader)return;const K=Ut&&g===F,D=Ut&&h!==void 0&&((x=h.current)==null?void 0:x.cell[1])===F;if((t.shiftKey||t.isLongTouch===!0)&&m!==void 0&&C!==void 0&&h.current!==void 0&&!D){if(K)return;const z=Math.min(s,m),O=Math.max(s,m),J=Math.min(g,C),ie=Math.max(g,C);be({...h.current,range:{x:z,y:J,width:O-z+1,height:ie-J+1}},!0,r,"click"),ct.current=void 0,Me()}else be({cell:[s,g],range:{x:s,y:g,width:1,height:1}},!0,r,"click"),ct.current=void 0,b(void 0),Me()}}else if(t.kind==="header")if(xt.current=[s,g],b(void 0),Ve&&s===0)ct.current=void 0,Dt.current=void 0,ke==="multi"&&(f.length!==F?ye(Y.fromSingleSelection([0,F]),void 0,r):ye(Y.empty(),void 0,r),Me());else{const E=Dt.current;if(pe==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&E!==void 0&&u.hasIndex(E)){const k=[Math.min(E,s),Math.max(E,s)+1];c?ue(void 0,k,r):ue(Y.fromSingleSelection(k),void 0,r)}else c?(u.hasIndex(s)?ue(u.remove(s),void 0,r):ue(void 0,s,r),Dt.current=s):pe!=="none"&&(ue(Y.fromSingleSelection(s),void 0,r),Dt.current=s);ct.current=void 0,Me()}else t.kind===$t?xt.current=[s,g]:t.kind===or&&!t.isMaybeScrollbar&&(Ie(Fo,!1),b(void 0),Me(),nt==null||nt(),ct.current=void 0,Dt.current=void 0)},[ke,pe,h,Ve,a,oe,F,Ke,Ee,Wt,Me,Wo,xe,Vt,ye,bo,Ht,Ne,yt,Ut,be,ue,Ie,nt]),Xt=l.useRef(!1),xt=l.useRef(),On=l.useRef(pt),$e=l.useRef(),ul=l.useCallback(t=>{if(It.current=!1,On.current=ze.current,t.button!==0&&t.button!==1){$e.current=void 0;return}const r=performance.now();$e.current={button:t.button,time:r,location:t.location},(t==null?void 0:t.kind)==="header"&&(Xt.current=!0);const n=t.kind==="cell"&&t.isFillHandle;!n&&t.kind!=="cell"&&t.isEdge||(L({previousSelection:h,fillHandle:n}),xt.current=void 0,!t.isTouch&&t.button===0&&!n?_t(t):!t.isTouch&&t.button===1&&(xt.current=t.location))},[h,_t]),[Jo,Qo]=l.useState(),Wn=l.useCallback(t=>{if(t.kind!==$t||pe!=="multi")return;const r=Ao.value?t.metaKey:t.ctrlKey,[n]=t.location,c=h.columns;if(n<a)return;const s=_[n];let g=n,u=n;for(let f=n-1;f>=a&&nr(s.group,_[f].group);f--)g--;for(let f=n+1;f<_.length&&nr(s.group,_[f].group);f++)u++;if(Me(),r)if(c.hasAll([g,u+1])){let f=c;for(let m=g;m<=u;m++)f=f.remove(m);ue(f,void 0,r)}else ue(void 0,[g,u+1],r);else ue(Y.fromSingleSelection([g,u+1]),void 0,r)},[pe,Me,h.columns,_,a,ue]),It=l.useRef(!1),yo=l.useCallback(async t=>{if(ge!==void 0&&zt!==void 0){const r=ze.current.y,n=ze.current.height;let c=ge({x:t,y:r,width:1,height:Math.min(n,F-r)},Se.current.signal);typeof c!="object"&&(c=await c());const s=Te[t-a],u=document.createElement("canvas").getContext("2d",{alpha:!1});if(u!==null){u.font=ve.baseFontFull;const f=fr(u,ve,s,0,c,St,fo,!1,xe);zt==null||zt(s,f.width,t,f.width)}}},[Te,ge,fo,ve,St,zt,a,F,xe]),[dl,en]=l.useState(),Ft=l.useCallback(async(t,r)=>{var f,m;const n=(f=t.current)==null?void 0:f.range;if(n===void 0||ge===void 0||r.current===void 0)return;const c=r.current.range;if(he!==void 0){let C=!1;if(he({fillDestination:{...c,x:c.x-a},patternSource:{...n,x:n.x-a},preventDefault:()=>C=!0}),C)return}let s=ge(n,Se.current.signal);typeof s!="object"&&(s=await s());const g=s,u=[];for(let C=0;C<c.width;C++)for(let y=0;y<c.height;y++){const T=[c.x+C,c.y+y];if(ql(T,n))continue;const x=g[y%n.height][C%n.width];Lo(x)||!Ho(x)||u.push({location:T,value:{...x}})}Fe(u),(m=de.current)==null||m.damage(u.map(C=>({cell:C.location})))},[ge,Fe,he,a]),Un=l.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const t={...h,current:{...h.current,range:{...h.current.range,width:1}}};Ft(t,h)},[Ft,h]),Bn=l.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const t={...h,current:{...h.current,range:{...h.current.range,height:1}}};Ft(t,h)},[Ft,h]),fl=l.useCallback((t,r)=>{var y,T;const n=R;if(L(void 0),qo(void 0),en(void 0),Xt.current=!1,r)return;if((n==null?void 0:n.fillHandle)===!0&&h.current!==void 0&&((y=n.previousSelection)==null?void 0:y.current)!==void 0){if(bt===void 0)return;const x={...h,current:{...h.current,range:jl(n.previousSelection.current.range,bt)}};Ft(n.previousSelection,x),Ie(x,!0);return}const[c,s]=t.location,[g,u]=xt.current??[],f=()=>{It.current=!0},m=x=>{var k,K,D;const E=x.isTouch||g===c&&u===s;if(E&&(we==null||we([c-a,s],{...x,preventDefault:f})),x.button===1)return!It.current;if(!It.current){const z=Ee(t.location),O=xe(z);if(O!==void 0&&O.onClick!==void 0&&E){const ie=O.onClick({...x,cell:z,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:Vt(z,t.location),preventDefault:f});ie!==void 0&&!Lo(ie)&&Zt(ie)&&(Fe([{location:x.location,value:ie}]),(k=de.current)==null||k.damage([{cell:x.location}]))}if(It.current||h.current===void 0)return!1;let J=!1;switch(z.activationBehaviorOverride??Oo){case"double-click":case"second-click":{if(((D=(K=n==null?void 0:n.previousSelection)==null?void 0:K.current)==null?void 0:D.cell)===void 0)break;const[ie,We]=h.current.cell,[Xe,Ue]=n.previousSelection.current.cell;J=c===ie&&c===Xe&&s===We&&s===Ue&&(x.isDoubleClick===!0||Oo==="second-click");break}case"single-click":{J=!0;break}}if(J)return se==null||se([c-a,s]),Lt(x.bounds,!1),!0}return!1},C=t.location[0]-a;if(t.isTouch){const x=ze.current,E=On.current;if(x.x!==E.x||x.y!==E.y)return;if(t.isLongTouch===!0){if(t.kind==="cell"&&Zl((T=h.current)==null?void 0:T.cell,t.location)){Ae==null||Ae([C,t.location[1]],{...t,preventDefault:f});return}else if(t.kind==="header"&&h.columns.hasIndex(c)){Ge==null||Ge(C,{...t,preventDefault:f});return}else if(t.kind===$t){if(C<0)return;H==null||H(C,{...t,preventDefault:f});return}}t.kind==="cell"?m(t)||_t(t):t.kind===$t?He==null||He(C,{...t,preventDefault:f}):(t.kind===Jl&&(Le==null||Le(C,{...t,preventDefault:f})),_t(t));return}if(t.kind==="header"){if(C<0)return;t.isEdge?t.isDoubleClick===!0&&yo(c):t.button===0&&c===g&&s===u&&(Le==null||Le(C,{...t,preventDefault:f}))}if(t.kind===$t){if(C<0)return;t.button===0&&c===g&&s===u&&(He==null||He(C,{...t,preventDefault:f}),It.current||Wn(t))}t.kind==="cell"&&(t.button===0||t.button===1)&&m(t),xt.current=void 0},[R,h,a,bt,Ft,Ie,we,Ee,xe,Oo,Vt,Fe,se,Lt,Ae,Ge,H,_t,He,Le,yo,Wn]),hl=l.useCallback(t=>{const r={...t,location:[t.location[0]-a,t.location[1]]};no==null||no(r),R!==void 0&&t.buttons===0&&(L(void 0),qo(void 0),en(void 0),Xt.current=!1),en(n=>{var c;return Xt.current?[t.scrollEdge[0],0]:t.scrollEdge[0]===(n==null?void 0:n[0])&&t.scrollEdge[1]===n[1]?n:R===void 0||(((c=$e.current)==null?void 0:c.location[0])??0)<a?void 0:t.scrollEdge})},[R,no,a]),gl=l.useCallback((t,r)=>{ro==null||ro(t-a,r)},[ro,a]),ml=l.useCallback((t,r)=>{lo==null||lo(t-a,r)},[lo,a]),_e=(Jn=h==null?void 0:h.current)==null?void 0:Jn.cell,vl=l.useCallback((t,r,n,c,s,g)=>{go.current=!1;let u=_e;u!==void 0&&(u=[u[0]-a,u[1]]);const f=Je===0?void 0:{x:0,y:t.y,width:Je,height:t.height},m=[];f!==void 0&&m.push(f),Qe>0&&(m.push({x:t.x-a,y:F-Qe,width:t.width,height:Qe}),Je>0&&m.push({x:0,y:F-Qe,width:Je,height:Qe}));const C={x:t.x-a,y:t.y,width:t.width,height:oe&&t.y+t.height>=F?t.height-1:t.height,tx:s,ty:g,extras:{selected:u,freezeRegion:f,freezeRegions:m}};ze.current=C,An(C),cl([r,n,c]),so==null||so(C,C.tx,C.ty,C.extras)},[_e,a,oe,F,Je,Qe,An,so]),Cl=ut(Re,l.useCallback((t,r)=>(Re==null?void 0:Re(t-a,r-a))!==!1,[Re,a])),wl=ut(gt,l.useCallback((t,r)=>{gt==null||gt(t-a,r-a),pe!=="none"&&ue(Y.fromSingleSelection(r),void 0,!0)},[pe,gt,a,ue])),tn=l.useRef(!1),pl=l.useCallback(t=>{if(t.location[0]===0&&a>0){t.preventDefault();return}oo==null||oo({...t,location:[t.location[0]-a,t.location[1]]}),t.defaultPrevented()||(tn.current=!0),L(void 0)},[oo,a]),bl=l.useCallback(()=>{tn.current=!1},[]),Vn=ot==null?void 0:ot.selectionBehavior,xo=l.useCallback(t=>{if(Vn!=="block-spanning")return;const{isGroupHeader:r,path:n,groupRows:c}=yt(t);if(r)return[t,t];const s=n[n.length-1],g=t-s,u=t+c-s-1;return[g,u]},[yt,Vn]),on=l.useRef(),nn=l.useCallback(t=>{var r,n,c;if(!Ql(t,on.current)&&(on.current=t,!(((r=$e==null?void 0:$e.current)==null?void 0:r.button)!==void 0&&$e.current.button>=1))){if(t.buttons!==0&&R!==void 0&&((n=$e.current)==null?void 0:n.location[0])===0&&t.location[0]===0&&a===1&&ke==="multi"&&R.previousSelection&&!R.previousSelection.rows.hasIndex($e.current.location[1])&&h.rows.hasIndex($e.current.location[1])){const s=Math.min($e.current.location[1],t.location[1]),g=Math.max($e.current.location[1],t.location[1])+1;ye(Y.fromSingleSelection([s,g]),void 0,!1)}if(t.buttons!==0&&R!==void 0&&h.current!==void 0&&!tn.current&&!Xt.current&&(Be==="rect"||Be==="multi-rect")){const[s,g]=h.current.cell;let[u,f]=t.location;if(f<0&&(f=ze.current.y),R.fillHandle===!0&&((c=R.previousSelection)==null?void 0:c.current)!==void 0){const m=R.previousSelection.current.range;f=Math.min(f,oe?F-1:F);const C=ei(m,u,f,vn);qo(C)}else{if(oe&&g===F)return;if(oe&&f===F)if(t.kind===or)f--;else return;u=Math.max(u,a);const y=xo(g);f=y===void 0?f:Rt(f,y[0],y[1]);const T=u-s,x=f-g,E={x:T>=0?s:u,y:x>=0?g:f,width:Math.abs(T)+1,height:Math.abs(x)+1};be({...h.current,range:E},!0,!1,"drag")}}co==null||co({...t,location:[t.location[0]-a,t.location[1]]})}},[R,a,ke,h,Be,co,ye,oe,F,vn,xo,be]),yl=l.useCallback(()=>{var u,f;const t=on.current;if(t===void 0)return;const[r,n]=t.scrollEdge;let[c,s]=t.location;const g=ze.current;r===-1?c=((f=(u=g.extras)==null?void 0:u.freezeRegion)==null?void 0:f.x)??g.x:r===1&&(c=g.x+g.width),n===-1?s=Math.max(0,g.y):n===1&&(s=Math.min(F-1,g.y+g.height)),c=Rt(c,0,_.length-1),s=Rt(s,0,F-1),nn({...t,location:[c,s]})},[_.length,nn,F]);sc(dl,j,yl);const Oe=l.useCallback(t=>{if(h.current===void 0)return;const[r,n]=t,[c,s]=h.current.cell,g=h.current.range;let u=g.x,f=g.x+g.width,m=g.y,C=g.y+g.height;const[y,T]=xo(s)??[0,F-1],x=T+1;if(n!==0)switch(n){case 2:{C=x,m=s,le(0,C,"vertical");break}case-2:{m=y,C=s+1,le(0,m,"vertical");break}case 1:{m<s?(m++,le(0,m,"vertical")):(C=Math.min(x,C+1),le(0,C,"vertical"));break}case-1:{C>s+1?(C--,le(0,C,"vertical")):(m=Math.max(y,m-1),le(0,m,"vertical"));break}default:rr()}if(r!==0)if(r===2)f=_.length,u=c,le(f-1-a,0,"horizontal");else if(r===-2)u=a,f=c+1,le(u-a,0,"horizontal");else{let E=[];if(ge!==void 0){const k=ge({x:u,y:m,width:f-u-a,height:C-m},Se.current.signal);typeof k=="object"&&(E=wc(k))}if(r===1){let k=!1;if(u<c){if(E.length>0){const K=At(u+1,c+1).find(D=>!E.includes(D-a));K!==void 0&&(u=K,k=!0)}else u++,k=!0;k&&le(u,0,"horizontal")}k||(f=Math.min(_.length,f+1),le(f-1-a,0,"horizontal"))}else if(r===-1){let k=!1;if(f>c+1){if(E.length>0){const K=At(f-1,c,-1).find(D=>!E.includes(D-a));K!==void 0&&(f=K,k=!0)}else f--,k=!0;k&&le(f-a,0,"horizontal")}k||(u=Math.max(a,u-1),le(u-a,0,"horizontal"))}else rr()}be({cell:h.current.cell,range:{x:u,y:m,width:f-u,height:C-m}},!0,!1,"keyboard-select")},[ge,xo,h,_.length,a,F,le,be]),rn=l.useRef(pn);rn.current=pn;const st=l.useCallback((t,r,n,c)=>{const s=Ce-(n?0:1);t=Rt(t,a,Te.length-1+a),r=Rt(r,0,s);const g=_e==null?void 0:_e[0],u=_e==null?void 0:_e[1];if(t===g&&r===u)return!1;if(c&&h.current!==void 0){const f=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&f.push(h.current.range),Ie({...h,current:{cell:[t,r],range:{x:t,y:r,width:1,height:1},rangeStack:f}},!0)}else be({cell:[t,r],range:{x:t,y:r,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===t&&v.current[1]===r&&(v.current=void 0),rn.current&&le(t-a,r),!0},[Ce,a,Te.length,_e,h,le,Ie,be]),xl=l.useCallback((t,r)=>{(w==null?void 0:w.cell)!==void 0&&t!==void 0&&Zt(t)&&(Fe([{location:w.cell,value:t}]),window.requestAnimationFrame(()=>{var s;(s=de.current)==null||s.damage([{cell:w.cell}])})),Me(!0),b(void 0);const[n,c]=r;if(h.current!==void 0&&(n!==0||c!==0)){const s=h.current.cell[1]===Ce-1&&t!==void 0;st(Rt(h.current.cell[0]+n,0,_.length-1),Rt(h.current.cell[1]+c,0,Ce-1),s,!1)}q==null||q(t,r)},[w==null?void 0:w.cell,Me,h,q,Fe,Ce,st,_.length]),Ml=l.useMemo(()=>`gdg-overlay-${Cc++}`,[]),Mt=l.useCallback(t=>{var n,c,s,g;Me();const r=[];for(let u=t.x;u<t.x+t.width;u++)for(let f=t.y;f<t.y+t.height;f++){const m=N([u-a,f]);if(!m.allowOverlay&&m.kind!==Q.Boolean)continue;let C;if(m.kind===Q.Custom){const y=xe(m),T=(n=y==null?void 0:y.provideEditor)==null?void 0:n.call(y,m);(y==null?void 0:y.onDelete)!==void 0?C=y.onDelete(m):ti(T)&&(C=(c=T==null?void 0:T.deletedValue)==null?void 0:c.call(T,m))}else if(Zt(m)&&m.allowOverlay||m.kind===Q.Boolean){const y=xe(m);C=(s=y==null?void 0:y.onDelete)==null?void 0:s.call(y,m)}C!==void 0&&!Lo(C)&&Zt(C)&&r.push({location:[u,f],value:C})}Fe(r),(g=de.current)==null||g.damage(r.map(u=>({cell:u.location})))},[Me,N,xe,Fe,a]),Yt=w!==void 0,_n=l.useCallback(t=>{var K,D;const r=()=>{t.stopPropagation(),t.preventDefault()},n={didMatch:!1},{bounds:c}=t,s=h.columns,g=h.rows,u=lt;if(!Yt&&A(u.clear,t,n))Ie(Fo,!1),nt==null||nt();else if(!Yt&&A(u.selectAll,t,n))Ie({columns:Y.empty(),rows:Y.empty(),current:{cell:((K=h.current)==null?void 0:K.cell)??[a,0],range:{x:a,y:0,width:W.length,height:F},rangeStack:[]}},!1);else if(A(u.search,t,n))(D=I==null?void 0:I.current)==null||D.focus({preventScroll:!0}),Hn(!0);else if(A(u.delete,t,n)){const z=(it==null?void 0:it(h))??!0;if(z!==!1){const O=z===!0?h:z;if(O.current!==void 0){Mt(O.current.range);for(const J of O.current.rangeStack)Mt(J)}for(const J of O.rows)Mt({x:a,y:J,width:W.length,height:1});for(const J of O.columns)Mt({x:J,y:0,width:1,height:F})}}if(n.didMatch)return r(),!0;if(h.current===void 0)return!1;let[f,m]=h.current.cell;const[,C]=h.current.cell;let y=!1,T=!1;if(A(u.scrollToSelectedCell,t,n)?ko.current(f-a,m):pe!=="none"&&A(u.selectColumn,t,n)?s.hasIndex(f)?ue(s.remove(f),void 0,!0):pe==="single"?ue(Y.fromSingleSelection(f),void 0,!0):ue(void 0,f,!0):ke!=="none"&&A(u.selectRow,t,n)?g.hasIndex(m)?ye(g.remove(m),void 0,!0):ke==="single"?ye(Y.fromSingleSelection(m),void 0,!0):ye(void 0,m,!0):!Yt&&c!==void 0&&A(u.activateCell,t,n)?m===F&&oe?window.setTimeout(()=>{const z=bo(f);Ht(z??f)},0):(se==null||se([f-a,m]),Lt(c,!0)):h.current.range.height>1&&A(u.downFill,t,n)?Bn():h.current.range.width>1&&A(u.rightFill,t,n)?Un():A(u.goToNextPage,t,n)?m+=Math.max(1,ze.current.height-4):A(u.goToPreviousPage,t,n)?m-=Math.max(1,ze.current.height-4):A(u.goToFirstCell,t,n)?(b(void 0),m=0,f=0):A(u.goToLastCell,t,n)?(b(void 0),m=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):A(u.selectToFirstCell,t,n)?(b(void 0),Oe([-2,-2])):A(u.selectToLastCell,t,n)?(b(void 0),Oe([2,2])):Yt?(A(u.closeOverlay,t,n)&&b(void 0),A(u.acceptOverlayDown,t,n)&&(b(void 0),m++),A(u.acceptOverlayUp,t,n)&&(b(void 0),m--),A(u.acceptOverlayLeft,t,n)&&(b(void 0),f--),A(u.acceptOverlayRight,t,n)&&(b(void 0),f++)):(A(u.goDownCell,t,n)?m+=1:A(u.goUpCell,t,n)?m-=1:A(u.goRightCell,t,n)?f+=1:A(u.goLeftCell,t,n)?f-=1:A(u.goDownCellRetainSelection,t,n)?(m+=1,y=!0):A(u.goUpCellRetainSelection,t,n)?(m-=1,y=!0):A(u.goRightCellRetainSelection,t,n)?(f+=1,y=!0):A(u.goLeftCellRetainSelection,t,n)?(f-=1,y=!0):A(u.goToLastRow,t,n)?m=F-1:A(u.goToFirstRow,t,n)?m=Number.MIN_SAFE_INTEGER:A(u.goToLastColumn,t,n)?f=Number.MAX_SAFE_INTEGER:A(u.goToFirstColumn,t,n)?f=Number.MIN_SAFE_INTEGER:(Be==="rect"||Be==="multi-rect")&&(A(u.selectGrowDown,t,n)?Oe([0,1]):A(u.selectGrowUp,t,n)?Oe([0,-1]):A(u.selectGrowRight,t,n)?Oe([1,0]):A(u.selectGrowLeft,t,n)?Oe([-1,0]):A(u.selectToLastRow,t,n)?Oe([0,2]):A(u.selectToFirstRow,t,n)?Oe([0,-2]):A(u.selectToLastColumn,t,n)?Oe([2,0]):A(u.selectToFirstColumn,t,n)&&Oe([-2,0])),T=n.didMatch),Ne!==void 0&&Ne!=="normal"&&m!==C){const z=Ne==="skip-up"||Ne==="skip"||Ne==="block",O=Ne==="skip-down"||Ne==="skip"||Ne==="block",J=m<C;if(J&&z){for(;m>=0&&yt(m).isGroupHeader;)m--;m<0&&(m=C)}else if(!J&&O){for(;m<F&&yt(m).isGroupHeader;)m++;m>=F&&(m=C)}}const E=st(f,m,!1,y),k=n.didMatch;return k&&(E||!T||Cn)&&r(),k},[Ne,Yt,h,lt,pe,ke,Be,a,yt,F,st,Ie,nt,W.length,it,Cn,Mt,ue,ye,oe,bo,Ht,se,Lt,Bn,Un,Oe]),qt=l.useCallback(t=>{let r=!1;if(Pt!==void 0&&Pt({...t,cancel:()=>{r=!0}}),r||_n(t)||h.current===void 0)return;const[n,c]=h.current.cell,s=ze.current;if(to&&!t.metaKey&&!t.ctrlKey&&h.current!==void 0&&t.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(t.key)&&t.bounds!==void 0&&Ho(N([n-a,Math.max(0,Math.min(c,F-1))]))){if((!oe||c!==F)&&(s.y>c||c>s.y+s.height||s.x>n||n>s.x+s.width))return;Lt(t.bounds,!0,t.key),t.stopPropagation(),t.preventDefault()}},[to,Pt,_n,h,N,a,F,oe,Lt]),Rl=l.useCallback((t,r)=>{const n=t.location[0]-a;if(t.kind==="header"&&(Ge==null||Ge(n,{...t,preventDefault:r})),t.kind===$t){if(n<0)return;H==null||H(n,{...t,preventDefault:r})}if(t.kind==="cell"){const[c,s]=t.location;Ae==null||Ae([n,s],{...t,preventDefault:r}),oi(h,t.location)||st(c,s,!1,!1)}},[h,Ae,H,Ge,a,st]),ln=l.useCallback(async t=>{var u,f,m;if(!lt.paste)return;function r(C,y,T,x){var k,K;const E=typeof T=="object"?(T==null?void 0:T.join(`
`))??"":(T==null?void 0:T.toString())??"";if(!Lo(C)&&Ho(C)&&C.readonly!==!0){const D=ee==null?void 0:ee(E,C);if(D!==void 0&&Zt(D))return{location:y,value:D};const z=xe(C);if(z===void 0)return;if(z.kind===Q.Custom){$o(C.kind===Q.Custom);const O=(k=z.onPaste)==null?void 0:k.call(z,E,C.data);return O===void 0?void 0:{location:y,value:{...C,data:O}}}else{const O=(K=z.onPaste)==null?void 0:K.call(z,E,C,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:T});return O===void 0?void 0:($o(O.kind===C.kind),{location:y,value:O})}}}const n=h.columns,c=h.rows,s=((u=j.current)==null?void 0:u.contains(document.activeElement))===!0||((f=p.current)==null?void 0:f.contains(document.activeElement))===!0;let g;if(h.current!==void 0?g=[h.current.range.x,h.current.range.y]:n.length===1?g=[n.first()??0,0]:c.length===1&&(g=[a,c.first()??0]),s&&g!==void 0){let C,y;const T="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const D=await navigator.clipboard.read();for(const z of D){if(z.types.includes(x)){const J=await(await z.getType(x)).text(),ie=lr(J);if(ie!==void 0){C=ie;break}}z.types.includes(T)&&(y=await(await z.getType(T)).text())}}else if(navigator.clipboard.readText!==void 0)y=await navigator.clipboard.readText();else if(t!==void 0&&(t==null?void 0:t.clipboardData)!==null){if(t.clipboardData.types.includes(x)){const D=t.clipboardData.getData(x);C=lr(D)}C===void 0&&t.clipboardData.types.includes(T)&&(y=t.clipboardData.getData(T))}else return;const[E,k]=g,K=[];do{if(Ct===void 0){const D=Ee(g),z=y??(C==null?void 0:C.map(J=>J.map(ie=>ie.rawValue).join("	")).join("	"))??"",O=r(D,g,z,void 0);O!==void 0&&K.push(O);break}if(C===void 0){if(y===void 0)return;C=ni(y)}if(Ct===!1||typeof Ct=="function"&&(Ct==null?void 0:Ct([g[0]-a,g[1]],C.map(D=>D.map(z=>{var O;return((O=z.rawValue)==null?void 0:O.toString())??""}))))!==!0)return;for(const[D,z]of C.entries()){if(D+k>=F)break;for(const[O,J]of z.entries()){const ie=[O+E,D+k],[We,Xe]=ie;if(We>=_.length||Xe>=Ce)continue;const Ue=Ee(ie),Ye=r(Ue,ie,J.rawValue,J.formatted);Ye!==void 0&&K.push(Ye)}}}while(!1);Fe(K),(m=de.current)==null||m.damage(K.map(D=>({cell:D.location})))}},[ee,xe,Ee,h,lt.paste,j,_.length,Fe,Ce,Ct,a,F]);un("paste",ln,M,!1,!0);const jt=l.useCallback(async(t,r)=>{var u,f;if(!lt.copy)return;const n=r===!0||((u=j.current)==null?void 0:u.contains(document.activeElement))===!0||((f=p.current)==null?void 0:f.contains(document.activeElement))===!0,c=h.columns,s=h.rows,g=(m,C)=>{if(!mn)ir(m,C,t);else{const y=C.map(T=>({kind:Q.Text,data:W[T].title,displayData:W[T].title,allowOverlay:!1}));ir([y,...m],C,t)}};if(n&&ge!==void 0){if(h.current!==void 0){let m=ge(h.current.range,Se.current.signal);typeof m!="object"&&(m=await m()),g(m,At(h.current.range.x-a,h.current.range.x+h.current.range.width-a))}else if(s!==void 0&&s.length>0){const C=[...s].map(y=>{const T=ge({x:a,y,width:W.length,height:1},Se.current.signal);return typeof T=="object"?T[0]:T().then(x=>x[0])});if(C.some(y=>y instanceof Promise)){const y=await Promise.all(C);g(y,At(W.length))}else g(C,At(W.length))}else if(c.length>0){const m=[],C=[];for(const y of c){let T=ge({x:y,y:0,width:1,height:F},Se.current.signal);typeof T!="object"&&(T=await T()),m.push(T),C.push(y-a)}if(m.length===1)g(m[0],C);else{const y=m.reduce((T,x)=>T.map((E,k)=>[...E,...x[k]]));g(y,C)}}}},[W,ge,h,lt.copy,a,j,F,mn]);un("copy",jt,M,!1,!1);const kl=l.useCallback(async t=>{var n,c;if(!(!lt.cut||!(((n=j.current)==null?void 0:n.contains(document.activeElement))===!0||((c=p.current)==null?void 0:c.contains(document.activeElement))===!0))&&(await jt(t),h.current!==void 0)){let s={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:Y.empty(),columns:Y.empty()};const g=it==null?void 0:it(s);if(g===!1||(s=g===!0?s:g,s.current===void 0))return;Mt(s.current.range)}},[Mt,h,lt.cut,jt,j,it]);un("cut",kl,M,!1,!1);const Sl=l.useCallback((t,r)=>{if(Pe!==void 0){a!==0&&(t=t.map(s=>[s[0]-a,s[1]])),Pe(t,r);return}if(t.length===0||r===-1)return;const[n,c]=t[r];v.current!==void 0&&v.current[0]===n&&v.current[1]===c||(v.current=[n,c],st(n,c,!1,!1))},[Pe,a,st]),[Mo,Ro]=((Qn=wt==null?void 0:wt.current)==null?void 0:Qn.cell)??[],ko=l.useRef(le);ko.current=le,l.useLayoutEffect(()=>{var t,r,n,c;rn.current&&!go.current&&Mo!==void 0&&Ro!==void 0&&(Mo!==((r=(t=ho.current)==null?void 0:t.current)==null?void 0:r.cell[0])||Ro!==((c=(n=ho.current)==null?void 0:n.current)==null?void 0:c.cell[1]))&&ko.current(Mo,Ro),go.current=!1},[Mo,Ro]);const Xn=h.current!==void 0&&(h.current.cell[0]>=_.length||h.current.cell[1]>=Ce);l.useLayoutEffect(()=>{Xn&&Ie(Fo,!1)},[Xn,Ie]);const Tl=l.useMemo(()=>oe===!0&&(B==null?void 0:B.tint)===!0?Y.fromSingleSelection(Ce-1):Y.empty(),[Ce,oe,B==null?void 0:B.tint]),zl=l.useCallback(t=>typeof kt=="boolean"?kt:(kt==null?void 0:kt(t-a))??!0,[a,kt]),El=l.useMemo(()=>{if(Jo===void 0||p.current===null)return null;const{bounds:t,group:r}=Jo,n=p.current.getBoundingClientRect();return l.createElement(ji,{bounds:t,group:r,canvasBounds:n,onClose:()=>Qo(void 0),onFinish:c=>{Qo(void 0),ne==null||ne(r,c)}})},[ne,Jo]),Ll=Math.min(_.length,Je+(Ve?1:0));l.useImperativeHandle(o,()=>({appendRow:(t,r)=>Ht(t+a,r),updateCells:t=>{var r;return a!==0&&(t=t.map(n=>({cell:[n.cell[0]+a,n.cell[1]]}))),(r=de.current)==null?void 0:r.damage(t)},getBounds:(t,r)=>{var n;if(!((p==null?void 0:p.current)===null||(j==null?void 0:j.current)===null)){if(t===void 0&&r===void 0){const c=p.current.getBoundingClientRect(),s=c.width/j.current.clientWidth;return{x:c.x-j.current.scrollLeft*s,y:c.y-j.current.scrollTop*s,width:j.current.scrollWidth*s,height:j.current.scrollHeight*s}}return(n=de.current)==null?void 0:n.getBounds((t??0)+a,r)}},focus:()=>{var t;return(t=de.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await jt(void 0,!0);break;case"paste":await ln();break}},scrollTo:le,remeasureColumns:t=>{for(const r of t)yo(r+a)},getMouseArgsForPosition:(t,r,n)=>{if((de==null?void 0:de.current)===null)return;const c=de.current.getMouseArgsForPosition(t,r,n);if(c!==void 0)return{...c,location:[c.location[0]-a,c.location[1]]}}}),[Ht,yo,j,jt,qt,ln,a,le]);const[Yn,qn]=_e??[],Hl=l.useCallback(t=>{const[r,n]=t;if(n===-1){pe!=="none"&&(ue(Y.fromSingleSelection(r),void 0,!1),Me());return}Yn===r&&qn===n||(be({cell:t,range:{x:r,y:n,width:1,height:1}},!0,!1,"keyboard-nav"),le(r,n))},[pe,Me,le,Yn,qn,be,ue]),[Dl,Il]=l.useState(!1),jn=l.useRef(ai(t=>{Il(t)},5)),Fl=l.useCallback(()=>{jn.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&R===void 0&&be({cell:[a,mo],range:{x:a,y:mo,width:1,height:1}},!0,!1,"keyboard-select")},[mo,h,R,a,be]),$l=l.useCallback(()=>{jn.current(!1)},[]),[Al,Gl]=l.useMemo(()=>{let t;const r=(ce==null?void 0:ce.scrollbarWidthOverride)??ri(),n=F+(oe?1:0);if(typeof rt=="number")t=Bt+n*rt;else{let s=0;const g=Math.min(n,10);for(let u=0;u<g;u++)s+=rt(u);s=Math.floor(s/g),t=Bt+n*s}t+=r;const c=_.reduce((s,g)=>g.width+s,0)+r;return[`${Math.min(1e5,c)}px`,`${Math.min(1e5,t)}px`]},[_,ce==null?void 0:ce.scrollbarWidthOverride,rt,F,oe,Bt]),Pl=l.useMemo(()=>li(ve),[ve]);return l.createElement(ii.Provider,{value:ve},l.createElement(lc,{style:Pl,className:Gt,inWidth:V??Al,inHeight:me??Gl},l.createElement(_i,{fillHandle:kr,drawFocusRing:yn,experimental:ce,fixedShadowX:Sr,fixedShadowY:Tr,getRowThemeOverride:et,headerIcons:zr,imageWindowLoader:Er,initialSize:Lr,isDraggable:Hr,onDragLeave:Dr,onRowMoved:Wt,overscrollX:jr,overscrollY:Zr,preventDiagonalScrolling:$r,rightElement:Ar,rightElementProps:Gr,smoothScrollX:Pr,smoothScrollY:Kr,className:Gt,enableGroups:Yo,onCanvasFocused:Fl,onCanvasBlur:$l,canvasRef:p,onContextMenu:Rl,theme:ve,cellXOffset:sl,cellYOffset:mo,accessibilityHeight:pt.height,onDragEnd:bl,columns:_,nonGrowWidth:In,drawHeader:ll,onColumnProposeMove:Cl,drawCell:il,disabledRows:Tl,freezeColumns:Ll,lockColumns:a,firstColAccessible:a===0,getCellContent:Ee,minColumnWidth:St,maxColumnWidth:fo,searchInputRef:I,showSearch:Qr,onSearchClose:el,highlightRegions:al,getCellsForSelection:ge,getGroupDetails:jo,headerHeight:_o,isFocused:Dl,groupHeaderHeight:Yo?En:0,freezeTrailingRows:Qe+(oe&&(B==null?void 0:B.sticky)===!0?1:0),hasAppendRow:oe,onColumnResize:zt,onColumnResizeEnd:nl,onColumnResizeStart:rl,onCellFocused:Hl,onColumnMoved:wl,onDragStart:pl,onHeaderMenuClick:gl,onHeaderIndicatorClick:ml,onItemHovered:nn,isFilling:(R==null?void 0:R.fillHandle)===!0,onMouseMove:hl,onKeyDown:qt,onKeyUp:ht,onMouseDown:ul,onMouseUp:fl,onDragOverCell:Mr,onDrop:Rr,onSearchResultsChanged:Sl,onVisibleRegionChanged:vl,clientSize:Xo,rowHeight:rt,searchResults:ft,searchValue:Po,onSearchValueChange:Qt,rows:Ce,scrollRef:j,selection:h,translateX:pt.tx,translateY:pt.ty,verticalBorder:zl,gridRef:de,getCellRenderer:xe,resizeIndicator:Vr}),El,w!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(vc,{...w,validateCell:ol,bloom:qe,id:Ml,getCellRenderer:xe,className:(ce==null?void 0:ce.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:br,imageEditorOverride:S,onFinishEditing:xl,markdownDivCreateNode:U,isOutsideClick:Br,customEventTarget:ce==null?void 0:ce.eventTarget}))))},bc=l.forwardRef(pc),yc=(e,o)=>{const i=l.useMemo(()=>({...Ni,...e.headerIcons}),[e.headerIcons]),d=l.useMemo(()=>e.imageWindowLoader??new ci,[e.imageWindowLoader]);return l.createElement(bc,{...e,renderers:si,headerIcons:i,ref:o,imageWindowLoader:d})},Lc=l.forwardRef(yc);export{Xi as C,Lc as D,at as k,hc as u};
