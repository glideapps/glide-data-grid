import{j as U,a as he,F as me,s as Ce}from"./marked.esm-dbrxtycE.js";import{r as t}from"./index-BMVQvedj.js";import{c as Re}from"./throttle-7EuXLZa7.js";import{Q as Se,R as we,u as ve}from"./image-window-loader--5E_ifQX.js";function ae(e,f,m,o){return Re(Math.round(f-(e.growOffset??0)),Math.ceil(m),Math.floor(o))}const De=e=>{const[f,m]=t.useState(),[o,D]=t.useState(),[i,O]=t.useState(),[h,w]=t.useState(),[C,b]=t.useState(!1),[K,c]=t.useState(),[R,X]=t.useState(),[N,oe]=t.useState(),[q,ee]=t.useState(!1),[ne,re]=t.useState(),{onHeaderMenuClick:Y,onHeaderIndicatorClick:te,getCellContent:x,onColumnMoved:j,onColumnResize:S,onColumnResizeStart:$,onColumnResizeEnd:F,gridRef:_,maxColumnWidth:M,minColumnWidth:W,onRowMoved:E,lockColumns:A,onColumnProposeMove:J,onMouseDown:P,onMouseUp:Z,onItemHovered:n,onDragStart:L,canvasRef:H}=e,G=(S??F??$)!==void 0,{columns:a,selection:l}=e,s=l.columns,d=t.useCallback(r=>{const[g,y]=r.location;i!==void 0&&h!==g&&g>=A?(b(!0),w(g)):R!==void 0&&y!==void 0?(ee(!0),oe(Math.max(0,y))):o===void 0&&!C&&!q&&(n==null||n(r))},[i,R,h,n,A,o,C,q]),B=j!==void 0,V=t.useCallback(r=>{var g;if(r.button===0){const[y,v]=r.location;if(r.kind==="out-of-bounds"&&r.isEdge&&G){const T=(g=_==null?void 0:_.current)==null?void 0:g.getBounds(a.length-1,-1);T!==void 0&&(m(T.x),D(a.length-1))}else if(r.kind==="header"&&y>=A){const T=H==null?void 0:H.current;if(r.isEdge&&G&&T){m(r.bounds.x),D(y);const ue=T.getBoundingClientRect().width/T.offsetWidth,le=r.bounds.width/ue;$==null||$(a[y],le,y,le+(a[y].growOffset??0))}else r.kind==="header"&&B&&(c(r.bounds.x),O(y))}else r.kind==="cell"&&A>0&&y===0&&v!==void 0&&E!==void 0&&(re(r.bounds.y),X(v))}P==null||P(r)},[P,G,A,E,_,a,B,$,H]),Q=t.useCallback((r,g)=>{C||q||Y==null||Y(r,g)},[C,q,Y]),se=t.useCallback((r,g)=>{C||q||te==null||te(r,g)},[C,q,te]),k=t.useRef(-1),u=t.useCallback(()=>{k.current=-1,X(void 0),oe(void 0),re(void 0),ee(!1),O(void 0),w(void 0),c(void 0),b(!1),D(void 0),m(void 0)},[]),z=t.useCallback((r,g)=>{if(r.button===0){if(o!==void 0){if((s==null?void 0:s.hasIndex(o))===!0)for(const v of s){if(v===o)continue;const T=a[v],p=ae(T,k.current,W,M);S==null||S(T,p,v,p+(T.growOffset??0))}const y=ae(a[o],k.current,W,M);if(F==null||F(a[o],y,o,y+(a[o].growOffset??0)),s.hasIndex(o))for(const v of s){if(v===o)continue;const T=a[v],p=ae(T,k.current,W,M);F==null||F(T,p,v,p+(T.growOffset??0))}}u(),i!==void 0&&h!==void 0&&(j==null||j(i,h)),R!==void 0&&N!==void 0&&(E==null||E(R,N))}Z==null||Z(r,g)},[Z,o,i,h,R,N,s,F,a,W,M,S,j,E,u]),I=t.useMemo(()=>{if(!(i===void 0||h===void 0)&&i!==h&&(J==null?void 0:J(i,h))!==!1)return{src:i,dest:h}},[i,h,J]),ie=t.useCallback(r=>{const g=H==null?void 0:H.current;if(i!==void 0&&K!==void 0)Math.abs(r.clientX-K)>20&&b(!0);else if(R!==void 0&&ne!==void 0)Math.abs(r.clientY-ne)>20&&ee(!0);else if(o!==void 0&&f!==void 0&&g){const v=g.getBoundingClientRect().width/g.offsetWidth,T=(r.clientX-f)/v,p=a[o],ue=ae(p,T,W,M);if(S==null||S(p,ue,o,ue+(p.growOffset??0)),k.current=T,(s==null?void 0:s.first())===o)for(const le of s){if(le===o)continue;const fe=a[le],ge=ae(fe,k.current,W,M);S==null||S(fe,ge,le,ge+(fe.growOffset??0))}}},[i,K,R,ne,o,f,a,W,M,S,s,H]),ce=t.useCallback((r,g)=>{if(R===void 0||N===void 0)return x(r,g);let[y,v]=r;return v===N?v=R:(v>N&&(v-=1),v>=R&&(v+=1)),x([y,v],g)},[R,N,x]),de=t.useCallback(r=>{L==null||L(r),r.defaultPrevented()||u()},[u,L]);return U(Se,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ce,isResizing:o!==void 0,onHeaderMenuClick:Q,onHeaderIndicatorClick:se,isDragging:C,onItemHovered:d,onDragStart:de,onMouseDown:V,allowResize:G,onMouseUp:z,dragAndDropState:I,onMouseMoveRaw:ie,ref:_})},be=De;function He(e){const f=t.useRef(null),[m,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const D=O=>{for(const h of O){const{width:w,height:C}=h&&h.contentRect||{};o(b=>b.width===w&&b.height===C?b:{width:w,height:C})}},i=new window.ResizeObserver(D);return f.current&&i.observe(f.current,void 0),()=>{i.disconnect()}},[f.current]),{ref:f,...m}}const ye=(e,f,m)=>{const o=t.useRef(null),D=t.useRef(null),i=t.useRef(null),O=t.useRef(0),h=t.useRef(f);h.current=f;const w=m.current;t.useEffect(()=>{const C=()=>{var c,R;if(D.current===!1&&w!==null){const X=[w.scrollLeft,w.scrollTop];if(((c=i.current)==null?void 0:c[0])===X[0]&&((R=i.current)==null?void 0:R[1])===X[1])if(O.current>10){i.current=null,D.current=null;return}else O.current++;else O.current=0,h.current(X[0],X[1]),i.current=X;o.current=window.setTimeout(C,8.333333333333334)}},b=()=>{D.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},K=c=>{c.touches.length===0&&(D.current=!1,O.current=0,o.current=window.setTimeout(C,8.333333333333334))};if(e&&w!==null){const c=w;return c.addEventListener("touchstart",b),c.addEventListener("touchend",K),()=>{c.removeEventListener("touchstart",b),c.removeEventListener("touchend",K),o.current!==null&&window.clearTimeout(o.current)}}},[e,w])},xe=ye,Me=()=>e=>e.isSafari?"scroll":"auto",ke=Ce("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[Me()]}});function Te(e){const[f,m]=t.useState(!1),o=typeof window>"u"?null:window,D=t.useRef(0);return ve("touchstart",t.useCallback(()=>{window.clearTimeout(D.current),m(!0)},[]),o,!0,!1),ve("touchend",t.useCallback(i=>{i.touches.length===0&&(D.current=window.setTimeout(()=>m(!1),e))},[e]),o,!0,!1),f}const Ie=e=>{var G,a;const{children:f,clientHeight:m,scrollHeight:o,scrollWidth:D,update:i,draggable:O,className:h,preventDiagonalScrolling:w=!1,paddingBottom:C=0,paddingRight:b=0,rightElement:K,rightElementProps:c,kineticScrollPerfHack:R=!1,scrollRef:X,initialSize:N}=e,oe=[],q=(c==null?void 0:c.sticky)??!1,ee=(c==null?void 0:c.fill)??!1,ne=t.useRef(0),re=t.useRef(0),Y=t.useRef(null),te=typeof window>"u"?1:window.devicePixelRatio,x=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),j=t.useRef(null),S=Te(200),[$,F]=t.useState(!0),_=t.useRef(0);t.useLayoutEffect(()=>{if(!$||S||x.current.lockDirection===void 0)return;const l=Y.current;if(l===null)return;const[s,d]=x.current.lockDirection;s!==void 0?l.scrollLeft=s:d!==void 0&&(l.scrollTop=d),x.current.lockDirection=void 0},[S,$]);const M=t.useCallback((l,s)=>{var de;const d=Y.current;if(d===null)return;s=s??d.scrollTop,l=l??d.scrollLeft;const B=x.current.scrollTop,V=x.current.scrollLeft,Q=l-V,se=s-B;S&&Q!==0&&se!==0&&(Math.abs(Q)>3||Math.abs(se)>3)&&w&&x.current.lockDirection===void 0&&(x.current.lockDirection=Math.abs(Q)<Math.abs(se)?[V,void 0]:[void 0,B]);const k=x.current.lockDirection;l=(k==null?void 0:k[0])??l,s=(k==null?void 0:k[1])??s,x.current.scrollLeft=l,x.current.scrollTop=s;const u=d.clientWidth,z=d.clientHeight,I=s,ie=re.current-I,ce=d.scrollHeight-z;if(re.current=I,ce>0&&(Math.abs(ie)>2e3||I===0||I===ce)&&o>d.scrollHeight+5){const r=I/ce,g=(o-z)*r;ne.current=g-I}k!==void 0&&(window.clearTimeout(_.current),F(!1),_.current=window.setTimeout(()=>F(!0),200)),i({x:l,y:I+ne.current,width:u-b,height:z-C,paddingRight:((de=j.current)==null?void 0:de.clientWidth)??0})},[C,b,o,i,w,S]);xe(R&&we.value,M,Y);const W=t.useRef(M);W.current=M;const E=t.useRef(),A=t.useRef(!1);t.useLayoutEffect(()=>{A.current?M():A.current=!0},[M,C,b]);const J=t.useCallback(l=>{Y.current=l,X!==void 0&&(X.current=l)},[X]);let P=0,Z=0;for(oe.push(U("div",{style:{width:D,height:0}},P++));Z<o;){const l=Math.min(5e6,o-Z);oe.push(U("div",{style:{width:0,height:l}},P++)),Z+=l}const{ref:n,width:L,height:H}=He(N);return typeof window<"u"&&(((G=E.current)==null?void 0:G.height)!==H||((a=E.current)==null?void 0:a.width)!==L)&&(window.setTimeout(()=>W.current(),0),E.current={width:L,height:H}),(L??0)===0||(H??0)===0?U("div",{ref:n}):U("div",{ref:n,children:he(ke,{isSafari:we.value,children:[U("div",{className:"dvn-underlay",children:f}),U("div",{ref:J,style:E.current,draggable:O,onDragStart:l=>{O||(l.stopPropagation(),l.preventDefault())},className:"dvn-scroller "+(h??""),onScroll:()=>M(),children:he("div",{className:"dvn-scroll-inner"+(K===void 0?" dvn-hidden":""),children:[U("div",{className:"dvn-stack",children:oe}),K!==void 0&&he(me,{children:[!ee&&U("div",{className:"dvn-spacer"}),U("div",{ref:j,style:{height:H,maxHeight:m-Math.ceil(te%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:b,flexGrow:ee?1:void 0,right:q?b??0:void 0,pointerEvents:"auto"},children:K})]})]})})]})})},Oe=e=>{const{columns:f,rows:m,rowHeight:o,headerHeight:D,groupHeaderHeight:i,enableGroups:O,freezeColumns:h,experimental:w,nonGrowWidth:C,clientSize:b,className:K,onVisibleRegionChanged:c,scrollRef:R,preventDiagonalScrolling:X,rightElement:N,rightElementProps:oe,overscrollX:q,overscrollY:ee,initialSize:ne,smoothScrollX:re=!1,smoothScrollY:Y=!1,isDraggable:te}=e,{paddingRight:x,paddingBottom:j}=w??{},[S,$]=b,F=t.useRef(),_=t.useRef(),M=t.useRef(),W=t.useRef(),E=C+Math.max(0,q??0);let A=O?D+i:D;if(typeof o=="number")A+=m*o;else for(let n=0;n<m;n++)A+=o(n);ee!==void 0&&(A+=ee);const J=t.useRef(),P=t.useCallback(()=>{var se,k;if(J.current===void 0)return;const n={...J.current};let L=0,H=n.x<0?-n.x:0,G=0,a=0;n.x=n.x<0?0:n.x;let l=0;for(let u=0;u<h;u++)l+=f[u].width;for(const u of f){const z=L-l;if(n.x>=z+u.width)L+=u.width,a++,G++;else if(n.x>z)L+=u.width,re?H+=z-n.x:a++,G++;else if(n.x+n.width>z)L+=u.width,G++;else break}let s=0,d=0,B=0;if(typeof o=="number")Y?(d=Math.floor(n.y/o),s=d*o-n.y):d=Math.ceil(n.y/o),B=Math.ceil(n.height/o)+d,s<0&&B++;else{let u=0;for(let z=0;z<m;z++){const I=o(z),ie=u+(Y?0:I/2);if(n.y>=u+I)u+=I,d++,B++;else if(n.y>ie)u+=I,Y?s+=ie-n.y:d++,B++;else if(n.y+n.height>I/2+u)u+=I,B++;else break}}const V={x:a,y:d,width:G-a,height:B-d},Q=F.current;(Q===void 0||Q.y!==V.y||Q.x!==V.x||Q.height!==V.height||Q.width!==V.width||_.current!==H||M.current!==s||n.width!==((se=W.current)==null?void 0:se[0])||n.height!==((k=W.current)==null?void 0:k[1]))&&(c==null||c({x:a,y:d,width:G-a,height:B-d},n.width,n.height,n.paddingRight??0,H,s),F.current=V,_.current=H,M.current=s,W.current=[n.width,n.height])},[f,o,m,c,h,re,Y]),Z=t.useCallback(n=>{J.current=n,P()},[P]);return t.useEffect(()=>{P()},[P]),U(Ie,{scrollRef:R,className:K,kineticScrollPerfHack:w==null?void 0:w.kineticScrollPerfHack,preventDiagonalScrolling:X,draggable:te===!0||typeof te=="string",scrollWidth:E+(x??0),scrollHeight:A+(j??0),clientHeight:$,rightElement:N,paddingBottom:j,paddingRight:x,rightElementProps:oe,update:Z,initialSize:ne,children:U(be,{eventTargetRef:R,width:S,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator})})},ze=Oe;export{ze as G};
