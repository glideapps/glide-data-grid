var Li=Object.defineProperty;var Ni=(e,t,n)=>t in e?Li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var te=(e,t,n)=>(Ni(e,typeof t!="symbol"?t+"":t,n),n);import{a as Ke,j as $,F as On,s as yt,b as zi}from"./marked.esm-dbrxtycE.js";import{r as I,R as Kn}from"./index-BMVQvedj.js";import{h as Oi,d as Xi,v as $i,_ as Yi,g as _i,c as wn,r as Ui,j as qi,t as ji}from"./throttle-7EuXLZa7.js";import{_ as Vi}from"./iframe-ai2fO41v.js";function jo(e="This should not happen"){throw new Error(e)}function gt(e,t="Assertion failed"){if(!e)return jo(t)}function Gn(e,t){return jo(t??"Hell froze over")}function el(e,t){try{return e()}catch{return t}}const ko=Object.prototype.hasOwnProperty;function zt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&zt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(ko.call(e,n)&&++o&&!ko.call(t,n)||!(n in t)||!zt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const xn=null,Jn=void 0;var se=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(se||{}),Ki=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(Ki||{}),Xn=(e=>(e.Triangle="triangle",e.Dots="dots",e))(Xn||{});function tl(e){return"width"in e&&typeof e.width=="number"}async function nl(e){return typeof e=="object"?e:await e()}function Gi(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function ol(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function Vo(e){return e.kind==="marker"||e.kind==="new-row"}function Ji(e){if(!Gi(e)||e.kind==="image")return!1;if(e.kind==="text"||e.kind==="number"||e.kind==="markdown"||e.kind==="uri"||e.kind==="custom"||e.kind==="boolean")return e.readonly!==!0;Gn(e,"A cell was passed with an invalid kind")}function il(e){return Oi(e,"editor")}function $n(e){return!(e.readonly??!1)}var tn=(e=>(e.NewRow="new-row",e.Marker="marker",e))(tn||{});function Qi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Co;const ht=class ht{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new ht(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Qi([...this.items,n]);return new ht(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const d=[];s<o&&d.push([s,o]),i<a&&d.push([i,a]),n.splice(r,1,...d)}}return new ht(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};te(ht,"empty",()=>Co??(Co=new ht([]))),te(ht,"fromSingleSelection",t=>ht.empty().add(t));let Yn=ht;function Ve(e,t,n,o,i=!1){const r=I.useRef();r.current=t,I.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var d;(d=r.current)==null||d.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function rl(e,t){return e===void 0?void 0:t}const Zi=Math.PI;function So(e){return e*Zi/180}const Ko=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Go=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},Jo=(e,t,n)=>Math.min(e,t-n*2),Qo=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Qn=e=>{const t=e.fgColor??"currentColor";return Ke("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[$("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),$("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"})]})},er=e=>{const t=e.fgColor??"currentColor";return $("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:$("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})};function tr(e,t,n){const[o,i]=I.useState(e),r=I.useRef(!0);I.useEffect(()=>()=>{r.current=!1},[]);const l=I.useRef(Xi(s=>{r.current&&i(s)},n));return I.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const nr="֑-߿יִ-﷽ﹰ-ﻼ",or="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ir=new RegExp("^[^"+or+"]*["+nr+"]");function Zn(e){return ir.test(e)?"rtl":"not-rtl"}let vn;function Io(){if(typeof document>"u")return 0;if(vn!==void 0)return vn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),vn=n-o,vn}const Ft=Symbol();function sl(e){const t=I.useRef([Ft,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=I.useState(e),[,i]=I.useState(),r=I.useCallback(s=>{const a=t.current[0];a!==Ft&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Ft&&i({}),o(d=>typeof s=="function"?s(a===Ft?d:a):s),t.current[0]=Ft)},[]),l=I.useCallback(()=>{t.current[0]=Ft,i({})},[]);return[t.current[0]===Ft?n:t.current[0],r,l]}function Zo(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ll(e){const t=I.useRef(e);return zt(e,t.current)||(t.current=e),t.current}function rr(e,t){return Kn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked})),[e,t])}function al(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(bn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function _n(e,t){return(e??"")===(t??"")}function sr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function lr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function bn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ei(e){return[e.x+e.width-1,e.y+e.height-1]}function Mo(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[d,f]=t.span;return d>=o&&d<=i||f>=o&&d<=i||d<o&&f>i}function ar(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Mo(e,t,r)&&i++;for(const l of n.current.rangeStack)Mo(e,t,l)&&i++;return i}function ti(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function Ot(e,t){let n=0;const o=ti(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Xt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Un(e,t,n,o,i){const r=ti(e,o),l=[];for(const d of r)if(d.sticky)l.push(d);else break;if(l.length>0)for(const d of l)n-=d.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let d=t;d<s;d++){const f=r[d];f.sticky||l.push(f)}return l}function cr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function dr(e,t,n,o,i,r,l,s,a,d){const f=o+i;if(n&&e<=i)return-2;if(e<=f)return-1;let g=t;for(let c=0;c<d;c++){const h=r-1-c,y=typeof l=="number"?l:l(h);if(g-=y,e>=g)return h}const m=r-d,u=e-(a??0);if(typeof l=="number"){const c=Math.floor((u-f)/l)+s;return c>=m?void 0:c}else{let c=f;for(let h=s;h<m;h++){const y=l(h);if(u<=c+y)return h;c+=y}return}}let pn=0,Qt={};const ur=typeof window>"u";async function fr(){var e;ur||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,pn=0,Qt={},$i())}fr();function ni(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function $t(e,t,n,o="middle"){const i=ni(e,t,o,n);let r=Qt[i];return r===void 0&&(r=t.measureText(e),Qt[i]=r,pn++),pn>1e4&&(Qt={},pn=0),r}function oi(e,t){const n=ni(e,void 0,"middle",t);return Qt[n]}function Ct(e,t){return typeof t!="string"&&(t=t.baseFontFull),hr(e,t)}function Eo(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Bo=[];function hr(e,t){for(const r of Bo)if(r.key===t)return r.val;const n=Eo(e,"alphabetic"),i=-(Eo(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Bo.push({key:t,val:i}),i}function gr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let d=Number.MAX_SAFE_INTEGER;const f=500;if(t!==void 0&&(d=n-t,d<f)){const g=1-d/f;l.globalAlpha=g,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return d<f}function rn(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function ii(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function ri(e,t){const n=$t("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function mr(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function yr(e,t,n,o,i,r,l,s,a,d){const f=s.baseFontFull,g=Yi(e,t,f,i-s.cellHorizontalPadding*2,d??!1),m=ri(e,f),u=s.lineHeight*m,c=m+u*(g.length-1),h=c+s.cellVerticalPadding>r;h&&(e.save(),e.rect(n,o,i,r),e.clip());const y=o+r/2-c/2;let b=Math.max(o+s.cellVerticalPadding,y);for(const k of g)if(ii(e,k,n,b,i,m,l,s,a),b+=u,b>o+r)break;h&&e.restore()}function mt(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:d,width:f,height:g}=l;o=o??!1,o||(t=mr(t,f));const m=Ct(r,s),u=Zn(t)==="rtl";if(n===void 0&&u&&(n="right"),u&&(r.direction="rtl"),t.length>0){let c=!1;n==="right"?(r.textAlign="right",c=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,c=!0),o?yr(r,t,a,d,f,g,m,s,n,i):ii(r,t,a,d,f,g,m,s,n),c&&(r.textAlign="start"),u&&(r.direction="inherit")}}function st(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function vr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function br(e,t,n){const o=function(s,a){const d=a.x-s.x,f=a.y-s.y,g=Math.sqrt(d*d+f*f),m=d/g,u=f/g;return{x:d,y:a.y-s.y,len:g,nx:m,ny:u,ang:Math.atan2(u,m)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const d=t[(s+1)%r],f=o(a,l),g=o(a,d),m=f.nx*g.ny-f.ny*g.nx,u=f.nx*g.nx-f.ny*-g.ny;let c=Math.asin(m<-1?-1:m>1?1:m),h=1,y=!1;u<0?c<0?c=Math.PI+c:(c=Math.PI-c,h=-1,y=!0):c>0&&(h=-1,y=!0),i=a.radius!==void 0?a.radius:n;const b=c/2;let k=Math.abs(Math.cos(b)*i/Math.sin(b)),E;k>Math.min(f.len/2,g.len/2)?(k=Math.min(f.len/2,g.len/2),E=Math.abs(k*Math.sin(b)/Math.cos(b))):E=i;let A=a.x+g.nx*k,H=a.y+g.ny*k;A+=-g.ny*E*h,H+=g.nx*E*h,e.arc(A,H,E,f.ang+Math.PI/2*h,g.ang-Math.PI/2*h,y),l=a,a=d}e.closePath()}function qn(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c){const h={x:0,y:r+d,width:0,height:0};if(e>=u.length||t>=f||t<-2||e<0)return h;const y=r-i;if(e>=g){const b=l>e?-1:1,k=Ot(u);h.x+=k+a;for(let E=l;E!==e;E+=b)h.x+=u[b===1?E:E-1].width*b}else for(let b=0;b<e;b++)h.x+=u[b].width;if(h.width=u[e].width+1,t===-1)h.y=i,h.height=y;else if(t===-2){h.y=0,h.height=i;let b=e;const k=u[e].group,E=u[e].sticky;for(;b>0&&_n(u[b-1].group,k)&&u[b-1].sticky===E;){const H=u[b-1];h.x-=H.width,h.width+=H.width,b--}let A=e;for(;A+1<u.length&&_n(u[A+1].group,k)&&u[A+1].sticky===E;){const H=u[A+1];h.width+=H.width,A++}if(!E){const H=Ot(u),S=h.x-H;S<0&&(h.x-=S,h.width+=S),h.x+h.width>n&&(h.width=n-h.x)}}else if(t>=f-m){let b=f-t;for(h.y=o;b>0;){const k=t+b-1;h.height=typeof c=="number"?c:c(k),h.y-=h.height,b--}h.height+=1}else{const b=s>t?-1:1;if(typeof c=="number"){const k=t-s;h.y+=k*c}else for(let k=s;k!==t;k+=b)h.y+=c(k)*b;h.height=(typeof c=="number"?c:c(t))+1}return h}const eo=1<<21;function et(e,t){return(t+2)*eo+e}function si(e){return e%eo}function to(e){return Math.floor(e/eo)-2}function no(e){const t=si(e),n=to(e);return[t,n]}class li{constructor(){te(this,"visibleWindow",{x:0,y:0,width:0,height:0});te(this,"freezeCols",0);te(this,"freezeRows",[]);te(this,"isInWindow",t=>{const n=si(t),o=to(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&zt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class pr extends li{constructor(){super(...arguments);te(this,"cache",new Map);te(this,"setValue",(n,o)=>{this.cache.set(et(n[0],n[1]),o)});te(this,"getValue",n=>this.cache.get(et(n[0],n[1])));te(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Zt{constructor(t=[]){te(this,"cells");this.cells=new Set(t.map(n=>et(n[0],n[1])))}add(t){this.cells.add(et(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(et(t[0],t[1]))}remove(t){this.cells.delete(et(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(to(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(et(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield no(t)}}function wr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class xr{constructor(t,n){te(this,"spriteMap",new Map);te(this,"headerIcons");te(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[d,f]=wr(n,s),g=l*Math.ceil(window.devicePixelRatio),m=`${d}_${f}_${g}_${t}`;let u=this.spriteMap.get(m);if(u===void 0){const c=this.headerIcons[t];if(c===void 0)return;u=document.createElement("canvas");const h=u.getContext("2d");if(h===null)return;const y=new Image;y.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(c({fgColor:f,bgColor:d}))}`,this.spriteMap.set(m,u);const b=y.decode();if(b===void 0)return;this.inFlight++,b.then(()=>{h.drawImage(y,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(u,0,0,g,g,i,r,l,l),a<1&&(o.globalAlpha=1)}}const Pn={};let kt=null;function kr(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function jn(e){const t=e.toLowerCase().trim();if(Pn[t]!==void 0)return Pn[t];kt=kt||kr(),kt.style.color="#000",kt.style.color=t;const n=getComputedStyle(kt).color;kt.style.color="#fff",kt.style.color=t;const o=getComputedStyle(kt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),Pn[t]=i,i}function sn(e,t){const[n,o,i]=jn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Fo=new Map;function Do(e,t){const n=`${e}-${t}`,o=Fo.get(n);if(o!==void 0)return o;const i=Ye(e,t);return Fo.set(n,i),i}function Ye(e,t){if(t===void 0)return e;const[n,o,i,r]=jn(e);if(r===1)return e;const[l,s,a,d]=jn(t),f=r+d*(1-r),g=(r*n+d*l*(1-r))/f,m=(r*o+d*s*(1-r))/f,u=(r*i+d*a*(1-r))/f;return`rgba(${g}, ${m}, ${u}, ${f})`}function ai(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function kn(e,t,n,o,i,r,l,s,a){s=s??t;let d=t,f=e;const g=o-r;let m=!1;for(;d<n&&f<g;){const u=i(f);if(d+u>s&&a(d,f,u,!1,l&&f===o-1)===!0){m=!0;break}d+=u,f++}if(!m){d=n;for(let u=0;u<r;u++){f=o-1-u;const c=i(f);d-=c,a(d,f,c,!0,l&&f===o-1)}}}function St(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const d of e){const f=d.sticky?s:l+n;if(r(d,f,a,d.sticky?0:s,t)===!0)break;l+=d.width,s+=d.sticky?d.width:0}}function ci(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let d=s+1,f=a.width;for(a.sticky&&(l+=f);d<e.length&&_n(e[d].group,a.group)&&e[d].sticky===e[s].sticky;){const h=e[d];f+=h.width,d++,s++,h.sticky&&(l+=h.width)}const g=a.sticky?0:n,m=r+g,u=a.sticky?0:Math.max(0,l-m),c=Math.min(f-u,t-(m+u));i([a.sourceIndex,e[d-1].sourceIndex],a.group??"",m+u,0,c,o),r+=f}}function di(e,t,n,o,i,r,l){var m;const[s,a]=e;let d,f;const g=((m=l.find(u=>!u.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const u=Math.max(s,g);let c=t,h=o;for(let y=r.sourceIndex-1;y>=u;y--)c-=l[y].width,h+=l[y].width;for(let y=r.sourceIndex+1;y<=a;y++)h+=l[y].width;f={x:c,y:n,width:h,height:i}}if(g>s){const u=Math.min(a,g-1);let c=t,h=o;for(let y=r.sourceIndex-1;y>=s;y--)c-=l[y].width,h+=l[y].width;for(let y=r.sourceIndex+1;y<=u;y++)h+=l[y].width;d={x:c,y:n,width:h,height:i}}return[d,f]}function cl(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ui={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function dl(){return ui}const ul=Kn.createContext(ui);function nn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Ye(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function fl(e,t,n,o){if(o==="any")return Cr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),lr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function on(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function en(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Cr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Sr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Ir(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,d=e.x+e.width-l,f=r-e.y,g=e.y+e.height-s,m=a>0?e.x+Math.floor(a/o)*o:e.x,u=d>0?e.x+e.width-Math.floor(d/o)*o:e.x+e.width,c=f>0?e.y+Math.floor(f/o)*o:e.y,h=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:c,width:u-m,height:h-c}}function Mr(e,t,n,o,i){const[r,l,s,a]=t,[d,f,g,m]=i,{x:u,y:c,width:h,height:y}=e,b=[];if(h<=0||y<=0)return b;const k=u+h,E=c+y,A=u<r,H=c<l,S=u+h>s,F=c+y>a,L=u>=r&&u<s||k>r&&k<=s||u<r&&k>s,C=c>=l&&c<a||E>l&&E<=a||c<l&&E>a;if(L&&C){const B=Math.max(u,r),w=Math.max(c,l),x=Math.min(k,s),p=Math.min(E,a);b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:d,y:f,width:g-d+1,height:m-f+1}})}if(A&&H){const B=u,w=c,x=Math.min(k,r),p=Math.min(E,l);b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:0,y:0,width:d+1,height:f+1}})}if(H&&L){const B=Math.max(u,r),w=c,x=Math.min(k,s),p=Math.min(E,l);b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:d,y:0,width:g-d+1,height:f+1}})}if(H&&S){const B=Math.max(u,s),w=c,x=k,p=Math.min(E,l);b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:g,y:0,width:n-g+1,height:f+1}})}if(A&&C){const B=u,w=Math.max(c,l),x=Math.min(k,r),p=Math.min(E,a);b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:0,y:f,width:d+1,height:m-f+1}})}if(S&&C){const B=Math.max(u,s),w=Math.max(c,l),x=k,p=Math.min(E,a);b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:g,y:f,width:n-g+1,height:m-f+1}})}if(A&&F){const B=u,w=Math.max(c,a),x=Math.min(k,r),p=E;b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:0,y:m,width:d+1,height:o-m+1}})}if(F&&L){const B=Math.max(u,r),w=Math.max(c,a),x=Math.min(k,s),p=E;b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:d,y:m,width:g-d+1,height:o-m+1}})}if(S&&F){const B=Math.max(u,s),w=Math.max(c,a),x=k,p=E;b.push({rect:{x:B,y:w,width:x-B,height:p-w},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return b}const Er={kind:se.Loading,allowOverlay:!1};function Ao(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y,b,k,E,A,H,S,F,L,C,P,B,w,x,p,q,V,Y,ie){let we=(E==null?void 0:E.size)??Number.MAX_SAFE_INTEGER;const de=performance.now();let le=x.baseFontFull;e.font=le;const Le={ctx:e},J=[0,0],ze=y>0?Xt(a,y,d):0;let Ae,X;const Me=ai(k);return St(t,s,r,l,i,(ne,Re,_e,lt,It)=>{const at=Math.max(0,lt-Re),Ue=Re+at,ge=i+1,vt=ne.width-at,Oe=o-i-1;if(k.length>0){let fe=!1;for(let me=0;me<k.length;me++){const R=k[me];if(on(Ue,ge,vt,Oe,R.x,R.y,R.width,R.height)){fe=!0;break}}if(!fe)return}const re=()=>{e.save(),e.beginPath(),e.rect(Ue,ge,vt,Oe),e.clip()},tt=A.columns.hasIndex(ne.sourceIndex),We=g(ne.group??"").overrideTheme,Ee=ne.themeOverride===void 0&&We===void 0?x:nn(x,We,ne.themeOverride),ue=Ee.baseFontFull;ue!==le&&(le=ue,e.font=ue),re();let be;return kn(It,_e,o,a,d,y,b,Me,(fe,me,R,He,_)=>{var ot,it,Ht;if(me<0||(J[0]=ne.sourceIndex,J[1]=me,E!==void 0&&!E.has(J)))return;if(k.length>0){let Q=!1;for(let xe=0;xe<k.length;xe++){const ve=k[xe];if(on(Re,fe,ne.width,R,ve.x,ve.y,ve.width,ve.height)){Q=!0;break}}if(!Q)return}const G=A.rows.hasIndex(me),ke=u.hasIndex(me),ae=me<a?f(J):Er;let ce=Re,K=ne.width,Pe=!1,Xe=!1;if(ae.span!==void 0){const[Q,xe]=ae.span,ve=`${me},${Q},${xe},${ne.sticky}`;if(X===void 0&&(X=new Set),X.has(ve)){we--;return}else{const bt=di(ae.span,Re,fe,ne.width,R,ne,n),je=ne.sticky?bt[0]:bt[1];if(!ne.sticky&&bt[0]!==void 0&&(Xe=!0),je!==void 0){ce=je.x,K=je.width,X.add(ve),e.restore(),be=void 0,e.save(),e.beginPath();const pt=Math.max(0,lt-je.x);e.rect(je.x+pt,fe,je.width-pt,R),Ae===void 0&&(Ae=[]),Ae.push({x:je.x+pt,y:fe,width:je.width-pt,height:R}),e.clip(),Pe=!0}}}const $e=m==null?void 0:m(me),Ge=_&&((ot=ne.trailingRowOptions)==null?void 0:ot.themeOverride)!==void 0?(it=ne.trailingRowOptions)==null?void 0:it.themeOverride:void 0,Ce=ae.themeOverride===void 0&&$e===void 0&&Ge===void 0?Ee:nn(Ee,$e,Ge,ae.themeOverride);e.beginPath();const nt=sr(J,ae,A);let Ne=ar(J,ae,A,h);const Yt=ae.span!==void 0&&A.columns.some(Q=>ae.span!==void 0&&Q>=ae.span[0]&&Q<=ae.span[1]);nt&&!c&&h?Ne=0:nt&&h&&(Ne=Math.max(Ne,1)),Yt&&Ne++,nt||(G&&Ne++,tt&&!_&&Ne++);const ct=ae.kind===se.Protected?Ce.bgCellMedium:Ce.bgCell;let pe;if((He||ct!==x.bgCell)&&(pe=Ye(ct,pe)),Ne>0||ke){ke&&(pe=Ye(Ce.bgHeader,pe));for(let Q=0;Q<Ne;Q++)pe=Ye(Ce.accentLight,pe)}else if(H!==void 0){for(const Q of H)if(Q[0]===ne.sourceIndex&&Q[1]===me){pe=Ye(Ce.bgSearchResult,pe);break}}if(S!==void 0)for(let Q=0;Q<S.length;Q++){const xe=S[Q],ve=xe.range;xe.style!=="solid-outline"&&ve.x<=ne.sourceIndex&&ne.sourceIndex<ve.x+ve.width&&ve.y<=me&&me<ve.y+ve.height&&(pe=Ye(xe.color,pe))}let dt=!1;if(E!==void 0){const Q=fe+1,ve=(He?Q+R-1:Math.min(Q+R-1,o-ze))-Q;(ve!==R-1||ce+1<=lt)&&(dt=!0,e.save(),e.beginPath(),e.rect(ce+1,Q,K-1,ve),e.clip()),pe=pe===void 0?Ce.bgCell:Ye(pe,Ce.bgCell)}const ye=ne.sourceIndex===n.length-1,qe=me===a-1;pe!==void 0&&(e.fillStyle=pe,be!==void 0&&(be.fillStyle=pe),E!==void 0?e.fillRect(ce+1,fe+1,K-(ye?2:1),R-(qe?2:1)):e.fillRect(ce,fe,K,R)),ae.style==="faded"&&(e.globalAlpha=.6);let ut;for(let Q=0;Q<C.length;Q++){const xe=C[Q];if(xe.item[0]===ne.sourceIndex&&xe.item[1]===me){ut=xe;break}}if(K>ie&&!Xe){const Q=Ce.baseFontFull;Q!==le&&(e.font=Q,le=Q),be=fi(e,ae,ne.sourceIndex,me,ye,qe,ce,fe,K,R,Ne>0,Ce,pe??Ce.bgCell,F,L,(ut==null?void 0:ut.hoverAmount)??0,P,w,de,B,be,p,q,V,Y)}return dt&&e.restore(),ae.style==="faded"&&(e.globalAlpha=1),we--,Pe&&(e.restore(),(Ht=be==null?void 0:be.deprep)==null||Ht.call(be,Le),be=void 0,re(),le=ue,e.font=ue),we<=0}),e.restore(),we<=0}),Ae}const Vt=[0,0],Kt={x:0,y:0,width:0,height:0},Rn=[void 0,()=>{}];let Vn=!1;function Br(){Vn=!0}function fi(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y,b,k,E,A,H,S,F,L){var q,V;let C,P;y!==void 0&&y[0][0]===n&&y[0][1]===o&&(C=y[1][0],P=y[1][1]);let B;Vt[0]=n,Vt[1]=o,Kt.x=l,Kt.y=s,Kt.width=a,Kt.height=d,Rn[0]=S.getValue(Vt),Rn[1]=Y=>S.setValue(Vt,Y),Vn=!1;const w={ctx:e,theme:g,col:n,row:o,cell:t,rect:Kt,highlighted:f,cellFillColor:m,hoverAmount:h,frameTime:k,hoverX:C,drawState:Rn,hoverY:P,imageLoader:u,spriteManager:c,hyperWrapping:b,overrideCursor:C!==void 0?L:void 0,requestAnimationFrame:Br},x=gr(w,t.lastUpdated,k,A,i,r),p=F(t);if(p!==void 0){(A==null?void 0:A.renderer)!==p&&((q=A==null?void 0:A.deprep)==null||q.call(A,w),A=void 0);const Y=(V=p.drawPrep)==null?void 0:V.call(p,w,A);E!==void 0&&!Vo(w.cell)?E(w,()=>p.draw(w,t)):p.draw(w,t),B=Y===void 0?void 0:{deprep:Y==null?void 0:Y.deprep,fillStyle:Y==null?void 0:Y.fillStyle,font:Y==null?void 0:Y.font,renderer:p}}return(x||Vn)&&(H==null||H(Vt)),B}function oo(e,t,n,o,i,r,l,s,a=-20,d=-20,f=32,g="center",m="square"){const u=Math.floor(i+l/2),c=m==="circle"?1e4:t.roundingRadius??4;let h=Jo(f,l,t.cellVerticalPadding),y=h/2;const b=Go(g,o,r,t.cellHorizontalPadding,h),k=Ko(b,u,h),E=Qo(o+a,i+d,k);switch(n){case!0:{e.beginPath(),st(e,b-h/2,u-h/2,h,h,c),m==="circle"&&(y*=.8,h*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(b-y+h/4.23,u-y+h/1.97),e.lineTo(b-y+h/2.42,u-y+h/1.44),e.lineTo(b-y+h/1.29,u-y+h/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case xn:case!1:{e.beginPath(),st(e,b-h/2+.5,u-h/2+.5,h-1,h-1,c),e.lineWidth=1,e.strokeStyle=E?t.textDark:t.textMedium,e.stroke();break}case Jn:{e.beginPath(),st(e,b-h/2,u-h/2,h,h,c),e.fillStyle=E?t.textMedium:t.textLight,e.fill(),m==="circle"&&(y*=.8,h*=.8),e.beginPath(),e.moveTo(b-h/3,u),e.lineTo(b+h/3,u),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Gn()}}function Fr(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y,b,k){const E=l+s;if(E<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,E);const[A,H]=(o==null?void 0:o[0])??[],S=g.headerFontFull;e.font=S,St(t,0,r,0,E,(F,L,C,P)=>{var Le;if(y!==void 0&&!y.has([F.sourceIndex,-1]))return;const B=Math.max(0,P-L);e.save(),e.beginPath(),e.rect(L+B,s,F.width-B,l),e.clip();const w=h(F.group??"").overrideTheme,x=F.themeOverride===void 0&&w===void 0?g:nn(g,w,F.themeOverride);x.bgHeader!==g.bgHeader&&(e.fillStyle=x.bgHeader,e.fill()),x!==g&&(e.font=x.baseFontFull);const p=f.columns.hasIndex(F.sourceIndex),q=a!==void 0||d,V=!q&&H===-1&&A===F.sourceIndex,Y=q?0:((Le=u.find(J=>J.item[0]===F.sourceIndex&&J.item[1]===-1))==null?void 0:Le.hoverAmount)??0,ie=(f==null?void 0:f.current)!==void 0&&f.current.cell[0]===F.sourceIndex,we=p?x.accentColor:ie?x.bgHeaderHasFocus:x.bgHeader,de=n?s:0,le=F.sourceIndex===0?0:1;p?(e.fillStyle=we,e.fillRect(L+le,de,F.width-le,l)):(ie||Y>0)&&(e.beginPath(),e.rect(L+le,de,F.width-le,l),ie&&(e.fillStyle=x.bgHeaderHasFocus,e.fill()),Y>0&&(e.globalAlpha=Y,e.fillStyle=x.bgHeaderHovered,e.fill(),e.globalAlpha=1)),mi(e,L,de,F.width,l,F,p,x,V,ie,Y,m,b,k),e.restore()}),n&&Dr(e,t,i,r,s,o,g,m,u,c,h,y)}function Dr(e,t,n,o,i,r,l,s,a,d,f,g){const[u,c]=(r==null?void 0:r[0])??[];let h=0;ci(t,n,o,i,(y,b,k,E,A,H)=>{if(g!==void 0&&!g.hasItemInRectangle({x:y[0],y:-2,width:y[1]-y[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(k,E,A,H),e.clip();const S=f(b),F=(S==null?void 0:S.overrideTheme)===void 0?l:nn(l,S.overrideTheme),L=c===-2&&u!==void 0&&u>=y[0]&&u<=y[1],C=L?F.bgHeaderHovered:F.bgHeader;if(C!==l.bgHeader&&(e.fillStyle=C,e.fill()),e.fillStyle=F.textGroupHeader??F.textHeader,S!==void 0){let P=k;if(S.icon!==void 0&&(s.drawSprite(S.icon,"normal",e,P+8,(i-20)/2,20,F),P+=26),e.fillText(S.name,P+8,i/2+Ct(e,l.headerFontFull)),S.actions!==void 0&&L){const B=hi({x:k,y:E,width:A,height:H},S.actions);e.beginPath();const w=B[0].x-10,x=k+A-w;e.rect(w,0,x,i);const p=e.createLinearGradient(w,0,w+x,0),q=sn(C,0);p.addColorStop(0,q),p.addColorStop(10/x,C),p.addColorStop(1,C),e.fillStyle=p,e.fill(),e.globalAlpha=.6;const[V,Y]=(r==null?void 0:r[1])??[-1,-1];for(let ie=0;ie<S.actions.length;ie++){const we=S.actions[ie],de=B[ie],le=en(de,V+k,Y);le&&(e.globalAlpha=1),s.drawSprite(we.icon,"normal",e,de.x+de.width/2-10,de.y+de.height/2-10,20,F),le&&(e.globalAlpha=.6)}e.globalAlpha=1}}k!==0&&d(y[0])&&(e.beginPath(),e.moveTo(k+.5,0),e.lineTo(k+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),h=k+A}),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const Nt=30;function Ar(e,t,n,o,i){return i?{x:e,y:t,width:Nt,height:Math.min(Nt,o)}:{x:e+n-Nt,y:Math.max(t,t+o/2-Nt/2),width:Nt,height:Math.min(Nt,o)}}function hi(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function Gt(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function gi(e,t,n,o,i,r,l,s){var b;const a=l.cellHorizontalPadding,d=l.headerIconSize,f=Ar(n,o,i,r,!1);let g=n+a;const m=t.icon===void 0?void 0:{x:g,y:o+(r-d)/2,width:d,height:d},u=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(d*1.3));const c={x:g,y:o,width:i-g,height:r};let h;if(t.indicatorIcon!==void 0){const k=e===void 0?((b=oi(t.title,l.headerFontFull))==null?void 0:b.width)??0:$t(t.title,e,l.headerFontFull).width;c.width=k,g+=k+a,h={x:g,y:o+(r-d)/2,width:d,height:d}}const y=n+i/2;return{menuBounds:Gt(f,y,s),iconBounds:Gt(m,y,s),iconOverlayBounds:Gt(u,y,s),textBounds:Gt(c,y,s),indicatorIconBounds:Gt(h,y,s)}}function Ho(e,t,n,o,i,r,l,s,a,d,f,g,m,u){if(r.rowMarker!==void 0){const y=r.rowMarkerChecked;y!==!0&&(e.globalAlpha=d),oo(e,s,y,t,n,o,i,!1,void 0,void 0,18,"center",r.rowMarker),y!==!0&&(e.globalAlpha=1);return}const c=l?s.textHeaderSelected:s.textHeader,h=r.hasMenu===!0&&(a||g&&l)&&u.menuBounds!==void 0;if(r.icon!==void 0&&u.iconBounds!==void 0){let y=l?"selected":"normal";r.style==="highlight"&&(y=l?"selected":"special"),f.drawSprite(r.icon,y,e,u.iconBounds.x,u.iconBounds.y,u.iconBounds.width,s),r.overlayIcon!==void 0&&u.iconOverlayBounds!==void 0&&f.drawSprite(r.overlayIcon,l?"selected":"special",e,u.iconOverlayBounds.x,u.iconOverlayBounds.y,u.iconOverlayBounds.width,s)}if(h&&o>35){const b=m?35:o-35,k=m?35*.7:o-35*.7,E=b/o,A=k/o,H=e.createLinearGradient(t,0,t+o,0),S=sn(c,0);H.addColorStop(m?1:0,c),H.addColorStop(E,c),H.addColorStop(A,S),H.addColorStop(m?0:1,S),e.fillStyle=H}else e.fillStyle=c;if(m&&(e.textAlign="right"),u.textBounds!==void 0&&e.fillText(r.title,m?u.textBounds.x+u.textBounds.width:u.textBounds.x,n+i/2+Ct(e,s.headerFontFull)),m&&(e.textAlign="left"),r.indicatorIcon!==void 0&&u.indicatorIconBounds!==void 0&&(!h||!on(u.menuBounds.x,u.menuBounds.y,u.menuBounds.width,u.menuBounds.height,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,u.indicatorIconBounds.height))){let y=l?"selected":"normal";r.style==="highlight"&&(y=l?"selected":"special"),f.drawSprite(r.indicatorIcon,y,e,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,s)}if(h&&u.menuBounds!==void 0){const y=u.menuBounds;if(r.menuIcon===void 0||r.menuIcon===Xn.Triangle){e.beginPath();const b=y.x+y.width/2-5.5,k=y.y+y.height/2-3;br(e,[{x:b,y:k},{x:b+11,y:k},{x:b+5.5,y:k+6}],1),e.fillStyle=c,e.fill()}else if(r.menuIcon===Xn.Dots){e.beginPath();const b=y.x+y.width/2,k=y.y+y.height/2;vr(e,b,k),e.fillStyle=c,e.fill()}else{const b=y.x+(y.width-s.headerIconSize)/2,k=y.y+(y.height-s.headerIconSize)/2;f.drawSprite(r.menuIcon,"normal",e,b,k,s.headerIconSize,s)}}}function mi(e,t,n,o,i,r,l,s,a,d,f,g,m,u){const c=Zn(r.title)==="rtl",h=gi(e,r,t,n,o,i,s,c);m!==void 0?m({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:f,isHovered:a,hasSelectedCell:d,spriteManager:g,menuBounds:(h==null?void 0:h.menuBounds)??{x:0,y:0,height:0,width:0}},()=>Ho(e,t,n,o,i,r,l,s,a,f,g,u,c,h)):Ho(e,t,n,o,i,r,l,s,a,f,g,u,c,h)}function Hr(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y,b,k){if(b!==void 0||t[t.length-1]!==n[t.length-1])return;const E=ai(y);St(t,a,l,s,r,(A,H,S,F,L)=>{if(A!==t[t.length-1])return;H+=A.width;const C=Math.max(H,F);C>o||(e.save(),e.beginPath(),e.rect(C,r+1,1e4,i-r-1),e.clip(),kn(L,S,i,d,f,c,h,E,(P,B,w,x)=>{if(!x&&y.length>0&&!y.some(ie=>on(H,P,1e4,w,ie.x,ie.y,ie.width,ie.height)))return;const p=m.hasIndex(B),q=u.hasIndex(B);e.beginPath();const V=g==null?void 0:g(B),Y=V===void 0?k:nn(k,V);Y.bgCell!==k.bgCell&&(e.fillStyle=Y.bgCell,e.fillRect(H,P,1e4,w)),q&&(e.fillStyle=Y.bgHeader,e.fillRect(H,P,1e4,w)),p&&(e.fillStyle=Y.accentLight,e.fillRect(H,P,1e4,w))}),e.restore())})}function Pr(e,t,n,o,i,r,l,s,a){let d=!1;for(const c of t)if(!c.sticky){d=l(c.sourceIndex);break}const f=a.horizontalBorderColor??a.borderColor,g=a.borderColor,m=d?Ot(t):0;let u;if(m!==0&&(u=Do(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=u,e.stroke()),i>0){const c=g===f&&u!==void 0?u:Do(f,a.bgCell),h=Xt(r,i,s);e.beginPath(),e.moveTo(0,o-h+.5),e.lineTo(n,o-h+.5),e.strokeStyle=c,e.stroke()}}const yi=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Rr(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c){var w;const h=c.bgCell,{minX:y,maxX:b,minY:k,maxY:E}=yi(s,r,l),A=[],H=l-Xt(u,m,d);let S=a,F=n,L=0;for(;S+i<H;){const x=S+i,p=d(F);if(x>=k&&x<=E-1){const q=f==null?void 0:f(F),V=q==null?void 0:q.bgCell;V!==void 0&&V!==h&&F>=u-m&&A.push({x:y,y:x,w:b-y,h:p,color:V})}S+=p,F<u-m&&(L=S),F++}let C=0;const P=Math.min(H,E)-L;if(P>0)for(let x=0;x<t.length;x++){const p=t[x];if(p.width===0)continue;const q=p.sticky?C:C+o,V=(w=p.themeOverride)==null?void 0:w.bgCell;V!==void 0&&V!==h&&q>=y&&q<=b&&g(x+1)&&A.push({x:q,y:L,w:p.width,h:P,color:V}),C+=p.width}if(A.length===0)return;let B;e.beginPath();for(let x=A.length-1;x>=0;x--){const p=A[x];B===void 0?B=p.color:p.color!==B&&(e.fillStyle=B,e.fill(),e.beginPath(),B=p.color),e.rect(p.x,p.y,p.w,p.h)}B!==void 0&&(e.fillStyle=B,e.fill()),e.beginPath()}function Po(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y,b=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const w of a)e.rect(w.x+1,w.y+1,w.width-1,w.height-1);e.clip("evenodd")}const k=y.horizontalBorderColor??y.borderColor,E=y.borderColor,{minX:A,maxX:H,minY:S,maxY:F}=yi(s,r,l),L=[];e.beginPath();let C=.5;for(let w=0;w<t.length;w++){const x=t[w];if(x.width===0)continue;C+=x.width;const p=x.sticky?C:C+o;p>=A&&p<=H&&u(w+1)&&L.push({x1:p,y1:Math.max(d,S),x2:p,y2:Math.min(l,F),color:E})}let P=l+.5;for(let w=h-c;w<h;w++){const x=g(w);P-=x,L.push({x1:A,y1:P,x2:H,y2:P,color:k})}if(b!==!0){let w=f+.5,x=n;const p=P;for(;w+i<p;){const q=w+i;if(q>=S&&q<=F-1){const V=m==null?void 0:m(x);L.push({x1:A,y1:q,x2:H,y2:q,color:(V==null?void 0:V.horizontalBorderColor)??(V==null?void 0:V.borderColor)??k})}w+=g(x),x++}}const B=_i(L,w=>w.color);for(const w of Object.keys(B)){e.strokeStyle=w;for(const x of B[w])e.moveTo(x.x1,x.y1),e.lineTo(x.x2,x.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Tr(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y,b,k){const E=[];e.imageSmoothingEnabled=!1;const A=Math.min(i.cellYOffset,l),H=Math.max(i.cellYOffset,l);let S=0;if(typeof b=="number")S+=(H-A)*b;else for(let p=A;p<H;p++)S+=b(p);l>i.cellYOffset&&(S=-S),S+=a-i.translateY;const F=Math.min(i.cellXOffset,r),L=Math.max(i.cellXOffset,r);let C=0;for(let p=F;p<L;p++)C+=h[p].width;r>i.cellXOffset&&(C=-C),C+=s-i.translateX;const P=Ot(y);if(C!==0&&S!==0)return{regions:[]};const B=d>0?Xt(m,d,b):0,w=f-P-Math.abs(C),x=g-u-B-Math.abs(S)-1;if(w>150&&x>150){const p={sx:0,sy:0,sw:f*c,sh:g*c,dx:0,dy:0,dw:f*c,dh:g*c};if(S>0?(p.sy=(u+1)*c,p.sh=x*c,p.dy=(S+u+1)*c,p.dh=x*c,E.push({x:0,y:u,width:f,height:S+1})):S<0&&(p.sy=(-S+u+1)*c,p.sh=x*c,p.dy=(u+1)*c,p.dh=x*c,E.push({x:0,y:g+S-B,width:f,height:-S+B})),C>0?(p.sx=P*c,p.sw=w*c,p.dx=(C+P)*c,p.dw=w*c,E.push({x:P-1,y:0,width:C+2,height:g})):C<0&&(p.sx=(P-C)*c,p.sw=w*c,p.dx=P*c,p.dw=w*c,E.push({x:f+C,y:0,width:-C,height:g})),e.setTransform(1,0,0,1,0,0),k){if(P>0&&C!==0&&S===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const q=P*c,V=g*c;e.drawImage(t,0,0,q,V,0,0,q,V)}if(B>0&&C===0&&S!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const q=(g-B)*c,V=f*c,Y=B*c;e.drawImage(t,0,q,V,Y,0,q,V,Y)}}e.drawImage(t,p.sx,p.sy,p.sw,p.sh,p.dx,p.dy,p.dw,p.dh),e.scale(c,c)}return e.imageSmoothingEnabled=!0,{regions:E}}function Wr(e,t,n,o,i,r,l,s,a,d){const f=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||St(a,n,o,i,s,(g,m,u,c)=>{if(g.sourceIndex===d){const h=Math.max(m,c)+1;return f.push({x:h,y:0,width:r-h,height:l}),!0}}),f}function Lr(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(zt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...d}=r;if(!zt(s,d))return!1;n=o}return n===void 0?!0:n}return!0}function Ro(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h){const y=c==null?void 0:c.filter(F=>F.style!=="no-outline");if(y===void 0||y.length===0)return;const b=Ot(s),k=Xt(u,m,g),E=[a,0,s.length,u-m],A=[b,0,t,n-k],H=y.map(F=>{const L=F.range,C=F.style??"dashed";return Mr(L,E,t,n,A).map(P=>{const B=P.rect,w=qn(B.x,B.y,t,n,f,d+f,o,i,r,l,u,a,m,s,g),x=B.width===1&&B.height===1?w:qn(B.x+B.width-1,B.y+B.height-1,t,n,f,d+f,o,i,r,l,u,a,m,s,g);return B.x+B.width>=s.length&&(x.width-=1),B.y+B.height>=u&&(x.height-=1),{color:F.color,style:C,clip:P.clip,rect:Ir({x:w.x,y:w.y,width:x.x+x.width-w.x,height:x.y+x.height-w.y},t,n,8)}})}),S=()=>{e.lineWidth=1;let F=!1;for(const L of H)for(const C of L)if((C==null?void 0:C.rect)!==void 0&&on(0,0,t,n,C.rect.x,C.rect.y,C.rect.width,C.rect.height)){const P=F,B=!Sr(C.clip,C.rect);B&&(e.save(),e.rect(C.clip.x,C.clip.y,C.clip.width,C.clip.height),e.clip()),C.style==="dashed"&&!F?(e.setLineDash([5,3]),F=!0):(C.style==="solid"||C.style==="solid-outline")&&F&&(e.setLineDash([]),F=!1),e.strokeStyle=C.style==="solid-outline"?Ye(Ye(C.color,h.borderColor),h.bgCell):sn(C.color,1),e.strokeRect(C.rect.x+.5,C.rect.y+.5,C.rect.width-1,C.rect.height-1),B&&(e.restore(),F=P)}F&&e.setLineDash([])};return S(),S}function To(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Tn(e,t,n,o,i,r,l,s,a,d,f,g,m,u,c,h,y){if(f.current===void 0)return;const b=f.current.range,k=f.current.cell,E=[b.x+b.width-1,b.y+b.height-1];if(k[1]>=y&&E[1]>=y||!l.some(p=>p.sourceIndex===k[0]||p.sourceIndex===E[0]))return;const[H,S]=f.current.cell,F=m(f.current.cell),L=F.span??[H,H],C=S>=y-u,P=u>0&&!C?Xt(y,u,g)-1:0,B=E[1];let w;if(St(l,o,i,r,d,(p,q,V,Y,ie)=>{if(p.sticky&&H>p.sourceIndex)return;const we=p.sourceIndex<L[0],de=p.sourceIndex>L[1],le=p.sourceIndex===E[0];if(!(!le&&(we||de)))return kn(ie,V,n,y,g,u,c,void 0,(Le,J,ze)=>{if(J!==S&&J!==B)return;let Ae=q,X=p.width;if(F.span!==void 0){const ne=di(F.span,q,Le,p.width,ze,p,s),Re=p.sticky?ne[0]:ne[1];Re!==void 0&&(Ae=Re.x,X=Re.width)}return J===B&&le&&h&&(w=()=>{var ne;Y>Ae&&!p.sticky&&(e.beginPath(),e.rect(Y,0,t-Y,n),e.clip()),e.beginPath(),e.rect(Ae+X-4,Le+ze-4,4,4),e.fillStyle=((ne=p.themeOverride)==null?void 0:ne.accentColor)??a.accentColor,e.fill()}),w!==void 0}),w!==void 0}),w===void 0)return;const x=()=>{e.save(),e.beginPath(),e.rect(0,d,t,n-d-P),e.clip(),w==null||w(),e.restore()};return x(),x}function Nr(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),ci(t,n,r,o,(d,f,g,m,u,c)=>{a.hasItemInRectangle({x:d[0],y:-2,width:d[1]-d[0]+1,height:1})&&e.rect(g,m,u,c)}),St(t,s,r,l,i,(d,f,g,m)=>{const u=Math.max(0,m-f),c=f+u+1,h=d.width-u-1;a.has([d.sourceIndex,-1])&&e.rect(c,o,h,i-o)}),e.clip())}function zr(e,t,n,o,i,r,l,s,a,d){let f=0;return St(e,r,o,i,n,(g,m,u,c,h)=>(kn(h,u,t,l,s,a,d,void 0,(y,b,k,E)=>{E||(f=Math.max(b,f))}),!0)),f}function Wo(e,t){var dt;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:d,mappedColumns:f,enableGroups:g,freezeColumns:m,dragAndDropState:u,theme:c,drawFocus:h,headerHeight:y,groupHeaderHeight:b,disabledRows:k,rowHeight:E,verticalBorder:A,overrideCursor:H,isResizing:S,selection:F,fillHandle:L,freezeTrailingRows:C,rows:P,getCellContent:B,getGroupDetails:w,getRowThemeOverride:x,isFocused:p,drawHeaderCallback:q,prelightCells:V,drawCellCallback:Y,highlightRegions:ie,resizeCol:we,imageLoader:de,lastBlitData:le,hoverValues:Le,hyperWrapping:J,hoverInfo:ze,spriteManager:Ae,maxScaleFactor:X,hasAppendRow:Me,touchMode:ne,enqueue:Re,renderStateProvider:_e,getCellRenderer:lt,renderStrategy:It,bufferACtx:at,bufferBCtx:Ue,damage:ge,minimumCellWidth:vt}=e;if(i===0||r===0)return;const Oe=It==="double-buffer",re=Math.min(X,Math.ceil(window.devicePixelRatio??1)),tt=It!=="direct"&&Lr(e,t),We=n.canvas;(We.width!==i*re||We.height!==r*re)&&(We.width=i*re,We.height=r*re,We.style.width=i+"px",We.style.height=r+"px");const Ee=o.canvas,ue=g?b+y:y,be=ue+1;(Ee.width!==i*re||Ee.height!==be*re)&&(Ee.width=i*re,Ee.height=be*re,Ee.style.width=i+"px",Ee.style.height=be+"px");const fe=at.canvas,me=Ue.canvas;Oe&&(fe.width!==i*re||fe.height!==r*re)&&(fe.width=i*re,fe.height=r*re,le.current!==void 0&&(le.current.aBufferScroll=void 0)),Oe&&(me.width!==i*re||me.height!==r*re)&&(me.width=i*re,me.height=r*re,le.current!==void 0&&(le.current.bBufferScroll=void 0));const R=le.current;if(tt===!0&&l===(R==null?void 0:R.cellXOffset)&&s===(R==null?void 0:R.cellYOffset)&&a===(R==null?void 0:R.translateX)&&d===(R==null?void 0:R.translateY))return;let He=null;Oe&&(He=n);const _=o;let G;Oe?ge!==void 0?G=(R==null?void 0:R.lastBuffer)==="b"?Ue:at:G=(R==null?void 0:R.lastBuffer)==="b"?at:Ue:G=n;const ke=G.canvas,ae=Oe?ke===fe?me:fe:We,ce=typeof E=="number"?()=>E:E;_.save(),G.save(),_.beginPath(),G.beginPath(),_.textBaseline="middle",G.textBaseline="middle",re!==1&&(_.scale(re,re),G.scale(re,re));const K=Un(f,l,i,u,a);let Pe=[];const Xe=h&&((dt=F.current)==null?void 0:dt.cell[1])===s&&d===0;let $e=!1;if(ie!==void 0){for(const ye of ie)if(ye.style!=="no-outline"&&ye.range.y===s&&d===0){$e=!0;break}}const Ge=()=>{Fr(_,K,g,ze,i,a,y,b,u,S,F,c,Ae,Le,A,w,ge,q,ne),Po(_,K,s,a,d,i,r,void 0,void 0,b,ue,ce,x,A,C,P,c,!0),_.beginPath(),_.moveTo(0,be-.5),_.lineTo(i,be-.5),_.strokeStyle=Ye(c.headerBottomBorderColor??c.horizontalBorderColor??c.borderColor,c.bgHeader),_.stroke(),$e&&Ro(_,i,r,l,s,a,d,f,m,y,b,E,C,P,ie,c),Xe&&Tn(_,i,r,s,a,d,K,f,c,ue,F,ce,B,C,Me,L,P)};if(ge!==void 0){const ye=K[K.length-1].sourceIndex+1,qe=ge.hasItemInRegion([{x:l,y:-2,width:ye,height:2},{x:l,y:s,width:ye,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:l,y:P-C,width:ye,height:C,when:C>0}]),ut=ot=>{Ao(ot,K,f,r,ue,a,d,s,P,ce,B,w,x,k,p,h,C,Me,Pe,ge,F,V,ie,de,Ae,Le,ze,Y,J,c,Re,_e,lt,H,vt);const it=F.current;L&&h&&it!==void 0&&ge.has(ei(it.range))&&Tn(ot,i,r,s,a,d,K,f,c,ue,F,ce,B,C,Me,L,P)};qe&&(ut(G),He!==null&&(He.save(),He.scale(re,re),He.textBaseline="middle",ut(He),He.restore()),ge.hasHeader()&&(Nr(_,K,i,b,ue,a,d,s,ge),Ge())),G.restore(),_.restore();return}if((tt!==!0||l!==(R==null?void 0:R.cellXOffset)||a!==(R==null?void 0:R.translateX)||Xe!==(R==null?void 0:R.mustDrawFocusOnHeader)||$e!==(R==null?void 0:R.mustDrawHighlightRingsOnHeader))&&Ge(),tt===!0){gt(ae!==void 0&&R!==void 0);const{regions:ye}=Tr(G,ae,ae===fe?R.aBufferScroll:R.bBufferScroll,ae===fe?R.bBufferScroll:R.aBufferScroll,R,l,s,a,d,C,i,r,P,ue,re,f,K,E,Oe);Pe=ye}else tt!==!1&&(gt(R!==void 0),Pe=Wr(R,l,s,a,d,i,r,ue,K,tt));Pr(G,K,i,r,C,P,A,ce,c);const Ce=Ro(G,i,r,l,s,a,d,f,m,y,b,E,C,P,ie,c),nt=h?Tn(G,i,r,s,a,d,K,f,c,ue,F,ce,B,C,Me,L,P):void 0;if(G.fillStyle=c.bgCell,Pe.length>0){G.beginPath();for(const ye of Pe)G.rect(ye.x,ye.y,ye.width,ye.height);G.clip(),G.fill(),G.beginPath()}else G.fillRect(0,0,i,r);const Ne=Ao(G,K,f,r,ue,a,d,s,P,ce,B,w,x,k,p,h,C,Me,Pe,ge,F,V,ie,de,Ae,Le,ze,Y,J,c,Re,_e,lt,H,vt);Hr(G,K,f,i,r,ue,a,d,s,P,ce,x,F.rows,k,C,Me,Pe,ge,c),Rr(G,K,s,a,d,i,r,Pe,ue,ce,x,A,C,P,c),Po(G,K,s,a,d,i,r,Pe,Ne,b,ue,ce,x,A,C,P,c),Ce==null||Ce(),nt==null||nt(),S&&St(K,0,a,0,ue,(ye,qe)=>ye.sourceIndex===we?(To(_,qe+ye.width,0,ue+1,Ye(c.resizeIndicatorColor??c.accentLight,c.bgHeader)),To(G,qe+ye.width,ue,r,Ye(c.resizeIndicatorColor??c.accentLight,c.bgCell)),!0):!1),He!==null&&(He.fillStyle=c.bgCell,He.fillRect(0,0,i,r),He.drawImage(G.canvas,0,0));const Yt=zr(K,r,ue,a,d,s,P,ce,C,Me);de==null||de.setWindow({x:l,y:s,width:K.length,height:Yt-s},m,Array.from({length:C},(ye,qe)=>P-1-qe));const ct=R!==void 0&&(l!==R.cellXOffset||a!==R.translateX),pe=R!==void 0&&(s!==R.cellYOffset||d!==R.translateY);le.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:d,mustDrawFocusOnHeader:Xe,mustDrawHighlightRingsOnHeader:$e,lastBuffer:Oe?ke===fe?"a":"b":void 0,aBufferScroll:ke===fe?[ct,pe]:R==null?void 0:R.aBufferScroll,bBufferScroll:ke===me?[ct,pe]:R==null?void 0:R.bBufferScroll},G.restore(),_.restore()}const Or=80;function Xr(e){const t=e-1;return t*t*t+1}class $r{constructor(t){te(this,"currentHoveredItem");te(this,"leavingItems",[]);te(this,"lastAnimationTime");te(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>bn(o.item,t.item))||this.leavingItems.push(t)});te(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>bn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});te(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});te(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});te(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Xr(t.hoverAmount)})));te(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Or;for(const r of this.leavingItems)r.hoverAmount=wn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=wn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});te(this,"setHovered",t=>{var n;if(!bn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Yr{constructor(t){te(this,"fn");te(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function io(e){return new Yr(e)}const _r=io(()=>window.navigator.userAgent.includes("Firefox")),Lo=io(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),hl=io(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Ur(e){const t=I.useRef([]),n=I.useRef(0),o=I.useRef(e);o.current=e;const i=I.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(no);t.current=[],o.current(new Zt(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return I.useCallback(r=>{t.current.length===0&&i();const l=et(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Dt="header",At="group-header",No="out-of-bounds";var Jt=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(Jt||{});function qr(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const zo=6,jr=(e,t)=>{if(e.kind===se.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Vr=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:d=!1,groupHeaderHeight:f,rowHeight:g,rows:m,getCellContent:u,getRowThemeOverride:c,onHeaderMenuClick:h,onHeaderIndicatorClick:y,enableGroups:b,isFilling:k,onCanvasFocused:E,onCanvasBlur:A,isFocused:H,selection:S,freezeColumns:F,onContextMenu:L,freezeTrailingRows:C,fixedShadowX:P=!0,fixedShadowY:B=!0,drawFocusRing:w,onMouseDown:x,onMouseUp:p,onMouseMoveRaw:q,onMouseMove:V,onItemHovered:Y,dragAndDropState:ie,firstColAccessible:we,onKeyDown:de,onKeyUp:le,highlightRegions:Le,canvasRef:J,onDragStart:ze,onDragEnd:Ae,eventTargetRef:X,isResizing:Me,resizeColumn:ne,isDragging:Re,isDraggable:_e=!1,allowResize:lt,disabledRows:It,hasAppendRow:at,getGroupDetails:Ue,theme:ge,prelightCells:vt,headerIcons:Oe,verticalBorder:re,drawCell:tt,drawHeader:We,onCellFocused:Ee,onDragOverCell:ue,onDrop:be,onDragLeave:fe,imageWindowLoader:me,smoothScrollX:R=!1,smoothScrollY:He=!1,experimental:_,getCellRenderer:G}=e,ke=e.translateX??0,ae=e.translateY??0,ce=Math.max(F,Math.min(r.length-1,l)),K=I.useRef(null),Pe=I.useRef(window),Xe=Pe.current,$e=me,Ge=I.useRef(),[Ce,nt]=I.useState(!1),Ne=I.useRef([]),Yt=I.useRef(),[ct,pe]=I.useState(),[dt,ye]=I.useState(),qe=I.useRef(null),[ut,ot]=I.useState(),[it,Ht]=I.useState(!1),Q=I.useRef(it);Q.current=it;const xe=I.useMemo(()=>new xr(Oe,()=>{an.current=void 0,_t.current()}),[Oe]),ve=b?f+a:a,bt=I.useRef(-1),je=((_==null?void 0:_.enableFirefoxRescaling)??!1)&&_r.value,pt=((_==null?void 0:_.enableSafariRescaling)??!1)&&Lo.value;I.useLayoutEffect(()=>{window.devicePixelRatio===1||!je&&!pt||(bt.current!==-1&&nt(!0),window.clearTimeout(bt.current),bt.current=window.setTimeout(()=>{nt(!1),bt.current=-1},200))},[s,ce,ke,ae,je,pt]);const Se=rr(r,F),Sn=P?Ot(Se,ie):0,Be=I.useCallback((v,M,N)=>{const W=v.getBoundingClientRect();if(M>=Se.length||N>=m)return;const D=W.width/n,T=qn(M,N,n,o,f,ve,ce,s,ke,ae,m,F,C,Se,g);return D!==1&&(T.x*=D,T.y*=D,T.width*=D,T.height*=D),T.x+=W.x,T.y+=W.y,T},[n,o,f,ve,ce,s,ke,ae,m,F,C,Se,g]),Te=I.useCallback((v,M,N,W)=>{const D=v.getBoundingClientRect(),T=D.width/n,U=(M-D.left)/T,j=(N-D.top)/T,z=5,Fe=Un(Se,ce,n,void 0,ke);let O=0,oe=0;W instanceof MouseEvent&&(O=W.button,oe=W.buttons);const Z=cr(U,Fe,ke),ee=dr(j,o,b,a,f,m,g,s,ae,C),De=(W==null?void 0:W.shiftKey)===!0,Je=(W==null?void 0:W.ctrlKey)===!0,Ie=(W==null?void 0:W.metaKey)===!0,ft=W!==void 0&&!(W instanceof MouseEvent)||(W==null?void 0:W.pointerType)==="touch",wt=[U<0?-1:n<U?1:0,j<ve?-1:o<j?1:0];let Qe;if(Z===-1||j<0||U<0||ee===void 0||U>n||j>o){const he=U>n?1:U<0?-1:0,Ze=j>o?1:j<0?-1:0;let rt=he*2,qt=Ze*2;he===0&&(rt=Z===-1?Jt.EndPadding:Jt.Center),Ze===0&&(qt=ee===void 0?Jt.EndPadding:Jt.Center);let xt=!1;if(Z===-1&&ee===-1){const jt=Be(v,Se.length-1,-1);gt(jt!==void 0),xt=M<jt.x+jt.width+z}const Hn=U>n&&U<n+Io()||j>o&&j<o+Io();Qe={kind:No,location:[Z!==-1?Z:U<0?0:Se.length-1,ee??m-1],region:[rt,qt],shiftKey:De,ctrlKey:Je,metaKey:Ie,isEdge:xt,isTouch:ft,button:O,buttons:oe,scrollEdge:wt,isMaybeScrollbar:Hn}}else if(ee<=-1){let he=Be(v,Z,ee);gt(he!==void 0);let Ze=he!==void 0&&he.x+he.width-M<=z;const rt=Z-1;M-he.x<=z&&rt>=0?(Ze=!0,he=Be(v,rt,ee),gt(he!==void 0),Qe={kind:b&&ee===-2?At:Dt,location:[rt,ee],bounds:he,group:Se[rt].group??"",isEdge:Ze,shiftKey:De,ctrlKey:Je,metaKey:Ie,isTouch:ft,localEventX:M-he.x,localEventY:N-he.y,button:O,buttons:oe,scrollEdge:wt}):Qe={kind:b&&ee===-2?At:Dt,group:Se[Z].group??"",location:[Z,ee],bounds:he,isEdge:Ze,shiftKey:De,ctrlKey:Je,metaKey:Ie,isTouch:ft,localEventX:M-he.x,localEventY:N-he.y,button:O,buttons:oe,scrollEdge:wt}}else{const he=Be(v,Z,ee);gt(he!==void 0);const Ze=he!==void 0&&he.x+he.width-M<z;let rt=!1;if(d&&S.current!==void 0){const qt=ei(S.current.range),xt=Be(v,qt[0],qt[1]);if(xt!==void 0){const Hn=xt.x+xt.width-2,jt=xt.y+xt.height-2;rt=Math.abs(Hn-M)<zo&&Math.abs(jt-N)<zo}}Qe={kind:"cell",location:[Z,ee],bounds:he,isEdge:Ze,shiftKey:De,ctrlKey:Je,isFillHandle:rt,metaKey:Ie,isTouch:ft,localEventX:M-he.x,localEventY:N-he.y,button:O,buttons:oe,scrollEdge:wt}}return Qe},[n,Se,ce,ke,o,b,a,f,m,g,s,ae,C,Be,d,S,ve]),[Mt]=ct??[],ro=I.useRef(()=>{}),Pt=I.useRef(ct);Pt.current=ct;const[Et,Bt]=I.useMemo(()=>{const v=document.createElement("canvas"),M=document.createElement("canvas");return v.style.display="none",v.style.opacity="0",v.style.position="fixed",M.style.display="none",M.style.opacity="0",M.style.position="fixed",[v.getContext("2d",{alpha:!1}),M.getContext("2d",{alpha:!1})]},[]);I.useLayoutEffect(()=>{if(!(Et===null||Bt===null))return document.documentElement.append(Et.canvas),document.documentElement.append(Bt.canvas),()=>{Et.canvas.remove(),Bt.canvas.remove()}},[Et,Bt]);const ln=I.useMemo(()=>new pr,[]),so=je&&Ce?1:pt&&Ce?2:5,lo=(_==null?void 0:_.disableMinimumCellWidth)===!0?1:10,an=I.useRef(),cn=I.useRef(null),dn=I.useRef(null),un=I.useCallback(()=>{var U;const v=K.current,M=qe.current;if(v===null||M===null||(cn.current===null&&(cn.current=v.getContext("2d",{alpha:!1}),v.width=0,v.height=0),dn.current===null&&(dn.current=M.getContext("2d",{alpha:!1}),M.width=0,M.height=0),cn.current===null||dn.current===null||Et===null||Bt===null))return;let N=!1;const W=j=>{N=!0,ot(j)},D=an.current,T={headerCanvasCtx:dn.current,canvasCtx:cn.current,bufferACtx:Et,bufferBCtx:Bt,width:n,height:o,cellXOffset:ce,cellYOffset:s,translateX:Math.round(ke),translateY:Math.round(ae),mappedColumns:Se,enableGroups:b,freezeColumns:F,dragAndDropState:ie,theme:ge,headerHeight:a,groupHeaderHeight:f,disabledRows:It??Yn.empty(),rowHeight:g,verticalBorder:re,isResizing:Me,resizeCol:ne,isFocused:H,selection:S,fillHandle:d,drawCellCallback:tt,hasAppendRow:at,overrideCursor:W,maxScaleFactor:so,freezeTrailingRows:C,rows:m,drawFocus:w,getCellContent:u,getGroupDetails:Ue??(j=>({name:j})),getRowThemeOverride:c,drawHeaderCallback:We,prelightCells:vt,highlightRegions:Le,imageLoader:$e,lastBlitData:Yt,damage:Ge.current,hoverValues:Ne.current,hoverInfo:Pt.current,spriteManager:xe,scrolling:Ce,hyperWrapping:(_==null?void 0:_.hyperWrapping)??!1,touchMode:it,enqueue:ro.current,renderStateProvider:ln,renderStrategy:(_==null?void 0:_.renderStrategy)??(Lo.value?"double-buffer":"single-buffer"),getCellRenderer:G,minimumCellWidth:lo};T.damage===void 0?(an.current=T,Wo(T,D)):Wo(T,void 0),!N&&(T.damage===void 0||T.damage.has((U=Pt==null?void 0:Pt.current)==null?void 0:U[0]))&&ot(void 0)},[Et,Bt,n,o,ce,s,ke,ae,Se,b,F,ie,ge,a,f,It,g,re,Me,at,ne,H,S,d,C,m,w,so,u,Ue,c,tt,We,vt,Le,$e,xe,Ce,_==null?void 0:_.hyperWrapping,_==null?void 0:_.renderStrategy,it,ln,G,lo]),_t=I.useRef(un);I.useLayoutEffect(()=>{un(),_t.current=un},[un]),I.useLayoutEffect(()=>{(async()=>{var M;((M=document==null?void 0:document.fonts)==null?void 0:M.ready)!==void 0&&(await document.fonts.ready,an.current=void 0,_t.current())})()},[]);const Rt=I.useCallback(v=>{Ge.current=v,_t.current(),Ge.current=void 0},[]),vi=Ur(Rt);ro.current=vi;const ao=I.useCallback(v=>{Rt(new Zt(v.map(M=>M.cell)))},[Rt]);$e.setCallback(Rt);const[bi,pi]=I.useState(!1),[fn,Tt]=Mt??[],wi=fn!==void 0&&Tt===-1,xi=fn!==void 0&&Tt===-2;let co=!1,uo=!1,hn=ut;if(hn===void 0&&fn!==void 0&&Tt!==void 0&&Tt>-1&&Tt<m){const v=u([fn,Tt],!0);co=v.kind===tn.NewRow||v.kind===tn.Marker&&v.markerKind!=="number",uo=v.kind===se.Boolean&&$n(v),hn=v.cursor}const fo=Re?"grabbing":(dt??!1)||Me?"col-resize":bi||k?"crosshair":hn!==void 0?hn:wi||co||uo||xi?"pointer":"default",In=I.useMemo(()=>({contain:"strict",display:"block",cursor:fo}),[fo]),ho=I.useRef("default"),Mn=X==null?void 0:X.current;Mn!=null&&ho.current!==In.cursor&&(Mn.style.cursor=ho.current=In.cursor);const Wt=I.useCallback((v,M,N,W)=>{if(Ue===void 0)return;const D=Ue(v);if(D.actions!==void 0){const T=hi(M,D.actions);for(const[U,j]of T.entries())if(en(j,N+M.x,W+j.y))return D.actions[U]}},[Ue]),Lt=I.useCallback((v,M,N,W)=>{const D=Se[M];if(!Re&&!Me&&!(dt??!1)){const T=Be(v,M,-1);gt(T!==void 0);const U=gi(void 0,D,T.x,T.y,T.width,T.height,ge,Zn(D.title)==="rtl");if(D.hasMenu===!0&&U.menuBounds!==void 0&&en(U.menuBounds,N,W))return{area:"menu",bounds:U.menuBounds};if(D.indicatorIcon!==void 0&&U.indicatorIconBounds!==void 0&&en(U.indicatorIconBounds,N,W))return{area:"indicator",bounds:U.indicatorIconBounds}}},[Se,Be,dt,Re,Me,ge]),En=I.useRef(0),Ut=I.useRef(),Bn=I.useRef(!1),go=I.useCallback(v=>{const M=K.current,N=X==null?void 0:X.current;if(M===null||v.target!==M&&v.target!==N)return;Bn.current=!0;let W,D;if(v instanceof MouseEvent?(W=v.clientX,D=v.clientY):(W=v.touches[0].clientX,D=v.touches[0].clientY),v.target===N&&N!==null){const U=N.getBoundingClientRect();if(W>U.right||D>U.bottom)return}const T=Te(M,W,D,v);Ut.current=T.location,T.isTouch&&(En.current=Date.now()),Q.current!==T.isTouch&&Ht(T.isTouch),!(T.kind===Dt&&Lt(M,T.location[0],W,D)!==void 0)&&(T.kind===At&&Wt(T.group,T.bounds,T.localEventX,T.localEventY)!==void 0||(x==null||x(T),!T.isTouch&&_e!==!0&&_e!==T.kind&&T.button<3&&T.button!==1&&v.preventDefault()))},[X,_e,Te,Wt,Lt,x]);Ve("touchstart",go,Xe,!1),Ve("mousedown",go,Xe,!1);const mo=I.useRef(0),yo=I.useCallback(v=>{var oe,Z;const M=mo.current;mo.current=Date.now();const N=K.current;if(Bn.current=!1,p===void 0||N===null)return;const W=X==null?void 0:X.current,D=v.target!==N&&v.target!==W;let T,U,j=!0;if(v instanceof MouseEvent){if(T=v.clientX,U=v.clientY,j=v.button<3,v.pointerType==="touch")return}else T=v.changedTouches[0].clientX,U=v.changedTouches[0].clientY;let z=Te(N,T,U,v);z.isTouch&&En.current!==0&&Date.now()-En.current>500&&(z={...z,isLongTouch:!0}),M!==0&&Date.now()-M<(z.isTouch?1e3:500)&&(z={...z,isDoubleClick:!0}),Q.current!==z.isTouch&&Ht(z.isTouch),!D&&v.cancelable&&j&&v.preventDefault();const[Fe]=z.location,O=Lt(N,Fe,T,U);if(z.kind===Dt&&O!==void 0){(z.button!==0||((oe=Ut.current)==null?void 0:oe[0])!==Fe||((Z=Ut.current)==null?void 0:Z[1])!==-1)&&p(z,!0);return}else if(z.kind===At){const ee=Wt(z.group,z.bounds,z.localEventX,z.localEventY);if(ee!==void 0){z.button===0&&ee.onClick(z);return}}p(z,D)},[p,X,Te,Lt,Wt]);Ve("mouseup",yo,Xe,!1),Ve("touchend",yo,Xe,!1);const ki=I.useCallback(v=>{var Fe,O;const M=K.current;if(M===null)return;const N=X==null?void 0:X.current,W=v.target!==M&&v.target!==N;let D,T,U=!0;v instanceof MouseEvent?(D=v.clientX,T=v.clientY,U=v.button<3):(D=v.changedTouches[0].clientX,T=v.changedTouches[0].clientY);const j=Te(M,D,T,v);Q.current!==j.isTouch&&Ht(j.isTouch),!W&&v.cancelable&&U&&v.preventDefault();const[z]=j.location;if(j.kind===Dt){const oe=Lt(M,z,D,T);oe!==void 0&&j.button===0&&((Fe=Ut.current)==null?void 0:Fe[0])===z&&((O=Ut.current)==null?void 0:O[1])===-1&&(oe.area==="menu"?h==null||h(z,oe.bounds):oe.area==="indicator"&&(y==null||y(z,oe.bounds)))}else if(j.kind===At){const oe=Wt(j.group,j.bounds,j.localEventX,j.localEventY);oe!==void 0&&j.button===0&&oe.onClick(j)}},[X,Te,Lt,h,y,Wt]);Ve("click",ki,Xe,!1);const Ci=I.useCallback(v=>{const M=K.current,N=X==null?void 0:X.current;if(M===null||v.target!==M&&v.target!==N||L===void 0)return;const W=Te(M,v.clientX,v.clientY,v);L(W,()=>{v.cancelable&&v.preventDefault()})},[X,Te,L]);Ve("contextmenu",Ci,(X==null?void 0:X.current)??null,!1);const vo=I.useCallback(v=>{Ge.current=new Zt(v.map(M=>M.item)),Ne.current=v,_t.current(),Ge.current=void 0},[]),bo=I.useMemo(()=>new $r(vo),[vo]),po=I.useRef(bo);po.current=bo,I.useLayoutEffect(()=>{const v=po.current;if(Mt===void 0||Mt[1]<0){v.setHovered(Mt);return}const M=u(Mt,!0),N=G(M),W=N===void 0&&M.kind===se.Custom||(N==null?void 0:N.needsHover)!==void 0&&(typeof N.needsHover=="boolean"?N.needsHover:N.needsHover(M));v.setHovered(W?Mt:void 0)},[u,G,Mt]);const wo=I.useRef(),Si=I.useCallback(v=>{var j;const M=K.current;if(M===null)return;const N=X==null?void 0:X.current,W=v.target!==M&&v.target!==N,D=Te(M,v.clientX,v.clientY,v);if(D.kind!=="out-of-bounds"&&W&&!Bn.current&&!D.isTouch)return;const T=(z,Fe)=>{pe(O=>O===z||(O==null?void 0:O[0][0])===(z==null?void 0:z[0][0])&&(O==null?void 0:O[0][1])===(z==null?void 0:z[0][1])&&((O==null?void 0:O[1][0])===(z==null?void 0:z[1][0])&&(O==null?void 0:O[1][1])===(z==null?void 0:z[1][1])||!Fe)?O:z)};if(!qr(D,wo.current))ot(void 0),Y==null||Y(D),T(D.kind===No?void 0:[D.location,[D.localEventX,D.localEventY]],!0),wo.current=D;else if(D.kind==="cell"||D.kind===Dt||D.kind===At){let z=!1,Fe=!0;if(D.kind==="cell"){const oe=u(D.location);Fe=((j=G(oe))==null?void 0:j.needsHoverPosition)??oe.kind===se.Custom,z=Fe}else D.kind===At&&(z=!0);const O=[D.location,[D.localEventX,D.localEventY]];T(O,Fe),Pt.current=O,z&&Rt(new Zt([D.location]))}const U=D.location[0]>=(we?0:1);ye(D.kind===Dt&&D.isEdge&&U&&lt===!0),pi(D.kind==="cell"&&D.isFillHandle),q==null||q(v),V(D)},[X,Te,we,lt,q,V,Y,u,G,Rt]);Ve("mousemove",Si,Xe,!0);const Ii=I.useCallback(v=>{const M=K.current;if(M===null)return;let N,W;S.current!==void 0&&(N=Be(M,S.current.cell[0],S.current.cell[1]),W=S.current.cell),de==null||de({bounds:N,stopPropagation:()=>v.stopPropagation(),preventDefault:()=>v.preventDefault(),cancel:()=>{},ctrlKey:v.ctrlKey,metaKey:v.metaKey,shiftKey:v.shiftKey,altKey:v.altKey,key:v.key,keyCode:v.keyCode,rawEvent:v,location:W})},[de,S,Be]),Mi=I.useCallback(v=>{const M=K.current;if(M===null)return;let N,W;S.current!==void 0&&(N=Be(M,S.current.cell[0],S.current.cell[1]),W=S.current.cell),le==null||le({bounds:N,stopPropagation:()=>v.stopPropagation(),preventDefault:()=>v.preventDefault(),cancel:()=>{},ctrlKey:v.ctrlKey,metaKey:v.metaKey,shiftKey:v.shiftKey,altKey:v.altKey,key:v.key,keyCode:v.keyCode,rawEvent:v,location:W})},[le,S,Be]),Ei=I.useCallback(v=>{if(K.current=v,J!==void 0&&(J.current=v),v===null)Pe.current=window;else{const M=v.getRootNode();M===document&&(Pe.current=window),Pe.current=M}},[J]),Bi=I.useCallback(v=>{const M=K.current;if(M===null||_e===!1||Me){v.preventDefault();return}let N,W;const D=Te(M,v.clientX,v.clientY);if(_e!==!0&&D.kind!==_e){v.preventDefault();return}const T=(oe,Z)=>{N=oe,W=Z};let U,j,z;const Fe=(oe,Z,ee)=>{U=oe,j=Z,z=ee};let O=!1;if(ze==null||ze({...D,setData:T,setDragImage:Fe,preventDefault:()=>O=!0,defaultPrevented:()=>O}),!O&&N!==void 0&&W!==void 0&&v.dataTransfer!==null)if(v.dataTransfer.setData(N,W),v.dataTransfer.effectAllowed="copyLink",U!==void 0&&j!==void 0&&z!==void 0)v.dataTransfer.setDragImage(U,j,z);else{const[oe,Z]=D.location;if(Z!==void 0){const ee=document.createElement("canvas"),De=Be(M,oe,Z);gt(De!==void 0);const Je=Math.ceil(window.devicePixelRatio??1);ee.width=De.width*Je,ee.height=De.height*Je;const Ie=ee.getContext("2d");Ie!==null&&(Ie.scale(Je,Je),Ie.textBaseline="middle",Z===-1?(Ie.font=ge.headerFontFull,Ie.fillStyle=ge.bgHeader,Ie.fillRect(0,0,ee.width,ee.height),mi(Ie,0,0,De.width,De.height,Se[oe],!1,ge,!1,!1,0,xe,We,!1)):(Ie.font=ge.baseFontFull,Ie.fillStyle=ge.bgCell,Ie.fillRect(0,0,ee.width,ee.height),fi(Ie,u([oe,Z]),0,Z,!1,!1,0,0,De.width,De.height,!1,ge,ge.bgCell,$e,xe,1,void 0,!1,0,void 0,void 0,void 0,ln,G,()=>{}))),ee.style.left="-100%",ee.style.position="absolute",ee.style.width=`${De.width}px`,ee.style.height=`${De.height}px`,document.body.append(ee),v.dataTransfer.setDragImage(ee,De.width/2,De.height/2),window.setTimeout(()=>{ee.remove()},0)}}else v.preventDefault()},[_e,Me,Te,ze,Be,ge,Se,xe,We,u,$e,ln,G]);Ve("dragstart",Bi,(X==null?void 0:X.current)??null,!1,!1);const Fn=I.useRef(),Fi=I.useCallback(v=>{const M=K.current;if(be!==void 0&&v.preventDefault(),M===null||ue===void 0)return;const N=Te(M,v.clientX,v.clientY),[W,D]=N.location,T=W-(we?0:1),[U,j]=Fn.current??[];(U!==T||j!==D)&&(Fn.current=[T,D],ue([T,D],v.dataTransfer))},[we,Te,ue,be]);Ve("dragover",Fi,(X==null?void 0:X.current)??null,!1,!1);const Di=I.useCallback(()=>{Fn.current=void 0,Ae==null||Ae()},[Ae]);Ve("dragend",Di,(X==null?void 0:X.current)??null,!1,!1);const Ai=I.useCallback(v=>{const M=K.current;if(M===null||be===void 0)return;v.preventDefault();const N=Te(M,v.clientX,v.clientY),[W,D]=N.location,T=W-(we?0:1);be([T,D],v.dataTransfer)},[we,Te,be]);Ve("drop",Ai,(X==null?void 0:X.current)??null,!1,!1);const Hi=I.useCallback(()=>{fe==null||fe()},[fe]);Ve("dragleave",Hi,(X==null?void 0:X.current)??null,!1,!1);const xo=I.useRef(S);xo.current=S;const gn=I.useRef(null),Dn=I.useCallback(v=>{var M;K.current===null||!K.current.contains(document.activeElement)||(v===null&&xo.current.current!==void 0?(M=J==null?void 0:J.current)==null||M.focus({preventScroll:!0}):v!==null&&v.focus({preventScroll:!0}),gn.current=v)},[J]);I.useImperativeHandle(t,()=>({focus:()=>{var M;const v=gn.current;v===null||!document.contains(v)?(M=J==null?void 0:J.current)==null||M.focus({preventScroll:!0}):v.focus({preventScroll:!0})},getBounds:(v,M)=>{if(!(J===void 0||J.current===null))return Be(J.current,v??0,M??-1)},damage:ao}),[J,ao,Be]);const An=I.useRef(),Pi=tr(()=>{var j,z,Fe;if(n<50||(_==null?void 0:_.disableAccessibilityTree)===!0)return null;let v=Un(Se,ce,n,ie,ke);const M=we?0:-1;!we&&((j=v[0])==null?void 0:j.sourceIndex)===0&&(v=v.slice(1));const[N,W]=((z=S.current)==null?void 0:z.cell)??[],D=(Fe=S.current)==null?void 0:Fe.range,T=v.map(O=>O.sourceIndex),U=Ui(s,Math.min(m,s+i));return N!==void 0&&W!==void 0&&!(T.includes(N)&&U.includes(W))&&Dn(null),Ke("table",{role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Se.length+M,children:[$("thead",{role:"rowgroup",children:$("tr",{role:"row","aria-rowindex":1,children:v.map(O=>$("th",{role:"columnheader","aria-selected":S.columns.hasIndex(O.sourceIndex),"aria-colindex":O.sourceIndex+1+M,tabIndex:-1,onFocus:oe=>{if(oe.target!==gn.current)return Ee==null?void 0:Ee([O.sourceIndex,-1])},children:O.title},O.sourceIndex))})}),$("tbody",{role:"rowgroup",children:U.map(O=>$("tr",{role:"row","aria-selected":S.rows.hasIndex(O),"aria-rowindex":O+2,children:v.map(oe=>{const Z=oe.sourceIndex,ee=et(Z,O),De=N===Z&&W===O,Je=D!==void 0&&Z>=D.x&&Z<D.x+D.width&&O>=D.y&&O<D.y+D.height,Ie=`glide-cell-${Z}-${O}`,ft=[Z,O],wt=u(ft,!0);return $("td",{role:"gridcell","aria-colindex":Z+1+M,"aria-selected":Je,"aria-readonly":Vo(wt)||!Ji(wt),id:Ie,"data-testid":Ie,onClick:()=>{const Qe=J==null?void 0:J.current;if(Qe!=null)return de==null?void 0:de({bounds:Be(Qe,Z,O),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ft})},onFocusCapture:Qe=>{var he,Ze;if(!(Qe.target===gn.current||((he=An.current)==null?void 0:he[0])===Z&&((Ze=An.current)==null?void 0:Ze[1])===O))return An.current=ft,Ee==null?void 0:Ee(ft)},ref:De?Dn:void 0,tabIndex:-1,children:jr(wt,G)},ee)})},O))})]},"access-tree")},[n,Se,ce,ie,ke,m,s,i,S,Dn,u,J,de,Be,Ee],200),mn=F===0||!P?0:ce>F?1:wn(-ke/100,0,1),Ri=-s*32+ae,yn=B?wn(-Ri/100,0,1):0,Ti=I.useMemo(()=>{if(!mn&&!yn)return null;const v={position:"absolute",top:0,left:Sn,width:n-Sn,height:o,opacity:mn,pointerEvents:"none",transition:R?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},M={position:"absolute",top:ve,left:0,width:n,height:o,opacity:yn,pointerEvents:"none",transition:He?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return Ke(On,{children:[mn>0&&$("div",{id:"shadow-x",style:v}),yn>0&&$("div",{id:"shadow-y",style:M})]})},[mn,yn,Sn,n,R,ve,o,He]),Wi=I.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return Ke(On,{children:[$("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Ii,onKeyUp:Mi,onFocus:E,onBlur:A,ref:Ei,style:In,children:Pi}),$("canvas",{ref:qe,style:Wi}),Ti]})},gl=I.memo(I.forwardRef(Vr));function Kr(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case se.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Jn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case se.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case se.Image:case se.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case se.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case se.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case se.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case se.Markdown:case se.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case se.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case se.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case se.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Gn()}}function Gr(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:Kr(l))})}function Oo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Jr(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>Oo(l,!0)).join(",")):i.push(Oo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Wn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Xo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Qr(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Zr(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${Wn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Xo(i.rawValue[s])}>`+Wn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Xo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${Wn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function es(e,t){const n=Gr(e,t),o=Jr(n),i=Zr(n);return{textPlain:o,textHtml:i}}function ml(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),f=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(f==null?void 0:f.children.length)===1&&f.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const h of m)h.replaceWith(`
`);const u=a.getAttribute("gdg-raw-value"),c=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:c});else if(a.querySelector("ol")!==null){const h=a.querySelectorAll("li");r==null||r.push({rawValue:[...h].map(y=>y.getAttribute("gdg-raw-value")??""),formatted:[...h].map(y=>y.textContent??""),format:"string-array"})}else if(u!==null)r==null||r.push({rawValue:Qr(u),formatted:a.textContent??"",format:c});else{let h=a.textContent??"";g&&(h=h.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:h??"",formatted:h??"",format:c})}}}return r!==void 0&&i.push(r),i}function yl(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,d=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;d.push(...m);const u=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof u=="function")return r;d.push(...u)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;d.push(...m)}let f=a.x-n,g=a.x+a.width-1-n;for(const m of d)for(const u of m)u.span!==void 0&&(f=Math.min(u.span[0],f),g=Math.max(u.span[1],g));f===a.x-n&&g===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:f+n,y:a.y,width:g-f+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function $o(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function vl(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push($o(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push($o(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function bl(e,t,n){var s;const o=es(e,t),i=a=>{var d;(d=window.navigator.clipboard)==null||d.writeText(a)},r=(a,d)=>{var f;return((f=window.navigator.clipboard)==null?void 0:f.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([d],{type:"text/html"})})]),!0)},l=(a,d)=>{var f,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(f=n==null?void 0:n.clipboardData)==null||f.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",d)}catch{r(a,d)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function ts(e){return e!==!0}const Yo=20,ns={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:se.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>os(e,e.cell.data,$n(e.cell),e.cell.maxSize??Yo),onDelete:e=>({...e,data:!1}),onClick:e=>{const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:d}=i,f=t.maxSize??Yo,g=Math.floor(i.y+s/2),m=Jo(f,s,r.cellVerticalPadding),u=Go(t.contentAlign??"center",a,l,r.cellHorizontalPadding,m),c=Ko(u,g,m),h=Qo(a+n,d+o,c);if($n(t)&&h)return{...t,data:ts(t.data)}},onPaste:(e,t)=>{let n=xn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Jn),n===t.data?void 0:{...t,data:n}}};function os(e,t,n,o){if(!n&&t===xn)return;const{ctx:i,hoverAmount:r,theme:l,rect:s,highlighted:a,hoverX:d,hoverY:f,cell:{contentAlign:g}}=e,{x:m,y:u,width:c,height:h}=s,y=.35;let b=n?1-y+y*r:.4;t===xn&&(b*=r),b!==0&&(i.globalAlpha=b,oo(i,l,t,m,u,c,h,a,d,f,o,g),i.globalAlpha=1)}const is=yt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),rs=e=>{const{bubbles:t}=e;return Ke(is,{children:[t.map((n,o)=>$("div",{className:"boe-bubble",children:n},o)),$("textarea",{className:"gdg-input",autoFocus:!0})]})},ss=rs,ls={getAccessibilityString:e=>Zo(e.data),kind:se.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>cs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return $(ss,{bubbles:t.data})},onPaste:()=>{}},as=4;function cs(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:d}=n,f=20,g=8,m=as;let u=l+o.cellHorizontalPadding;const c=[];for(const h of t){if(u>l+a)break;const y=$t(h,i,o.baseFontFull).width;c.push({x:u,width:y}),u+=y+g*2+m}i.beginPath();for(const h of c)st(i,h.x,s+(d-f)/2,h.width+g*2,f,o.roundingRadius??f/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[h,y]of c.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[h],y.x+g,s+d/2+Ct(i,o))}const ds=yt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),us=e=>{const{drilldowns:t}=e;return $(ds,{children:t.map((n,o)=>Ke("div",{className:"doe-bubble",children:[n.img!==void 0&&$("img",{src:n.img}),$("div",{children:n.text})]},o))})},fs=us,hs={getAccessibilityString:e=>Zo(e.data.map(t=>t.text)),kind:se.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+20+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>ys(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return $(fs,{drilldowns:t.data})},onPaste:()=>{}},gs=4,Ln={};function ms(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,d=o+r,f=o*3,g=(f+r*2)*i,m=`${e},${t},${i},${n}`;if(Ln[m]!==void 0)return{el:Ln[m],height:a,width:g,middleWidth:s*i,sideWidth:d*i,padding:r*i,dpr:i};const u=document.createElement("canvas"),c=u.getContext("2d");return c===null?null:(u.width=g,u.height=a,c.scale(i,i),Ln[m]=u,c.beginPath(),st(c,r,r,f,l,o),c.shadowColor="rgba(24, 25, 34, 0.4)",c.shadowBlur=1,c.fillStyle=e,c.fill(),c.shadowColor="rgba(24, 25, 34, 0.3)",c.shadowOffsetY=1,c.shadowBlur=5,c.fillStyle=e,c.fill(),c.shadowOffsetY=0,c.shadowBlur=0,c.shadowBlur=0,c.beginPath(),st(c,r+.5,r+.5,f,l,o),c.strokeStyle=t,c.lineWidth=1,c.stroke(),{el:u,height:a,width:g,sideWidth:d*i,middleWidth:o*i,padding:r*i,dpr:i})}function ys(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:d}=n,f=o.baseFontFull,g=ri(i,f),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),u=Math.floor(n.y+(n.height-m)/2),c=m-10,h=8,y=gs;let b=a+o.cellHorizontalPadding;const k=o.roundingRadius??6,E=ms(o.bgCell,o.drilldownBorder,m,k),A=[];for(const H of t){if(b>a+d)break;const F=$t(H.text,i,f).width;let L=0;H.img!==void 0&&r.loadOrGetImage(H.img,l,s)!==void 0&&(L=c-8+4);const C=F+L+h*2;A.push({x:b,width:C}),b+=C+y}if(E!==null){const{el:H,height:S,middleWidth:F,sideWidth:L,width:C,dpr:P,padding:B}=E,w=L/P,x=B/P;for(const p of A){const q=Math.floor(p.x),V=Math.floor(p.width),Y=V-(w-x)*2;i.imageSmoothingEnabled=!1,i.drawImage(H,0,0,L,S,q-x,u,w,m),Y>0&&i.drawImage(H,L,0,F,S,q+(w-x),u,Y,m),i.drawImage(H,C-L,0,L,S,q+V-(w-x),u,w,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[H,S]of A.entries()){const F=t[H];let L=S.x+h;if(F.img!==void 0){const C=r.loadOrGetImage(F.img,l,s);if(C!==void 0){const P=c-8;let B=0,w=0,x=C.width,p=C.height;x>p?(B+=(x-p)/2,x=p):p>x&&(w+=(p-x)/2,p=x),i.beginPath(),st(i,L,u+m/2-P/2,P,P,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(C,B,w,x,p,L,u+m/2-P/2,P,P),i.restore(),L+=P+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(F.text,L,u+m/2+Ct(i,o))}}const vs=yt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),bs=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return Ke(vs,{"data-testid":"GDG-default-image-overlay-editor",children:[$(qi.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l,children:r.map(s=>{const a=(i==null?void 0:i(s))??$("img",{draggable:!1,src:s});return $("div",{className:"gdg-centering-container",children:a},s)})}),n&&o&&$("button",{className:"gdg-edit-icon",onClick:o,children:$(Qn,{})})]})},ps={getAccessibilityString:e=>e.data.join(", "),kind:se.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ws(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e;return $(o??bs,{urls:t.data,canWrite:t.readonly!==!1,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Nn=4;function ws(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:d}=e,{x:f,y:g,height:m,width:u}=i,c=m-s.cellVerticalPadding*2,h=[];let y=0;for(let k=0;k<t.length;k++){const E=t[k];if(E.length===0)continue;const A=d.loadOrGetImage(E,r,l);if(A!==void 0){h[k]=A;const H=A.width*(c/A.height);y+=H+Nn}}if(y===0)return;y-=Nn;let b=f+s.cellHorizontalPadding;o==="right"?b=Math.floor(f+u-s.cellHorizontalPadding-y):o==="center"&&(b=Math.floor(f+u/2-y/2));for(const k of h){if(k===void 0)continue;const E=k.width*(c/k.height);n>0&&(a.beginPath(),st(a,b,g+s.cellVerticalPadding,E,c,n),a.save(),a.clip()),a.drawImage(k,b,g+s.cellVerticalPadding,E,c),n>0&&a.restore(),b+=E+Nn}}function xs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const ks={getAccessibilityString:()=>"",kind:se.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(xs(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding,d=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);st(i,r.x+a,r.y+(r.height-d)/2,s,d,l.roundingRadius??3),i.fillStyle=sn(l.textDark,.1),i.fill()},onPaste:()=>{}},Cs=yt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Ss extends Kn.PureComponent{constructor(){super(...arguments);te(this,"targetElement",null);te(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=zi(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const f=document.createElement("template");f.innerHTML=l,a=f.content}n.append(a);const d=n.getElementsByTagName("a");for(const f of d)f.target="_blank",f.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),$(Cs,{ref:this.containerRefHook})}}const Is=yt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Ms=yt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Es=yt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let _o=0;const Cn=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:d}=s,f=I.useRef(null),g=n??"";gt(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=I.useState(()=>"input-box-"+(_o=(_o+1)%1e7));I.useEffect(()=>{const c=f.current;if(c===null||c.disabled)return;const h=g.toString().length;c.focus(),c.setSelectionRange(i?0:h,h)},[]),I.useLayoutEffect(()=>{var c;if(l!==void 0){const h=typeof l=="number"?[l,null]:l;(c=f.current)==null||c.setSelectionRange(h[0],h[1])}},[l]);const u=I.useCallback(c=>{c.key==="Enter"&&c.shiftKey&&r===!0||o==null||o(c)},[r,o]);return Ke(Es,{className:"gdg-growing-entry",children:[$(Ms,{className:d,children:g+`
`}),$(Is,{...s,className:(d??"")+" gdg-input",id:m,ref:f,onKeyDown:u,value:g,placeholder:t,dir:"auto"})]})},Bs=()=>e=>e.targetWidth,Uo=yt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Bs(),"px"]}}),Fs=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,d=t.readonly===!0,[f,g]=I.useState(a===""||o),m=I.useCallback(()=>{g(c=>!c)},[]),u=a?"gdg-ml-6":"";return f?Ke(Uo,{targetWidth:r.width-20,children:[$(Cn,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:c=>{c.key==="Enter"&&c.stopPropagation()},onChange:n}),$("div",{className:`gdg-edit-icon gdg-checkmark-hover ${u}`,onClick:()=>l(t),children:$(er,{})})]}):Ke(Uo,{targetWidth:r.width,children:[$(Ss,{contents:a,createNode:i}),!d&&Ke(On,{children:[$("div",{className:"spacer"}),$("div",{className:`gdg-edit-icon gdg-edit-hover ${u}`,onClick:m,children:$(Qn,{})})]}),$("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0})]})},Ds={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:se.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:rn,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>mt(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return $(Fs,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},As={getAccessibilityString:e=>e.row.toString(),kind:tn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Hs,measure:()=>44,draw:e=>Rs(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Hs(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Ps,n.textAlign="center",r}function Ps(e){const{ctx:t}=e;t.textAlign="start"}function Rs(e,t,n,o,i,r){const{ctx:l,rect:s,hoverAmount:a,theme:d}=e,{x:f,y:g,width:m,height:u}=s,c=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&c>0){l.globalAlpha=c;const h=7*(n?a:1);if(oo(l,d,n,i?f+h:f,g,i?m-h:m,u,!0,void 0,void 0,18,"center",r),i){l.globalAlpha=a,l.beginPath();for(const y of[3,6])for(const b of[-5,-1,3])l.rect(f+y,g+u/2+b,2,2);l.fillStyle=d.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const h=t.toString(),y=d.markerFontFull,b=f+m/2;o==="both"&&a!==0&&(l.globalAlpha=1-a),l.fillStyle=d.textLight,l.font=y,l.fillText(h,b,g+u/2+Ct(l,y)),a!==0&&(l.globalAlpha=1)}}const Ts={getAccessibilityString:()=>"",kind:tn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Ws(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Ws(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:d,width:f,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,d+1,f,g-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let u=0;if(n!==void 0){const h=g-8,y=a+8/2,b=d+8/2;s.drawSprite(n,"normal",o,y,b,h,l,m?1:r),u=h}else{u=24;const c=12,h=m?c:r*c,y=m?0:(1-r)*c*.5,b=l.cellHorizontalPadding+4;h>0&&(o.moveTo(a+b+y,d+g/2),o.lineTo(a+b+y+h,d+g/2),o.moveTo(a+b+y+h*.5,d+g/2-h*.5),o.lineTo(a+b+y+h*.5,d+g/2+h*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,u+a+l.cellHorizontalPadding+.5,d+g/2+Ct(o,l)),o.beginPath()}const Ls=I.lazy(async()=>await Vi(()=>import("./number-overlay-editor-wZgFM_Mr.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Ns={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:se.Number,needsHover:!1,needsHoverPosition:!1,useLabel:!0,drawPrep:rn,draw:e=>mt(e,e.cell.displayData,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return $(I.Suspense,{fallback:null,children:$(Ls,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})})})},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},zs={getAccessibilityString:()=>"",measure:()=>108,kind:se.Protected,needsHover:!1,needsHoverPosition:!1,draw:Os,onPaste:()=>{}};function Os(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const d=r+l/2,f=Math.cos(So(30))*s,g=Math.sin(So(30))*s;for(let m=0;m<12;m++)t.moveTo(a,d-s),t.lineTo(a,d+s),t.moveTo(a+f,d-g),t.lineTo(a-f,d+g),t.moveTo(a-f,d-g),t.lineTo(a+f,d+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Xs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:se.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>rn(e,t,e.theme.textLight),draw:e=>mt(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return $(Cn,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},$s={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:se.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:rn,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:d,hoverEffect:f,allowWrapping:g}=t;if(f===!0&&n>0){i.textBaseline="alphabetic";const m=l.cellHorizontalPadding,u=l.cellVerticalPadding,c=$t(a,i,l.baseFontFull,"alphabetic"),h=r.height-u,y=Math.min(h,c.actualBoundingBoxAscent*2.5);i.beginPath(),st(i,r.x+m/2,r.y+(r.height-y)/2+1,c.width+m*3,y-1,l.roundingRadius??4),i.globalAlpha=n,i.fillStyle=sn(l.textDark,.1),i.fill(),i.globalAlpha=1,i.fillStyle=l.textDark,i.textBaseline="middle",s==null||s("text")}mt(e,a,d,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return $(Cn,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Ys=yt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),_s=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=I.useState(!i&&(t===""||o)),d=I.useCallback(()=>{a(!0)},[]);return s?$(Cn,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):Ke(Ys,{children:[$("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer",children:l}),!i&&$("div",{className:"gdg-edit-icon",onClick:d,children:$(Qn,{})}),$("textarea",{className:"gdg-input",autoFocus:!0})]})},Us=_s;function qo(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}const qs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:se.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:rn,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,d=t.hoverEffect===!0;if(o!==void 0&&d&&i!==void 0&&r!==void 0){const f=$t(a,s,n.baseFontFull),g=qo(f,l,n,t.contentAlign),{x:m,y:u,width:c,height:h}=g;if(i>=m-4&&i<=m-4+c+8&&r>=u-4&&r<=u-4+h+8){const y=Ct(s,n.baseFontFull);o("pointer");const b=5,k=u-y;s.beginPath(),s.moveTo(l.x+m,Math.floor(l.y+k+h+b)+.5),s.lineTo(l.x+m+c,Math.floor(l.y+k+h+b)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,mt({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),mt({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),mt({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),mt({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=d?n.linkColor:n.textDark,mt(e,a,t.contentAlign)},onClick:e=>{const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return;const s=oi(l,r.baseFontFull);if(s===void 0)return;const a=qo(s,n,r,t.contentAlign);en({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)&&t.onClickUri(e)},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return $(Us,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},pl=[As,Ts,ns,ls,hs,ps,ks,Ds,Ns,zs,Xs,$s,qs],zn=[];class js extends li{constructor(){super(...arguments);te(this,"imageLoaded",()=>{});te(this,"loadedLocations",[]);te(this,"cache",{});te(this,"sendLoaded",ji(()=>{this.imageLoaded(new Zt(this.loadedLocations)),this.loadedLocations=[]},20));te(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=zn.pop()??new Image;let a=!1;const d={img:void 0,cells:[et(o,i)],url:n,cancel:()=>{a||(a=!0,zn.length<12?zn.unshift(s):l||(s.src=""))}},f=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await f,await s.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=s;for(const m of g.cells)this.loadedLocations.push(no(m));l=!0,this.sendLoaded()}}catch{d.cancel()}}),this.cache[r]=d}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=et(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}const wl=js;export{qr as A,fl as B,Yn as C,Gn as D,Gi as E,il as F,se as G,al as H,tn as I,ml as J,vl as K,Io as L,cl as M,bl as N,wl as O,pl as P,gl as Q,Lo as R,_r as S,ul as T,ol as U,Ki as a,gt as b,hl as c,ll as d,yl as e,sl as f,dl as g,sn as h,tl as i,el as j,Xt as k,At as l,nn as m,_n as n,No as o,en as p,lr as q,nl as r,Vo as s,ts as t,Ve as u,Ji as v,rl as w,Cr as x,bn as y,Dt as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./number-overlay-editor-wZgFM_Mr.js","./marked.esm-dbrxtycE.js","./index-BMVQvedj.js","./react-number-format.es-2Vaki8Uh.js","./number-overlay-editor-8QJ1sjy4.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}