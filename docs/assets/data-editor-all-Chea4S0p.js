const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-DoxmvVeT.js","./iframe-DZuEdV5X.js","./preload-helper-C1FmrZbK.js","./index-CrHABOeF.js","./marked.esm-cmvEwW9n.js","./throttle-1tkNeiYB.js","./flatten-BtdT1SSX.js","./number-overlay-editor-4HCoKGKU.js","./react-number-format.es-D45Xh0sM.js"])))=>i.map(i=>d[i]);
var Us=Object.defineProperty;var Vs=(e,t,n)=>t in e?Us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ne=(e,t,n)=>Vs(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as kt}from"./iframe-DZuEdV5X.js";import{_ as Tl}from"./preload-helper-C1FmrZbK.js";import{h as qs,g as Al,j as js,k as Zs,v as Js,l as Qs,m as sn,r as fo,t as ea}from"./throttle-1tkNeiYB.js";import{u as ta,f as rl}from"./flatten-BtdT1SSX.js";import{s as tn,a as na}from"./marked.esm-cmvEwW9n.js";function zl(e="This should not happen"){throw new Error(e)}function Qt(e,t="Assertion failed"){if(!e)return zl(t)}function ar(e,t){return zl(t??"Hell froze over")}function oa(e,t){try{return e()}catch{return t}}const il=Object.prototype.hasOwnProperty;function Xo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Xo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(il.call(e,n)&&++o&&!il.call(t,n)||!(n in t)||!Xo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Wr=null,Hi=void 0;var J;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(J||(J={}));var ll;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(ll||(ll={}));var $r;(function(e){e.Triangle="triangle",e.Dots="dots"})($r||($r={}));function Hr(e){return"width"in e&&typeof e.width=="number"}async function sl(e){return typeof e=="object"?e:await e()}function Wo(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown)}function Eu(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown||e.kind===J.Boolean||e.kind===J.Image||e.kind===J.Custom)}function Oo(e){return e.kind===an.Marker||e.kind===an.NewRow}function $o(e){if(!Wo(e)||e.kind===J.Image)return!1;switch(e.kind){case J.Text:case J.Number:case J.Markdown:case J.Uri:case J.Custom:case J.Boolean:return e.readonly!==!0;default:ar(e,"A cell was passed with an invalid kind")}}function ra(e){return qs(e,"editor")}function Ti(e){return!(e.readonly??!1)}var an;(function(e){e.NewRow="new-row",e.Marker="marker"})(an||(an={}));const Or={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function bi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let al;const qt=class qt{constructor(t){Ne(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new qt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=bi([...this.items,n]);return new qt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,d]=a;if(l<=r&&o<=d){const f=[];l<o&&f.push([l,o]),r<d&&f.push([r,d]),n.splice(i,1,...f)}}return new qt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Ne(qt,"create",t=>new qt(bi(t))),Ne(qt,"empty",()=>al??(al=new qt([]))),Ne(qt,"fromSingleSelection",t=>qt.empty().add(t)),Ne(qt,"fromArray",t=>{if(t.length===0)return qt.empty();const n=t.map(r=>[r,r+1]),o=bi(n);return new qt(o)});let st=qt;const ia=tn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Kt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=d=>{var f;(f=i.current)==null||f.call(a,d)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function jn(e,t){return e===void 0?void 0:t}const la=Math.PI;function cl(e){return e*la/180}const Pl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Bl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Ll=(e,t,n)=>Math.min(e,t-n*2),Wl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ai=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},sa=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function aa(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Al(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const ca="֑-߿יִ-﷽ﹰ-ﻼ",da="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ua=new RegExp("^[^"+da+"]*["+ca+"]");function zi(e){return ua.test(e)?"rtl":"not-rtl"}let Tr;function Mi(){if(typeof document>"u")return 0;if(Tr!==void 0)return Tr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Tr=n-o,Tr}const uo=Symbol();function fa(e){const t=s.useRef([uo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const d=t.current[0];d!==uo&&(l=typeof l=="function"?l(d):l,l===d)||(d!==uo&&r({}),o(f=>typeof l=="function"?l(d===uo?f:d):l),t.current[0]=uo)},[]),a=s.useCallback(()=>{t.current[0]=uo,r({})},[]);return[t.current[0]===uo?n:t.current[0],i,a]}function $l(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ha(e){const t=s.useRef(e);return Xo(e,t.current)||(t.current=e),t.current}const ga=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(ia,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(js.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const d=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},d)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Ai,null)))},ma=tn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class wa extends kt.PureComponent{constructor(){super(...arguments);Ne(this,"targetElement",null);Ne(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=na(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let d=i==null?void 0:i(a);if(d===void 0){const u=document.createElement("template");u.innerHTML=a,d=u.content}n.append(d);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),kt.createElement(ma,{ref:this.containerRefHook})}}const ba=tn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),ya=tn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),pa=tn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let dl=0;const Gr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...l}=e,{onChange:d,className:f}=l,u=s.useRef(null),g=n??"";Qt(d!==void 0,"GrowingEntry must be a controlled input area");const[m]=s.useState(()=>"input-box-"+(dl=(dl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=g.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(a!==void 0){const b=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[a]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(pa,{className:"gdg-growing-entry"},s.createElement(ya,{className:f},g+`
`),s.createElement(ba,{...l,className:(f??"")+" gdg-input",id:m,ref:u,onKeyDown:w,value:g,placeholder:t,dir:"auto"}))},yi={};let Vn=null;function va(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Yo(e){const t=e.toLowerCase().trim();if(yi[t]!==void 0)return yi[t];Vn=Vn||va(),Vn.style.color="#000",Vn.style.color=t;const n=getComputedStyle(Vn).color;Vn.style.color="#fff",Vn.style.color=t;const o=getComputedStyle(Vn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),yi[t]=r,r}function go(e,t){const[n,o,r]=Yo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const ul=new Map;function fl(e,t){const n=`${e}-${t}`,o=ul.get(n);if(o!==void 0)return o;const r=en(e,t);return ul.set(n,r),r}function en(e,t){if(t===void 0)return e;const[n,o,r,i]=Yo(e);if(i===1)return e;const[a,l,d,f]=Yo(t),u=i+f*(1-i),g=(i*n+f*a*(1-i))/u,m=(i*o+f*l*(1-i))/u,w=(i*r+f*d*(1-i))/u;return`rgba(${g}, ${m}, ${w}, ${u})`}function Iu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,a]=Yo(e),[l,d,f,u]=Yo(t),g=o*a,m=r*a,w=i*a,h=l*u,b=d*u,x=f*u,C=n,p=1-n,R=a*p+u*C;if(R===0)return"rgba(0, 0, 0, 0)";const X=Math.floor((g*p+h*C)/R),B=Math.floor((m*p+b*C)/R),z=Math.floor((w*p+x*C)/R);return`rgba(${X}, ${B}, ${z}, ${R})`}function Du(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=Yo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Ca(e,t){return kt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function xa(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(ir(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function cr(e,t){return(e??"")===(t??"")}function ka(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Ol(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function ir(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Nl(e){return[e.x+e.width-1,e.y+e.height-1]}function hl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,d]=e;if(d<i||d>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Sa(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&hl(e,t,i)&&r++;for(const a of n.current.rangeStack)hl(e,t,a)&&r++;return r}function Xl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Go(e,t){let n=0;const o=Xl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function mo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ri(e,t,n,o,r){const i=Xl(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let l=t,d=r??0;for(;d<=n&&l<i.length;)d+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||a.push(u)}return a}function Ma(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Ra(e,t,n,o,r,i,a,l,d,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let g=t;for(let h=0;h<f;h++){const b=i-1-h,x=typeof a=="number"?a:a(b);if(g-=x,e>=g)return b}const m=i-f,w=e-(d??0);if(typeof a=="number"){const h=Math.floor((w-u)/a)+l;return h>=m?void 0:h}else{let h=u;for(let b=l;b<m;b++){const x=a(b);if(w<=h+x)return b;h+=x}return}}let Lr=0,lr={};const Ea=typeof window>"u";async function Ia(){var e;Ea||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Lr=0,lr={},Js())}Ia();function Yl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function _o(e,t,n,o="middle"){const r=Yl(e,t,o,n);let i=lr[r];return i===void 0&&(i=t.measureText(e),lr[r]=i,Lr++),Lr>1e4&&(lr={},Lr=0),i}function Gl(e,t){const n=Yl(e,void 0,"middle",t);return lr[n]}function Jn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Da(e,t)}function gl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const ml=[];function Da(e,t){for(const i of ml)if(i.key===t)return i.val;const n=gl(e,"alphabetic"),r=-(gl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return ml.push({key:t,val:r}),r}function Fa(e,t,n,o,r,i){const{ctx:a,rect:l,theme:d}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const g=1-f/u;a.globalAlpha=g,a.fillStyle=d.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=d.bgSearchResult)}return f<u}function ur(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function Fu(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,kn({ctx:a,rect:i,theme:l},t,n,o,r)}function _l(e,t,n,o,r,i,a,l,d){d==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):d==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function Kl(e,t){const n=_o("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ha(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ta(e,t,n,o,r,i,a,l,d,f){const u=l.baseFontFull,g=Zs(e,t,u,r-l.cellHorizontalPadding*2,f??!1),m=Kl(e,u),w=l.lineHeight*m,h=m+w*(g.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let C=Math.max(o+l.cellVerticalPadding,x);for(const p of g)if(_l(e,p,n,C,r,m,a,l,d),C+=w,C>o+i)break;b&&e.restore()}function kn(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:d,y:f,width:u,height:g}=a;o=o??!1,o||(t=Ha(t,u));const m=Jn(i,l),w=zi(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ta(i,t,d,f,u,g,m,l,n,r):_l(i,t,d,f,u,g,m,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function Sn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Aa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function za(e,t,n){const o=function(l,d){const f=d.x-l.x,u=d.y-l.y,g=Math.sqrt(f*f+u*u),m=f/g,w=u/g;return{x:f,y:d.y-l.y,len:g,nx:m,ny:w,ang:Math.atan2(w,m)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let d=t[l%i];const f=t[(l+1)%i],u=o(d,a),g=o(d,f),m=u.nx*g.ny-u.ny*g.nx,w=u.nx*g.nx-u.ny*-g.ny;let h=Math.asin(m<-1?-1:m>1?1:m),b=1,x=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,x=!0):h>0&&(b=-1,x=!0),r=d.radius!==void 0?d.radius:n;const C=h/2;let p=Math.abs(Math.cos(C)*r/Math.sin(C)),R;p>Math.min(u.len/2,g.len/2)?(p=Math.min(u.len/2,g.len/2),R=Math.abs(p*Math.sin(C)/Math.cos(C))):R=r;let X=d.x+g.nx*p,B=d.y+g.ny*p;X+=-g.ny*R*b,B+=g.nx*R*b,e.arc(X,B,R,u.ang+Math.PI/2*b,g.ang-Math.PI/2*b,x),a=d,d=f}e.closePath()}function Ei(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h){const b={x:0,y:i+f,width:0,height:0};if(e>=w.length||t>=u||t<-2||e<0)return b;const x=i-r;if(e>=g){const C=a>e?-1:1,p=Go(w);b.x+=p+d;for(let R=a;R!==e;R+=C)b.x+=w[C===1?R:R-1].width*C}else for(let C=0;C<e;C++)b.x+=w[C].width;if(b.width=w[e].width+1,t===-1)b.y=r,b.height=x;else if(t===-2){b.y=0,b.height=r;let C=e;const p=w[e].group,R=w[e].sticky;for(;C>0&&cr(w[C-1].group,p)&&w[C-1].sticky===R;){const B=w[C-1];b.x-=B.width,b.width+=B.width,C--}let X=e;for(;X+1<w.length&&cr(w[X+1].group,p)&&w[X+1].sticky===R;){const B=w[X+1];b.width+=B.width,X++}if(!R){const B=Go(w),z=b.x-B;z<0&&(b.x-=z,b.width+=z),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-m){let C=u-t;for(b.y=o;C>0;){const p=t+C-1;b.height=typeof h=="number"?h:h(p),b.y-=b.height,C--}b.height+=1}else{const C=l>t?-1:1;if(typeof h=="number"){const p=t-l;b.y+=p*h}else for(let p=l;p!==t;p+=C)b.y+=h(p)*C;b.height=(typeof h=="number"?h:h(t))+1}return b}const Pi=1<<21;function yn(e,t){return(t+2)*Pi+e}function Ul(e){return e%Pi}function Bi(e){return Math.floor(e/Pi)-2}function Li(e){const t=Ul(e),n=Bi(e);return[t,n]}class Vl{constructor(){Ne(this,"visibleWindow",{x:0,y:0,width:0,height:0});Ne(this,"freezeCols",0);Ne(this,"freezeRows",[]);Ne(this,"isInWindow",t=>{const n=Ul(t),o=Bi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Xo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Pa extends Vl{constructor(){super(...arguments);Ne(this,"cache",new Map);Ne(this,"setValue",(n,o)=>{this.cache.set(yn(n[0],n[1]),o)});Ne(this,"getValue",n=>this.cache.get(yn(n[0],n[1])));Ne(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class sr{constructor(t=[]){Ne(this,"cells");this.cells=new Set(t.map(n=>yn(n[0],n[1])))}add(t){this.cells.add(yn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(yn(t[0],t[1]))}remove(t){this.cells.delete(yn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Bi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(yn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Li(t)}}function Ba(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ql={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function jl(){return ql}const Zl=kt.createContext(ql);function Hu(){return kt.useContext(Zl)}function Bn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=en(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ii=150;function La(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ii}function Jl(e,t,n,o,r,i,a,l,d){let f=0;const u=r===void 0?[]:r.map(w=>{const h=La(e,w[o],t,d);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const b of u)w+=b;const h=w/u.length;for(let b=0;b<u.length;b++)u[b]>=h*2?u[b]=0:f=Math.max(f,u[b])}const g=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=g;const m=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:m}}function Wa(e,t,n,o,r,i,a,l,d){const f=s.useRef(t),u=s.useRef(n),g=s.useRef(a);f.current=t,u.current=n,g.current=a;const[m,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const p=document.createElement("canvas");return p.style.display="none",p.style.opacity="0",p.style.position="fixed",[p,p.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(m&&document.documentElement.append(m),()=>{m==null||m.remove()}),[m]);const h=s.useRef({}),b=s.useRef(),[x,C]=s.useState();return s.useLayoutEffect(()=>{const p=u.current;if(p===void 0||e.every(Hr))return;let R=Math.max(1,10-Math.floor(e.length/1e4)),X=0;R<f.current&&R>1&&(R--,X=1);const B={x:0,y:0,width:e.length,height:Math.min(f.current,R)},z={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const G=p(B,d.signal),M=X>0?p(z,d.signal):void 0;let W;typeof G=="object"?W=G:W=await sl(G),M!==void 0&&(typeof M=="object"?W=[...W,...M]:W=[...W,...await sl(M)]),b.current=e,C(W)})()},[d.signal,e]),s.useMemo(()=>{let R=e.every(Hr)?e:w===null?e.map(L=>Hr(L)?L:{...L,width:Ii}):(w.font=g.current.baseFontFull,e.map((L,G)=>{if(Hr(L))return L;if(h.current[L.id]!==void 0)return{...L,width:h.current[L.id]};if(x===void 0||b.current!==e||L.id===void 0)return{...L,width:Ii};const M=Jl(w,a,L,G,x,r,i,!0,l);return h.current[L.id]=M.width,M})),X=0,B=0;const z=[];for(const[L,G]of R.entries())X+=G.width,G.grow!==void 0&&G.grow>0&&(B+=G.grow,z.push(L));if(X<o&&z.length>0){const L=[...R],G=o-X;let M=G;for(let W=0;W<z.length;W++){const N=z[W],A=(R[N].grow??0)/B,D=W===z.length-1?M:Math.min(M,Math.floor(G*A));L[N]={...R[N],growOffset:D,width:R[N].width+D},M-=D}R=L}return{sizedColumns:R,nonGrowWidth:X}},[o,e,w,x,a,r,i,l])}const Ct='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Ql=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Ga=e=>{const t=e.bgColor;return`${Ct}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},_a=Ql,Ka=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},uc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},fc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},hc={headerRowID:$a,headerNumber:Na,headerCode:Oa,headerString:Xa,headerBoolean:Ya,headerAudioUri:_a,headerVideoUri:Ka,headerEmoji:Ua,headerImage:Va,headerUri:Ql,headerPhone:qa,headerMarkdown:ja,headerDate:Za,headerTime:Ja,headerEmail:Qa,headerReference:ec,headerIfThenElse:tc,headerSingleValue:nc,headerLookup:oc,headerTextTemplate:rc,headerMath:ic,headerRollup:lc,headerJoinStrings:sc,headerSplitString:ac,headerGeoDistance:cc,headerArray:dc,rowOwnerOverlay:uc,protectedColumnOverlay:fc,renameIcon:Ga};function gc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class mc{constructor(t,n){Ne(this,"onSettled");Ne(this,"spriteMap",new Map);Ne(this,"headerIcons");Ne(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,d=1){const[f,u]=gc(n,l),g=a*Math.ceil(window.devicePixelRatio),m=`${f}_${u}_${g}_${t}`;let w=this.spriteMap.get(m);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(m,w);const C=x.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{b.drawImage(x,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else d<1&&(o.globalAlpha=d),o.drawImage(w,0,0,g,g,r,i,a,a),d<1&&(o.globalAlpha=1)}}function es(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function _r(e,t,n,o,r,i,a,l,d){l=l??t;let f=t,u=e;const g=o-i;let m=!1;for(;f<n&&u<g;){const w=r(u);if(f+w>l&&d(f,u,w,!1,a&&u===o-1)===!0){m=!0;break}f+=w,u++}if(!m){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,d(f,u,h,!0,a&&u===o-1)}}}function Qn(e,t,n,o,r,i){let a=0,l=0;const d=r+o;for(const f of e){const u=f.sticky?l:a+n;if(i(f,u,d,f.sticky?0:l,t)===!0)break;a+=f.width,l+=f.sticky?f.width:0}}function ts(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const d=e[l];let f=l+1,u=d.width;for(d.sticky&&(a+=u);f<e.length&&cr(e[f].group,d.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(a+=b.width)}const g=d.sticky?0:n,m=i+g,w=d.sticky?0:Math.max(0,a-m),h=Math.min(u-w,t-(m+w));r([d.sourceIndex,e[f-1].sourceIndex],d.group??"",m+w,0,h,o),i+=u}}function ns(e,t,n,o,r,i,a){var m;const[l,d]=e;let f,u;const g=((m=a.find(w=>!w.sticky))==null?void 0:m.sourceIndex)??0;if(d>g){const w=Math.max(l,g);let h=t,b=o;for(let x=i.sourceIndex-1;x>=w;x--)h-=a[x].width,b+=a[x].width;for(let x=i.sourceIndex+1;x<=d;x++)b+=a[x].width;u={x:h,y:n,width:b,height:r}}if(g>l){const w=Math.min(d,g-1);let h=t,b=o;for(let x=i.sourceIndex-1;x>=l;x--)h-=a[x].width,b+=a[x].width;for(let x=i.sourceIndex+1;x<=w;x++)b+=a[x].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function wc(e,t,n,o){if(o==="any")return os(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Ol([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,d=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return d===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:d===a?{x:e.x,y:n,width:e.width,height:e.y-n}:d===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function dr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function ho(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function os(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function bc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function yc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,d=r-e.x,f=e.x+e.width-a,u=i-e.y,g=e.y+e.height-l,m=d>0?e.x+Math.floor(d/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:h,width:w-m,height:b-h}}function pc(e,t,n,o,r){const[i,a,l,d]=t,[f,u,g,m]=r,{x:w,y:h,width:b,height:x}=e,C=[];if(b<=0||x<=0)return C;const p=w+b,R=h+x,X=w<i,B=h<a,z=w+b>l,L=h+x>d,G=w>=i&&w<l||p>i&&p<=l||w<i&&p>l,M=h>=a&&h<d||R>a&&R<=d||h<a&&R>d;if(G&&M){const N=Math.max(w,i),A=Math.max(h,a),D=Math.min(p,l),E=Math.min(R,d);C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:f,y:u,width:g-f+1,height:m-u+1}})}if(X&&B){const N=w,A=h,D=Math.min(p,i),E=Math.min(R,a);C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:0,y:0,width:f+1,height:u+1}})}if(B&&G){const N=Math.max(w,i),A=h,D=Math.min(p,l),E=Math.min(R,a);C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:f,y:0,width:g-f+1,height:u+1}})}if(B&&z){const N=Math.max(w,l),A=h,D=p,E=Math.min(R,a);C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(X&&M){const N=w,A=Math.max(h,a),D=Math.min(p,i),E=Math.min(R,d);C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:0,y:u,width:f+1,height:m-u+1}})}if(z&&M){const N=Math.max(w,l),A=Math.max(h,a),D=p,E=Math.min(R,d);C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(X&&L){const N=w,A=Math.max(h,d),D=Math.min(p,i),E=R;C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:0,y:m,width:f+1,height:o-m+1}})}if(L&&G){const N=Math.max(w,i),A=Math.max(h,d),D=Math.min(p,l),E=R;C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:f,y:m,width:g-f+1,height:o-m+1}})}if(z&&L){const N=Math.max(w,l),A=Math.max(h,d),D=p,E=R;C.push({rect:{x:N,y:A,width:D-N,height:E-A},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return C}const vc={kind:J.Loading,allowOverlay:!1};function wl(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x,C,p,R,X,B,z,L,G,M,W,N,A,D,E,ae,U,re,Me){let be=(R==null?void 0:R.size)??Number.MAX_SAFE_INTEGER;const ee=performance.now();let _=D.baseFontFull;e.font=_;const ye={ctx:e},ne=[0,0],Re=x>0?mo(d,x,f):0;let pe,Q;const V=es(p);return Qn(t,l,i,a,r,(fe,Pe,Ge,nt,gt)=>{const xe=Math.max(0,nt-Pe),Ie=Pe+xe,Fe=r+1,mt=fe.width-xe,wt=o-r-1;if(p.length>0){let Te=!1;for(let De=0;De<p.length;De++){const ot=p[De];if(dr(Ie,Fe,mt,wt,ot.x,ot.y,ot.width,ot.height)){Te=!0;break}}if(!Te)return}const at=()=>{e.save(),e.beginPath(),e.rect(Ie,Fe,mt,wt),e.clip()},ke=X.columns.hasIndex(fe.sourceIndex),te=g(fe.group??"").overrideTheme,ve=fe.themeOverride===void 0&&te===void 0?D:Bn(D,te,fe.themeOverride),Ee=ve.baseFontFull;Ee!==_&&(_=Ee,e.font=Ee),at();let ue;return _r(gt,Ge,o,d,f,x,C,V,(Te,De,ot,oe,me)=>{var Ke,Ht,jt;if(De<0||(ne[0]=fe.sourceIndex,ne[1]=De,R!==void 0&&!R.has(ne)))return;if(p.length>0){let Qe=!1;for(let Dt=0;Dt<p.length;Dt++){const it=p[Dt];if(dr(Pe,Te,fe.width,ot,it.x,it.y,it.width,it.height)){Qe=!0;break}}if(!Qe)return}const Be=X.rows.hasIndex(De),_e=w.hasIndex(De),Je=De<d?u(ne):vc;let bt=Pe,rt=fe.width,Le=!1,St=!1;if(Je.span!==void 0){const[Qe,Dt]=Je.span,it=`${De},${Qe},${Dt},${fe.sticky}`;if(Q===void 0&&(Q=new Set),Q.has(it)){be--;return}else{const nn=ns(Je.span,Pe,Te,fe.width,ot,fe,n),Yt=fe.sticky?nn[0]:nn[1];if(!fe.sticky&&nn[0]!==void 0&&(St=!0),Yt!==void 0){bt=Yt.x,rt=Yt.width,Q.add(it),e.restore(),ue=void 0,e.save(),e.beginPath();const Vt=Math.max(0,nt-Yt.x);e.rect(Yt.x+Vt,Te,Yt.width-Vt,ot),pe===void 0&&(pe=[]),pe.push({x:Yt.x+Vt,y:Te,width:Yt.width-Vt,height:ot}),e.clip(),Le=!0}}}const Ft=m==null?void 0:m(De),Wt=me&&((Ke=fe.trailingRowOptions)==null?void 0:Ke.themeOverride)!==void 0?(Ht=fe.trailingRowOptions)==null?void 0:Ht.themeOverride:void 0,xt=Je.themeOverride===void 0&&Ft===void 0&&Wt===void 0?ve:Bn(ve,Ft,Wt,Je.themeOverride);e.beginPath();const It=ka(ne,Je,X);let Bt=Sa(ne,Je,X,b);const cn=Je.span!==void 0&&X.columns.some(Qe=>Je.span!==void 0&&Qe>=Je.span[0]&&Qe<=Je.span[1]);It&&!h&&b?Bt=0:It&&b&&(Bt=Math.max(Bt,1)),cn&&Bt++,It||(Be&&Bt++,ke&&!me&&Bt++);const Ut=Je.kind===J.Protected?xt.bgCellMedium:xt.bgCell;let ct;if((oe||Ut!==D.bgCell)&&(ct=en(Ut,ct)),Bt>0||_e){_e&&(ct=en(xt.bgHeader,ct));for(let Qe=0;Qe<Bt;Qe++)ct=en(xt.accentLight,ct)}else if(B!==void 0){for(const Qe of B)if(Qe[0]===fe.sourceIndex&&Qe[1]===De){ct=en(xt.bgSearchResult,ct);break}}if(z!==void 0)for(let Qe=0;Qe<z.length;Qe++){const Dt=z[Qe],it=Dt.range;Dt.style!=="solid-outline"&&it.x<=fe.sourceIndex&&fe.sourceIndex<it.x+it.width&&it.y<=De&&De<it.y+it.height&&(ct=en(Dt.color,ct))}let Mn=!1;if(R!==void 0){const Qe=Te+1,it=(oe?Qe+ot-1:Math.min(Qe+ot-1,o-Re))-Qe;(it!==ot-1||bt+1<=nt)&&(Mn=!0,e.save(),e.beginPath(),e.rect(bt+1,Qe,rt-1,it),e.clip()),ct=ct===void 0?xt.bgCell:en(ct,xt.bgCell)}const dn=fe.sourceIndex===n.length-1,yt=De===d-1;ct!==void 0&&(e.fillStyle=ct,ue!==void 0&&(ue.fillStyle=ct),R!==void 0?e.fillRect(bt+1,Te+1,rt-(dn?2:1),ot-(yt?2:1)):e.fillRect(bt,Te,rt,ot)),Je.style==="faded"&&(e.globalAlpha=.6);let Ot;for(let Qe=0;Qe<M.length;Qe++){const Dt=M[Qe];if(Dt.item[0]===fe.sourceIndex&&Dt.item[1]===De){Ot=Dt;break}}if(rt>Me&&!St){const Qe=xt.baseFontFull;Qe!==_&&(e.font=Qe,_=Qe),ue=rs(e,Je,fe.sourceIndex,De,dn,yt,bt,Te,rt,ot,Bt>0,xt,ct??xt.bgCell,L,G,(Ot==null?void 0:Ot.hoverAmount)??0,W,A,ee,N,ue,E,ae,U,re)}return Mn&&e.restore(),Je.style==="faded"&&(e.globalAlpha=1),be--,Le&&(e.restore(),(jt=ue==null?void 0:ue.deprep)==null||jt.call(ue,ye),ue=void 0,at(),_=Ee,e.font=Ee),be<=0}),e.restore(),be<=0}),pe}const tr=[0,0],nr={x:0,y:0,width:0,height:0},pi=[void 0,()=>{}];let Di=!1;function Cc(){Di=!0}function rs(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x,C,p,R,X,B,z,L,G){var ae,U;let M,W;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(M=x[1][0],W=x[1][1]);let N;tr[0]=n,tr[1]=o,nr.x=a,nr.y=l,nr.width=d,nr.height=f,pi[0]=z.getValue(tr),pi[1]=re=>z.setValue(tr,re),Di=!1;const A={ctx:e,theme:g,col:n,row:o,cell:t,rect:nr,highlighted:u,cellFillColor:m,hoverAmount:b,frameTime:p,hoverX:M,drawState:pi,hoverY:W,imageLoader:w,spriteManager:h,hyperWrapping:C,overrideCursor:M!==void 0?G:void 0,requestAnimationFrame:Cc},D=Fa(A,t.lastUpdated,p,X,r,i),E=L(t);if(E!==void 0){(X==null?void 0:X.renderer)!==E&&((ae=X==null?void 0:X.deprep)==null||ae.call(X,A),X=void 0);const re=(U=E.drawPrep)==null?void 0:U.call(E,A,X);R!==void 0&&!Oo(A.cell)?R(A,()=>E.draw(A,t)):E.draw(A,t),N=re===void 0?void 0:{deprep:re==null?void 0:re.deprep,fillStyle:re==null?void 0:re.fillStyle,font:re==null?void 0:re.font,renderer:E}}return(D||Di)&&(B==null||B(tr)),N}function Wi(e,t,n,o,r,i,a,l,d=-20,f=-20,u=void 0,g="center",m="square"){const w=Math.floor(r+a/2),h=m==="circle"?1e4:t.roundingRadius??4;let b=Ll(u??t.checkboxMaxSize,a,t.cellVerticalPadding),x=b/2;const C=Bl(g,o,i,t.cellHorizontalPadding,b),p=Pl(C,w,b),R=Wl(o+d,r+f,p);switch(n){case!0:{e.beginPath(),Sn(e,C-b/2,w-b/2,b,b,h),m==="circle"&&(x*=.8,b*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-x+b/4.23,w-x+b/1.97),e.lineTo(C-x+b/2.42,w-x+b/1.44),e.lineTo(C-x+b/1.29,w-x+b/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Wr:case!1:{e.beginPath(),Sn(e,C-b/2+.5,w-b/2+.5,b-1,b-1,h),e.lineWidth=1,e.strokeStyle=R?t.textDark:t.textMedium,e.stroke();break}case Hi:{e.beginPath(),Sn(e,C-b/2,w-b/2,b,b,h),e.fillStyle=R?t.textMedium:t.textLight,e.fill(),m==="circle"&&(x*=.8,b*=.8),e.beginPath(),e.moveTo(C-b/3,w),e.lineTo(C+b/3,w),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:ar()}}function xc(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x,C,p){var M,W,N,A;const R=a+l;if(R<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,r,R);const X=(M=o==null?void 0:o[0])==null?void 0:M[0],B=(W=o==null?void 0:o[0])==null?void 0:W[1],z=(N=o==null?void 0:o[1])==null?void 0:N[0],L=(A=o==null?void 0:o[1])==null?void 0:A[1],G=g.headerFontFull;e.font=G,Qn(t,0,i,0,R,(D,E,ae,U)=>{var fe;if(x!==void 0&&!x.has([D.sourceIndex,-1]))return;const re=Math.max(0,U-E);e.save(),e.beginPath(),e.rect(E+re,l,D.width-re,a),e.clip();const Me=b(D.group??"").overrideTheme,be=D.themeOverride===void 0&&Me===void 0?g:Bn(g,Me,D.themeOverride);be.bgHeader!==g.bgHeader&&(e.fillStyle=be.bgHeader,e.fill()),be!==g&&(e.font=be.headerFontFull);const ee=u.columns.hasIndex(D.sourceIndex),_=d!==void 0||f||D.headerRowMarkerDisabled===!0,ye=!_&&B===-1&&X===D.sourceIndex,ne=_?0:((fe=w.find(Pe=>Pe.item[0]===D.sourceIndex&&Pe.item[1]===-1))==null?void 0:fe.hoverAmount)??0,Re=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===D.sourceIndex,pe=ee?be.accentColor:Re?be.bgHeaderHasFocus:be.bgHeader,Q=n?l:0,V=D.sourceIndex===0?0:1;ee?(e.fillStyle=pe,e.fillRect(E+V,Q,D.width-V,a)):(Re||ne>0)&&(e.beginPath(),e.rect(E+V,Q,D.width-V,a),Re&&(e.fillStyle=be.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=be.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ss(e,E,Q,D.width,a,D,ee,be,ye,ye?z:void 0,ye?L:void 0,Re,ne,m,C,p),e.restore()}),n&&kc(e,t,r,i,l,o,g,m,w,h,b,x)}function kc(e,t,n,o,r,i,a,l,d,f,u,g){const[w,h]=(i==null?void 0:i[0])??[];let b=0;ts(t,n,o,r,(x,C,p,R,X,B)=>{if(g!==void 0&&!g.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,R,X,B),e.clip();const z=u(C),L=(z==null?void 0:z.overrideTheme)===void 0?a:Bn(a,z.overrideTheme),G=h===-2&&w!==void 0&&w>=x[0]&&w<=x[1],M=G?L.bgGroupHeaderHovered??L.bgHeaderHovered:L.bgGroupHeader??L.bgHeader;if(M!==a.bgHeader&&(e.fillStyle=M,e.fill()),e.fillStyle=L.textGroupHeader??L.textHeader,z!==void 0){let W=p;if(z.icon!==void 0&&(l.drawSprite(z.icon,"normal",e,W+8,(r-20)/2,20,L),W+=26),e.fillText(z.name,W+8,r/2+Jn(e,a.headerFontFull)),z.actions!==void 0&&G){const N=is({x:p,y:R,width:X,height:B},z.actions);e.beginPath();const A=N[0].x-10,D=p+X-A;e.rect(A,0,D,r);const E=e.createLinearGradient(A,0,A+D,0),ae=go(M,0);E.addColorStop(0,ae),E.addColorStop(10/D,M),E.addColorStop(1,M),e.fillStyle=E,e.fill(),e.globalAlpha=.6;const[U,re]=(i==null?void 0:i[1])??[-1,-1];for(let Me=0;Me<z.actions.length;Me++){const be=z.actions[Me],ee=N[Me],_=ho(ee,U+p,re);_&&(e.globalAlpha=1),l.drawSprite(be.icon,"normal",e,ee.x+ee.width/2-10,ee.y+ee.height/2-10,20,L),_&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&f(x[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=p+X}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const Ar=30;function Sc(e,t,n,o,r){return{x:e+n-Ar,y:Math.max(t,t+o/2-Ar/2),width:Ar,height:Math.min(Ar,o)}}function is(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function or(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ls(e,t,n,o,r,i,a,l){var C;const d=a.cellHorizontalPadding,f=a.headerIconSize,u=Sc(n,o,r,i);let g=n+d;const m=t.icon===void 0?void 0:{x:g,y:o+(i-f)/2,width:f,height:f},w=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(f*1.3));const h={x:g,y:o,width:r-g,height:i};let b;if(t.indicatorIcon!==void 0){const p=e===void 0?((C=Gl(t.title,a.headerFontFull))==null?void 0:C.width)??0:_o(t.title,e,a.headerFontFull).width;h.width=p,g+=p+d,b={x:g,y:o+(i-f)/2,width:f,height:f}}const x=n+r/2;return{menuBounds:or(u,x,l),iconBounds:or(m,x,l),iconOverlayBounds:or(w,x,l),textBounds:or(h,x,l),indicatorIconBounds:or(b,x,l)}}function bl(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const p=i.rowMarkerChecked;p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const R=i.headerRowMarkerTheme!==void 0?Bn(l,i.headerRowMarkerTheme):l;Wi(e,R,p,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=a?l.textHeaderSelected:l.textHeader,C=i.hasMenu===!0&&(d||w&&a)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let p=a?"selected":"normal";i.style==="highlight"&&(p=a?"selected":"special"),m.drawSprite(i.icon,p,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&m.drawSprite(i.overlayIcon,a?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(C&&o>35){const R=h?35:o-35,X=h?35*.7:o-35*.7,B=R/o,z=X/o,L=e.createLinearGradient(t,0,t+o,0),G=go(x,0);L.addColorStop(h?1:0,x),L.addColorStop(B,x),L.addColorStop(z,G),L.addColorStop(h?0:1,G),e.fillStyle=L}else e.fillStyle=x;if(h&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,h?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+Jn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!C||!dr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let p=a?"selected":"normal";i.style==="highlight"&&(p=a?"selected":"special"),m.drawSprite(i.indicatorIcon,p,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(C&&b.menuBounds!==void 0){const p=b.menuBounds,R=f!==void 0&&u!==void 0&&ho(p,f+t,u+n);if(R||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===$r.Triangle){e.beginPath();const X=p.x+p.width/2-5.5,B=p.y+p.height/2-3;za(e,[{x:X,y:B},{x:X+11,y:B},{x:X+5.5,y:B+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===$r.Dots){e.beginPath();const X=p.x+p.width/2,B=p.y+p.height/2;Aa(e,X,B),e.fillStyle=x,e.fill()}else{const X=p.x+(p.width-l.headerIconSize)/2,B=p.y+(p.height-l.headerIconSize)/2;m.drawSprite(i.menuIcon,"normal",e,X,B,l.headerIconSize,l)}R||(e.globalAlpha=1)}}function ss(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b){const x=zi(i.title)==="rtl",C=ls(e,i,t,n,o,r,l,x);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:m,isHovered:d,hasSelectedCell:g,spriteManager:w,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>bl(e,t,n,o,r,i,a,l,d,f,u,m,w,b,x,C)):bl(e,t,n,o,r,i,a,l,d,f,u,m,w,b,x,C)}function Mc(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x,C,p){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const R=es(x);Qn(t,d,a,l,i,(X,B,z,L,G)=>{if(X!==t[t.length-1])return;B+=X.width;const M=Math.max(B,L);M>o||(e.save(),e.beginPath(),e.rect(M,i+1,1e4,r-i-1),e.clip(),_r(G,z,r,f,u,h,b,R,(W,N,A,D)=>{if(!D&&x.length>0&&!x.some(Me=>dr(B,W,1e4,A,Me.x,Me.y,Me.width,Me.height)))return;const E=m.hasIndex(N),ae=w.hasIndex(N);e.beginPath();const U=g==null?void 0:g(N),re=U===void 0?p:Bn(p,U);re.bgCell!==p.bgCell&&(e.fillStyle=re.bgCell,e.fillRect(B,W,1e4,A)),ae&&(e.fillStyle=re.bgHeader,e.fillRect(B,W,1e4,A)),E&&(e.fillStyle=re.accentLight,e.fillRect(B,W,1e4,A))}),e.restore())})}function Rc(e,t,n,o,r,i,a,l,d){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=d.horizontalBorderColor??d.borderColor,g=d.borderColor,m=f?Go(t):0;let w;if(m!==0&&(w=fl(g,d.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=g===u&&w!==void 0?w:fl(u,d.bgCell),b=mo(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const as=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function Ec(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h){var A;const b=h.bgCell,{minX:x,maxX:C,minY:p,maxY:R}=as(l,i,a),X=[],B=a-mo(w,m,f);let z=d,L=n,G=0;for(;z+r<B;){const D=z+r,E=f(L);if(D>=p&&D<=R-1){const ae=u==null?void 0:u(L),U=ae==null?void 0:ae.bgCell;U!==void 0&&U!==b&&L>=w-m&&X.push({x,y:D,w:C-x,h:E,color:U})}z+=E,L<w-m&&(G=z),L++}let M=0;const W=Math.min(B,R)-G;if(W>0)for(let D=0;D<t.length;D++){const E=t[D];if(E.width===0)continue;const ae=E.sticky?M:M+o,U=(A=E.themeOverride)==null?void 0:A.bgCell;U!==void 0&&U!==b&&ae>=x&&ae<=C&&g(D+1)&&X.push({x:ae,y:G,w:E.width,h:W,color:U}),M+=E.width}if(X.length===0)return;let N;e.beginPath();for(let D=X.length-1;D>=0;D--){const E=X[D];N===void 0?N=E.color:E.color!==N&&(e.fillStyle=N,e.fill(),e.beginPath(),N=E.color),e.rect(E.x,E.y,E.w,E.h)}N!==void 0&&(e.fillStyle=N,e.fill()),e.beginPath()}function yl(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x,C=!1){if(d!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const A of d)e.rect(A.x+1,A.y+1,A.width-1,A.height-1);e.clip("evenodd")}const p=x.horizontalBorderColor??x.borderColor,R=x.borderColor,{minX:X,maxX:B,minY:z,maxY:L}=as(l,i,a),G=[];e.beginPath();let M=.5;for(let A=0;A<t.length;A++){const D=t[A];if(D.width===0)continue;M+=D.width;const E=D.sticky?M:M+o;E>=X&&E<=B&&w(A+1)&&G.push({x1:E,y1:Math.max(f,z),x2:E,y2:Math.min(a,L),color:R})}let W=a+.5;for(let A=b-h;A<b;A++){const D=g(A);W-=D,G.push({x1:X,y1:W,x2:B,y2:W,color:p})}if(C!==!0){let A=u+.5,D=n;const E=W;for(;A+r<E;){const ae=A+r;if(ae>=z&&ae<=L-1){const U=m==null?void 0:m(D);G.push({x1:X,y1:ae,x2:B,y2:ae,color:(U==null?void 0:U.horizontalBorderColor)??(U==null?void 0:U.borderColor)??p})}A+=g(D),D++}}const N=Qs(G,A=>A.color);for(const A of Object.keys(N)){e.strokeStyle=A;for(const D of N[A])e.moveTo(D.x1,D.y1),e.lineTo(D.x2,D.y2);e.stroke(),e.beginPath()}d!==void 0&&e.restore()}function Ic(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x,C,p){const R=[];e.imageSmoothingEnabled=!1;const X=Math.min(r.cellYOffset,a),B=Math.max(r.cellYOffset,a);let z=0;if(typeof C=="number")z+=(B-X)*C;else for(let E=X;E<B;E++)z+=C(E);a>r.cellYOffset&&(z=-z),z+=d-r.translateY;const L=Math.min(r.cellXOffset,i),G=Math.max(r.cellXOffset,i);let M=0;for(let E=L;E<G;E++)M+=b[E].width;i>r.cellXOffset&&(M=-M),M+=l-r.translateX;const W=Go(x);if(M!==0&&z!==0)return{regions:[]};const N=f>0?mo(m,f,C):0,A=u-W-Math.abs(M),D=g-w-N-Math.abs(z)-1;if(A>150&&D>150){const E={sx:0,sy:0,sw:u*h,sh:g*h,dx:0,dy:0,dw:u*h,dh:g*h};if(z>0?(E.sy=(w+1)*h,E.sh=D*h,E.dy=(z+w+1)*h,E.dh=D*h,R.push({x:0,y:w,width:u,height:z+1})):z<0&&(E.sy=(-z+w+1)*h,E.sh=D*h,E.dy=(w+1)*h,E.dh=D*h,R.push({x:0,y:g+z-N,width:u,height:-z+N})),M>0?(E.sx=W*h,E.sw=A*h,E.dx=(M+W)*h,E.dw=A*h,R.push({x:W-1,y:0,width:M+2,height:g})):M<0&&(E.sx=(W-M)*h,E.sw=A*h,E.dx=W*h,E.dw=A*h,R.push({x:u+M,y:0,width:-M,height:g})),e.setTransform(1,0,0,1,0,0),p){if(W>0&&M!==0&&z===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ae=W*h,U=g*h;e.drawImage(t,0,0,ae,U,0,0,ae,U)}if(N>0&&M===0&&z!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ae=(g-N)*h,U=u*h,re=N*h;e.drawImage(t,0,ae,U,re,0,ae,U,re)}}e.drawImage(t,E.sx,E.sy,E.sw,E.sh,E.dx,E.dy,E.dw,E.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:R}}function Dc(e,t,n,o,r,i,a,l,d,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Qn(d,n,o,r,l,(g,m,w,h)=>{if(g.sourceIndex===f){const b=Math.max(m,h)+1;return u.push({x:b,y:0,width:i-b,height:a}),!0}}),u}function Fc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Xo(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:d,...f}=i;if(!Xo(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function pl(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b){const x=h==null?void 0:h.filter(L=>L.style!=="no-outline");if(x===void 0||x.length===0)return;const C=Go(l),p=mo(w,m,g),R=[d,0,l.length,w-m],X=[C,0,t,n-p],B=x.map(L=>{const G=L.range,M=L.style??"dashed";return pc(G,R,t,n,X).map(W=>{const N=W.rect,A=Ei(N.x,N.y,t,n,u,f+u,o,r,i,a,w,d,m,l,g),D=N.width===1&&N.height===1?A:Ei(N.x+N.width-1,N.y+N.height-1,t,n,u,f+u,o,r,i,a,w,d,m,l,g);return N.x+N.width>=l.length&&(D.width-=1),N.y+N.height>=w&&(D.height-=1),{color:L.color,style:M,clip:W.clip,rect:yc({x:A.x,y:A.y,width:D.x+D.width-A.x,height:D.y+D.height-A.y},t,n,8)}})}),z=()=>{e.lineWidth=1;let L=!1;for(const G of B)for(const M of G)if((M==null?void 0:M.rect)!==void 0&&dr(0,0,t,n,M.rect.x,M.rect.y,M.rect.width,M.rect.height)){const W=L,N=!bc(M.clip,M.rect);e.beginPath(),N&&(e.save(),e.rect(M.clip.x,M.clip.y,M.clip.width,M.clip.height),e.clip()),M.style==="dashed"&&!L?(e.setLineDash([5,3]),L=!0):(M.style==="solid"||M.style==="solid-outline")&&L&&(e.setLineDash([]),L=!1),e.strokeStyle=M.style==="solid-outline"?en(en(M.color,b.borderColor),b.bgCell):go(M.color,1),e.closePath(),e.strokeRect(M.rect.x+.5,M.rect.y+.5,M.rect.width-1,M.rect.height-1),N&&(e.restore(),L=W)}L&&e.setLineDash([])};return z(),z}function vl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function vi(e,t,n,o,r,i,a,l,d,f,u,g,m,w,h,b,x){if(u.current===void 0)return;const C=b!==!1&&b!==void 0;if(!C)return;const p=typeof b=="object"?{...Or,...b}:Or,R=u.current.range,X=u.current.cell,B=[R.x+R.width-1,R.y+R.height-1];if(X[1]>=x&&B[1]>=x||!a.some(U=>U.sourceIndex===X[0]||U.sourceIndex===B[0]))return;const[L,G]=u.current.cell,M=m(u.current.cell),W=M.span??[L,L],N=G>=x-w,A=w>0&&!N?mo(x,w,g)-1:0,D=B[1];let E;if(Qn(a,o,r,i,f,(U,re,Me,be,ee)=>{if(U.sticky&&L>U.sourceIndex)return;const _=U.sourceIndex<W[0],ye=U.sourceIndex>W[1],ne=U.sourceIndex===B[0];if(!(!ne&&(_||ye)))return _r(ee,Me,n,x,g,w,h,void 0,(Re,pe,Q)=>{if(pe!==G&&pe!==D)return;let V=re,fe=U.width;if(M.span!==void 0){const Ge=ns(M.span,re,Re,U.width,Q,U,l),nt=U.sticky?Ge[0]:Ge[1];nt!==void 0&&(V=nt.x,fe=nt.width)}return pe===D&&ne&&C&&(E=()=>{var Ie;be>V&&!U.sticky&&(e.beginPath(),e.rect(be,0,t-be,n),e.clip());const Ge=p.size,nt=Ge/2,gt=V+fe+p.offsetX-nt+.5,xe=Re+Q+p.offsetY-nt+.5;e.beginPath(),p.shape==="circle"?e.arc(gt+nt,xe+nt,nt,0,Math.PI*2):e.rect(gt,xe,Ge,Ge),e.fillStyle=((Ie=U.themeOverride)==null?void 0:Ie.accentColor)??d.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=d.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(gt+nt,xe+nt,nt+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(gt-p.outline/2,xe-p.outline/2,Ge+p.outline,Ge+p.outline))}),E!==void 0}),E!==void 0}),E===void 0)return;const ae=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-A),e.clip(),E==null||E(),e.restore()};return ae(),ae}function Hc(e,t,n,o,r,i,a,l,d){d===void 0||d.size===0||(e.beginPath(),ts(t,n,i,o,(f,u,g,m,w,h)=>{d.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(g,m,w,h)}),Qn(t,l,i,a,r,(f,u,g,m)=>{const w=Math.max(0,m-u),h=u+w+1,b=f.width-w-1;d.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function Tc(e,t,n,o,r,i,a,l,d,f){let u=0;return Qn(e,i,o,r,n,(g,m,w,h,b)=>(_r(b,w,t,a,l,d,f,void 0,(x,C,p,R)=>{R||(u=Math.max(C,u))}),!0)),u}function Cl(e,t){var dn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:d,translateY:f,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:x,groupHeaderHeight:C,disabledRows:p,rowHeight:R,verticalBorder:X,overrideCursor:B,isResizing:z,selection:L,fillHandle:G,freezeTrailingRows:M,rows:W,getCellContent:N,getGroupDetails:A,getRowThemeOverride:D,isFocused:E,drawHeaderCallback:ae,prelightCells:U,drawCellCallback:re,highlightRegions:Me,resizeCol:be,imageLoader:ee,lastBlitData:_,hoverValues:ye,hyperWrapping:ne,hoverInfo:Re,spriteManager:pe,maxScaleFactor:Q,hasAppendRow:V,touchMode:fe,enqueue:Pe,renderStateProvider:Ge,getCellRenderer:nt,renderStrategy:gt,bufferACtx:xe,bufferBCtx:Ie,damage:Fe,minimumCellWidth:mt,resizeIndicator:wt}=e;if(r===0||i===0)return;const at=gt==="double-buffer",ke=Math.min(Q,Math.ceil(window.devicePixelRatio??1)),te=gt!=="direct"&&Fc(e,t),ve=n.canvas;(ve.width!==r*ke||ve.height!==i*ke)&&(ve.width=r*ke,ve.height=i*ke,ve.style.width=r+"px",ve.style.height=i+"px");const Ee=o.canvas,ue=g?C+x:x,Te=ue+1;(Ee.width!==r*ke||Ee.height!==Te*ke)&&(Ee.width=r*ke,Ee.height=Te*ke,Ee.style.width=r+"px",Ee.style.height=Te+"px");const De=xe.canvas,ot=Ie.canvas;at&&(De.width!==r*ke||De.height!==i*ke)&&(De.width=r*ke,De.height=i*ke,_.current!==void 0&&(_.current.aBufferScroll=void 0)),at&&(ot.width!==r*ke||ot.height!==i*ke)&&(ot.width=r*ke,ot.height=i*ke,_.current!==void 0&&(_.current.bBufferScroll=void 0));const oe=_.current;if(te===!0&&a===(oe==null?void 0:oe.cellXOffset)&&l===(oe==null?void 0:oe.cellYOffset)&&d===(oe==null?void 0:oe.translateX)&&f===(oe==null?void 0:oe.translateY))return;let me=null;at&&(me=n);const Be=o;let _e;at?Fe!==void 0?_e=(oe==null?void 0:oe.lastBuffer)==="b"?Ie:xe:_e=(oe==null?void 0:oe.lastBuffer)==="b"?xe:Ie:_e=n;const Je=_e.canvas,bt=at?Je===De?ot:De:ve,rt=typeof R=="number"?()=>R:R;Be.save(),_e.save(),Be.beginPath(),_e.beginPath(),Be.textBaseline="middle",_e.textBaseline="middle",ke!==1&&(Be.scale(ke,ke),_e.scale(ke,ke));const Le=Ri(u,a,r,w,d);let St=[];const Ft=b&&((dn=L.current)==null?void 0:dn.cell[1])===l&&f===0;let Wt=!1;if(Me!==void 0){for(const yt of Me)if(yt.style!=="no-outline"&&yt.range.y===l&&f===0){Wt=!0;break}}const xt=()=>{xc(Be,Le,g,Re,r,d,x,C,w,z,L,h,pe,ye,X,A,Fe,ae,fe),yl(Be,Le,l,d,f,r,i,void 0,void 0,C,ue,rt,D,X,M,W,h,!0),Be.beginPath(),Be.moveTo(0,Te-.5),Be.lineTo(r,Te-.5),Be.strokeStyle=en(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Be.stroke(),Wt&&pl(Be,r,i,a,l,d,f,u,m,x,C,R,M,W,Me,h),Ft&&vi(Be,r,i,l,d,f,Le,u,h,ue,L,rt,N,M,V,G,W)};if(Fe!==void 0){const yt=Le[Le.length-1].sourceIndex+1,Ot=Fe.hasItemInRegion([{x:a,y:-2,width:yt,height:2},{x:a,y:l,width:yt,height:300},{x:0,y:l,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:a,y:W-M,width:yt,height:M,when:M>0}]),Ke=Ht=>{wl(Ht,Le,u,i,ue,d,f,l,W,rt,N,A,D,p,E,b,M,V,St,Fe,L,U,Me,ee,pe,ye,Re,re,ne,h,Pe,Ge,nt,B,mt);const jt=L.current;G!==!1&&G!==void 0&&b&&jt!==void 0&&Fe.has(Nl(jt.range))&&vi(Ht,r,i,l,d,f,Le,u,h,ue,L,rt,N,M,V,G,W)};Ot&&(Ke(_e),me!==null&&(me.save(),me.scale(ke,ke),me.textBaseline="middle",Ke(me),me.restore()),Fe.hasHeader()&&(Hc(Be,Le,r,C,ue,d,f,l,Fe),xt())),_e.restore(),Be.restore();return}if((te!==!0||a!==(oe==null?void 0:oe.cellXOffset)||d!==(oe==null?void 0:oe.translateX)||Ft!==(oe==null?void 0:oe.mustDrawFocusOnHeader)||Wt!==(oe==null?void 0:oe.mustDrawHighlightRingsOnHeader))&&xt(),te===!0){Qt(bt!==void 0&&oe!==void 0);const{regions:yt}=Ic(_e,bt,bt===De?oe.aBufferScroll:oe.bBufferScroll,bt===De?oe.bBufferScroll:oe.aBufferScroll,oe,a,l,d,f,M,r,i,W,ue,ke,u,Le,R,at);St=yt}else te!==!1&&(Qt(oe!==void 0),St=Dc(oe,a,l,d,f,r,i,ue,Le,te));Rc(_e,Le,r,i,M,W,X,rt,h);const It=pl(_e,r,i,a,l,d,f,u,m,x,C,R,M,W,Me,h),Bt=b?vi(_e,r,i,l,d,f,Le,u,h,ue,L,rt,N,M,V,G,W):void 0;if(_e.fillStyle=h.bgCell,St.length>0){_e.beginPath();for(const yt of St)_e.rect(yt.x,yt.y,yt.width,yt.height);_e.clip(),_e.fill(),_e.beginPath()}else _e.fillRect(0,0,r,i);const cn=wl(_e,Le,u,i,ue,d,f,l,W,rt,N,A,D,p,E,b,M,V,St,Fe,L,U,Me,ee,pe,ye,Re,re,ne,h,Pe,Ge,nt,B,mt);Mc(_e,Le,u,r,i,ue,d,f,l,W,rt,D,L.rows,p,M,V,St,Fe,h),Ec(_e,Le,l,d,f,r,i,St,ue,rt,D,X,M,W,h),yl(_e,Le,l,d,f,r,i,St,cn,C,ue,rt,D,X,M,W,h),It==null||It(),Bt==null||Bt(),z&&wt!=="none"&&Qn(Le,0,d,0,ue,(yt,Ot)=>yt.sourceIndex===be?(vl(Be,Ot+yt.width,0,ue+1,en(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),wt==="full"&&vl(_e,Ot+yt.width,ue,i,en(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),me!==null&&(me.fillStyle=h.bgCell,me.fillRect(0,0,r,i),me.drawImage(_e.canvas,0,0));const Ut=Tc(Le,i,ue,d,f,l,W,rt,M,V);ee==null||ee.setWindow({x:a,y:l,width:Le.length,height:Ut-l},m,Array.from({length:M},(yt,Ot)=>W-1-Ot));const ct=oe!==void 0&&(a!==oe.cellXOffset||d!==oe.translateX),Mn=oe!==void 0&&(l!==oe.cellYOffset||f!==oe.translateY);_.current={cellXOffset:a,cellYOffset:l,translateX:d,translateY:f,mustDrawFocusOnHeader:Ft,mustDrawHighlightRingsOnHeader:Wt,lastBuffer:at?Je===De?"a":"b":void 0,aBufferScroll:Je===De?[ct,Mn]:oe==null?void 0:oe.aBufferScroll,bBufferScroll:Je===ot?[ct,Mn]:oe==null?void 0:oe.bBufferScroll},_e.restore(),Be.restore()}const Ac=80;function zc(e){const t=e-1;return t*t*t+1}class Pc{constructor(t){Ne(this,"callback");Ne(this,"currentHoveredItem");Ne(this,"leavingItems",[]);Ne(this,"lastAnimationTime");Ne(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>ir(o.item,t.item))||this.leavingItems.push(t)});Ne(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>ir(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Ne(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Ne(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Ne(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:zc(t.hoverAmount)})));Ne(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Ac;for(const i of this.leavingItems)i.hoverAmount=sn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=sn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Ne(this,"setHovered",t=>{var n;if(!ir((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Bc{constructor(t){Ne(this,"fn");Ne(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function $i(e){return new Bc(e)}const Lc=$i(()=>window.navigator.userAgent.includes("Firefox")),Nr=$i(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Xr=$i(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Wc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Li);t.current=[],o.current(new sr(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=yn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Zn="header",bn="group-header",Yr="out-of-bounds";var No;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(No||(No={}));function cs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const $c=(e,t)=>{if(e.kind===J.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Oc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:d,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:b,onHeaderIndicatorClick:x,enableGroups:C,isFilling:p,onCanvasFocused:R,onCanvasBlur:X,isFocused:B,selection:z,freezeColumns:L,onContextMenu:G,freezeTrailingRows:M,fixedShadowX:W=!0,fixedShadowY:N=!0,drawFocusRing:A,onMouseDown:D,onMouseUp:E,onMouseMoveRaw:ae,onMouseMove:U,onItemHovered:re,dragAndDropState:Me,firstColAccessible:be,onKeyDown:ee,onKeyUp:_,highlightRegions:ye,canvasRef:ne,onDragStart:Re,onDragEnd:pe,eventTargetRef:Q,isResizing:V,resizeColumn:fe,isDragging:Pe,isDraggable:Ge=!1,allowResize:nt,disabledRows:gt,hasAppendRow:xe,getGroupDetails:Ie,theme:Fe,prelightCells:mt,headerIcons:wt,verticalBorder:at,drawCell:ke,drawHeader:te,onCellFocused:ve,onDragOverCell:Ee,onDrop:ue,onDragLeave:Te,imageWindowLoader:De,smoothScrollX:ot=!1,smoothScrollY:oe=!1,experimental:me,getCellRenderer:Be,resizeIndicator:_e="full"}=e,Je=e.translateX??0,bt=e.translateY??0,rt=Math.max(L,Math.min(i.length-1,a)),Le=s.useRef(null),St=s.useRef((me==null?void 0:me.eventTarget)??window),Ft=St.current,Wt=De,xt=s.useRef(),[It,Bt]=s.useState(!1),cn=s.useRef([]),Ut=s.useRef(),[ct,Mn]=s.useState(),[dn,yt]=s.useState(),Ot=s.useRef(null),[Ke,Ht]=s.useState(),[jt,Qe]=s.useState(!1),Dt=s.useRef(jt);Dt.current=jt;const it=s.useMemo(()=>new mc(wt,()=>{bo.current=void 0,eo.current()}),[wt]),nn=C?u+d:d,Yt=s.useRef(-1),Vt=((me==null?void 0:me.enableFirefoxRescaling)??!1)&&Lc.value,Rn=((me==null?void 0:me.enableSafariRescaling)??!1)&&Nr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Vt&&!Rn||(Yt.current!==-1&&Bt(!0),window.clearTimeout(Yt.current),Yt.current=window.setTimeout(()=>{Bt(!1),Yt.current=-1},200))},[l,rt,Je,bt,Vt,Rn]);const dt=Ca(i,L),Ln=s.useMemo(()=>W?Go(dt,Me):0,[dt,Me,W]),Tt=s.useCallback((S,Y,ce)=>{const de=S.getBoundingClientRect();if(Y>=dt.length||ce>=m)return;const j=de.width/n,Z=Ei(Y,ce,n,o,u,nn,rt,l,Je,bt,m,L,M,dt,g);return j!==1&&(Z.x*=j,Z.y*=j,Z.width*=j,Z.height*=j),Z.x+=de.x,Z.y+=de.y,Z},[n,o,u,nn,rt,l,Je,bt,m,L,M,dt,g]),Ue=s.useCallback((S,Y,ce,de)=>{const j=S.getBoundingClientRect(),Z=j.width/n,Se=(Y-j.left)/Z,Ve=(ce-j.top)/Z,he=5,At=Ri(dt,rt,n,void 0,Je);let we=0,qe=0;const Ae=typeof PointerEvent<"u"&&de instanceof PointerEvent&&de.pointerType==="mouse"||typeof MouseEvent<"u"&&de instanceof MouseEvent,We=typeof PointerEvent<"u"&&de instanceof PointerEvent&&de.pointerType==="touch"||typeof TouchEvent<"u"&&de instanceof TouchEvent;Ae&&(we=de.button,qe=de.buttons);const He=Ma(Se,At,Je),je=Ra(Ve,o,C,d,u,m,g,l,bt,M),Mt=(de==null?void 0:de.shiftKey)===!0,fn=(de==null?void 0:de.ctrlKey)===!0,hn=(de==null?void 0:de.metaKey)===!0,vt=[Se<0?-1:n<Se?1:0,Ve<nn?-1:o<Ve?1:0];let Et;if(He===-1||Ve<0||Se<0||je===void 0||Se>n||Ve>o){const lt=Se>n?1:Se<0?-1:0,on=Ve>o?1:Ve<0?-1:0;let Nt=lt*2,Fo=on*2;lt===0&&(Nt=He===-1?No.EndPadding:No.Center),on===0&&(Fo=je===void 0?No.EndPadding:No.Center);let An=!1;if(He===-1&&je===-1){const zt=Tt(S,dt.length-1,-1);Qt(zt!==void 0),An=Y<zt.x+zt.width+he}const Oe=Se>n&&Se<n+Mi()||Ve>o&&Ve<o+Mi();Et={kind:Yr,location:[He!==-1?He:Se<0?0:dt.length-1,je??m-1],region:[Nt,Fo],shiftKey:Mt,ctrlKey:fn,metaKey:hn,isEdge:An,isTouch:We,button:we,buttons:qe,scrollEdge:vt,isMaybeScrollbar:Oe}}else if(je<=-1){let lt=Tt(S,He,je);Qt(lt!==void 0);let on=lt!==void 0&&lt.x+lt.width-Y<=he;const Nt=He-1;Y-lt.x<=he&&Nt>=0?(on=!0,lt=Tt(S,Nt,je),Qt(lt!==void 0),Et={kind:C&&je===-2?bn:Zn,location:[Nt,je],bounds:lt,group:dt[Nt].group??"",isEdge:on,shiftKey:Mt,ctrlKey:fn,metaKey:hn,isTouch:We,localEventX:Y-lt.x,localEventY:ce-lt.y,button:we,buttons:qe,scrollEdge:vt}):Et={kind:C&&je===-2?bn:Zn,group:dt[He].group??"",location:[He,je],bounds:lt,isEdge:on,shiftKey:Mt,ctrlKey:fn,metaKey:hn,isTouch:We,localEventX:Y-lt.x,localEventY:ce-lt.y,button:we,buttons:qe,scrollEdge:vt}}else{const lt=Tt(S,He,je);Qt(lt!==void 0);const on=lt!==void 0&&lt.x+lt.width-Y<he;let Nt=!1;if(f!==!1&&f!==void 0&&z.current!==void 0){const An=typeof f=="object"?{...Or,...f}:Or,Oe=An.size,zt=Oe/2,ro=Nl(z.current.range),Gn=Tt(S,ro[0],ro[1]);if(Gn!==void 0){const zn=Gn.x+Gn.width+An.offsetX-zt+.5,ut=Gn.y+Gn.height+An.offsetY-zt+.5;Nt=Math.abs(zn-Y)<Oe&&Math.abs(ut-ce)<Oe}}Et={kind:"cell",location:[He,je],bounds:lt,isEdge:on,shiftKey:Mt,ctrlKey:fn,isFillHandle:Nt,metaKey:hn,isTouch:We,localEventX:Y-lt.x,localEventY:ce-lt.y,button:we,buttons:qe,scrollEdge:vt}}return Et},[n,dt,rt,Je,o,C,d,u,m,g,l,bt,M,Tt,f,z,nn]),[En]=ct??[],fr=s.useRef(()=>{}),Wn=s.useRef(ct);Wn.current=ct;const[In,Dn]=s.useMemo(()=>{const S=document.createElement("canvas"),Y=document.createElement("canvas");return S.style.display="none",S.style.opacity="0",S.style.position="fixed",Y.style.display="none",Y.style.opacity="0",Y.style.position="fixed",[S.getContext("2d",{alpha:!1}),Y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(In===null||Dn===null))return document.documentElement.append(In.canvas),document.documentElement.append(Dn.canvas),()=>{In.canvas.remove(),Dn.canvas.remove()}},[In,Dn]);const wo=s.useMemo(()=>new Pa,[]),hr=Vt&&It?1:Rn&&It?2:5,$n=(me==null?void 0:me.disableMinimumCellWidth)===!0?1:10,bo=s.useRef(),yo=s.useRef(null),po=s.useRef(null),vo=s.useCallback(()=>{var Se;const S=Le.current,Y=Ot.current;if(S===null||Y===null||(yo.current===null&&(yo.current=S.getContext("2d",{alpha:!1}),S.width=0,S.height=0),po.current===null&&(po.current=Y.getContext("2d",{alpha:!1}),Y.width=0,Y.height=0),yo.current===null||po.current===null||In===null||Dn===null))return;let ce=!1;const de=Ve=>{ce=!0,Ht(Ve)},j=bo.current,Z={headerCanvasCtx:po.current,canvasCtx:yo.current,bufferACtx:In,bufferBCtx:Dn,width:n,height:o,cellXOffset:rt,cellYOffset:l,translateX:Math.round(Je),translateY:Math.round(bt),mappedColumns:dt,enableGroups:C,freezeColumns:L,dragAndDropState:Me,theme:Fe,headerHeight:d,groupHeaderHeight:u,disabledRows:gt??st.empty(),rowHeight:g,verticalBorder:at,isResizing:V,resizeCol:fe,isFocused:B,selection:z,fillHandle:f,drawCellCallback:ke,hasAppendRow:xe,overrideCursor:de,maxScaleFactor:hr,freezeTrailingRows:M,rows:m,drawFocus:A,getCellContent:w,getGroupDetails:Ie??(Ve=>({name:Ve})),getRowThemeOverride:h,drawHeaderCallback:te,prelightCells:mt,highlightRegions:ye,imageLoader:Wt,lastBlitData:Ut,damage:xt.current,hoverValues:cn.current,hoverInfo:Wn.current,spriteManager:it,scrolling:It,hyperWrapping:(me==null?void 0:me.hyperWrapping)??!1,touchMode:jt,enqueue:fr.current,renderStateProvider:wo,renderStrategy:(me==null?void 0:me.renderStrategy)??(Nr.value?"double-buffer":"single-buffer"),getCellRenderer:Be,minimumCellWidth:$n,resizeIndicator:_e};Z.damage===void 0?(bo.current=Z,Cl(Z,j)):Cl(Z,void 0),!ce&&(Z.damage===void 0||Z.damage.has((Se=Wn==null?void 0:Wn.current)==null?void 0:Se[0]))&&Ht(void 0)},[In,Dn,n,o,rt,l,Je,bt,dt,C,L,Me,Fe,d,u,gt,g,at,V,xe,fe,B,z,f,M,m,A,hr,w,Ie,h,ke,te,mt,ye,Wt,it,It,me==null?void 0:me.hyperWrapping,me==null?void 0:me.renderStrategy,jt,wo,Be,$n,_e]),eo=s.useRef(vo);s.useLayoutEffect(()=>{vo(),eo.current=vo},[vo]),s.useLayoutEffect(()=>{(async()=>{var Y;((Y=document==null?void 0:document.fonts)==null?void 0:Y.ready)!==void 0&&(await document.fonts.ready,bo.current=void 0,eo.current())})()},[]);const Fn=s.useCallback(S=>{xt.current=S,eo.current(),xt.current=void 0},[]),Kr=Wc(Fn);fr.current=Kr;const gr=s.useCallback(S=>{Fn(new sr(S.map(Y=>Y.cell)))},[Fn]);Wt.setCallback(Fn);const[Ur,Vr]=s.useState(!1),[pn,On]=En??[],qr=pn!==void 0&&On===-1&&pn>=0&&pn<dt.length&&dt[pn].headerRowMarkerDisabled!==!0,jr=pn!==void 0&&On===-2;let Co=!1,mr=!1,to=Ke;if(to===void 0&&pn!==void 0&&On!==void 0&&On>-1&&On<m){const S=w([pn,On],!0);Co=S.kind===an.NewRow||S.kind===an.Marker&&S.markerKind!=="number",mr=S.kind===J.Boolean&&Ti(S),to=S.cursor}const wr=Pe?"grabbing":(dn??!1)||V?"col-resize":Ur||p?"crosshair":to!==void 0?to:qr||Co||mr||jr?"pointer":"default",xo=s.useMemo(()=>({contain:"strict",display:"block",cursor:wr}),[wr]),ft=s.useRef("default"),Gt=Q==null?void 0:Q.current;Gt!=null&&ft.current!==xo.cursor&&(Gt.style.cursor=ft.current=xo.cursor);const ko=s.useCallback((S,Y,ce,de)=>{if(Ie===void 0)return;const j=Ie(S);if(j.actions!==void 0){const Z=is(Y,j.actions);for(const[Se,Ve]of Z.entries())if(ho(Ve,ce+Y.x,de+Ve.y))return j.actions[Se]}},[Ie]),Hn=s.useCallback((S,Y,ce,de)=>{const j=dt[Y];if(!Pe&&!V&&!(dn??!1)){const Z=Tt(S,Y,-1);Qt(Z!==void 0);const Se=ls(void 0,j,Z.x,Z.y,Z.width,Z.height,Fe,zi(j.title)==="rtl");if(j.hasMenu===!0&&Se.menuBounds!==void 0&&ho(Se.menuBounds,ce,de))return{area:"menu",bounds:Se.menuBounds};if(j.indicatorIcon!==void 0&&Se.indicatorIconBounds!==void 0&&ho(Se.indicatorIconBounds,ce,de))return{area:"indicator",bounds:Se.indicatorIconBounds}}},[dt,Tt,dn,Pe,V,Fe]),So=s.useRef(0),Nn=s.useRef(),Mo=s.useRef(!1),Ro=s.useCallback(S=>{const Y=Le.current,ce=Q==null?void 0:Q.current;if(Y===null||S.target!==Y&&S.target!==ce)return;Mo.current=!0;const de=S.clientX,j=S.clientY;if(S.target===ce&&ce!==null){const Se=ce.getBoundingClientRect();if(de>Se.right||j>Se.bottom)return}const Z=Ue(Y,de,j,S);Nn.current=Z.location,Z.isTouch&&(So.current=Date.now()),Dt.current!==Z.isTouch&&Qe(Z.isTouch),!(Z.kind===Zn&&Hn(Y,Z.location[0],de,j)!==void 0)&&(Z.kind===bn&&ko(Z.group,Z.bounds,Z.localEventX,Z.localEventY)!==void 0||(D==null||D(Z),!Z.isTouch&&Ge!==!0&&Ge!==Z.kind&&Z.button<3&&Z.button!==1&&S.preventDefault()))},[Q,Ge,Ue,ko,Hn,D]);Kt("pointerdown",Ro,Ft,!1);const no=s.useRef(0),Xn=s.useCallback(S=>{var qe,Ae;const Y=no.current;no.current=Date.now();const ce=Le.current;if(Mo.current=!1,E===void 0||ce===null)return;const de=Q==null?void 0:Q.current,j=S.target!==ce&&S.target!==de,Z=S.clientX,Se=S.clientY,Ve=S.pointerType==="mouse"?S.button<3:!0;let he=Ue(ce,Z,Se,S);he.isTouch&&So.current!==0&&Date.now()-So.current>500&&(he={...he,isLongTouch:!0}),Y!==0&&Date.now()-Y<(he.isTouch?1e3:500)&&(he={...he,isDoubleClick:!0}),Dt.current!==he.isTouch&&Qe(he.isTouch),!j&&S.cancelable&&Ve&&S.preventDefault();const[At]=he.location,we=Hn(ce,At,Z,Se);if(he.kind===Zn&&we!==void 0){(he.button!==0||((qe=Nn.current)==null?void 0:qe[0])!==At||((Ae=Nn.current)==null?void 0:Ae[1])!==-1)&&E(he,!0);return}else if(he.kind===bn){const We=ko(he.group,he.bounds,he.localEventX,he.localEventY);if(We!==void 0){he.button===0&&We.onClick(he);return}}E(he,j)},[E,Q,Ue,Hn,ko]);Kt("pointerup",Xn,Ft,!1);const Eo=s.useCallback(S=>{var At,we;const Y=Le.current;if(Y===null)return;const ce=Q==null?void 0:Q.current,de=S.target!==Y&&S.target!==ce;let j,Z,Se=!0;S instanceof MouseEvent?(j=S.clientX,Z=S.clientY,Se=S.button<3):(j=S.changedTouches[0].clientX,Z=S.changedTouches[0].clientY);const Ve=Ue(Y,j,Z,S);Dt.current!==Ve.isTouch&&Qe(Ve.isTouch),!de&&S.cancelable&&Se&&S.preventDefault();const[he]=Ve.location;if(Ve.kind===Zn){const qe=Hn(Y,he,j,Z);qe!==void 0&&Ve.button===0&&((At=Nn.current)==null?void 0:At[0])===he&&((we=Nn.current)==null?void 0:we[1])===-1&&(qe.area==="menu"?b==null||b(he,qe.bounds):qe.area==="indicator"&&(x==null||x(he,qe.bounds)))}},[Q,Ue,Hn,b,x]);Kt("click",Eo,Ft,!1);const Jr=s.useCallback(S=>{const Y=Le.current,ce=Q==null?void 0:Q.current;if(Y===null||S.target!==Y&&S.target!==ce||G===void 0)return;const de=Ue(Y,S.clientX,S.clientY,S);G(de,()=>{S.cancelable&&S.preventDefault()})},[Q,Ue,G]);Kt("contextmenu",Jr,(Q==null?void 0:Q.current)??null,!1);const Ko=s.useCallback(S=>{xt.current=new sr(S.map(Y=>Y.item)),cn.current=S,eo.current(),xt.current=void 0},[]),Ce=s.useMemo(()=>new Pc(Ko),[Ko]),Uo=s.useRef(Ce);Uo.current=Ce,s.useLayoutEffect(()=>{const S=Uo.current;if(En===void 0||En[1]<0){S.setHovered(En);return}const Y=w(En,!0),ce=Be(Y),de=ce===void 0&&Y.kind===J.Custom||(ce==null?void 0:ce.needsHover)!==void 0&&(typeof ce.needsHover=="boolean"?ce.needsHover:ce.needsHover(Y));S.setHovered(de?En:void 0)},[w,Be,En]);const br=s.useRef(),un=s.useCallback(S=>{var Ve;const Y=Le.current;if(Y===null)return;const ce=Q==null?void 0:Q.current,de=S.target!==Y&&S.target!==ce,j=Ue(Y,S.clientX,S.clientY,S);if(j.kind!=="out-of-bounds"&&de&&!Mo.current&&!j.isTouch)return;const Z=(he,At)=>{Mn(we=>we===he||(we==null?void 0:we[0][0])===(he==null?void 0:he[0][0])&&(we==null?void 0:we[0][1])===(he==null?void 0:he[0][1])&&((we==null?void 0:we[1][0])===(he==null?void 0:he[1][0])&&(we==null?void 0:we[1][1])===(he==null?void 0:he[1][1])||!At)?we:he)};if(!cs(j,br.current))Ht(void 0),re==null||re(j),Z(j.kind===Yr?void 0:[j.location,[j.localEventX,j.localEventY]],!0),br.current=j;else if(j.kind==="cell"||j.kind===Zn||j.kind===bn){let he=!1,At=!0;if(j.kind==="cell"){const qe=w(j.location);At=((Ve=Be(qe))==null?void 0:Ve.needsHoverPosition)??qe.kind===J.Custom,he=At}else he=!0;const we=[j.location,[j.localEventX,j.localEventY]];Z(we,At),Wn.current=we,he&&Fn(new sr([j.location]))}const Se=j.location[0]>=(be?0:1);yt(j.kind===Zn&&j.isEdge&&Se&&nt===!0),Vr(j.kind==="cell"&&j.isFillHandle),ae==null||ae(S),U(j)},[Q,Ue,be,nt,ae,U,re,w,Be,Fn]);Kt("pointermove",un,Ft,!0);const Qr=s.useCallback(S=>{const Y=Le.current;if(Y===null)return;let ce,de;z.current!==void 0&&(ce=Tt(Y,z.current.cell[0],z.current.cell[1]),de=z.current.cell),ee==null||ee({bounds:ce,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:de})},[ee,z,Tt]),vn=s.useCallback(S=>{const Y=Le.current;if(Y===null)return;let ce,de;z.current!==void 0&&(ce=Tt(Y,z.current.cell[0],z.current.cell[1]),de=z.current.cell),_==null||_({bounds:ce,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:de})},[_,z,Tt]),Vo=s.useCallback(S=>{if(Le.current=S,ne!==void 0&&(ne.current=S),me!=null&&me.eventTarget)St.current=me.eventTarget;else if(S===null)St.current=window;else{const Y=S.getRootNode();Y===document&&(St.current=window),St.current=Y}},[ne,me==null?void 0:me.eventTarget]),yr=s.useCallback(S=>{const Y=Le.current;if(Y===null||Ge===!1||V){S.preventDefault();return}let ce,de;const j=Ue(Y,S.clientX,S.clientY);if(Ge!==!0&&j.kind!==Ge){S.preventDefault();return}const Z=(qe,Ae)=>{ce=qe,de=Ae};let Se,Ve,he;const At=(qe,Ae,We)=>{Se=qe,Ve=Ae,he=We};let we=!1;if(Re==null||Re({...j,setData:Z,setDragImage:At,preventDefault:()=>we=!0,defaultPrevented:()=>we}),!we&&ce!==void 0&&de!==void 0&&S.dataTransfer!==null)if(S.dataTransfer.setData(ce,de),S.dataTransfer.effectAllowed="copyLink",Se!==void 0&&Ve!==void 0&&he!==void 0)S.dataTransfer.setDragImage(Se,Ve,he);else{const[qe,Ae]=j.location;if(Ae!==void 0){const We=document.createElement("canvas"),He=Tt(Y,qe,Ae);Qt(He!==void 0);const je=Math.ceil(window.devicePixelRatio??1);We.width=He.width*je,We.height=He.height*je;const Mt=We.getContext("2d");Mt!==null&&(Mt.scale(je,je),Mt.textBaseline="middle",Ae===-1?(Mt.font=Fe.headerFontFull,Mt.fillStyle=Fe.bgHeader,Mt.fillRect(0,0,We.width,We.height),ss(Mt,0,0,He.width,He.height,dt[qe],!1,Fe,!1,void 0,void 0,!1,0,it,te,!1)):(Mt.font=Fe.baseFontFull,Mt.fillStyle=Fe.bgCell,Mt.fillRect(0,0,We.width,We.height),rs(Mt,w([qe,Ae]),0,Ae,!1,!1,0,0,He.width,He.height,!1,Fe,Fe.bgCell,Wt,it,1,void 0,!1,0,void 0,void 0,void 0,wo,Be,()=>{}))),We.style.left="-100%",We.style.position="absolute",We.style.width=`${He.width}px`,We.style.height=`${He.height}px`,document.body.append(We),S.dataTransfer.setDragImage(We,He.width/2,He.height/2),window.setTimeout(()=>{We.remove()},0)}}else S.preventDefault()},[Ge,V,Ue,Re,Tt,Fe,dt,it,te,w,Wt,wo,Be]);Kt("dragstart",yr,(Q==null?void 0:Q.current)??null,!1,!1);const Io=s.useRef(),ei=s.useCallback(S=>{const Y=Le.current;if(ue!==void 0&&S.preventDefault(),Y===null||Ee===void 0)return;const ce=Ue(Y,S.clientX,S.clientY),[de,j]=ce.location,Z=de-(be?0:1),[Se,Ve]=Io.current??[];(Se!==Z||Ve!==j)&&(Io.current=[Z,j],Ee([Z,j],S.dataTransfer))},[be,Ue,Ee,ue]);Kt("dragover",ei,(Q==null?void 0:Q.current)??null,!1,!1);const ti=s.useCallback(()=>{Io.current=void 0,pe==null||pe()},[pe]);Kt("dragend",ti,(Q==null?void 0:Q.current)??null,!1,!1);const Cn=s.useCallback(S=>{const Y=Le.current;if(Y===null||ue===void 0)return;S.preventDefault();const ce=Ue(Y,S.clientX,S.clientY),[de,j]=ce.location,Z=de-(be?0:1);ue([Z,j],S.dataTransfer)},[be,Ue,ue]);Kt("drop",Cn,(Q==null?void 0:Q.current)??null,!1,!1);const Yn=s.useCallback(()=>{Te==null||Te()},[Te]);Kt("dragleave",Yn,(Q==null?void 0:Q.current)??null,!1,!1);const Zt=s.useRef(z);Zt.current=z;const I=s.useRef(null),pt=s.useCallback(S=>{var Y;Le.current===null||!Le.current.contains(document.activeElement)||(S===null&&Zt.current.current!==void 0?(Y=ne==null?void 0:ne.current)==null||Y.focus({preventScroll:!0}):S!==null&&S.focus({preventScroll:!0}),I.current=S)},[ne]);s.useImperativeHandle(t,()=>({focus:()=>{var Y;const S=I.current;S===null||!document.contains(S)?(Y=ne==null?void 0:ne.current)==null||Y.focus({preventScroll:!0}):S.focus({preventScroll:!0})},getBounds:(S,Y)=>{if(!(ne===void 0||ne.current===null))return Tt(ne.current,S??0,Y??-1)},damage:gr,getMouseArgsForPosition:(S,Y,ce)=>{if(!(ne===void 0||ne.current===null))return Ue(ne.current,S,Y,ce)}}),[ne,gr,Tt,Ue]);const Tn=s.useRef(),ni=aa(()=>{var Ve,he,At;if(n<50||(me==null?void 0:me.disableAccessibilityTree)===!0)return null;let S=Ri(dt,rt,n,Me,Je);const Y=be?0:-1;!be&&((Ve=S[0])==null?void 0:Ve.sourceIndex)===0&&(S=S.slice(1));const[ce,de]=((he=z.current)==null?void 0:he.cell)??[],j=(At=z.current)==null?void 0:At.range,Z=S.map(we=>we.sourceIndex),Se=fo(l,Math.min(m,l+r));return ce!==void 0&&de!==void 0&&!(Z.includes(ce)&&Se.includes(de))&&pt(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":dt.length+Y},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},S.map(we=>s.createElement("th",{role:"columnheader","aria-selected":z.columns.hasIndex(we.sourceIndex),"aria-colindex":we.sourceIndex+1+Y,tabIndex:-1,onFocus:qe=>{if(qe.target!==I.current)return ve==null?void 0:ve([we.sourceIndex,-1])},key:we.sourceIndex},we.title)))),s.createElement("tbody",{role:"rowgroup"},Se.map(we=>s.createElement("tr",{role:"row","aria-selected":z.rows.hasIndex(we),key:we,"aria-rowindex":we+2},S.map(qe=>{const Ae=qe.sourceIndex,We=yn(Ae,we),He=ce===Ae&&de===we,je=j!==void 0&&Ae>=j.x&&Ae<j.x+j.width&&we>=j.y&&we<j.y+j.height,Mt=`glide-cell-${Ae}-${we}`,fn=[Ae,we],hn=w(fn,!0);return s.createElement("td",{key:We,role:"gridcell","aria-colindex":Ae+1+Y,"aria-selected":je,"aria-readonly":Oo(hn)||!$o(hn),id:Mt,"data-testid":Mt,onClick:()=>{const vt=ne==null?void 0:ne.current;if(vt!=null)return ee==null?void 0:ee({bounds:Tt(vt,Ae,we),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:fn})},onFocusCapture:vt=>{var Et,lt;if(!(vt.target===I.current||((Et=Tn.current)==null?void 0:Et[0])===Ae&&((lt=Tn.current)==null?void 0:lt[1])===we))return Tn.current=fn,ve==null?void 0:ve(fn)},ref:He?pt:void 0,tabIndex:-1},$c(hn,Be))})))))},[n,dt,rt,Me,Je,m,l,r,z,pt,w,ne,ee,Tt,ve],200),oo=L===0||!W?0:rt>L?1:sn(-Je/100,0,1),oi=-l*32+bt,Do=N?sn(-oi/100,0,1):0,Ni=s.useMemo(()=>{if(!oo&&!Do)return null;const S={position:"absolute",top:0,left:Ln,width:n-Ln,height:o,opacity:oo,pointerEvents:"none",transition:ot?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},Y={position:"absolute",top:nn,left:0,width:n,height:o,opacity:Do,pointerEvents:"none",transition:oe?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,oo>0&&s.createElement("div",{id:"shadow-x",style:S}),Do>0&&s.createElement("div",{id:"shadow-y",style:Y}))},[oo,Do,Ln,n,ot,nn,o,oe]),P=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Qr,onKeyUp:vn,onFocus:R,onBlur:X,ref:Vo,style:xo},ni),s.createElement("canvas",{ref:Ot,style:P}),Ni)},Nc=s.memo(s.forwardRef(Oc));function rr(e,t,n,o){return sn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Xc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,d]=s.useState(),[f,u]=s.useState(!1),[g,m]=s.useState(),[w,h]=s.useState(),[b,x]=s.useState(),[C,p]=s.useState(!1),[R,X]=s.useState(),{onHeaderMenuClick:B,onHeaderIndicatorClick:z,getCellContent:L,onColumnMoved:G,onColumnResize:M,onColumnResizeStart:W,onColumnResizeEnd:N,gridRef:A,maxColumnWidth:D,minColumnWidth:E,onRowMoved:ae,lockColumns:U,onColumnProposeMove:re,onMouseDown:Me,onMouseUp:be,onItemHovered:ee,onDragStart:_,canvasRef:ye,setScrollDir:ne}=e,Re=(M??N??W)!==void 0,{columns:pe,selection:Q}=e,V=Q.columns,fe=s.useCallback(te=>{const[ve,Ee]=te.location;i!==void 0&&l!==ve&&ve>=U?(u(!0),d(ve)):w!==void 0&&Ee!==void 0?(p(!0),x(Math.max(0,Ee)),ne(te.scrollEdge)):o===void 0&&!f&&!C&&(ee==null||ee(te))},[i,w,l,ee,U,o,f,C,ne]),Pe=G!==void 0,Ge=s.useCallback(te=>{var ve;if(te.button===0){const[Ee,ue]=te.location;if(te.kind==="out-of-bounds"&&te.isEdge&&Re){const Te=(ve=A==null?void 0:A.current)==null?void 0:ve.getBounds(pe.length-1,-1);Te!==void 0&&(n(Te.x),r(pe.length-1))}else if(te.kind==="header"&&Ee>=U){const Te=ye==null?void 0:ye.current;if(te.isEdge&&Re&&Te){n(te.bounds.x),r(Ee);const ot=Te.getBoundingClientRect().width/Te.offsetWidth,oe=te.bounds.width/ot;W==null||W(pe[Ee],oe,Ee,oe+(pe[Ee].growOffset??0))}else te.kind==="header"&&Pe&&(m(te.bounds.x),a(Ee))}else te.kind==="cell"&&U>0&&Ee===0&&ue!==void 0&&ae!==void 0&&(X(te.bounds.y),h(ue))}Me==null||Me(te)},[Me,Re,U,ae,A,pe,Pe,W,ye]),nt=s.useCallback((te,ve)=>{f||C||B==null||B(te,ve)},[f,C,B]),gt=s.useCallback((te,ve)=>{f||C||z==null||z(te,ve)},[f,C,z]),xe=s.useRef(-1),Ie=s.useCallback(()=>{xe.current=-1,h(void 0),x(void 0),X(void 0),p(!1),a(void 0),d(void 0),m(void 0),u(!1),r(void 0),n(void 0)},[]),Fe=s.useCallback((te,ve)=>{if(te.button===0){if(o!==void 0){if((V==null?void 0:V.hasIndex(o))===!0)for(const ue of V){if(ue===o)continue;const Te=pe[ue],De=rr(Te,xe.current,E,D);M==null||M(Te,De,ue,De+(Te.growOffset??0))}const Ee=rr(pe[o],xe.current,E,D);if(N==null||N(pe[o],Ee,o,Ee+(pe[o].growOffset??0)),V.hasIndex(o))for(const ue of V){if(ue===o)continue;const Te=pe[ue],De=rr(Te,xe.current,E,D);N==null||N(Te,De,ue,De+(Te.growOffset??0))}}Ie(),i!==void 0&&l!==void 0&&(re==null?void 0:re(i,l))!==!1&&(G==null||G(i,l)),w!==void 0&&b!==void 0&&(ae==null||ae(w,b))}be==null||be(te,ve)},[be,o,i,l,w,b,V,N,pe,E,D,M,G,ae,Ie,re]),mt=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(re==null?void 0:re(i,l))!==!1)return{src:i,dest:l}},[i,l,re]),wt=s.useCallback(te=>{const ve=ye==null?void 0:ye.current;if(i!==void 0&&g!==void 0)Math.abs(te.clientX-g)>20&&u(!0);else if(w!==void 0&&R!==void 0)Math.abs(te.clientY-R)>20&&p(!0);else if(o!==void 0&&t!==void 0&&ve){const ue=ve.getBoundingClientRect().width/ve.offsetWidth,Te=(te.clientX-t)/ue,De=pe[o],ot=rr(De,Te,E,D);if(M==null||M(De,ot,o,ot+(De.growOffset??0)),xe.current=Te,(V==null?void 0:V.first())===o)for(const oe of V){if(oe===o)continue;const me=pe[oe],Be=rr(me,xe.current,E,D);M==null||M(me,Be,oe,Be+(me.growOffset??0))}}},[i,g,w,R,o,t,pe,E,D,M,V,ye]),at=s.useCallback((te,ve)=>{if(w===void 0||b===void 0)return L(te,ve);let[Ee,ue]=te;return ue===b?ue=w:(ue>b&&(ue-=1),ue>=w&&(ue+=1)),L([Ee,ue],ve)},[w,b,L]),ke=s.useCallback(te=>{_==null||_(te),te.defaultPrevented()||Ie()},[Ie,_]);return s.createElement(Nc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:at,isResizing:o!==void 0,onHeaderMenuClick:nt,onHeaderIndicatorClick:gt,isDragging:f,onItemHovered:fe,onDragStart:ke,onMouseDown:Ge,allowResize:Re,onMouseUp:Fe,dragAndDropState:mt,onMouseMoveRaw:wt,ref:A})};function Yc(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:d,height:f}=l&&l.contentRect||{};o(u=>u.width===d&&u.height===f?u:{width:d,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Gc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const d=n.current;s.useEffect(()=>{const f=()=>{var m,w;if(r.current===!1&&d!==null){const h=[d.scrollLeft,d.scrollTop];if(((m=i.current)==null?void 0:m[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=m=>{m.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&d!==null){const m=d;return m.addEventListener("touchstart",u),m.addEventListener("touchend",g),()=>{m.removeEventListener("touchstart",u),m.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,d])},_c=()=>e=>e.isSafari?"scroll":"auto",Kc=tn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[_c()]}}),Uc=33554400,Vc=5e6;function qc(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Kt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Kt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const jc=e=>{var pe,Q;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:d=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:g,rightElementProps:m,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,x=[],C=(m==null?void 0:m.sticky)??!1,p=(m==null?void 0:m.fill)??!1,R=s.useRef(0),X=s.useRef(0),B=s.useRef(null),z=typeof window>"u"?1:window.devicePixelRatio,L=s.useRef(z);s.useEffect(()=>{if(L.current!==z){R.current=0,X.current=0,L.current=z;const V=B.current;V!==null&&ae.current(V.scrollLeft,V.scrollTop)}},[z]);const G=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),M=s.useRef(null),W=qc(200),[N,A]=s.useState(!0),D=s.useRef(0);s.useLayoutEffect(()=>{if(!N||W||G.current.lockDirection===void 0)return;const V=B.current;if(V===null)return;const[fe,Pe]=G.current.lockDirection;fe!==void 0?V.scrollLeft=fe:Pe!==void 0&&(V.scrollTop=Pe),G.current.lockDirection=void 0},[W,N]);const E=s.useCallback((V,fe)=>{var ve;const Pe=B.current;if(Pe===null)return;fe=fe??Pe.scrollTop,V=V??Pe.scrollLeft;const Ge=G.current.scrollTop,nt=G.current.scrollLeft,gt=V-nt,xe=fe-Ge;W&&gt!==0&&xe!==0&&(Math.abs(gt)>3||Math.abs(xe)>3)&&d&&G.current.lockDirection===void 0&&(G.current.lockDirection=Math.abs(gt)<Math.abs(xe)?[nt,void 0]:[void 0,Ge]);const Ie=G.current.lockDirection;V=(Ie==null?void 0:Ie[0])??V,fe=(Ie==null?void 0:Ie[1])??fe,G.current.scrollLeft=V,G.current.scrollTop=fe;const Fe=Pe.clientWidth,mt=Pe.clientHeight,wt=fe,at=X.current-wt,ke=Pe.scrollHeight-mt;X.current=wt;let te;if(ke>0&&o>Pe.scrollHeight+5)if(Math.abs(at)>2e3||wt===0||wt===ke){const Ee=Math.max(0,Math.min(1,wt/ke)),ue=o-mt;te=Ee*ue,R.current=te}else R.current-=at,te=R.current;else te=wt,R.current=te;te=Math.max(0,Math.min(te,o-mt)),R.current=te,Ie!==void 0&&(window.clearTimeout(D.current),A(!1),D.current=window.setTimeout(()=>A(!0),200)),i({x:V,y:te,width:Fe-u,height:mt-f,paddingRight:((ve=M.current)==null?void 0:ve.clientWidth)??0})},[f,u,o,i,d,W]);Gc(w&&Nr.value,E,B);const ae=s.useRef(E);ae.current=E;const U=s.useRef(),re=s.useRef(!1);s.useLayoutEffect(()=>{re.current?E():re.current=!0},[E,f,u]);const Me=s.useCallback(V=>{B.current=V,h!==void 0&&(h.current=V)},[h]);let be=0,ee=0;const _=Math.min(o,Uc);for(x.push(s.createElement("div",{key:be++,style:{width:r,height:0}}));ee<_;){const V=Math.min(Vc,_-ee);x.push(s.createElement("div",{key:be++,style:{width:0,height:V}})),ee+=V}const{ref:ye,width:ne,height:Re}=Yc(b);return typeof window<"u"&&(((pe=U.current)==null?void 0:pe.height)!==Re||((Q=U.current)==null?void 0:Q.width)!==ne)&&(window.setTimeout(()=>ae.current(),0),U.current={width:ne,height:Re}),(ne??0)===0||(Re??0)===0?s.createElement("div",{ref:ye}):s.createElement("div",{ref:ye},s.createElement(Kc,{isSafari:Nr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:Me,style:U.current,draggable:a,onDragStart:V=>{a||(V.stopPropagation(),V.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>E()},s.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),g!==void 0&&s.createElement(s.Fragment,null,!p&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:M,style:{height:Re,maxHeight:n-Math.ceil(z%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:p?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},g))))))},Zc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:d,nonGrowWidth:f,clientSize:u,className:g,onVisibleRegionChanged:m,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:x,overscrollX:C,overscrollY:p,initialSize:R,smoothScrollX:X=!1,smoothScrollY:B=!1,isDraggable:z}=e,{paddingRight:L,paddingBottom:G}=d??{},[M,W]=u,N=s.useRef(),A=s.useRef(),D=s.useRef(),E=s.useRef(),ae=f+Math.max(0,C??0);let U=a?r+i:r;if(typeof o=="number")U+=n*o;else for(let ee=0;ee<n;ee++)U+=o(ee);p!==void 0&&(U+=p);const re=s.useRef(),Me=s.useCallback(()=>{var nt,gt;if(re.current===void 0)return;const ee={...re.current};let _=0,ye=ee.x<0?-ee.x:0,ne=0,Re=0;ee.x=ee.x<0?0:ee.x;let pe=0;for(let xe=0;xe<l;xe++)pe+=t[xe].width;for(const xe of t){const Ie=_-pe;if(ee.x>=Ie+xe.width)_+=xe.width,Re++,ne++;else if(ee.x>Ie)_+=xe.width,X?ye+=Ie-ee.x:Re++,ne++;else if(ee.x+ee.width>Ie)_+=xe.width,ne++;else break}let Q=0,V=0,fe=0;if(typeof o=="number")B?(V=Math.floor(ee.y/o),Q=V*o-ee.y):V=Math.ceil(ee.y/o),fe=Math.ceil(ee.height/o)+V,Q<0&&fe++;else{let xe=0;for(let Ie=0;Ie<n;Ie++){const Fe=o(Ie),mt=xe+(B?0:Fe/2);if(ee.y>=xe+Fe)xe+=Fe,V++,fe++;else if(ee.y>mt)xe+=Fe,B?Q+=mt-ee.y:V++,fe++;else if(ee.y+ee.height>Fe/2+xe)xe+=Fe,fe++;else break}}V=Math.max(0,Math.min(V,n-1)),fe=Math.max(V,Math.min(fe,n));const Pe={x:Re,y:V,width:ne-Re,height:fe-V},Ge=N.current;(Ge===void 0||Ge.y!==Pe.y||Ge.x!==Pe.x||Ge.height!==Pe.height||Ge.width!==Pe.width||A.current!==ye||D.current!==Q||ee.width!==((nt=E.current)==null?void 0:nt[0])||ee.height!==((gt=E.current)==null?void 0:gt[1]))&&(m==null||m({x:Re,y:V,width:ne-Re,height:fe-V},ee.width,ee.height,ee.paddingRight??0,ye,Q),N.current=Pe,A.current=ye,D.current=Q,E.current=[ee.width,ee.height])},[t,o,n,m,l,X,B]),be=s.useCallback(ee=>{re.current=ee,Me()},[Me]);return s.useEffect(()=>{Me()},[Me]),s.createElement(jc,{scrollRef:w,className:g,kineticScrollPerfHack:d==null?void 0:d.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:z===!0||typeof z=="string",scrollWidth:ae+(L??0),scrollHeight:U+(G??0),clientHeight:W,rightElement:b,paddingBottom:G,paddingRight:L,rightElementProps:x,update:be,initialSize:R},s.createElement(Xc,{eventTargetRef:w,width:M,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator,setScrollDir:e.setScrollDir}))},Jc=tn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Qc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),ed=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),td=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),nd=10,od=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:d,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:g=!1,onSearchClose:m}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),x=a??h,C=s.useCallback(_=>{b(_),d==null||d(_)},[d]),[p,R]=s.useState(),X=s.useRef(p);X.current=p,s.useEffect(()=>{l!==void 0&&(l.length>0?R(_=>({rowsSearched:o,results:l.length,selectedIndex:(_==null?void 0:_.selectedIndex)??-1})):R(void 0))},[o,l]);const B=s.useRef();B.current===void 0&&(B.current=new AbortController);const z=s.useRef(),[L,G]=s.useState([]),M=l??L,W=s.useCallback(()=>{z.current!==void 0&&(window.cancelAnimationFrame(z.current),z.current=void 0),B.current!==void 0&&B.current.abort(),B.current=new AbortController},[]),N=s.useRef(n);N.current=n;const A=s.useCallback(_=>{const ye=new RegExp(_.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ne=N.current,Re=Math.min(10,o),pe=0;R(void 0),G([]);const Q=[],V=async()=>{var wt;if(f===void 0)return;const fe=performance.now(),Pe=o-pe;let Ge=f({x:0,y:ne,width:r.length,height:Math.min(Re,Pe,o-ne)},B.current.signal);typeof Ge=="function"&&(Ge=await Ge());let nt=!1;for(const[at,ke]of Ge.entries())for(const[te,ve]of ke.entries()){let Ee;switch(ve.kind){case J.Text:case J.Number:Ee=ve.displayData;break;case J.Uri:case J.Markdown:Ee=ve.data;break;case J.Boolean:Ee=typeof ve.data=="boolean"?ve.data.toString():void 0;break;case J.Image:case J.Bubble:Ee=ve.data.join("🐳");break;case J.Custom:Ee=ve.copyData;break}Ee!==void 0&&ye.test(Ee)&&(Q.push([te,at+ne]),nt=!0)}const gt=performance.now();nt&&G([...Q]),pe+=Ge.length,Qt(pe<=o);const xe=((wt=X.current)==null?void 0:wt.selectedIndex)??-1;R({results:Q.length,rowsSearched:pe,selectedIndex:xe}),u==null||u(Q,xe),ne+Re>=o?ne=0:ne+=Re;const Ie=gt-fe,Fe=Math.max(Ie,1),mt=nd/Fe;Re=Math.ceil(Re*mt),pe<o&&Q.length<1e3&&(z.current=window.requestAnimationFrame(V))};W(),z.current=window.requestAnimationFrame(V)},[W,r.length,f,u,o]),D=s.useCallback(()=>{var _;m==null||m(),R(void 0),G([]),u==null||u([],-1),W(),(_=t==null?void 0:t.current)==null||_.focus()},[W,t,m,u]),E=s.useCallback(_=>{C(_.target.value),l===void 0&&(_.target.value===""?(R(void 0),G([]),W()):A(_.target.value))},[A,W,C,l]);s.useEffect(()=>{i.current!==null&&(C(""),R(void 0),L.length>0&&(G([]),u==null||u([],-1)),g?i.current.focus({preventScroll:!0}):W())},[g,i]);const ae=s.useCallback(_=>{var ne;if((ne=_==null?void 0:_.stopPropagation)==null||ne.call(_),p===void 0||p.results===0)return;const ye=(p.selectedIndex+1)%p.results;R({...p,selectedIndex:ye}),u==null||u(M,ye)},[p,u,M]),U=s.useCallback(_=>{var ne;if((ne=_==null?void 0:_.stopPropagation)==null||ne.call(_),p===void 0||p.results===0)return;let ye=(p.selectedIndex-1)%p.results;ye<0&&(ye+=p.results),R({...p,selectedIndex:ye}),u==null||u(M,ye)},[u,M,p]),re=s.useCallback(_=>{(_.ctrlKey||_.metaKey)&&_.nativeEvent.code==="KeyF"||_.key==="Escape"?(D(),_.stopPropagation(),_.preventDefault()):_.key==="Enter"&&(_.shiftKey?U():ae())},[D,ae,U]);s.useEffect(()=>()=>{W()},[W]);const[Me,be]=s.useState(!1);s.useEffect(()=>{if(g)be(!0);else{const _=setTimeout(()=>be(!1),150);return()=>clearTimeout(_)}},[g]);const ee=s.useMemo(()=>{if(!g&&!Me)return null;let _;p!==void 0&&(_=p.results>=1e3?"over 1000":`${p.results} result${p.results!==1?"s":""}`,p.selectedIndex>=0&&(_=`${p.selectedIndex+1} of ${_}`));const ye=pe=>{pe.stopPropagation()},Re={width:`${o>0?Math.floor(((p==null?void 0:p.rowsSearched)??0)/o*100):0}%`};return s.createElement(Jc,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:ye,onMouseMove:ye,onMouseUp:ye,onClick:ye},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:E,value:x,tabIndex:g?void 0:-1,onKeyDownCapture:re}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:U,disabled:((p==null?void 0:p.results)??0)===0},Qc),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:ae,disabled:((p==null?void 0:p.results)??0)===0},ed),m!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:D},td)),p!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},_)),s.createElement("div",{className:"gdg-search-progress",style:Re})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[g,Me,p,o,w,i,E,x,re,U,ae,m,D]);return s.createElement(s.Fragment,null,s.createElement(Zc,{prelightCells:M,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator,setScrollDir:e.setScrollDir}),ee)};class rd extends s.PureComponent{constructor(){super(...arguments);Ne(this,"wrapperRef",s.createRef());Ne(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const id=()=>e=>Math.max(16,e.targetHeight-10),ld=tn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[id(),"px"]}}),sd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=kt.useState(n);return kt.createElement(rd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},kt.createElement(ld,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:d=>d.target.setSelectionRange(0,a.length),onChange:d=>l(d.target.value),onKeyDown:d=>{d.key==="Enter"?i(a):d.key==="Escape"&&o()},autoFocus:!0}))};function ad(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Xe(e,t,n){const o=ds(e,t);return o&&(n.didMatch=!0),o}function ds(e,t){if(e.length===0)return!1;if(e.includes("|")){const d=e.split("|");for(const f of d)if(ds(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!ad(l,t))return!1;if(a[0]==="any")return!0;for(const d of a)switch(d){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Xr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function cd(e,t,n,o,r,i,a){const l=kt.useCallback((u,g,m,w)=>{var R;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(m||w==="drag")||n==="additive",b=(o==="mixed"||o==="additive")&&h,x=(r==="mixed"||r==="additive")&&h;let C={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((R=e.current)==null?void 0:R.rangeStack)??[]:[]},columns:b?e.columns:st.empty(),rows:x?e.rows:st.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,g)},[o,e,n,i,a,r,t]),d=kt.useCallback((u,g,m)=>{u=u??e.rows,g!==void 0&&(u=u.add(g));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:st.empty(),rows:u};else{const h=m&&n==="mixed"||n==="additive",b=m&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:b?e.columns:st.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=kt.useCallback((u,g,m)=>{u=u??e.columns,g!==void 0&&(u=u.add(g));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:st.empty(),columns:u};else{const h=m&&n==="mixed"||n==="additive",b=m&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:b?e.rows:st.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,d,f]}function dd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let g=f.y;g<f.y+f.height;g++){const m=[];for(let w=f.x;w<f.x+f.width;w++)w<0||g>=r?m.push({kind:J.Loading,allowOverlay:!1}):m.push(t([w,g]));u.push(m)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const g=a(u,o.signal);return typeof g=="function"?async()=>(await g()).map(m=>[{kind:J.Loading,allowOverlay:!1},...m]):g.map(m=>[{kind:J.Loading,allowOverlay:!1},...m])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function ud(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case J.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Hi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case J.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case J.Image:case J.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case J.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case J.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case J.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case J.Markdown:case J.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case J.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case J.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case J.Protected:return{formatted:"************",rawValue:"",format:"string"};default:ar()}}function fd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:ud(a))})}function xl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function hd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>xl(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:xl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ci(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function kl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function gd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function md(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ci(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${kl(r.rawValue[l])}>`+Ci(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${kl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ci(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function wd(e,t){const n=fd(e,t),o=hd(n),r=md(n);return{textPlain:o,textHtml:r}}function Sl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const d=l.cloneNode(!0),u=d.children.length===1&&d.children[0].nodeName==="P"?d.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=d.querySelectorAll("br");for(const b of m)b.replaceWith(`
`);const w=d.getAttribute("gdg-raw-value"),h=d.getAttribute("gdg-format")??"string";if(d.querySelector("a")!==null)i==null||i.push({rawValue:((a=d.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:d.textContent??"",format:h});else if(d.querySelector("ol")!==null){const b=d.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...b].map(x=>x.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:gd(w),formatted:d.textContent??"",format:h});else{let b=d.textContent??"";g&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function bd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const d=(l=e.current)==null?void 0:l.range,f=[];if(d.width>2){const m=t({x:d.x,y:d.y,width:1,height:d.height},r.signal);if(typeof m=="function")return i;f.push(...m);const w=t({x:d.x+d.width-1,y:d.y,width:1,height:d.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const m=t({x:d.x,y:d.y,width:d.width,height:d.height},r.signal);if(typeof m=="function")return i;f.push(...m)}let u=d.x-n,g=d.x+d.width-1-n;for(const m of f)for(const w of m)w.span!==void 0&&(u=Math.min(w.span[0],u),g=Math.max(w.span[1],g));u===d.x-n&&g===d.x+d.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:d.y,width:g-u+1,height:d.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Ml(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function yd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Ml(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Ml(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(d=>({rawValue:d,formatted:d,format:"string"})))}function Rl(e,t,n){var l;const o=wd(e,t),r=d=>{var f;(f=window.navigator.clipboard)==null||f.writeText(d)},i=(d,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([d],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(d,f)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",d),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",f)}catch{i(d,f)||r(d)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function us(e){return e!==!0}function El(e){return typeof e=="string"?e:`${e}px`}const pd=()=>e=>e.innerWidth,vd=()=>e=>e.innerHeight,Cd=tn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[pd()],"wmyidgi-1":[vd()]}}),xd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Cd,{innerHeight:El(n),innerWidth:El(t),...r},o)},kd=2,Sd=1300;function Md(e,t,n){const o=kt.useRef(0),[r,i]=e??[0,0];kt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const d=f=>{var u;if(!a){if(l===0)l=f;else{const g=f-l;o.current=Math.min(1,o.current+g/Sd);const m=o.current**1.618*g*kd;(u=t.current)==null||u.scrollBy(r*m,i*m),l=f,n==null||n()}window.requestAnimationFrame(d)}};return window.requestAnimationFrame(d),()=>{a=!0}},[t,r,i,n])}function Rd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[d,f,u,g,m,w]=kt.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,x=jl();return[typeof b=="number"?b*h:C=>Math.ceil(b(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,a,o]);return{rowHeight:d,headerHeight:f,groupHeaderHeight:u,theme:g,overscrollX:m,overscrollY:w}}const qn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Ye(e,t){return e===!0?t:e===!1?"":e}function Il(e){const t=Xr.value;return{activateCell:Ye(e.activateCell," |Enter|shift+Enter"),clear:Ye(e.clear,"any+Escape"),closeOverlay:Ye(e.closeOverlay,"any+Escape"),acceptOverlayDown:Ye(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Ye(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Ye(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Ye(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Ye(e.delete,t?"Backspace|Delete":"Delete"),downFill:Ye(e.downFill,"primary+_68"),scrollToSelectedCell:Ye(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Ye(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Ye(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Ye(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Ye(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Ye(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Ye(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Ye(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Ye(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Ye(e.goToFirstCell,"primary+Home"),goToFirstColumn:Ye(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Ye(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Ye(e.goToLastCell,"primary+End"),goToLastColumn:Ye(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Ye(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Ye(e.goToNextPage,"PageDown"),goToPreviousPage:Ye(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Ye(e.rightFill,"primary+_82"),search:Ye(e.search,"primary+f"),selectAll:Ye(e.selectAll,"primary+a"),selectColumn:Ye(e.selectColumn,"ctrl+ "),selectGrowDown:Ye(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Ye(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Ye(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Ye(e.selectGrowUp,"shift+ArrowUp"),selectRow:Ye(e.selectRow,"shift+ "),selectToFirstCell:Ye(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Ye(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Ye(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Ye(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Ye(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Ye(e.selectToLastRow,"primary+shift+ArrowDown")}}function Ed(e){const t=ha(e);return kt.useMemo(()=>{if(t===void 0)return Il(qn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??qn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??qn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??qn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??qn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??qn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??qn.selectToLastCell};return Il({...qn,...n})},[t])}function Id(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,d)=>t(l,r+1,[...i,d])).sort((l,d)=>l.headerIndex-d.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Oi(e,t){const n=[];function o(l,d,f=!1){let u=d!==null?d-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let g=0;g<l.subGroups.length;g++){const m=g<l.subGroups.length-1?l.subGroups[g+1].headerIndex:d;o(l.subGroups[g],m,f||l.isCollapsed)}}const r=Id(e.groups);for(let l=0;l<r.length;l++){const d=l<r.length-1?r[l+1].headerIndex:null;o(r[l],d)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:d,...f}=l;return f})}function Fi(e,t){if(t===void 0||Oi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Dd(e,t,n,o){const r=kt.useMemo(()=>e===void 0?void 0:Oi(e,t),[e,t]),i=kt.useMemo(()=>r==null?void 0:r.reduce((u,g)=>(u[g.rowIndex]=g,u),{}),[r]),a=kt.useMemo(()=>r===void 0?t:r.reduce((u,g)=>u+(g.isCollapsed?1:g.rows+1),0),[r,t]),l=kt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),d=kt.useCallback(u=>{if(r===void 0)return u;let g=u;for(const m of r){if(g===0)return;if(g--,!m.isCollapsed){if(g<m.rows)return m.contentIndex+g;g-=m.rows}}return u},[r]),f=jn(o??(e==null?void 0:e.themeOverride),kt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:m,groupIndex:w}=Fi(u,r);return g?e.themeOverride:o==null?void 0:o(u,w,m)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:d,getRowThemeOverride:f}:{rowHeight:l,rows:a,rowNumberMapper:d,getRowThemeOverride:f}}function Fd(e,t){const n=kt.useMemo(()=>e===void 0?void 0:Oi(e,t),[e,t]);return{getRowGroupingForPath:hs,updateRowGroupingByPath:fs,mapper:kt.useCallback(o=>{if(typeof o=="number")return Fi(o,n);const r=Fi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function fs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:fs(i.subGroups??[],r,n)}:i)}function hs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:hs(e[n].subGroups??[],o)}function Hd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Td(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[d,f,u]=fa(l),g=s.useRef(r);g.current=r;const m=Hd(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(d.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&m.current!==null&&w){if(m.current.scrollTop===t)return;m.current.scrollTop=t,m.current.scrollTop!==t&&u(),g.current()}},[t,w,u,m]);const h=(d.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&m.current!==null&&h){if(m.current.scrollLeft===e)return;m.current.scrollLeft=e,m.current.scrollLeft!==e&&u(),g.current()}},[e,h,u,m]),{visibleRegion:d,setVisibleRegion:f,scrollRef:m}}const Ad=s.lazy(async()=>await Tl(()=>import("./data-grid-overlay-editor-DoxmvVeT.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let zd=0;function Pd(e){return ta(rl(rl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return fo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function zr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Pr={kind:J.Loading,allowOverlay:!1},Br={columns:st.empty(),rows:st.empty(),current:void 0},Bd=(e,t)=>{var tl,nl,ol;const[n,o]=s.useState(Br),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[d,f]=s.useState(),u=s.useRef(),g=typeof window>"u"?null:window,{imageEditorOverride:m,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:x,columns:C,rows:p,getCellContent:R,onCellClicked:X,onCellActivated:B,onFillPattern:z,onFinishedEditing:L,coercePasteValue:G,drawHeader:M,drawCell:W,editorBloom:N,onHeaderClicked:A,onColumnProposeMove:D,rangeSelectionColumnSpanning:E=!0,spanRangeBehavior:ae="default",onGroupHeaderClicked:U,onCellContextMenu:re,className:Me,onHeaderContextMenu:be,getCellsForSelection:ee,onGroupHeaderContextMenu:_,onGroupHeaderRenamed:ye,onCellEdited:ne,onCellsEdited:Re,onSearchResultsChanged:pe,searchResults:Q,onSearchValueChange:V,searchValue:fe,onKeyDown:Pe,onKeyUp:Ge,keybindings:nt,editOnType:gt=!0,onRowAppended:xe,onColumnAppended:Ie,onColumnMoved:Fe,validateCell:mt,highlightRegions:wt,rangeSelect:at="rect",columnSelect:ke="multi",rowSelect:te="multi",rangeSelectionBlending:ve="exclusive",columnSelectionBlending:Ee="exclusive",rowSelectionBlending:ue="exclusive",onDelete:Te,onDragStart:De,onMouseMove:ot,onPaste:oe,copyHeaders:me=!1,freezeColumns:Be=0,cellActivationBehavior:_e="second-click",rowSelectionMode:Je="auto",columnSelectionMode:bt="auto",onHeaderMenuClick:rt,onHeaderIndicatorClick:Le,getGroupDetails:St,rowGrouping:Ft,onSearchClose:Wt,onItemHovered:xt,onSelectionCleared:It,showSearch:Bt,onVisibleRegionChanged:cn,gridSelection:Ut,onGridSelectionChange:ct,minColumnWidth:Mn=50,maxColumnWidth:dn=500,maxColumnAutoWidth:yt,provideEditor:Ot,trailingRowOptions:Ke,freezeTrailingRows:Ht=0,allowedFillDirections:jt="orthogonal",scrollOffsetX:Qe,scrollOffsetY:Dt,verticalBorder:it,onDragOverCell:nn,onDrop:Yt,onColumnResize:Vt,onColumnResizeEnd:Rn,onColumnResizeStart:dt,customRenderers:Ln,fillHandle:Tt,experimental:Ue,fixedShadowX:En,fixedShadowY:fr,headerIcons:Wn,imageWindowLoader:In,initialSize:Dn,isDraggable:wo,onDragLeave:hr,onRowMoved:$n,overscrollX:bo,overscrollY:yo,preventDiagonalScrolling:po,rightElement:vo,rightElementProps:eo,trapFocus:Fn=!1,smoothScrollX:Kr,smoothScrollY:gr,scaleToRem:Ur=!1,rowHeight:Vr=34,headerHeight:pn=36,groupHeaderHeight:On=pn,theme:qr,isOutsideClick:jr,renderers:Co,resizeIndicator:mr,scrollToActiveCell:to=!0,drawFocusRing:Zr=!0,portalElementRef:wr}=e,xo=Zr==="no-editor"?r===void 0:Zr,ft=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Gt=(ft==null?void 0:ft.kind)??e.rowMarkers??"none",ko=(ft==null?void 0:ft.width)??e.rowMarkerWidth,Hn=(ft==null?void 0:ft.startIndex)??e.rowMarkerStartIndex??1,So=(ft==null?void 0:ft.theme)??e.rowMarkerTheme,Nn=ft==null?void 0:ft.headerTheme,Mo=ft==null?void 0:ft.headerAlwaysVisible,Ro=te!=="multi"||(ft==null?void 0:ft.headerDisabled)===!0,no=(ft==null?void 0:ft.checkboxStyle)??"square",Xn=Math.max(Mn,20),Eo=Math.max(dn,Xn),Jr=Math.max(yt??Eo,Xn),Ko=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Ce,rowNumberMapper:Uo,rowHeight:br,getRowThemeOverride:un}=Dd(Ft,p,Vr,w),Qr=s.useMemo(()=>Number.parseFloat(Ko.fontSize),[Ko]),{rowHeight:vn,headerHeight:Vo,groupHeaderHeight:yr,theme:Io,overscrollX:ei,overscrollY:ti}=Rd({groupHeaderHeight:On,headerHeight:pn,overscrollX:bo,overscrollY:yo,remSize:Qr,rowHeight:br,scaleToRem:Ur,theme:qr}),Cn=Ed(nt),Yn=ko??(p>1e4?48:p>1e3?44:p>100?36:32),Zt=Gt!=="none",I=Zt?1:0,pt=Ke!==void 0,Tn=(Ke==null?void 0:Ke.sticky)===!0,[ni,oo]=s.useState(!1),oi=Bt??ni,Do=s.useCallback(()=>{Wt!==void 0?Wt():oo(!1)},[Wt]),P=s.useMemo(()=>Ut===void 0?void 0:zr(Ut,I),[Ut,I])??n,S=s.useRef();S.current===void 0&&(S.current=new AbortController),s.useEffect(()=>()=>S==null?void 0:S.current.abort(),[]);const[Y,ce]=dd(ee,R,I,S.current,Ce),de=s.useCallback((c,y,v)=>{if(mt===void 0)return!0;const k=[c[0]-I,c[1]];return mt==null?void 0:mt(k,y,v)},[I,mt]),j=s.useRef(Ut),Z=s.useCallback((c,y)=>{y&&(c=bd(c,Y,I,ae,S.current)),ct!==void 0?(j.current=zr(c,-I),ct(j.current)):o(c)},[ct,Y,I,ae]),Se=jn(Vt,s.useCallback((c,y,v,k)=>{Vt==null||Vt(C[v-I],y,v-I,k)},[Vt,I,C])),Ve=jn(Rn,s.useCallback((c,y,v,k)=>{Rn==null||Rn(C[v-I],y,v-I,k)},[Rn,I,C])),he=jn(dt,s.useCallback((c,y,v,k)=>{dt==null||dt(C[v-I],y,v-I,k)},[dt,I,C])),At=jn(M,s.useCallback((c,y)=>(M==null?void 0:M({...c,columnIndex:c.columnIndex-I},y))??!1,[M,I])),we=jn(W,s.useCallback((c,y)=>(W==null?void 0:W({...c,col:c.col-I},y))??!1,[W,I])),qe=s.useCallback(c=>{if(Te!==void 0){const y=Te(zr(c,-I));return typeof y=="boolean"?y:zr(y,I)}return!0},[Te,I]),[Ae,We,He]=cd(P,Z,ve,Ee,ue,at,E),je=s.useMemo(()=>Bn(jl(),Io),[Io]),[Mt,fn]=s.useState([0,0,0]),hn=s.useMemo(()=>{if(Co===void 0)return{};const c={};for(const y of Co)c[y.kind]=y;return c},[Co]),vt=s.useCallback(c=>c.kind!==J.Custom?hn[c.kind]:Ln==null?void 0:Ln.find(y=>y.isMatch(c)),[Ln,hn]);let{sizedColumns:Et,nonGrowWidth:lt}=Wa(C,Ce,ce,Mt[0]-(I===0?0:Yn)-Mt[2],Xn,Jr,je,vt,S.current);Gt!=="none"&&(lt+=Yn);const on=s.useMemo(()=>Et.some(c=>c.group!==void 0),[Et]),Nt=on?Vo+yr:Vo,Fo=P.rows.length,An=Gt==="none"?void 0:Fo===0?!1:Fo===Ce?!0:void 0,Oe=s.useMemo(()=>Gt==="none"?Et:[{title:"",width:Yn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:So,rowMarker:no,rowMarkerChecked:An,headerRowMarkerTheme:Nn,headerRowMarkerAlwaysVisible:Mo,headerRowMarkerDisabled:Ro},...Et],[Gt,Et,Yn,So,no,An,Nn,Mo,Ro]),zt=s.useRef({height:1,width:1,x:0,y:0}),ro=s.useRef(!1),{setVisibleRegion:Gn,visibleRegion:zn,scrollRef:ut}=Td(Qe,Dt,vn,zt,()=>ro.current=!0);zt.current=zn;const ws=zn.x+I,pr=zn.y,Lt=s.useRef(null),_t=s.useCallback(c=>{var y;c===!0?(y=Lt.current)==null||y.focus():window.requestAnimationFrame(()=>{var v;(v=Lt.current)==null||v.focus()})},[]),Xt=pt?Ce+1:Ce,rn=s.useCallback(c=>{const y=I===0?c:c.map(k=>({...k,location:[k.location[0]-I,k.location[1]]})),v=Re==null?void 0:Re(y);if(v!==!0)for(const k of y)ne==null||ne(k.location,k.value);return v},[ne,Re,I]),[io,ri]=s.useState(),vr=P.current!==void 0&&P.current.range.width*P.current.range.height>1?P.current.range:void 0,Ho=xo?(tl=P.current)==null?void 0:tl.cell:void 0,Cr=Ho==null?void 0:Ho[0],xr=Ho==null?void 0:Ho[1],bs=s.useMemo(()=>{if((wt===void 0||wt.length===0)&&(vr??Cr??xr??io)===void 0)return;const c=[];if(wt!==void 0)for(const y of wt){const v=Oe.length-y.range.x-I;v>0&&c.push({color:y.color,range:{...y.range,x:y.range.x+I,width:Math.min(v,y.range.width)},style:y.style})}return io!==void 0&&c.push({color:go(je.accentColor,0),range:io,style:"dashed"}),vr!==void 0&&c.push({color:go(je.accentColor,.5),range:vr,style:"solid-outline"}),Cr!==void 0&&xr!==void 0&&c.push({color:je.accentColor,range:{x:Cr,y:xr,width:1,height:1},style:"solid-outline"}),c.length>0?c:void 0},[io,vr,Cr,xr,wt,Oe.length,je.accentColor,I]),Xi=s.useRef(Oe);Xi.current=Oe;const Jt=s.useCallback(([c,y],v=!1)=>{var $,F,T,O,q,le,ie;const k=pt&&y===Xt-1;if(c===0&&Zt){if(k)return Pr;const K=Uo(y);return K===void 0?Pr:{kind:an.Marker,allowOverlay:!1,checkboxStyle:no,checked:(P==null?void 0:P.rows.hasIndex(y))===!0,markerKind:Gt==="clickable-number"?"number":Gt,row:Hn+K,drawHandle:$n!==void 0,cursor:Gt==="clickable-number"?"pointer":void 0}}else if(k){const ge=c===I?(Ke==null?void 0:Ke.hint)??"":"",se=Xi.current[c];if((($=se==null?void 0:se.trailingRowOptions)==null?void 0:$.disabled)===!0)return Pr;{const ze=((F=se==null?void 0:se.trailingRowOptions)==null?void 0:F.hint)??ge,et=((T=se==null?void 0:se.trailingRowOptions)==null?void 0:T.addIcon)??(Ke==null?void 0:Ke.addIcon);return{kind:an.NewRow,hint:ze,allowOverlay:!1,icon:et}}}else{const K=c-I;if(v||(Ue==null?void 0:Ue.strict)===!0){const se=zt.current,ze=se.x>K||K>se.x+se.width||se.y>y||y>se.y+se.height||y>=ai.current,et=K===((q=(O=se.extras)==null?void 0:O.selected)==null?void 0:q[0])&&y===((le=se.extras)==null?void 0:le.selected[1]);let $e=!1;if(((ie=se.extras)==null?void 0:ie.freezeRegions)!==void 0){for(const tt of se.extras.freezeRegions)if(ho(tt,K,y)){$e=!0;break}}if(ze&&!et&&!$e)return Pr}let ge=R([K,y]);return I!==0&&ge.span!==void 0&&(ge={...ge,span:[ge.span[0]+I,ge.span[1]+I]}),ge}},[pt,Xt,Zt,Uo,no,P==null?void 0:P.rows,Gt,Hn,$n,I,Ke==null?void 0:Ke.hint,Ke==null?void 0:Ke.addIcon,Ue==null?void 0:Ue.strict,R]),ii=s.useCallback(c=>{let y=(St==null?void 0:St(c))??{name:c};return ye!==void 0&&c!==""&&(y={icon:y.icon,name:y.name,overrideTheme:y.overrideTheme,actions:[...y.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>di({group:y.name,bounds:v.bounds})}]}),y},[St,ye]),kr=s.useCallback(c=>{var T;const[y,v]=c.cell,k=Oe[y],H=(k==null?void 0:k.group)!==void 0?(T=ii(k.group))==null?void 0:T.overrideTheme:void 0,$=k==null?void 0:k.themeOverride,F=un==null?void 0:un(v);i({...c,theme:Bn(je,H,$,F,c.content.themeOverride)})},[un,Oe,ii,je]),To=s.useCallback((c,y,v)=>{var F;if(P.current===void 0)return;const[k,H]=P.current.cell,$=Jt([k,H]);if($.kind!==J.Boolean&&$.allowOverlay){let T=$;if(v!==void 0)switch(T.kind){case J.Number:{const O=oa(()=>v==="-"?-0:Number.parseFloat(v),0);T={...T,data:Number.isNaN(O)?0:O};break}case J.Text:case J.Markdown:case J.Uri:T={...T,data:v};break}kr({target:c,content:T,initialValue:v,cell:[k,H],highlight:v===void 0,forceEditMode:v!==void 0,activation:y})}else $.kind===J.Boolean&&y.inputType==="keyboard"&&$.readonly!==!0&&(rn([{location:P.current.cell,value:{...$,data:us($.data)}}]),(F=Lt.current)==null||F.damage([{cell:P.current.cell}]))},[Jt,P,rn,kr]),Yi=s.useCallback((c,y)=>{var H;const v=(H=Lt.current)==null?void 0:H.getBounds(c,y);if(v===void 0||ut.current===null)return;const k=Jt([c,y]);k.allowOverlay&&kr({target:v,content:k,initialValue:void 0,highlight:!0,cell:[c,y],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Jt,ut,kr]),Rt=s.useCallback((c,y,v="both",k=0,H=0,$=void 0)=>{if(ut.current!==null){const F=Lt.current,T=l.current,O=typeof c!="number"?c.unit==="cell"?c.amount:void 0:c,q=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,le=typeof c!="number"&&c.unit==="px"?c.amount:void 0,ie=typeof y!="number"&&y.unit==="px"?y.amount:void 0;if(F!==null&&T!==null){let K={x:0,y:0,width:0,height:0},ge=0,se=0;if((O!==void 0||q!==void 0)&&(K=F.getBounds((O??0)+I,q??0)??K,K.width===0||K.height===0))return;const ze=T.getBoundingClientRect(),et=ze.width/T.offsetWidth;if(le!==void 0&&(K={...K,x:le-ze.left-ut.current.scrollLeft,width:1}),ie!==void 0&&(K={...K,y:ie+ze.top-ut.current.scrollTop,height:1}),K!==void 0){const $e={x:K.x-k,y:K.y-H,width:K.width+2*k,height:K.height+2*H};let tt=0;for(let wi=0;wi<Be;wi++)tt+=Et[wi].width;let Ze=0;const ht=Ht+(Tn?1:0);ht>0&&(Ze=mo(Xt,ht,vn));let Pt=tt*et+ze.left+I*Yn*et,$t=ze.right,wn=ze.top+Nt*et,Pn=ze.bottom-Ze*et;const Lo=K.width+k*2;switch($==null?void 0:$.hAlign){case"start":$t=Pt+Lo;break;case"end":Pt=$t-Lo;break;case"center":Pt=Math.floor((Pt+$t)/2)-Lo/2,$t=Pt+Lo;break}const co=K.height+H*2;switch($==null?void 0:$.vAlign){case"start":Pn=wn+co;break;case"end":wn=Pn-co;break;case"center":wn=Math.floor((wn+Pn)/2)-co/2,Pn=wn+co;break}Pt>$e.x?ge=$e.x-Pt:$t<$e.x+$e.width&&(ge=$e.x+$e.width-$t),wn>$e.y?se=$e.y-wn:Pn<$e.y+$e.height&&(se=$e.y+$e.height-Pn),v==="vertical"||typeof c=="number"&&c<Be?ge=0:(v==="horizontal"||typeof y=="number"&&y>=Xt-ht)&&(se=0),(ge!==0||se!==0)&&(et!==1&&(ge/=et,se/=et),ut.current.scrollTo({left:ge+ut.current.scrollLeft,top:se+ut.current.scrollTop,behavior:($==null?void 0:$.behavior)??"auto"}))}}}},[I,Ht,Yn,ut,Nt,Be,Et,Xt,Tn,vn]),li=s.useRef(Yi),si=s.useRef(R);li.current=Yi,si.current=R;const ai=s.useRef(Ce);ai.current=Ce;const Gi=s.useRef(Oe.length);Gi.current=Oe.length;const _n=s.useCallback(async(c,y=!0,v)=>{var q;const k=Oe[c];if(((q=k==null?void 0:k.trailingRowOptions)==null?void 0:q.disabled)===!0)return;const H=xe==null?void 0:xe();let $,F=!0;H!==void 0&&($=await H,$==="top"&&(F=!1),typeof $=="number"&&(F=!1));let T=0;const O=()=>{if(ai.current<=Ce){T<500&&window.setTimeout(O,T),T=50+T*2;return}const le=typeof $=="number"?$:F?Ce:0;Fr.current(c-I,le,"both",0,0,v?{behavior:v}:void 0),Ae({cell:[c,le],range:{x:c,y:le,width:1,height:1}},!1,!1,"edit");const ie=si.current([c-I,le]);ie.allowOverlay&&$o(ie)&&ie.readonly!==!0&&y&&window.setTimeout(()=>{li.current(c,le)},0)};O()},[Oe,xe,I,Ce,Ae]),Sr=s.useCallback(async(c,y=!0)=>{const v=Ie==null?void 0:Ie();let k,H=!0;v!==void 0&&(k=await v,k==="left"&&(H=!1),typeof k=="number"&&(H=!1));let $=0;const F=()=>{if(Gi.current<=Oe.length){$<500&&window.setTimeout(F,$),$=50+$*2;return}const T=typeof k=="number"?k:H?Oe.length:0;Rt(T-I,c),Ae({cell:[T,c],range:{x:T,y:c,width:1,height:1}},!1,!1,"edit");const O=si.current([T-I,c]);O.allowOverlay&&$o(O)&&O.readonly!==!0&&y&&window.setTimeout(()=>{li.current(T,c)},0)};F()},[Oe,Ie,I,Rt,Ae]),Ao=s.useCallback(c=>{var v,k;const y=((k=(v=Et[c])==null?void 0:v.trailingRowOptions)==null?void 0:k.targetColumn)??(Ke==null?void 0:Ke.targetColumn);if(typeof y=="number")return y+(Zt?1:0);if(typeof y=="object"){const H=C.indexOf(y);if(H>=0)return H+(Zt?1:0)}},[Et,C,Zt,Ke==null?void 0:Ke.targetColumn]),Kn=s.useRef(),zo=s.useRef(),qo=s.useCallback((c,y)=>{var H;const[v,k]=y;return Bn(je,(H=Oe[v])==null?void 0:H.themeOverride,un==null?void 0:un(k),c.themeOverride)},[un,Oe,je]),{mapper:lo}=Fd(Ft,p),gn=Ft==null?void 0:Ft.navigationBehavior,jo=s.useCallback(c=>{var q,le,ie;const y=Xr.value?c.metaKey:c.ctrlKey,v=y&&te==="multi",[k,H]=c.location,$=P.columns,F=P.rows,[T,O]=((q=P.current)==null?void 0:q.cell)??[];if(c.kind==="cell"){if(zo.current=void 0,so.current=[k,H],k===0&&Zt){if(pt===!0&&H===Ce||Gt==="number"||te==="none")return;const K=Jt(c.location);if(K.kind!==an.Marker)return;if($n!==void 0){const ze=vt(K);Qt((ze==null?void 0:ze.kind)===an.Marker);const et=(le=ze==null?void 0:ze.onClick)==null?void 0:le.call(ze,{...c,cell:K,posX:c.localEventX,posY:c.localEventY,bounds:c.bounds,theme:qo(K,c.location),preventDefault:()=>{}});if(et===void 0||et.checked===K.checked)return}i(void 0),_t();const ge=F.hasIndex(H),se=Kn.current;if(te==="multi"&&(c.shiftKey||c.isLongTouch===!0)&&se!==void 0&&F.hasIndex(se)){const ze=[Math.min(se,H),Math.max(se,H)+1];v||Je==="multi"?We(void 0,ze,!0):We(st.fromSingleSelection(ze),void 0,v)}else te==="multi"&&(v||c.isTouch||Je==="multi")?ge?We(F.remove(H),void 0,!0):(We(void 0,H,!0),Kn.current=H):ge&&F.length===1?We(st.empty(),void 0,y):(We(st.fromSingleSelection(H),void 0,y),Kn.current=H)}else if(k>=I&&pt&&H===Ce){const K=Ao(k);_n(K??k)}else if(T!==k||O!==H){const K=Jt(c.location),ge=vt(K);if((ge==null?void 0:ge.onSelect)!==void 0){let et=!1;if(ge.onSelect({...c,cell:K,posX:c.localEventX,posY:c.localEventY,bounds:c.bounds,preventDefault:()=>et=!0,theme:qo(K,c.location)}),et)return}if(gn==="block"&&lo(H).isGroupHeader)return;const se=Tn&&H===Ce,ze=Tn&&P!==void 0&&((ie=P.current)==null?void 0:ie.cell[1])===Ce;if((c.shiftKey||c.isLongTouch===!0)&&T!==void 0&&O!==void 0&&P.current!==void 0&&!ze){if(se)return;const et=Math.min(k,T),$e=Math.max(k,T),tt=Math.min(H,O),Ze=Math.max(H,O);Ae({...P.current,range:{x:et,y:tt,width:$e-et+1,height:Ze-tt+1}},!0,y,"click"),Kn.current=void 0,_t()}else Ae({cell:[k,H],range:{x:k,y:H,width:1,height:1}},!0,y,"click"),Kn.current=void 0,i(void 0),_t()}}else if(c.kind==="header")if(so.current=[k,H],i(void 0),Zt&&k===0)Kn.current=void 0,zo.current=void 0,!Ro&&te==="multi"&&(F.length!==Ce?We(st.fromSingleSelection([0,Ce]),void 0,y):We(st.empty(),void 0,y),_t());else{const K=zo.current;if(ke==="multi"&&(c.shiftKey||c.isLongTouch===!0)&&K!==void 0&&$.hasIndex(K)){const ge=[Math.min(K,k),Math.max(K,k)+1];y||c.isTouch||bt==="multi"?He(void 0,ge,y):He(st.fromSingleSelection(ge),void 0,y)}else ke==="multi"&&(y||c.isTouch||bt==="multi")?($.hasIndex(k)?He($.remove(k),void 0,y):He(void 0,k,y),zo.current=k):ke!=="none"&&($.hasIndex(k)?He($.remove(k),void 0,y):He(st.fromSingleSelection(k),void 0,y),zo.current=k);Kn.current=void 0,_t()}else c.kind===bn?so.current=[k,H]:c.kind===Yr&&!c.isMaybeScrollbar&&(Z(Br,!1),i(void 0),_t(),It==null||It(),Kn.current=void 0,zo.current=void 0)},[te,ke,P,Zt,I,pt,Ce,Gt,Jt,$n,_t,Je,bt,vt,qo,We,Ao,_n,gn,lo,Tn,Ae,Ro,He,Z,It]),Zo=s.useRef(!1),so=s.useRef(),_i=s.useRef(zn),ln=s.useRef(),ys=s.useCallback(c=>{if(Po.current=!1,_i.current=zt.current,c.button!==0&&c.button!==1){ln.current=void 0;return}const y=performance.now();ln.current={button:c.button,time:y,location:c.location},(c==null?void 0:c.kind)==="header"&&(Zo.current=!0);const v=c.kind==="cell"&&c.isFillHandle;!v&&c.kind!=="cell"&&c.isEdge||(f({previousSelection:P,fillHandle:v}),so.current=void 0,!c.isTouch&&c.button===0&&!v?jo(c):!c.isTouch&&c.button===1&&(so.current=c.location))},[P,jo]),[ci,di]=s.useState(),Ki=s.useCallback(c=>{if(c.kind!==bn||ke!=="multi")return;const y=Xr.value?c.metaKey:c.ctrlKey,[v]=c.location,k=P.columns;if(v<I)return;const H=Oe[v];let $=v,F=v;for(let T=v-1;T>=I&&cr(H.group,Oe[T].group);T--)$--;for(let T=v+1;T<Oe.length&&cr(H.group,Oe[T].group);T++)F++;if(_t(),y||c.isTouch||bt==="multi")if(k.hasAll([$,F+1])){let T=k;for(let O=$;O<=F;O++)T=T.remove(O);He(T,void 0,y)}else He(void 0,[$,F+1],y);else He(st.fromSingleSelection([$,F+1]),void 0,y)},[ke,_t,P.columns,Oe,I,He,bt]),Po=s.useRef(!1),Mr=s.useCallback(async c=>{if(Y!==void 0&&Se!==void 0){const y=zt.current.y,v=zt.current.height;let k=Y({x:c,y,width:1,height:Math.min(v,Ce-y)},S.current.signal);typeof k!="object"&&(k=await k());const H=Et[c-I],F=document.createElement("canvas").getContext("2d",{alpha:!1});if(F!==null){F.font=je.baseFontFull;const T=Jl(F,je,H,0,k,Xn,Eo,!1,vt);Se==null||Se(H,T.width,c,T.width)}}},[Et,Y,Eo,je,Xn,Se,I,Ce,vt]),[ps,Rr]=s.useState(),Bo=s.useCallback(async(c,y)=>{var T,O;const v=(T=c.current)==null?void 0:T.range;if(v===void 0||Y===void 0||y.current===void 0)return;const k=y.current.range;if(z!==void 0){let q=!1;if(z({fillDestination:{...k,x:k.x-I},patternSource:{...v,x:v.x-I},preventDefault:()=>q=!0}),q)return}let H=Y(v,S.current.signal);typeof H!="object"&&(H=await H());const $=H,F=[];for(let q=0;q<k.width;q++)for(let le=0;le<k.height;le++){const ie=[k.x+q,k.y+le];if(Ol(ie,v))continue;const K=$[le%v.height][q%v.width];Oo(K)||!$o(K)||F.push({location:ie,value:{...K}})}rn(F),(O=Lt.current)==null||O.damage(F.map(q=>({cell:q.location})))},[Y,rn,z,I]),Ui=s.useCallback(()=>{if(P.current===void 0||P.current.range.width<=1)return;const c={...P,current:{...P.current,range:{...P.current.range,width:1}}};Bo(c,P)},[Bo,P]),Vi=s.useCallback(()=>{if(P.current===void 0||P.current.range.height<=1)return;const c={...P,current:{...P.current,range:{...P.current.range,height:1}}};Bo(c,P)},[Bo,P]),vs=s.useCallback((c,y)=>{var le,ie;const v=d;if(f(void 0),ri(void 0),Rr(void 0),Zo.current=!1,y)return;if((v==null?void 0:v.fillHandle)===!0&&P.current!==void 0&&((le=v.previousSelection)==null?void 0:le.current)!==void 0){if(io===void 0)return;const K={...P,current:{...P.current,range:os(v.previousSelection.current.range,io)}};Bo(v.previousSelection,K),Z(K,!0);return}const[k,H]=c.location,[$,F]=so.current??[],T=()=>{Po.current=!0},O=K=>{var se,ze,et;const ge=K.isTouch||$===k&&F===H;if(ge&&(X==null||X([k-I,H],{...K,preventDefault:T})),K.button===1)return!Po.current;if(!Po.current){const $e=Jt(c.location),tt=vt($e);if(tt!==void 0&&tt.onClick!==void 0&&ge){const ht=tt.onClick({...K,cell:$e,posX:K.localEventX,posY:K.localEventY,bounds:K.bounds,theme:qo($e,c.location),preventDefault:T});ht!==void 0&&!Oo(ht)&&Wo(ht)&&(rn([{location:K.location,value:ht}]),(se=Lt.current)==null||se.damage([{cell:K.location}]))}if(Po.current||P.current===void 0)return!1;let Ze=!1;switch($e.activationBehaviorOverride??_e){case"double-click":case"second-click":{if(((et=(ze=v==null?void 0:v.previousSelection)==null?void 0:ze.current)==null?void 0:et.cell)===void 0)break;const[ht,Pt]=P.current.cell,[$t,wn]=v.previousSelection.current.cell;Ze=k===ht&&k===$t&&H===Pt&&H===wn&&(K.isDoubleClick===!0||_e==="second-click");break}case"single-click":{Ze=!0;break}}if(Ze){const Pt={inputType:"pointer",pointerActivation:K.isDoubleClick===!0?"double-click":$e.activationBehaviorOverride??_e,pointerType:K.isTouch?"touch":"mouse"};return B==null||B([k-I,H],Pt),To(K.bounds,Pt),!0}}return!1},q=c.location[0]-I;if(c.isTouch){const K=zt.current,ge=_i.current;if(K.x!==ge.x||K.y!==ge.y)return;if(c.isLongTouch===!0){if(c.kind==="cell"&&ir((ie=P.current)==null?void 0:ie.cell,c.location)){re==null||re([q,c.location[1]],{...c,preventDefault:T});return}else if(c.kind==="header"&&P.columns.hasIndex(k)){be==null||be(q,{...c,preventDefault:T});return}else if(c.kind===bn){if(q<0)return;_==null||_(q,{...c,preventDefault:T});return}}c.kind==="cell"?O(c)||jo(c):c.kind===bn?U==null||U(q,{...c,preventDefault:T}):(c.kind===Zn&&(A==null||A(q,{...c,preventDefault:T})),jo(c));return}if(c.kind==="header"){if(q<0)return;c.isEdge?c.isDoubleClick===!0&&Mr(k):c.button===0&&k===$&&H===F&&(A==null||A(q,{...c,preventDefault:T}))}if(c.kind===bn){if(q<0)return;c.button===0&&k===$&&H===F&&(U==null||U(q,{...c,preventDefault:T}),Po.current||Ki(c))}c.kind==="cell"&&(c.button===0||c.button===1)&&O(c),so.current=void 0},[d,P,I,io,Bo,Z,X,Jt,vt,_e,qo,rn,B,To,re,be,_,jo,U,A,Mr,Ki]),Cs=s.useCallback(c=>{const y={...c,location:[c.location[0]-I,c.location[1]]};ot==null||ot(y),d!==void 0&&c.buttons===0&&(f(void 0),ri(void 0),Rr(void 0),Zo.current=!1),Rr(v=>{var k;return Zo.current?[c.scrollEdge[0],0]:c.scrollEdge[0]===(v==null?void 0:v[0])&&c.scrollEdge[1]===v[1]?v:d===void 0||(((k=ln.current)==null?void 0:k.location[0])??0)<I?void 0:c.scrollEdge})},[d,ot,I]),xs=s.useCallback((c,y)=>{rt==null||rt(c-I,y)},[rt,I]),ks=s.useCallback((c,y)=>{Le==null||Le(c-I,y)},[Le,I]),xn=(nl=P==null?void 0:P.current)==null?void 0:nl.cell,Ss=s.useCallback((c,y,v,k,H,$)=>{ro.current=!1;let F=xn;F!==void 0&&(F=[F[0]-I,F[1]]);const T=Be===0?void 0:{x:0,y:c.y,width:Be,height:c.height},O=[];T!==void 0&&O.push(T),Ht>0&&(O.push({x:c.x-I,y:Ce-Ht,width:c.width,height:Ht}),Be>0&&O.push({x:0,y:Ce-Ht,width:Be,height:Ht}));const q={x:c.x-I,y:c.y,width:c.width,height:pt&&c.y+c.height>=Ce?c.height-1:c.height,tx:H,ty:$,extras:{selected:F,freezeRegion:T,freezeRegions:O}};zt.current=q,Gn(q),fn([y,v,k]),cn==null||cn(q,q.tx,q.ty,q.extras)},[xn,I,pt,Ce,Be,Ht,Gn,cn]),Ms=jn(D,s.useCallback((c,y)=>(D==null?void 0:D(c-I,y-I))!==!1,[D,I])),Rs=jn(Fe,s.useCallback((c,y)=>{Fe==null||Fe(c-I,y-I),ke!=="none"&&He(st.fromSingleSelection(y),void 0,!0)},[ke,Fe,I,He])),ui=s.useRef(!1),Es=s.useCallback(c=>{if(c.location[0]===0&&I>0){c.preventDefault();return}De==null||De({...c,location:[c.location[0]-I,c.location[1]]}),c.defaultPrevented()||(ui.current=!0),f(void 0)},[De,I]),Is=s.useCallback(()=>{ui.current=!1},[]),qi=Ft==null?void 0:Ft.selectionBehavior,Er=s.useCallback(c=>{if(qi!=="block-spanning")return;const{isGroupHeader:y,path:v,groupRows:k}=lo(c);if(y)return[c,c];const H=v[v.length-1],$=c-H,F=c+k-H-1;return[$,F]},[lo,qi]),fi=s.useRef(),hi=s.useCallback(c=>{var y,v,k;if(!cs(c,fi.current)&&(fi.current=c,!(((y=ln==null?void 0:ln.current)==null?void 0:y.button)!==void 0&&ln.current.button>=1))){if(c.buttons!==0&&d!==void 0&&((v=ln.current)==null?void 0:v.location[0])===0&&I===1&&te==="multi"&&d.previousSelection&&!d.previousSelection.rows.hasIndex(ln.current.location[1])&&P.rows.hasIndex(ln.current.location[1])){const H=Math.min(ln.current.location[1],c.location[1]),$=Math.max(ln.current.location[1],c.location[1])+1;We(st.fromSingleSelection([H,$]),void 0,!1)}else if(c.buttons!==0&&d!==void 0&&P.current!==void 0&&!ui.current&&!Zo.current&&(at==="rect"||at==="multi-rect")){const[H,$]=P.current.cell;let[F,T]=c.location;if(T<0&&(T=zt.current.y),d.fillHandle===!0&&((k=d.previousSelection)==null?void 0:k.current)!==void 0){const O=d.previousSelection.current.range;T=Math.min(T,pt?Ce-1:Ce);const q=wc(O,F,T,jt);ri(q)}else{if(pt&&$===Ce)return;if(pt&&T===Ce)if(c.kind===Yr)T--;else return;F=Math.max(F,I);const le=Er($);T=le===void 0?T:sn(T,le[0],le[1]);const ie=F-H,K=T-$,ge={x:ie>=0?H:F,y:K>=0?$:T,width:Math.abs(ie)+1,height:Math.abs(K)+1};Ae({...P.current,range:ge},!0,!1,"drag")}}xt==null||xt({...c,location:[c.location[0]-I,c.location[1]]})}},[d,I,te,P,at,xt,We,pt,Ce,jt,Er,Ae]),Ds=s.useCallback(()=>{var F,T;const c=fi.current;if(c===void 0)return;const[y,v]=c.scrollEdge;let[k,H]=c.location;const $=zt.current;y===-1?k=((T=(F=$.extras)==null?void 0:F.freezeRegion)==null?void 0:T.x)??$.x:y===1&&(k=$.x+$.width),v===-1?H=Math.max(0,$.y):v===1&&(H=Math.min(Ce-1,$.y+$.height)),k=sn(k,0,Oe.length-1),H=sn(H,0,Ce-1),hi({...c,location:[k,H]})},[Oe.length,hi,Ce]);Md(ps,ut,Ds);const mn=s.useCallback(c=>{if(P.current===void 0)return;const[y,v]=c,[k,H]=P.current.cell,$=P.current.range;let F=$.x,T=$.x+$.width,O=$.y,q=$.y+$.height;const[le,ie]=Er(H)??[0,Ce-1],K=ie+1;if(v!==0)switch(v){case 2:{q=K,O=H,Rt(0,q,"vertical");break}case-2:{O=le,q=H+1,Rt(0,O,"vertical");break}case 1:{O<H?(O++,Rt(0,O,"vertical")):(q=Math.min(K,q+1),Rt(0,q,"vertical"));break}case-1:{q>H+1?(q--,Rt(0,q,"vertical")):(O=Math.max(le,O-1),Rt(0,O,"vertical"));break}default:ar()}if(y!==0)if(y===2)T=Oe.length,F=k,Rt(T-1-I,0,"horizontal");else if(y===-2)F=I,T=k+1,Rt(F-I,0,"horizontal");else{let ge=[];if(Y!==void 0){const se=Y({x:F,y:O,width:T-F-I,height:q-O},S.current.signal);typeof se=="object"&&(ge=Pd(se))}if(y===1){let se=!1;if(F<k){if(ge.length>0){const ze=fo(F+1,k+1).find(et=>!ge.includes(et-I));ze!==void 0&&(F=ze,se=!0)}else F++,se=!0;se&&Rt(F,0,"horizontal")}se||(T=Math.min(Oe.length,T+1),Rt(T-1-I,0,"horizontal"))}else if(y===-1){let se=!1;if(T>k+1){if(ge.length>0){const ze=fo(T-1,k,-1).find(et=>!ge.includes(et-I));ze!==void 0&&(T=ze,se=!0)}else T--,se=!0;se&&Rt(T-I,0,"horizontal")}se||(F=Math.max(I,F-1),Rt(F-I,0,"horizontal"))}else ar()}Ae({cell:P.current.cell,range:{x:F,y:O,width:T-F,height:q-O}},!0,!1,"keyboard-select")},[Y,Er,P,Oe.length,I,Ce,Rt,Ae]),gi=s.useRef(to);gi.current=to;const Un=s.useCallback((c,y,v,k)=>{const H=Xt-(v?0:1);c=sn(c,I,Et.length-1+I),y=sn(y,0,H);const $=xn==null?void 0:xn[0],F=xn==null?void 0:xn[1];if(c===$&&y===F)return!1;if(k&&P.current!==void 0){const T=[...P.current.rangeStack];(P.current.range.width>1||P.current.range.height>1)&&T.push(P.current.range),Z({...P,current:{cell:[c,y],range:{x:c,y,width:1,height:1},rangeStack:T}},!0)}else Ae({cell:[c,y],range:{x:c,y,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===c&&u.current[1]===y&&(u.current=void 0),gi.current&&Rt(c-I,y),!0},[Xt,I,Et.length,xn,P,Rt,Z,Ae]),Fs=s.useCallback((c,y)=>{(r==null?void 0:r.cell)!==void 0&&c!==void 0&&Wo(c)&&(rn([{location:r.cell,value:c}]),window.requestAnimationFrame(()=>{var H;(H=Lt.current)==null||H.damage([{cell:r.cell}])})),_t(!0),i(void 0);const[v,k]=y;if(P.current!==void 0&&(v!==0||k!==0)){const H=P.current.cell[1]===Xt-1&&c!==void 0,$=P.current.cell[0]===Oe.length-1&&c!==void 0;let F=!0;if(H&&k===1&&xe!==void 0){F=!1;const T=P.current.cell[0]+v,O=Ao(T);_n(O??T,!1)}if($&&v===1&&Ie!==void 0){F=!1;const T=P.current.cell[1]+k;Sr(T,!1)}F&&Un(sn(P.current.cell[0]+v,0,Oe.length-1),sn(P.current.cell[1]+k,0,Xt-1),H,!1)}L==null||L(c,y)},[r==null?void 0:r.cell,_t,P,L,rn,Xt,Un,Oe.length,_n,Sr,xe,Ie,Ao]),Hs=s.useMemo(()=>`gdg-overlay-${zd++}`,[]),ao=s.useCallback(c=>{var v,k,H,$;_t();const y=[];for(let F=c.x;F<c.x+c.width;F++)for(let T=c.y;T<c.y+c.height;T++){const O=R([F-I,T]);if(!O.allowOverlay&&O.kind!==J.Boolean)continue;let q;if(O.kind===J.Custom){const le=vt(O),ie=(v=le==null?void 0:le.provideEditor)==null?void 0:v.call(le,{...O,location:[F-I,T]});(le==null?void 0:le.onDelete)!==void 0?q=le.onDelete(O):ra(ie)&&(q=(k=ie==null?void 0:ie.deletedValue)==null?void 0:k.call(ie,O))}else if(Wo(O)&&O.allowOverlay||O.kind===J.Boolean){const le=vt(O);q=(H=le==null?void 0:le.onDelete)==null?void 0:H.call(le,O)}q!==void 0&&!Oo(q)&&Wo(q)&&y.push({location:[F,T],value:q})}rn(y),($=Lt.current)==null||$.damage(y.map(F=>({cell:F.location})))},[_t,R,vt,rn,I]),Jo=r!==void 0,ji=s.useCallback(c=>{var ze,et;const y=()=>{c.stopPropagation(),c.preventDefault()},v={didMatch:!1},{bounds:k}=c,H=P.columns,$=P.rows,F=Cn;if(!Jo&&Xe(F.clear,c,v))Z(Br,!1),It==null||It();else if(!Jo&&Xe(F.selectAll,c,v))Z({columns:st.empty(),rows:st.empty(),current:{cell:((ze=P.current)==null?void 0:ze.cell)??[I,0],range:{x:I,y:0,width:C.length,height:Ce},rangeStack:[]}},!1);else if(Xe(F.search,c,v))(et=a==null?void 0:a.current)==null||et.focus({preventScroll:!0}),oo(!0);else if(Xe(F.delete,c,v)){const $e=(qe==null?void 0:qe(P))??!0;if($e!==!1){const tt=$e===!0?P:$e;if(tt.current!==void 0){ao(tt.current.range);for(const Ze of tt.current.rangeStack)ao(Ze)}for(const Ze of tt.rows)ao({x:I,y:Ze,width:C.length,height:1});for(const Ze of tt.columns)ao({x:Ze,y:0,width:1,height:Ce})}}if(v.didMatch)return y(),!0;if(P.current===void 0)return!1;let[T,O]=P.current.cell;const[,q]=P.current.cell;let le=!1,ie=!1;if(Xe(F.scrollToSelectedCell,c,v))Fr.current(T-I,O);else if(ke!=="none"&&Xe(F.selectColumn,c,v))H.hasIndex(T)?He(H.remove(T),void 0,!0):ke==="single"?He(st.fromSingleSelection(T),void 0,!0):He(void 0,T,!0);else if(te!=="none"&&Xe(F.selectRow,c,v))$.hasIndex(O)?We($.remove(O),void 0,!0):te==="single"?We(st.fromSingleSelection(O),void 0,!0):We(void 0,O,!0);else if(!Jo&&k!==void 0&&Xe(F.activateCell,c,v))if(O===Ce&&pt)window.setTimeout(()=>{const $e=Ao(T);_n($e??T)},0);else{const $e={inputType:"keyboard",key:c.key};B==null||B([T-I,O],$e),To(k,$e)}else P.current.range.height>1&&Xe(F.downFill,c,v)?Vi():P.current.range.width>1&&Xe(F.rightFill,c,v)?Ui():Xe(F.goToNextPage,c,v)?O+=Math.max(1,zt.current.height-4):Xe(F.goToPreviousPage,c,v)?O-=Math.max(1,zt.current.height-4):Xe(F.goToFirstCell,c,v)?(i(void 0),O=0,T=0):Xe(F.goToLastCell,c,v)?(i(void 0),O=Number.MAX_SAFE_INTEGER,T=Number.MAX_SAFE_INTEGER):Xe(F.selectToFirstCell,c,v)?(i(void 0),mn([-2,-2])):Xe(F.selectToLastCell,c,v)?(i(void 0),mn([2,2])):Jo?(Xe(F.closeOverlay,c,v)&&i(void 0),Xe(F.acceptOverlayDown,c,v)&&(i(void 0),O++),Xe(F.acceptOverlayUp,c,v)&&(i(void 0),O--),Xe(F.acceptOverlayLeft,c,v)&&(i(void 0),T--),Xe(F.acceptOverlayRight,c,v)&&(i(void 0),T++)):(Xe(F.goDownCell,c,v)?O+=1:Xe(F.goUpCell,c,v)?O-=1:Xe(F.goRightCell,c,v)?T+=1:Xe(F.goLeftCell,c,v)?T-=1:Xe(F.goDownCellRetainSelection,c,v)?(O+=1,le=!0):Xe(F.goUpCellRetainSelection,c,v)?(O-=1,le=!0):Xe(F.goRightCellRetainSelection,c,v)?(T+=1,le=!0):Xe(F.goLeftCellRetainSelection,c,v)?(T-=1,le=!0):Xe(F.goToLastRow,c,v)?O=Ce-1:Xe(F.goToFirstRow,c,v)?O=Number.MIN_SAFE_INTEGER:Xe(F.goToLastColumn,c,v)?T=Number.MAX_SAFE_INTEGER:Xe(F.goToFirstColumn,c,v)?T=Number.MIN_SAFE_INTEGER:(at==="rect"||at==="multi-rect")&&(Xe(F.selectGrowDown,c,v)?mn([0,1]):Xe(F.selectGrowUp,c,v)?mn([0,-1]):Xe(F.selectGrowRight,c,v)?mn([1,0]):Xe(F.selectGrowLeft,c,v)?mn([-1,0]):Xe(F.selectToLastRow,c,v)?mn([0,2]):Xe(F.selectToFirstRow,c,v)?mn([0,-2]):Xe(F.selectToLastColumn,c,v)?mn([2,0]):Xe(F.selectToFirstColumn,c,v)&&mn([-2,0])),ie=v.didMatch);if(gn!==void 0&&gn!=="normal"&&O!==q){const $e=gn==="skip-up"||gn==="skip"||gn==="block",tt=gn==="skip-down"||gn==="skip"||gn==="block",Ze=O<q;if(Ze&&$e){for(;O>=0&&lo(O).isGroupHeader;)O--;O<0&&(O=q)}else if(!Ze&&tt){for(;O<Ce&&lo(O).isGroupHeader;)O++;O>=Ce&&(O=q)}}const ge=Un(T,O,!1,le),se=v.didMatch;return se&&(ge||!ie||Fn)&&y(),se},[gn,Jo,P,Cn,ke,te,at,I,lo,Ce,Un,Z,It,C.length,qe,Fn,ao,He,We,pt,Ao,_n,B,To,Vi,Ui,mn]),Qo=s.useCallback(c=>{let y=!1;if(Pe!==void 0&&Pe({...c,...c.location&&{location:[c.location[0]-I,c.location[1]]},cancel:()=>{y=!0}}),y||ji(c)||P.current===void 0)return;const[v,k]=P.current.cell,H=zt.current;if(gt&&!c.metaKey&&!c.ctrlKey&&P.current!==void 0&&c.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(c.key)&&c.bounds!==void 0&&$o(R([v-I,Math.max(0,Math.min(k,Ce-1))]))){if((!pt||k!==Ce)&&(H.y>k||k>H.y+H.height||H.x>v||v>H.x+H.width))return;const $={inputType:"keyboard",key:c.key};B==null||B([v-I,k],$),To(c.bounds,$,c.key),c.stopPropagation(),c.preventDefault()}},[gt,Pe,ji,P,R,I,Ce,pt,B,To]),Ts=s.useCallback((c,y)=>{const v=c.location[0]-I;if(c.kind==="header"&&(be==null||be(v,{...c,preventDefault:y})),c.kind===bn){if(v<0)return;_==null||_(v,{...c,preventDefault:y})}if(c.kind==="cell"){const[k,H]=c.location;re==null||re([v,H],{...c,preventDefault:y}),xa(P,c.location)||Un(k,H,!1,!1)}},[P,re,_,be,I,Un]),mi=s.useCallback(async c=>{var F,T,O,q,le;if(!Cn.paste)return;function y(ie,K,ge,se){var et,$e;const ze=typeof ge=="object"?(ge==null?void 0:ge.join(`
`))??"":(ge==null?void 0:ge.toString())??"";if(!Oo(ie)&&$o(ie)&&ie.readonly!==!0){const tt=G==null?void 0:G(ze,ie);if(tt!==void 0&&Wo(tt))return{location:K,value:tt};const Ze=vt(ie);if(Ze===void 0)return;if(Ze.kind===J.Custom){Qt(ie.kind===J.Custom);const ht=(et=Ze.onPaste)==null?void 0:et.call(Ze,ze,ie.data);return ht===void 0?void 0:{location:K,value:{...ie,data:ht}}}else{const ht=($e=Ze.onPaste)==null?void 0:$e.call(Ze,ze,ie,{formatted:se,formattedString:typeof se=="string"?se:se==null?void 0:se.join(`
`),rawValue:ge});return ht===void 0?void 0:(Qt(ht.kind===ie.kind),{location:K,value:ht})}}}const v=P.columns,k=P.rows,H=((F=ut.current)==null?void 0:F.contains(document.activeElement))===!0||((T=l.current)==null?void 0:T.contains(document.activeElement))===!0;let $;if(P.current!==void 0?$=[P.current.range.x,P.current.range.y]:v.length===1?$=[v.first()??0,0]:k.length===1&&($=[I,k.first()??0]),H&&$!==void 0){let ie,K;const ge="text/plain",se="text/html";if(((O=navigator.clipboard)==null?void 0:O.read)!==void 0){const tt=await navigator.clipboard.read();for(const Ze of tt){if(Ze.types.includes(se)){const Pt=await(await Ze.getType(se)).text(),$t=Sl(Pt);if($t!==void 0){ie=$t;break}}Ze.types.includes(ge)&&(K=await(await Ze.getType(ge)).text())}}else if(((q=navigator.clipboard)==null?void 0:q.readText)!==void 0)K=await navigator.clipboard.readText();else if(c!==void 0&&(c==null?void 0:c.clipboardData)!==null){if(c.clipboardData.types.includes(se)){const tt=c.clipboardData.getData(se);ie=Sl(tt)}ie===void 0&&c.clipboardData.types.includes(ge)&&(K=c.clipboardData.getData(ge))}else return;const[ze,et]=$,$e=[];do{if(oe===void 0){const tt=Jt($),Ze=K??(ie==null?void 0:ie.map(Pt=>Pt.map($t=>$t.rawValue).join("	")).join("	"))??"",ht=y(tt,$,Ze,void 0);ht!==void 0&&$e.push(ht);break}if(ie===void 0){if(K===void 0)return;ie=yd(K)}if(oe===!1||typeof oe=="function"&&(oe==null?void 0:oe([$[0]-I,$[1]],ie.map(tt=>tt.map(Ze=>{var ht;return((ht=Ze.rawValue)==null?void 0:ht.toString())??""}))))!==!0)return;for(const[tt,Ze]of ie.entries()){if(tt+et>=Ce)break;for(const[ht,Pt]of Ze.entries()){const $t=[ht+ze,tt+et],[wn,Pn]=$t;if(wn>=Oe.length||Pn>=Xt)continue;const Lo=Jt($t),co=y(Lo,$t,Pt.rawValue,Pt.formatted);co!==void 0&&$e.push(co)}}}while(!1);rn($e),(le=Lt.current)==null||le.damage($e.map(tt=>({cell:tt.location})))}},[G,vt,Jt,P,Cn.paste,ut,Oe.length,rn,Xt,oe,I,Ce]);Kt("paste",mi,g,!1,!0);const er=s.useCallback(async(c,y)=>{var F,T;if(!Cn.copy)return;const v=y===!0||((F=ut.current)==null?void 0:F.contains(document.activeElement))===!0||((T=l.current)==null?void 0:T.contains(document.activeElement))===!0,k=P.columns,H=P.rows,$=(O,q)=>{if(!me)Rl(O,q,c);else{const le=q.map(ie=>({kind:J.Text,data:C[ie].title,displayData:C[ie].title,allowOverlay:!1}));Rl([le,...O],q,c)}};if(v&&Y!==void 0){if(P.current!==void 0){let O=Y(P.current.range,S.current.signal);typeof O!="object"&&(O=await O()),$(O,fo(P.current.range.x-I,P.current.range.x+P.current.range.width-I))}else if(H!==void 0&&H.length>0){const q=[...H].map(le=>{const ie=Y({x:I,y:le,width:C.length,height:1},S.current.signal);return typeof ie=="object"?ie[0]:ie().then(K=>K[0])});if(q.some(le=>le instanceof Promise)){const le=await Promise.all(q);$(le,fo(C.length))}else $(q,fo(C.length))}else if(k.length>0){const O=[],q=[];for(const le of k){let ie=Y({x:le,y:0,width:1,height:Ce},S.current.signal);typeof ie!="object"&&(ie=await ie()),O.push(ie),q.push(le-I)}if(O.length===1)$(O[0],q);else{const le=O.reduce((ie,K)=>ie.map((ge,se)=>[...ge,...K[se]]));$(le,q)}}}},[C,Y,P,Cn.copy,I,ut,Ce,me]);Kt("copy",er,g,!1,!1);const As=s.useCallback(async c=>{var v,k;if(!(!Cn.cut||!(((v=ut.current)==null?void 0:v.contains(document.activeElement))===!0||((k=l.current)==null?void 0:k.contains(document.activeElement))===!0))&&(await er(c),P.current!==void 0)){let H={current:{cell:P.current.cell,range:P.current.range,rangeStack:[]},rows:st.empty(),columns:st.empty()};const $=qe==null?void 0:qe(H);if($===!1||(H=$===!0?H:$,H.current===void 0))return;ao(H.current.range)}},[ao,P,Cn.cut,er,ut,qe]);Kt("cut",As,g,!1,!1);const zs=s.useCallback((c,y)=>{if(pe!==void 0){I!==0&&(c=c.map(H=>[H[0]-I,H[1]])),pe(c,y);return}if(c.length===0||y===-1)return;const[v,k]=c[y];u.current!==void 0&&u.current[0]===v&&u.current[1]===k||(u.current=[v,k],Un(v,k,!1,!1))},[pe,I,Un]),[Ir,Dr]=((ol=Ut==null?void 0:Ut.current)==null?void 0:ol.cell)??[],Fr=s.useRef(Rt);Fr.current=Rt,s.useLayoutEffect(()=>{var c,y,v,k;gi.current&&!ro.current&&Ir!==void 0&&Dr!==void 0&&(Ir!==((y=(c=j.current)==null?void 0:c.current)==null?void 0:y.cell[0])||Dr!==((k=(v=j.current)==null?void 0:v.current)==null?void 0:k.cell[1]))&&Fr.current(Ir,Dr),ro.current=!1},[Ir,Dr]);const Zi=P.current!==void 0&&(P.current.cell[0]>=Oe.length||P.current.cell[1]>=Xt);s.useLayoutEffect(()=>{Zi&&Z(Br,!1)},[Zi,Z]);const Ps=s.useMemo(()=>pt===!0&&(Ke==null?void 0:Ke.tint)===!0?st.fromSingleSelection(Xt-1):st.empty(),[Xt,pt,Ke==null?void 0:Ke.tint]),Bs=s.useCallback(c=>typeof it=="boolean"?it:(it==null?void 0:it(c-I))??!0,[I,it]),Ls=s.useMemo(()=>{if(ci===void 0||l.current===null)return null;const{bounds:c,group:y}=ci,v=l.current.getBoundingClientRect();return s.createElement(sd,{bounds:c,group:y,canvasBounds:v,onClose:()=>di(void 0),onFinish:k=>{di(void 0),ye==null||ye(y,k)}})},[ye,ci]),Ws=Math.min(Oe.length,Be+(Zt?1:0));s.useImperativeHandle(t,()=>({appendRow:(c,y)=>_n(c+I,y),appendColumn:(c,y)=>Sr(c,y),updateCells:c=>{var y;return I!==0&&(c=c.map(v=>({cell:[v.cell[0]+I,v.cell[1]]}))),(y=Lt.current)==null?void 0:y.damage(c)},getBounds:(c,y)=>{var v;if(!((l==null?void 0:l.current)===null||(ut==null?void 0:ut.current)===null)){if(c===void 0&&y===void 0){const k=l.current.getBoundingClientRect(),H=k.width/ut.current.clientWidth;return{x:k.x-ut.current.scrollLeft*H,y:k.y-ut.current.scrollTop*H,width:ut.current.scrollWidth*H,height:ut.current.scrollHeight*H}}return(v=Lt.current)==null?void 0:v.getBounds((c??0)+I,y)}},focus:()=>{var c;return(c=Lt.current)==null?void 0:c.focus()},emit:async c=>{switch(c){case"delete":Qo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Qo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Qo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await er(void 0,!0);break;case"paste":await mi();break}},scrollTo:Rt,remeasureColumns:c=>{for(const y of c)Mr(y+I)},getMouseArgsForPosition:(c,y,v)=>{if((Lt==null?void 0:Lt.current)===null)return;const k=Lt.current.getMouseArgsForPosition(c,y,v);if(k!==void 0)return{...k,location:[k.location[0]-I,k.location[1]]}}}),[_n,Sr,Mr,ut,er,Qo,mi,I,Rt]);const[Ji,Qi]=xn??[],$s=s.useCallback(c=>{const[y,v]=c;if(v===-1){ke!=="none"&&(He(st.fromSingleSelection(y),void 0,!1),_t());return}Ji===y&&Qi===v||(Ae({cell:c,range:{x:y,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Rt(y,v))},[ke,_t,Rt,Ji,Qi,Ae,He]),[Os,Ns]=s.useState(!1),el=s.useRef(Al(c=>{Ns(c)},5)),Xs=s.useCallback(()=>{el.current(!0),P.current===void 0&&P.columns.length===0&&P.rows.length===0&&d===void 0&&Ae({cell:[I,pr],range:{x:I,y:pr,width:1,height:1}},!0,!1,"keyboard-select")},[pr,P,d,I,Ae]),Ys=s.useCallback(()=>{el.current(!1)},[]),[Gs,_s]=s.useMemo(()=>{let c;const y=(Ue==null?void 0:Ue.scrollbarWidthOverride)??Mi(),v=Ce+(pt?1:0);if(typeof vn=="number")c=Nt+v*vn;else{let H=0;const $=Math.min(v,10);for(let F=0;F<$;F++)H+=vn(F);H=Math.floor(H/$),c=Nt+v*H}c+=y;const k=Oe.reduce((H,$)=>$.width+H,0)+y;return[`${Math.min(1e5,k)}px`,`${Math.min(1e5,c)}px`]},[Oe,Ue==null?void 0:Ue.scrollbarWidthOverride,vn,Ce,pt,Nt]),Ks=s.useMemo(()=>Ba(je),[je]);return s.createElement(Zl.Provider,{value:je},s.createElement(xd,{style:Ks,className:Me,inWidth:b??Gs,inHeight:x??_s},s.createElement(od,{fillHandle:Tt,drawFocusRing:xo,experimental:Ue,fixedShadowX:En,fixedShadowY:fr,getRowThemeOverride:un,headerIcons:Wn,imageWindowLoader:In,initialSize:Dn,isDraggable:wo,onDragLeave:hr,onRowMoved:$n,overscrollX:ei,overscrollY:ti,preventDiagonalScrolling:po,rightElement:vo,rightElementProps:eo,smoothScrollX:Kr,smoothScrollY:gr,className:Me,enableGroups:on,onCanvasFocused:Xs,onCanvasBlur:Ys,canvasRef:l,onContextMenu:Ts,theme:je,cellXOffset:ws,cellYOffset:pr,accessibilityHeight:zn.height,onDragEnd:Is,columns:Oe,nonGrowWidth:lt,drawHeader:At,onColumnProposeMove:Ms,drawCell:we,disabledRows:Ps,freezeColumns:Ws,lockColumns:I,firstColAccessible:I===0,getCellContent:Jt,minColumnWidth:Xn,maxColumnWidth:Eo,searchInputRef:a,showSearch:oi,onSearchClose:Do,highlightRegions:bs,getCellsForSelection:Y,getGroupDetails:ii,headerHeight:Vo,isFocused:Os,groupHeaderHeight:on?yr:0,freezeTrailingRows:Ht+(pt&&(Ke==null?void 0:Ke.sticky)===!0?1:0),hasAppendRow:pt,onColumnResize:Se,onColumnResizeEnd:Ve,onColumnResizeStart:he,onCellFocused:$s,onColumnMoved:Rs,onDragStart:Es,onHeaderMenuClick:xs,onHeaderIndicatorClick:ks,onItemHovered:hi,isFilling:(d==null?void 0:d.fillHandle)===!0,onMouseMove:Cs,onKeyDown:Qo,onKeyUp:Ge,onMouseDown:ys,onMouseUp:vs,onDragOverCell:nn,onDrop:Yt,onSearchResultsChanged:zs,onVisibleRegionChanged:Ss,clientSize:Mt,rowHeight:vn,searchResults:Q,searchValue:fe,onSearchValueChange:V,rows:Xt,scrollRef:ut,selection:P,translateX:zn.tx,translateY:zn.ty,verticalBorder:Bs,gridRef:Lt,getCellRenderer:vt,resizeIndicator:mr,setScrollDir:Rr}),Ls,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Ad,{...r,validateCell:de,bloom:N,id:Hs,getCellRenderer:vt,className:(Ue==null?void 0:Ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Ot,imageEditorOverride:m,portalElementRef:wr,onFinishEditing:Fs,markdownDivCreateNode:h,isOutsideClick:jr,customEventTarget:Ue==null?void 0:Ue.eventTarget}))))},Ld=s.forwardRef(Bd);function Dl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:d,y:f}=r,u=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+l/2),m=Ll(u,l,i.cellVerticalPadding),w=Bl(t.contentAlign??"center",d,a,i.cellHorizontalPadding,m),h=Pl(w,g,m),b=Wl(d+n,f+o,h);return Ti(t)&&b}const Wd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:J.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>$d(e,e.cell.data,Ti(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Dl(e)&&e.preventDefault()},onClick:e=>{if(Dl(e))return{...e.cell,data:us(e.cell.data)}},onPaste:(e,t)=>{let n=Wr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Hi),n===t.data?void 0:{...t,data:n}}};function $d(e,t,n,o,r){if(!n&&t===Wr)return;const{ctx:i,hoverAmount:a,theme:l,rect:d,highlighted:f,hoverX:u,hoverY:g,cell:{contentAlign:m}}=e,{x:w,y:h,width:b,height:x}=d;let C=!1;if(r>0){let p=n?1-r+r*a:.4;if(t===Wr&&(p*=a),p===0)return;p<1&&(C=!0,i.globalAlpha=p)}Wi(i,l,t,w,h,b,x,f,u,g,o,m),C&&(i.globalAlpha=1)}const Od=tn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Nd=e=>{const{bubbles:t}=e;return s.createElement(Od,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Xd={getAccessibilityString:e=>$l(e.data),kind:J.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Yd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Nd,{bubbles:t.data})},onPaste:()=>{}};function Yd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:d,height:f}=n;let u=a+o.cellHorizontalPadding;const g=[];for(const m of t){if(u>a+d)break;const w=_o(m,r,o.baseFontFull).width;g.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const m of g)Sn(r,m.x,l+(f-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,w]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],w.x+o.bubblePadding,l+f/2+Jn(r,o))}const Gd=tn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),_d=e=>{const{drilldowns:t}=e;return s.createElement(Gd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Kd={getAccessibilityString:e=>$l(e.data.map(t=>t.text)),kind:J.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Vd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(_d,{drilldowns:t.data})},onPaste:()=>{}},xi={};function Ud(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,d=n*r,f=o+i,u=o*3,g=(u+i*2)*r,m=`${e},${t},${r},${n}`;if(xi[m]!==void 0)return{el:xi[m],height:d,width:g,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=g,w.height=d,h.scale(r,r),xi[m]=w,h.beginPath(),Sn(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Sn(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:d,width:g,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Vd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:d,width:f}=n,u=o.baseFontFull,g=Kl(r,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-m)/2),h=m-10,b=o.bubblePadding,x=o.bubbleMargin;let C=d+o.cellHorizontalPadding;const p=o.roundingRadius??6,R=Ud(o.bgCell,o.drilldownBorder,m,p),X=[];for(const B of t){if(C>d+f)break;const L=_o(B.text,r,u).width;let G=0;B.img!==void 0&&i.loadOrGetImage(B.img,a,l)!==void 0&&(G=h-8+4);const M=L+G+b*2;X.push({x:C,width:M}),C+=M+x}if(R!==null){const{el:B,height:z,middleWidth:L,sideWidth:G,width:M,dpr:W,padding:N}=R,A=G/W,D=N/W;for(const E of X){const ae=Math.floor(E.x),U=Math.floor(E.width),re=U-(A-D)*2;r.imageSmoothingEnabled=!1,r.drawImage(B,0,0,G,z,ae-D,w,A,m),re>0&&r.drawImage(B,G,0,L,z,ae+(A-D),w,re,m),r.drawImage(B,M-G,0,G,z,ae+U-(A-D),w,A,m),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[B,z]of X.entries()){const L=t[B];let G=z.x+b;if(L.img!==void 0){const M=i.loadOrGetImage(L.img,a,l);if(M!==void 0){const W=h-8;let N=0,A=0,D=M.width,E=M.height;D>E?(N+=(D-E)/2,D=E):E>D&&(A+=(E-D)/2,E=D),r.beginPath(),Sn(r,G,w+m/2-W/2,W,W,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(M,N,A,D,E,G,w+m/2-W/2,W,W),r.restore(),G+=W+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(L.text,G,w+m/2+Jn(r,o))}}const qd={getAccessibilityString:e=>e.data.join(", "),kind:J.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>jd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ga;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},ki=4;function jd(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:d,imageLoader:f}=e,{x:u,y:g,height:m,width:w}=r,h=m-l.cellVerticalPadding*2,b=[];let x=0;for(let p=0;p<t.length;p++){const R=t[p];if(R.length===0)continue;const X=f.loadOrGetImage(R,i,a);if(X!==void 0){b[p]=X;const B=X.width*(h/X.height);x+=B+ki}}if(x===0)return;x-=ki;let C=u+l.cellHorizontalPadding;o==="right"?C=Math.floor(u+w-l.cellHorizontalPadding-x):o==="center"&&(C=Math.floor(u+w/2-x/2));for(const p of b){if(p===void 0)continue;const R=p.width*(h/p.height);n>0&&(d.beginPath(),Sn(d,C,g+l.cellVerticalPadding,R,h,n),d.save(),d.clip()),d.drawImage(p,C,g+l.cellVerticalPadding,R,h),n>0&&d.restore(),C+=R+ki}}function Zd(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Jd={getAccessibilityString:()=>"",kind:J.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Zd(n,o)*t.skeletonWidthVariability));const d=a.cellHorizontalPadding;l+d*2>=i.width&&(l=i.width-d*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);Sn(r,i.x+d,i.y+(i.height-f)/2,l,f,a.roundingRadius??3),r.fillStyle=go(a.textDark,.1),r.fill()},onPaste:()=>{}},Qd=()=>e=>e.targetWidth,Fl=tn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Qd(),"px"]}}),eu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,d=t.data,f=t.readonly===!0,[u,g]=s.useState(d===""||o),m=s.useCallback(()=>{g(h=>!h)},[]),w=d?"gdg-ml-6":"";return u?s.createElement(Fl,{targetWidth:i.width-20},s.createElement(Gr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:d,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>a(t)},s.createElement(sa,null))):s.createElement(Fl,{targetWidth:i.width},s.createElement(wa,{contents:d,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:m},s.createElement(Ai,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},tu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:ur,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>kn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(eu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:d=>t({...n,data:d.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},nu={getAccessibilityString:e=>e.row.toString(),kind:an.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:ou,measure:()=>44,draw:e=>iu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,d=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-d)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function ou(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=ru,n.textAlign="center",i}function ru(e){const{ctx:t}=e;t.textAlign="start"}function iu(e,t,n,o,r,i){const{ctx:a,rect:l,hoverAmount:d,theme:f}=e,{x:u,y:g,width:m,height:w}=l,h=n?1:o==="checkbox-visible"?.6+.4*d:d;if(o!=="number"&&h>0){a.globalAlpha=h;const b=7*(n?d:1);if(Wi(a,f,n,r?u+b:u,g,r?m-b:m,w,!0,void 0,void 0,f.checkboxMaxSize,"center",i),r){a.globalAlpha=d,a.beginPath();for(const x of[3,6])for(const C of[-5,-1,3])a.rect(u+x,g+w/2+C,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),x=f.markerFontFull,C=u+m/2;o==="both"&&d!==0&&(a.globalAlpha=1-d),a.fillStyle=f.textLight,a.font=x,a.fillText(b,C,g+w/2+Jn(a,x)),d!==0&&(a.globalAlpha=1)}}const lu={getAccessibilityString:()=>"",kind:an.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>su(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function su(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:d,y:f,width:u,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(d+1,f+1,u,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let w=0;if(n!==void 0){const b=g-8,x=d+8/2,C=f+8/2;l.drawSprite(n,"normal",o,x,C,b,a,m?1:i),w=b}else{w=24;const h=12,b=m?h:i*h,x=m?0:(1-i)*h*.5,C=a.cellHorizontalPadding+4;b>0&&(o.moveTo(d+C+x,f+g/2),o.lineTo(d+C+x+b,f+g/2),o.moveTo(d+C+x+b*.5,f+g/2-b*.5),o.lineTo(d+C+x+b*.5,f+g/2+b*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,w+d+a.cellHorizontalPadding+.5,f+g/2+Jn(o,a)),o.beginPath()}function gs(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=au(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Sn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??go(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function au(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=_o(n,e,o.baseFontFull,"alphabetic"),d=t.height-a,f=Math.min(d,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const cu=s.lazy(async()=>await Tl(()=>import("./number-overlay-editor-4HCoKGKU.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),du={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:ur,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:d,hoverEffectTheme:f}=n;l===!0&&t>0&&gs(o,r,f,d,i,t,a),kn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(cu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},uu={getAccessibilityString:()=>"",measure:()=>108,kind:J.Protected,needsHover:!1,needsHoverPosition:!1,draw:fu,onPaste:()=>{}};function fu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let d=r+n.cellHorizontalPadding+l;const f=i+a/2,u=Math.cos(cl(30))*l,g=Math.sin(cl(30))*l;for(let m=0;m<12;m++)t.moveTo(d,f-l),t.lineTo(d,f+l),t.moveTo(d+u,f-g),t.lineTo(d-u,f+g),t.moveTo(d-u,f-g),t.lineTo(d+u,f+g),d+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>ur(e,t,e.theme.textLight),draw:e=>kn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return kt.createElement(Gr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},gu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:ur,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:d,contentAlign:f,hoverEffect:u,allowWrapping:g,hoverEffectTheme:m}=t;u===!0&&n>0&&gs(r,a,m,d,i,n,l),kn(e,d,f,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Gr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},mu=tn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),wu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[l,d]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{d(!0)},[]);return l?s.createElement(Gr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(mu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Ai,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ms(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function Hl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Gl(a,i.baseFontFull);if(l===void 0)return!1;const d=ms(l,n,i,t.contentAlign);return ho({x:d.x-4,y:d.y-4,width:d.width+8,height:d.height+8},o,r)}const bu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:ur,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,d=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=_o(d,l,n.baseFontFull),g=ms(u,a,n,t.contentAlign),{x:m,y:w,width:h,height:b}=g;if(r>=m-4&&r<=m-4+h+8&&i>=w-4&&i<=w-4+b+8){const x=Jn(l,n.baseFontFull);o("pointer");const C=5,p=w-x;l.beginPath(),l.moveTo(a.x+m,Math.floor(a.y+p+b+C)+.5),l.lineTo(a.x+m+h,Math.floor(a.y+p+b+C)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,kn({...e,rect:{...a,x:a.x-1}},d,t.contentAlign),kn({...e,rect:{...a,x:a.x-2}},d,t.contentAlign),kn({...e,rect:{...a,x:a.x+1}},d,t.contentAlign),kn({...e,rect:{...a,x:a.x+2}},d,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,kn(e,d,t.contentAlign)},onSelect:e=>{Hl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Hl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(wu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},yu=[nu,lu,Wd,Xd,Kd,qd,Jd,tu,du,uu,hu,gu,bu],Si=[];class pu extends Vl{constructor(){super(...arguments);Ne(this,"imageLoaded",()=>{});Ne(this,"loadedLocations",[]);Ne(this,"cache",{});Ne(this,"sendLoaded",ea(()=>{this.imageLoaded(new sr(this.loadedLocations)),this.loadedLocations=[]},20));Ne(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=Si.pop()??new Image;let d=!1;const f={img:void 0,cells:[yn(o,r)],url:n,cancel:()=>{d||(d=!0,Si.length<12?Si.unshift(l):a||(l.src=""))}},u=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const g=this.cache[i];if(g!==void 0&&!d){g.img=l;for(const m of g.cells)this.loadedLocations.push(Li(m));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=yn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const vu=(e,t)=>{const n=s.useMemo(()=>({...hc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??yu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new pu,[e.imageWindowLoader]);return s.createElement(Ld,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Tu=s.forwardRef(vu);export{rd as C,Tu as D,J as G,Zl as T,Gr as a,Kl as b,en as c,Fu as d,Du as e,Eu as f,Jn as g,Wo as h,Iu as i,ll as j,Oo as k,ra as l,_o as m,Ba as n,Yo as p,Sn as r,Hu as u};
