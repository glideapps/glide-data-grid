import{j as U,a as he,F as me,s as Ce}from"./marked.esm-dbrxtycE.js";import{r as t}from"./index-BMVQvedj.js";import{c as Re}from"./throttle-7EuXLZa7.js";import{Q as Se,R as we,u as ve}from"./image-window-loader-kcFVuRwy.js";function ae(e,f,m,o){return Re(Math.round(f-(e.growOffset??0)),Math.ceil(m),Math.floor(o))}const De=e=>{const[f,m]=t.useState(),[o,D]=t.useState(),[l,X]=t.useState(),[h,w]=t.useState(),[C,b]=t.useState(!1),[K,c]=t.useState(),[R,Y]=t.useState(),[N,oe]=t.useState(),[q,ee]=t.useState(!1),[ne,re]=t.useState(),{onHeaderMenuClick:F,onHeaderIndicatorClick:te,getCellContent:x,onColumnMoved:j,onColumnResize:S,onColumnResizeStart:$,onColumnResizeEnd:W,gridRef:_,maxColumnWidth:M,minColumnWidth:I,onRowMoved:z,lockColumns:A,onColumnProposeMove:J,onMouseDown:P,onMouseUp:Z,onItemHovered:n,onDragStart:L,canvasRef:H}=e,G=(S??W??$)!==void 0,{columns:a,selection:i}=e,s=i.columns,d=t.useCallback(r=>{const[g,y]=r.location;l!==void 0&&h!==g&&g>=A?(b(!0),w(g)):R!==void 0&&y!==void 0?(ee(!0),oe(Math.max(0,y))):o===void 0&&!C&&!q&&(n==null||n(r))},[l,R,h,n,A,o,C,q]),B=j!==void 0,V=t.useCallback(r=>{var g;if(r.button===0){const[y,v]=r.location;if(r.kind==="out-of-bounds"&&r.isEdge&&G){const T=(g=_==null?void 0:_.current)==null?void 0:g.getBounds(a.length-1,-1);T!==void 0&&(m(T.x),D(a.length-1))}else if(r.kind==="header"&&y>=A){const T=H==null?void 0:H.current;if(r.isEdge&&G&&T){m(r.bounds.x),D(y);const ue=T.getBoundingClientRect().width/T.offsetWidth,ie=r.bounds.width/ue;$==null||$(a[y],ie,y,ie+(a[y].growOffset??0))}else r.kind==="header"&&B&&(c(r.bounds.x),X(y))}else r.kind==="cell"&&A>0&&y===0&&v!==void 0&&z!==void 0&&(re(r.bounds.y),Y(v))}P==null||P(r)},[P,G,A,z,_,a,B,$,H]),Q=t.useCallback((r,g)=>{C||q||F==null||F(r,g)},[C,q,F]),se=t.useCallback((r,g)=>{C||q||te==null||te(r,g)},[C,q,te]),k=t.useRef(-1),u=t.useCallback(()=>{k.current=-1,Y(void 0),oe(void 0),re(void 0),ee(!1),X(void 0),w(void 0),c(void 0),b(!1),D(void 0),m(void 0)},[]),E=t.useCallback((r,g)=>{if(r.button===0){if(o!==void 0){if((s==null?void 0:s.hasIndex(o))===!0)for(const v of s){if(v===o)continue;const T=a[v],p=ae(T,k.current,I,M);S==null||S(T,p,v,p+(T.growOffset??0))}const y=ae(a[o],k.current,I,M);if(W==null||W(a[o],y,o,y+(a[o].growOffset??0)),s.hasIndex(o))for(const v of s){if(v===o)continue;const T=a[v],p=ae(T,k.current,I,M);W==null||W(T,p,v,p+(T.growOffset??0))}}u(),l!==void 0&&h!==void 0&&(j==null||j(l,h)),R!==void 0&&N!==void 0&&(z==null||z(R,N))}Z==null||Z(r,g)},[Z,o,l,h,R,N,s,W,a,I,M,S,j,z,u]),O=t.useMemo(()=>{if(!(l===void 0||h===void 0)&&l!==h&&(J==null?void 0:J(l,h))!==!1)return{src:l,dest:h}},[l,h,J]),le=t.useCallback(r=>{const g=H==null?void 0:H.current;if(l!==void 0&&K!==void 0)Math.abs(r.clientX-K)>20&&b(!0);else if(R!==void 0&&ne!==void 0)Math.abs(r.clientY-ne)>20&&ee(!0);else if(o!==void 0&&f!==void 0&&g){const v=g.getBoundingClientRect().width/g.offsetWidth,T=(r.clientX-f)/v,p=a[o],ue=ae(p,T,I,M);if(S==null||S(p,ue,o,ue+(p.growOffset??0)),k.current=T,(s==null?void 0:s.first())===o)for(const ie of s){if(ie===o)continue;const fe=a[ie],ge=ae(fe,k.current,I,M);S==null||S(fe,ge,ie,ge+(fe.growOffset??0))}}},[l,K,R,ne,o,f,a,I,M,S,s,H]),ce=t.useCallback((r,g)=>{if(R===void 0||N===void 0)return x(r,g);let[y,v]=r;return v===N?v=R:(v>N&&(v-=1),v>=R&&(v+=1)),x([y,v],g)},[R,N,x]),de=t.useCallback(r=>{L==null||L(r),r.defaultPrevented()||u()},[u,L]);return U(Se,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ce,isResizing:o!==void 0,onHeaderMenuClick:Q,onHeaderIndicatorClick:se,isDragging:C,onItemHovered:d,onDragStart:de,onMouseDown:V,allowResize:G,onMouseUp:E,dragAndDropState:O,onMouseMoveRaw:le,ref:_})},be=De;function He(e){const f=t.useRef(null),[m,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const D=X=>{for(const h of X){const{width:w,height:C}=h&&h.contentRect||{};o(b=>b.width===w&&b.height===C?b:{width:w,height:C})}},l=new window.ResizeObserver(D);return f.current&&l.observe(f.current,void 0),()=>{l.disconnect()}},[f.current]),{ref:f,...m}}const ye=(e,f,m)=>{const o=t.useRef(null),D=t.useRef(null),l=t.useRef(null),X=t.useRef(0),h=t.useRef(f);h.current=f;const w=m.current;t.useEffect(()=>{const C=()=>{var c,R;if(D.current===!1&&w!==null){const Y=[w.scrollLeft,w.scrollTop];if(((c=l.current)==null?void 0:c[0])===Y[0]&&((R=l.current)==null?void 0:R[1])===Y[1])if(X.current>10){l.current=null,D.current=null;return}else X.current++;else X.current=0,h.current(Y[0],Y[1]),l.current=Y;o.current=window.setTimeout(C,8.333333333333334)}},b=()=>{D.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},K=c=>{c.touches.length===0&&(D.current=!1,X.current=0,o.current=window.setTimeout(C,8.333333333333334))};if(e&&w!==null){const c=w;return c.addEventListener("touchstart",b),c.addEventListener("touchend",K),()=>{c.removeEventListener("touchstart",b),c.removeEventListener("touchend",K),o.current!==null&&window.clearTimeout(o.current)}}},[e,w])},xe=ye,Me=()=>e=>e.isSafari?"scroll":"auto",ke=Ce("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[Me()]}});function Te(e){const[f,m]=t.useState(!1),o=typeof window>"u"?null:window,D=t.useRef(0);return ve("touchstart",t.useCallback(()=>{window.clearTimeout(D.current),m(!0)},[]),o,!0,!1),ve("touchend",t.useCallback(l=>{l.touches.length===0&&(D.current=window.setTimeout(()=>m(!1),e))},[e]),o,!0,!1),f}const Oe=e=>{var G,a;const{children:f,clientHeight:m,scrollHeight:o,scrollWidth:D,update:l,draggable:X,className:h,preventDiagonalScrolling:w=!1,paddingBottom:C=0,paddingRight:b=0,rightElement:K,rightElementProps:c,kineticScrollPerfHack:R=!1,scrollRef:Y,initialSize:N}=e,oe=[],q=(c==null?void 0:c.sticky)??!1,ee=(c==null?void 0:c.fill)??!1,ne=t.useRef(0),re=t.useRef(0),F=t.useRef(null),te=typeof window>"u"?1:window.devicePixelRatio,x=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),j=t.useRef(null),S=Te(200),[$,W]=t.useState(!0),_=t.useRef(0);t.useLayoutEffect(()=>{if(!$||S||x.current.lockDirection===void 0)return;const i=F.current;if(i===null)return;const[s,d]=x.current.lockDirection;s!==void 0?i.scrollLeft=s:d!==void 0&&(i.scrollTop=d),x.current.lockDirection=void 0},[S,$]);const M=t.useCallback((i,s)=>{var de;const d=F.current;if(d===null)return;s=s??d.scrollTop,i=i??d.scrollLeft;const B=x.current.scrollTop,V=x.current.scrollLeft,Q=i-V,se=s-B;S&&Q!==0&&se!==0&&(Math.abs(Q)>3||Math.abs(se)>3)&&w&&x.current.lockDirection===void 0&&(x.current.lockDirection=Math.abs(Q)<Math.abs(se)?[V,void 0]:[void 0,B]);const k=x.current.lockDirection;i=(k==null?void 0:k[0])??i,s=(k==null?void 0:k[1])??s,x.current.scrollLeft=i,x.current.scrollTop=s;const u=d.clientWidth,E=d.clientHeight,O=s,le=re.current-O,ce=d.scrollHeight-E;if(re.current=O,ce>0&&(Math.abs(le)>2e3||O===0||O===ce)&&o>d.scrollHeight+5){const r=O/ce,g=(o-E)*r;ne.current=g-O}k!==void 0&&(window.clearTimeout(_.current),W(!1),_.current=window.setTimeout(()=>W(!0),200)),l({x:i,y:O+ne.current,width:u-b,height:E-C,paddingRight:((de=j.current)==null?void 0:de.clientWidth)??0})},[C,b,o,l,w,S]);xe(R&&we.value,M,F);const I=t.useRef(M);I.current=M;const z=t.useRef(),A=t.useRef(!1);t.useLayoutEffect(()=>{A.current?M():A.current=!0},[M,C,b]);const J=t.useCallback(i=>{F.current=i,Y!==void 0&&(Y.current=i)},[Y]);let P=0,Z=0;for(oe.push(U("div",{style:{width:D,height:0}},P++));Z<o;){const i=Math.min(5e6,o-Z);oe.push(U("div",{style:{width:0,height:i}},P++)),Z+=i}const{ref:n,width:L,height:H}=He(N);return typeof window<"u"&&(((G=z.current)==null?void 0:G.height)!==H||((a=z.current)==null?void 0:a.width)!==L)&&(window.setTimeout(()=>I.current(),0),z.current={width:L,height:H}),(L??0)===0||(H??0)===0?U("div",{ref:n}):U("div",{ref:n,children:he(ke,{isSafari:we.value,children:[U("div",{className:"dvn-underlay",children:f}),U("div",{ref:J,style:z.current,draggable:X,onDragStart:i=>{X||(i.stopPropagation(),i.preventDefault())},className:"dvn-scroller "+(h??""),onScroll:()=>M(),children:he("div",{className:"dvn-scroll-inner"+(K===void 0?" dvn-hidden":""),children:[U("div",{className:"dvn-stack",children:oe}),K!==void 0&&he(me,{children:[!ee&&U("div",{className:"dvn-spacer"}),U("div",{ref:j,style:{height:H,maxHeight:m-Math.ceil(te%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:b,flexGrow:ee?1:void 0,right:q?b??0:void 0,pointerEvents:"auto"},children:K})]})]})})]})})},Xe=e=>{const{columns:f,rows:m,rowHeight:o,headerHeight:D,groupHeaderHeight:l,enableGroups:X,freezeColumns:h,experimental:w,nonGrowWidth:C,clientSize:b,className:K,onVisibleRegionChanged:c,scrollRef:R,preventDiagonalScrolling:Y,rightElement:N,rightElementProps:oe,overscrollX:q,overscrollY:ee,initialSize:ne,smoothScrollX:re=!1,smoothScrollY:F=!1,isDraggable:te}=e,{paddingRight:x,paddingBottom:j}=w??{},[S,$]=b,W=t.useRef(),_=t.useRef(),M=t.useRef(),I=t.useRef(),z=C+Math.max(0,q??0);let A=X?D+l:D;if(typeof o=="number")A+=m*o;else for(let n=0;n<m;n++)A+=o(n);ee!==void 0&&(A+=ee);const J=t.useRef(),P=t.useCallback(()=>{var se,k;if(J.current===void 0)return;const n={...J.current};let L=0,H=n.x<0?-n.x:0,G=0,a=0;n.x=n.x<0?0:n.x;let i=0;for(let u=0;u<h;u++)i+=f[u].width;for(const u of f){const E=L-i;if(n.x>=E+u.width)L+=u.width,a++,G++;else if(n.x>E)L+=u.width,re?H+=E-n.x:a++,G++;else if(n.x+n.width>E)L+=u.width,G++;else break}let s=0,d=0,B=0;if(typeof o=="number")F?(d=Math.floor(n.y/o),s=d*o-n.y):d=Math.ceil(n.y/o),B=Math.ceil(n.height/o)+d,s<0&&B++;else{let u=0;for(let E=0;E<m;E++){const O=o(E),le=u+(F?0:O/2);if(n.y>=u+O)u+=O,d++,B++;else if(n.y>le)u+=O,F?s+=le-n.y:d++,B++;else if(n.y+n.height>O/2+u)u+=O,B++;else break}}const V={x:a,y:d,width:G-a,height:B-d},Q=W.current;(Q===void 0||Q.y!==V.y||Q.x!==V.x||Q.height!==V.height||Q.width!==V.width||_.current!==H||M.current!==s||n.width!==((se=I.current)==null?void 0:se[0])||n.height!==((k=I.current)==null?void 0:k[1]))&&(c==null||c({x:a,y:d,width:G-a,height:B-d},n.width,n.height,n.paddingRight??0,H,s),W.current=V,_.current=H,M.current=s,I.current=[n.width,n.height])},[f,o,m,c,h,re,F]),Z=t.useCallback(n=>{J.current=n,P()},[P]);return t.useEffect(()=>{P()},[P]),U(Oe,{scrollRef:R,className:K,kineticScrollPerfHack:w==null?void 0:w.kineticScrollPerfHack,preventDiagonalScrolling:Y,draggable:te===!0||typeof te=="string",scrollWidth:z+(x??0),scrollHeight:A+(j??0),clientHeight:$,rightElement:N,paddingBottom:j,paddingRight:x,rightElementProps:oe,update:Z,initialSize:ne,children:U(be,{eventTargetRef:R,width:S,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY})})},Ee=Xe;export{Ee as G};
